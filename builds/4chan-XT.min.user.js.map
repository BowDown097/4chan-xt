{"version":3,"file":"4chan-XT.min.user.js","sources":["../../../../src/globals/globals.ts","../src/classes/Callbacks.js","../src/config/Config.js","../src/Monitoring/Favicon.js","../src/platform/$$.js","../src/Posting/Captcha.replace.js","../src/Posting/Captcha.t.js","../../../../src/platform/helpers.ts","../src/classes/DataBoard.js","../../../../src/classes/SimpleDict.ts","../../../../src/classes/Thread.ts","../src/classes/CatalogThread.js","../src/General/UI.js","../src/Miscellaneous/Nav.js","../src/Images/ImageHost.js","../src/Images/Volume.js","../src/Images/ImageCommon.js","../../../../src/Images/Audio.ts","../../../../src/Images/ImageExpand.ts","../../../../src/classes/Post.ts","../src/Menu/Menu.js","../src/Filtering/Recursive.js","../src/Filtering/PostHiding.js","../src/Miscellaneous/RelativeDates.js","../src/General/BoardConfig.js","../../../../src/classes/Board.ts","../src/Posting/PostRedirect.js","../src/Miscellaneous/ExpandComment.js","../src/Quotelinks/QuoteYou.js","../src/classes/RandomAccessList.js","../src/Monitoring/Unread.js","../src/Miscellaneous/ExpandThread.js","../src/Monitoring/UnreadIndex.js","../src/Monitoring/ThreadWatcher.js","../../../../src/globals/jsx.ts","../../../../src/Archive/Parse.ts","../src/Monitoring/ReplyPruning.js","../../../../src/Quotelinks/QuoteThreading.ts","../../../../src/classes/Fetcher.ts","../src/Quotelinks/QuotePreview.js","../src/General/Index.js","../src/Filtering/ThreadHiding.js","../../../../src/General/Settings/SettingsHtml.tsx","../../../../src/css/style.ts","../../../../src/css/CSS.ts","../src/Miscellaneous/CustomCSS.js","../src/site/SW.tinyboard.js","../../../../src/Miscellaneous/PassMessage/PassMessageHtml.tsx","../src/Miscellaneous/PassMessage.js","../src/Miscellaneous/Report.js","../src/Posting/PostSuccessful.js","../../../../src/site/SW.yotsuba.tsx","../../../../src/site/SW.yotsuba.Build/PostInfoHtml.tsx","../../../../src/site/SW.yotsuba.Build/FileHtml.tsx","../../../../src/site/SW.yotsuba.Build/CatalogThreadHtml.tsx","../src/site/SW.js","../../../../src/Miscellaneous/FileInfo.tsx","../../../../src/Miscellaneous/Time.ts","../../../../src/Monitoring/ThreadUpdater.ts","../../../../src/General/Settings.tsx","../src/Images/FappeTyme.js","../src/Images/Sauce.js","../src/Images/Gallery.js","../src/Linkification/Embedding.js","../src/Miscellaneous/Keybinds.js","../src/Posting/Captcha.js","../src/Posting/QR.js","../src/platform/CrossOrigin.js","../../../../src/platform/$.ts","../src/General/Get.js","../../../../src/Filtering/Filter.ts","../src/site/Site.js","../src/Miscellaneous/CatalogLinks.js","../../../../src/General/Header.ts","../src/classes/Notice.js","../../../../src/Archive/Redirect.ts","../src/classes/CatalogThreadNative.js","../src/Filtering/Anonymize.js","../src/Images/ImageHover.js","../src/Images/ImageLoader.js","../src/Images/Metadata.js","../src/Images/RevealSpoilers.js","../src/Linkification/Linkify.js","../src/Menu/ArchiveLink.js","../src/Menu/CopyTextLink.js","../src/Menu/DeleteLink.js","../src/Menu/DownloadLink.js","../src/Menu/ReportLink.js","../src/Miscellaneous/AntiAutoplay.js","../src/Miscellaneous/Banner.js","../src/Miscellaneous/Flash.js","../src/Miscellaneous/Fourchan.js","../src/Miscellaneous/IDColor.js","../src/Miscellaneous/IDHighlight.js","../src/Miscellaneous/IDPostCount.js","../src/Miscellaneous/ModContact.js","../src/Miscellaneous/NormalizeURL.js","../src/Miscellaneous/PostJumper.js","../src/Miscellaneous/PSA.js","../src/Miscellaneous/PSAHiding.js","../src/Miscellaneous/RemoveSpoilers.js","../src/Miscellaneous/ThreadLinks.js","../src/Miscellaneous/Tinyboard.js","../src/Monitoring/MarkNewIPs.js","../src/Monitoring/ThreadStats.js","../src/Posting/PassLink.js","../src/Quotelinks/QuoteInline.js","../src/Quotelinks/QuoteBacklink.js","../src/Quotelinks/QuoteCT.js","../src/Quotelinks/QuoteOP.js","../src/Quotelinks/Quotify.js","../src/General/Polyfill.js","../../../../src/Archive/RestoreDeletedFromArchive.ts","../src/main/Main.js","../src/Quotelinks/QuoteStrikeThrough.js"],"sourcesContent":[null,"import Main from \"../main/Main\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS206: Consider reworking classes to avoid initClass\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nexport default class Callbacks {\r\n  static initClass() {\r\n    this.Post          = new Callbacks('Post');\r\n    this.Thread        = new Callbacks('Thread');\r\n    this.CatalogThread = new Callbacks('Catalog Thread');\r\n    this.CatalogThreadNative = new Callbacks('Catalog Thread');\r\n  }\r\n\r\n  constructor(type) {\r\n    this.type = type;\r\n    this.keys = [];\r\n  }\r\n\r\n  push({name, cb}) {\r\n    if (!this[name]) { this.keys.push(name); }\r\n    return this[name] = cb;\r\n  }\r\n\r\n  execute(node, keys=this.keys, force=false) {\r\n    let errors;\r\n    if (node.callbacksExecuted && !force) { return; }\r\n    node.callbacksExecuted = true;\r\n    for (var name of keys) {\r\n      try {\r\n        this[name]?.call(node);\r\n      } catch (err) {\r\n        if (!errors) { errors = []; }\r\n        errors.push({\r\n          message: ['\"', name, '\" crashed on node ', this.type, ' No.', node.ID, ' (', node.board, ').'].join(''),\r\n          error: err,\r\n          html: node.nodes?.root?.outerHTML\r\n        });\r\n      }\r\n    }\r\n\r\n    if (errors) { return Main.handleErrors(errors); }\r\n  }\r\n}\r\nCallbacks.initClass();\r\n","import userCss from './user.css';\r\nimport banners from './banners.json';\r\nimport meta from '../../package.json';\r\n\r\nconst Config = {\r\n  main: {\r\n    'Miscellaneous': {\r\n      'Redirect to HTTPS': [\r\n        true,\r\n        'Redirect to the HTTPS version of 4chan.'\r\n      ],\r\n      'JSON Index': [\r\n        true,\r\n        'Replace the original board index with one supporting searching, sorting, infinite scrolling, and a catalog mode.'\r\n      ],\r\n      [`Use ${meta.name} Catalog`]: [\r\n        true,\r\n        `Link to ${meta.name}'s catalog instead of the native 4chan one.`,\r\n        1\r\n      ],\r\n      'Index Refresh Notifications': [\r\n        false,\r\n        'Show a notice at the top of the page when the index is refreshed.',\r\n        1\r\n      ],\r\n      'Follow Cursor': [\r\n        true,\r\n        'Image Hover and Quote Preview move with the mouse cursor.'\r\n      ],\r\n      'Open Threads in New Tab': [\r\n        false,\r\n        `Make links to threads in the index / ${meta.name} catalog open in a new tab.`\r\n      ],\r\n      'External Catalog': [\r\n        false,\r\n        'Link to external catalog instead of the internal one.'\r\n      ],\r\n      'Catalog Links': [\r\n        false,\r\n        'Add toggle link in header menu to turn Navigation links into links to each board\\'s catalog.'\r\n      ],\r\n      'Announcement Hiding': [\r\n        true,\r\n        'Add button to hide 4chan announcements.'\r\n      ],\r\n      'Desktop Notifications': [\r\n        true,\r\n        `Enables desktop notifications across various ${meta.name} features.`\r\n      ],\r\n      '404 Redirect': [\r\n        true,\r\n        'Redirect dead threads and images to the archives.'\r\n      ],\r\n      'Archive Report': [\r\n        true,\r\n        'Enable reporting posts to supported archives.'\r\n      ],\r\n      'Exempt Archives from Encryption': [\r\n        false,\r\n        'Permit loading content from, and warningless redirects to, HTTP-only archives from HTTPS pages.'\r\n      ],\r\n      'Keybinds': [\r\n        true,\r\n        'Bind actions to keyboard shortcuts.'\r\n      ],\r\n      'Time Formatting': [\r\n        true,\r\n        'Localize and format timestamps.'\r\n      ],\r\n      'Relative Post Dates': [\r\n        true,\r\n        'Display dates like \"3 minutes ago\". Tooltip shows the timestamp.'\r\n      ],\r\n      'Relative Date Title': [\r\n        true,\r\n        'Show Relative Post Date only when hovering over dates.',\r\n        1\r\n      ],\r\n      'Comment Expansion': [\r\n        true,\r\n        'Expand comments that are too long to display on the index. Not applicable with JSON Index.'\r\n      ],\r\n      'File Info Formatting': [\r\n        true,\r\n        'Reformat the file information.'\r\n      ],\r\n      'Thread Expansion': [\r\n        true,\r\n        'Add buttons to expand threads.'\r\n      ],\r\n      'Index Navigation': [\r\n        false,\r\n        'Add buttons to navigate between threads.'\r\n      ],\r\n      'Reply Navigation': [\r\n        false,\r\n        'Add buttons to navigate to top / bottom of thread.'\r\n      ],\r\n      'Unique ID and Capcode Navigation': [\r\n        false,\r\n        'Add buttons to navigate to posts having the same unique ID or capcode.'\r\n      ],\r\n      'Custom Board Titles': [\r\n        true,\r\n        'Allow editing of the board title and subtitle by ctrl/\\u2318+clicking them.'\r\n      ],\r\n      'Persistent Custom Board Titles': [\r\n        false,\r\n        'Force custom board titles to be persistent, even if the board titles are updated.',\r\n        1\r\n      ],\r\n      'Show Updated Notifications': [\r\n        true,\r\n        `Show notifications when ${meta.name} is successfully updated.`\r\n      ],\r\n      'Color User IDs': [\r\n        true,\r\n        'Assign unique colors to user IDs on boards that use them'\r\n      ],\r\n      'Count Posts by ID': [\r\n        true,\r\n        'Display number of posts in the thread when hovering over an ID.'\r\n      ],\r\n      'Remove Spoilers': [\r\n        false,\r\n        'Remove all spoilers in text.'\r\n      ],\r\n      'Reveal Spoilers': [\r\n        false,\r\n        'Indicate spoilers if Remove Spoilers is enabled, or make the text appear hovered if Remove Spoiler is disabled.'\r\n      ],\r\n      'Normalize URL': [\r\n        true,\r\n        'Rewrite the URL of the current page, removing slugs and excess slashes, and changing /res/ to /thread/.'\r\n      ],\r\n      'Work around CORB Bug': [\r\n        true,\r\n        'Leave this checked until your garbage browser is fixed.'\r\n      ],\r\n      'Disable Autoplaying Sounds': [\r\n        false,\r\n        'Prevent sounds on the page from autoplaying.'\r\n      ],\r\n      'Disable Native Extension': [\r\n        true,\r\n        `${meta.name} is NOT designed to work with the native extension.`\r\n      ],\r\n      'Enable Native Flash Embedding': [\r\n        true,\r\n        'Activate the native extension\\'s Flash embedding if the native extension is disabled.'\r\n      ]\r\n    },\r\n\r\n    'Linkification': {\r\n      'Linkify': [\r\n        true,\r\n        'Convert text into links where applicable.'\r\n      ],\r\n      'Link Title': [\r\n        true,\r\n        'Replace the link of a supported site with its actual title.',\r\n        1\r\n      ],\r\n      'Link Title in the catalog': [\r\n        false,\r\n        'Replace the link of a supported site with its actual title in the catalog too. ' +\r\n          'This is a separate settings because /vt/ had some many embeds it lagged Violentmonkey on chromium ' +\r\n          '<a href=\"https://github.com/ccd0/4chan-x/issues/3427\" target=\"_blank\" rel=\"noopener\">(4chan-x#3427)</a>.',\r\n        2\r\n      ],\r\n      'Cover Preview': [\r\n        true,\r\n        'Show preview of supported links on hover.',\r\n        1\r\n      ],\r\n      'Embedding': [\r\n        true,\r\n        'Embed supported services. Note: Some services don\\'t work on HTTPS.',\r\n        1\r\n      ],\r\n      'Auto-embed': [\r\n        false,\r\n        'Auto-embed Linkify Embeds.',\r\n        2\r\n      ],\r\n      'Floating Embeds': [\r\n        false,\r\n        'Embed content in a frame that remains in place when the page is scrolled.',\r\n        2\r\n      ]\r\n    },\r\n\r\n    'Filtering': {\r\n      'Anonymize': [\r\n        false,\r\n        'Make everyone Anonymous.'\r\n      ],\r\n      'Filter': [\r\n        true,\r\n        'Self-moderation placebo.'\r\n      ],\r\n      'Filtered Backlinks': [\r\n        false,\r\n        'When enabled, shows backlinks to filtered posts with a line-through decoration. Otherwise, hides the backlinks.',\r\n        1\r\n      ],\r\n      'Filter in Native Catalog': [\r\n        true,\r\n        'Apply 4chan X filters in native catalog.',\r\n        1\r\n      ],\r\n      'MD5 Quick Filter Notifications': [\r\n        true,\r\n        'Show notification when quick filtering MD5s using the button or keybind.',\r\n        1\r\n      ],\r\n      'Recursive Hiding': [\r\n        true,\r\n        'Hide replies of hidden posts, recursively.'\r\n      ],\r\n      'Thread Hiding Buttons': [\r\n        true,\r\n        'Add buttons to hide entire threads.'\r\n      ],\r\n      'Reply Hiding Buttons': [\r\n        true,\r\n        'Add buttons to hide single replies.'\r\n      ],\r\n      'Stubs': [\r\n        true,\r\n        'Show stubs of hidden threads / replies.'\r\n      ]\r\n    },\r\n\r\n    'Images and Videos': {\r\n      'Image Expansion': [\r\n        true,\r\n        'Expand images / videos.'\r\n      ],\r\n      'Image Hover': [\r\n        true,\r\n        'Show full image / video on mouseover.'\r\n      ],\r\n      'Image Hover in Catalog': [\r\n        true,\r\n        `Show full image / video on mouseover in ${meta.name} catalog.`\r\n      ],\r\n      'Gallery': [\r\n        true,\r\n        'Adds a simple and cute image gallery. Has more options in the gallery menu.'\r\n      ],\r\n      'Fullscreen Gallery': [\r\n        false,\r\n        'Open gallery in fullscreen mode.',\r\n        1\r\n      ],\r\n      'PDF in Gallery': [\r\n        false,\r\n        'Show PDF files in gallery.',\r\n        1\r\n      ],\r\n      'Sauce': [\r\n        true,\r\n        'Add sauce links to images.'\r\n      ],\r\n      'WEBM Metadata': [\r\n        true,\r\n        'Add link to fetch title metadata from webm videos.'\r\n      ],\r\n      'Reveal Spoiler Thumbnails': [\r\n        false,\r\n        'Replace spoiler thumbnails with the original image.'\r\n      ],\r\n      'Replace GIF': [\r\n        false,\r\n        'Replace gif thumbnails with the actual image.'\r\n      ],\r\n      'Replace JPG': [\r\n        false,\r\n        'Replace jpg thumbnails with the actual image.'\r\n      ],\r\n      'Replace PNG': [\r\n        false,\r\n        'Replace png thumbnails with the actual image.'\r\n      ],\r\n      'Replace WEBM': [\r\n        false,\r\n        'Replace webm, mp4, and ogv thumbnails with the actual video. Probably will degrade browser performance ;)'\r\n      ],\r\n      'Image Prefetching': [\r\n        true,\r\n        'Add a shortcut icon to the header to turn on image preloading.'\r\n      ],\r\n      'Fappe Tyme': [\r\n        true,\r\n        'Hide posts without images when header menu item is checked. *hint* *hint*'\r\n      ],\r\n      'Werk Tyme': [\r\n        true,\r\n        'Hide all post images when header menu item is checked.'\r\n      ],\r\n      'Autoplay': [\r\n        true,\r\n        'Videos begin playing immediately when opened.'\r\n      ],\r\n      'Restart when Opened': [\r\n        false,\r\n        'Restart GIFs and WebMs when you hover over or expand them.'\r\n      ],\r\n      'Show Controls': [\r\n        true,\r\n        'Show controls on videos expanded inline.'\r\n      ],\r\n      'Click Passthrough': [\r\n        false,\r\n        'Clicks on videos trigger your browser\\'s default behavior. Videos can be contracted with button / dragging to the left.',\r\n        1\r\n      ],\r\n      'Allow Sound': [\r\n        true,\r\n        'Open videos with the sound unmuted.'\r\n      ],\r\n      'Mouse Wheel Volume': [\r\n        true,\r\n        'Adjust volume of videos with the mouse wheel over the thumbnail/filename/gallery.'\r\n      ],\r\n      'Loop in New Tab': [\r\n        true,\r\n        'Loop videos opened in their own tabs.'\r\n      ],\r\n      'Volume in New Tab': [\r\n        true,\r\n        `Apply ${meta.name} mute and volume settings to videos opened in their own tabs.`\r\n      ],\r\n      'Enable sound posts': [\r\n        true,\r\n        'Enable loading audio from [sound=] file names. This audio is fetched from third parties.'\r\n      ],\r\n    },\r\n\r\n    'Menu': {\r\n      'Menu': [\r\n        true,\r\n        'Add a drop-down menu to posts.'\r\n      ],\r\n      'Report Link': [\r\n        true,\r\n        'Add a report link to the menu.',\r\n        1\r\n      ],\r\n      'Copy Text Link': [\r\n        true,\r\n        'Add a link to copy the post\\'s text.',\r\n        1\r\n      ],\r\n      'Thread Hiding Link': [\r\n        true,\r\n        'Add a link to hide entire threads.',\r\n        1\r\n      ],\r\n      'Reply Hiding Link': [\r\n        true,\r\n        'Add a link to hide single replies.',\r\n        1\r\n      ],\r\n      'Delete Link': [\r\n        true,\r\n        'Add post and image deletion links to the menu.',\r\n        1\r\n      ],\r\n      'Archive Link': [\r\n        true,\r\n        'Add an archive link to the menu.',\r\n        1\r\n      ],\r\n      'Edit Link': [\r\n        true,\r\n        'Add a link to edit the image in Tegaki, /i/\\'s painting program. Requires Quick Reply.',\r\n        1\r\n      ],\r\n      'Download Link': [\r\n        false,\r\n        'Add a download with original filename link to the menu.',\r\n        1\r\n      ]\r\n    },\r\n\r\n    'Monitoring': {\r\n      'Thread Updater': [\r\n        true,\r\n        'Fetch and insert new replies. Has more options in the header menu and the \"Advanced\" tab.'\r\n      ],\r\n      'Unread Count': [\r\n        true,\r\n        'Show the unread posts count in the tab title.'\r\n      ],\r\n      'Quoted Title': [\r\n        false,\r\n        'Change the page title to reflect you\\'ve been quoted.',\r\n        1\r\n      ],\r\n      'Hide Unread Count at (0)': [\r\n        false,\r\n        'Hide the unread posts count in the tab title when it reaches 0.',\r\n        1\r\n      ],\r\n      'Unread Favicon': [\r\n        true,\r\n        'Show a different favicon when there are unread posts.'\r\n      ],\r\n      'Unread Line': [\r\n        true,\r\n        'Show a line to distinguish read posts from unread ones.'\r\n      ],\r\n      'Remember Last Read Post': [\r\n        true,\r\n        'Remember how far you\\'ve read after you close the thread.'\r\n      ],\r\n      'Scroll to Last Read Post': [\r\n        true,\r\n        'Scroll back to the last read post when reopening a thread.',\r\n        1\r\n      ],\r\n      'Unread Line in Index': [\r\n        false,\r\n        'Show a line between read and unread posts in threads in the index.',\r\n        1\r\n      ],\r\n      'Remove Thread Excerpt': [\r\n        false,\r\n        'Replace the excerpt of the thread in the tab title with the board title.'\r\n      ],\r\n      'Thread Stats': [\r\n        true,\r\n        'Display reply and image count.'\r\n      ],\r\n      'IP Count in Stats': [\r\n        true,\r\n        'Display the unique IP count in the thread stats.',\r\n        1\r\n      ],\r\n      'Page Count in Stats': [\r\n        true,\r\n        'Display the page count in the thread stats.',\r\n        1\r\n      ],\r\n      'Updater and Stats in Header': [\r\n        true,\r\n        'Places the thread updater and thread stats in the header instead of floating them.'\r\n      ],\r\n      'Thread Watcher': [\r\n        true,\r\n        'Bookmark threads. Has more options in the thread watcher menu.'\r\n      ],\r\n      'Fixed Thread Watcher': [\r\n        true,\r\n        'Makes the thread watcher scroll with the page.',\r\n        1\r\n      ],\r\n      'Persistent Thread Watcher': [\r\n        false,\r\n        'The thread watcher will be visible when the page is loaded.',\r\n        1\r\n      ],\r\n      'Mark New IPs': [\r\n        false,\r\n        'Label each post from a new IP with the thread\\'s current IP count.'\r\n      ],\r\n      'Reply Pruning': [\r\n        true,\r\n        'Add option in header menu to hide old replies in long threads. Activated by default in stickies.'\r\n      ],\r\n      'Prune All Threads': [\r\n        false,\r\n        'Activate Reply Pruning by default in all threads.',\r\n        1\r\n      ]\r\n    },\r\n\r\n    'Posting and Captchas': {\r\n      'Quick Reply': [\r\n        true,\r\n        'All-in-one form to reply, create threads, automate dumping and more.'\r\n      ],\r\n      'Persistent QR': [\r\n        false,\r\n        'The Quick reply won\\'t disappear after posting.',\r\n        1\r\n      ],\r\n      'Auto Hide QR': [\r\n        true,\r\n        'Automatically hide the quick reply when posting.',\r\n        2\r\n      ],\r\n      'Open Post in New Tab': [\r\n        true,\r\n        'Open new threads in a new tab, and open replies in a new tab if you\\'re not already in the thread.',\r\n        1\r\n      ],\r\n      'Remember QR Size': [\r\n        false,\r\n        'Remember the size of the Quick reply.',\r\n        1\r\n      ],\r\n      'Remember Spoiler': [\r\n        false,\r\n        'Remember the spoiler state, instead of resetting after posting.',\r\n        1\r\n      ],\r\n      'Randomize Filename': [\r\n        false,\r\n        'Set the filename to a random timestamp within the past year. Disabled on /f/.',\r\n        1\r\n      ],\r\n      'Show New Thread Option in Threads': [\r\n        true,\r\n        'Show the option to post a new / different thread from inside a thread.',\r\n        1\r\n      ],\r\n      'Show Upload Progress': [\r\n        true,\r\n        'Track progress of file uploads as percentage in submit button.',\r\n        1\r\n      ],\r\n      'Cooldown': [\r\n        true,\r\n        'Indicate the remaining time before posting again.',\r\n        1\r\n      ],\r\n      'Posting Success Notifications': [\r\n        true,\r\n        'Show notifications on successful post creation or file uploading.',\r\n        1\r\n      ],\r\n      'Auto-load captcha': [\r\n        false,\r\n        'Automatically load the captcha in the QR even if your post is empty.',\r\n        1\r\n      ],\r\n      'Post on Captcha Completion': [\r\n        false,\r\n        'Submit the post immediately when the captcha is completed.',\r\n        1\r\n      ],\r\n      'Force Noscript Captcha': [\r\n        false,\r\n        'Use the non-Javascript fallback captcha even if Javascript is enabled.'\r\n      ],\r\n      'Pass Link': [\r\n        false,\r\n        'Add a 4chan Pass login link to the bottom of the page.'\r\n      ]\r\n    },\r\n\r\n    'Quote Links': {\r\n      'Quote Backlinks': [\r\n        true,\r\n        'Add quote backlinks.'\r\n      ],\r\n      'OP Backlinks': [\r\n        true,\r\n        'Add backlinks to the OP.',\r\n        1\r\n      ],\r\n      'Bottom Backlinks': [\r\n        false,\r\n        'Place backlinks at the bottom of posts.',\r\n        1\r\n      ],\r\n      'Quote Inlining': [\r\n        true,\r\n        'Inline quoted post on click.'\r\n      ],\r\n      'Inline Cross-thread Quotes Only': [\r\n        false,\r\n        'Don\\'t inline quote links when the posts are visible in the thread.',\r\n        1\r\n      ],\r\n      'Quote Hash Navigation': [\r\n        false,\r\n        'Include an extra link after quotes for autoscrolling to quoted posts.',\r\n        1\r\n      ],\r\n      'Forward Hiding': [\r\n        true,\r\n        'Hide original posts of inlined backlinks.',\r\n        1\r\n      ],\r\n      'Quote Previewing': [\r\n        true,\r\n        'Show quoted post on hover.'\r\n      ],\r\n      'Quote Highlighting': [\r\n        true,\r\n        'Highlight the previewed post.',\r\n        1\r\n      ],\r\n      'Resurrect Quotes': [\r\n        true,\r\n        'Link dead quotes to the archives, and support inlining/previewing of archive links like quote links.'\r\n      ],\r\n      'Remember Your Posts': [\r\n        true,\r\n        'Remember your posting history.'\r\n      ],\r\n      'Mark Quotes of You': [\r\n        true,\r\n        'Add \\'(You)\\' to quotes linking to your posts.',\r\n        1\r\n      ],\r\n      'Highlight Posts Quoting You': [\r\n        true,\r\n        'Highlights any posts that contain a quote to your post.',\r\n        1\r\n      ],\r\n      'Highlight Own Posts': [\r\n        true,\r\n        'Highlights own posts.',\r\n        1\r\n      ],\r\n      'Mark OP Quotes': [\r\n        true,\r\n        'Add \\'(OP)\\' to OP quotes.'\r\n      ],\r\n      'Mark Cross-thread Quotes': [\r\n        true,\r\n        'Add \\'(Cross-thread)\\' to cross-threads quotes.'\r\n      ],\r\n      'Quote Threading': [\r\n        true,\r\n        'Add option in header menu to thread conversations.'\r\n      ]\r\n    }\r\n  },\r\n\r\n  imageExpansion: {\r\n    'Fit width': [\r\n      true,\r\n      ''\r\n    ],\r\n    'Fit height': [\r\n      false,\r\n      ''\r\n    ],\r\n    'Scroll into view': [\r\n      true,\r\n      'Scroll down when expanding images to bring the full image into view.'\r\n    ],\r\n    'Expand spoilers': [\r\n      true,\r\n      'Expand all images along with spoilers.'\r\n    ],\r\n    'Expand videos': [\r\n      true,\r\n      'Expand all images also expands videos.'\r\n    ],\r\n    'Expand from here': [\r\n      false,\r\n      'Expand all images only from current position to thread end.'\r\n    ],\r\n    'Expand thread only': [\r\n      false,\r\n      'In index, expand all images only within the current thread.'\r\n    ],\r\n    'Advance on contract': [\r\n      false,\r\n      'Advance to next post when contracting an expanded image.'\r\n    ]\r\n  },\r\n\r\n  gallery: {\r\n    'Hide Thumbnails': [\r\n      false\r\n    ],\r\n    'Fit Width': [ // 'Fit width' (lowercase W) belongs to Image Expansion. Engine limitations, heh.\r\n      true\r\n    ],\r\n    'Fit Height': [\r\n      true\r\n    ],\r\n    'Stretch to Fit': [\r\n      false\r\n    ],\r\n    'Scroll to Post': [\r\n      true\r\n    ],\r\n    'Slide Delay': [\r\n      6.0\r\n    ]\r\n  },\r\n\r\n  'Default Volume': 1.0,\r\n\r\n  threadWatcher: {\r\n    'Current Board': [\r\n      false,\r\n      'Only show watched threads from the current board.'\r\n    ],\r\n    'Auto Update Thread Watcher': [\r\n      true,\r\n      'Periodically check status of watched threads.'\r\n    ],\r\n    'Auto Watch': [\r\n      true,\r\n      'Automatically watch threads you start.'\r\n    ],\r\n    'Auto Watch Reply': [\r\n      true,\r\n      'Automatically watch threads you reply to.'\r\n    ],\r\n    'Auto Prune': [\r\n      false,\r\n      'Automatically remove dead threads.'\r\n    ],\r\n    'Show Page': [\r\n      true,\r\n      'Show what page watched threads are on.'\r\n    ],\r\n    'Show Unread Count': [\r\n      true,\r\n      'Show number of unread posts in watched threads.'\r\n    ],\r\n    'Show Site Prefix': [\r\n      true,\r\n      'When multiple sites are shown in the thread watcher, add a prefix to board names to distinguish them.'\r\n    ],\r\n    'Require OP Quote Link': [\r\n      false,\r\n      'For purposes of thread watcher highlighting, only consider posts with a quote link to the OP as replies to the OP.'\r\n    ]\r\n  },\r\n\r\n  filter: {\r\n    general: '',\r\n\r\n    postID: `\\\r\n# Highlight dubs on [s4s]:\r\n#/(\\\\d)\\\\1$/;highlight;top:no;boards:s4s\\\r\n`,\r\n\r\n    name: `\\\r\n# Filter any namefags:\r\n#/^(?!Anonymous$)/\\\r\n`,\r\n\r\n    uniqueID: `\\\r\n# Filter a specific ID:\r\n#/Txhvk1Tl/\\\r\n`,\r\n\r\n    tripcode: `\\\r\n# Filter any tripfag\r\n#/^!/\\\r\n`,\r\n\r\n    capcode: `\\\r\n# Set a custom class for mods:\r\n#/Mod$/;highlight:mod;op:yes\r\n# Set a custom class for admins:\r\n#/Admin$/;highlight:admin;op:yes\\\r\n`,\r\n\r\n    pass: `\\\r\n# Filter anyone using since4pass:\r\n#/./\\\r\n`,\r\n\r\n    email: '',\r\n\r\n    subject: `\\\r\n# Filter Generals on /v/:\r\n#/general/i;boards:v;op:only\\\r\n`,\r\n\r\n    comment: `\\\r\n# Filter Stallman copypasta on /g/:\r\n#/what you\\'re refer+ing to as linux/i;boards:g\r\n# Filter posts with 20 or more quote links:\r\n#/(?:>>\\\\d(?:(?!>>\\\\d)[^])*){20}/\r\n# Filter posts like T H I S / H / I / S:\r\n#/^>?\\\\s?\\\\w\\\\s?(\\\\w)\\\\s?(\\\\w)\\\\s?(\\\\w).*$[\\\\s>]+\\\\1[\\\\s>]+\\\\2[\\\\s>]+\\\\3/im\\\r\n`,\r\n\r\n    flag: '',\r\n    filename: '',\r\n    dimensions: `\\\r\n# Highlight potential wallpapers:\r\n#/1920x1080/;op:yes;highlight;top:no;boards:w,wg\\\r\n`,\r\n\r\n    filesize: '',\r\n\r\n    MD5: ''\r\n  },\r\n\r\n  sauces: `\\\r\n# Known filename formats:\r\nhttps://www.pixiv.net/member_illust.php?mode=medium&illust_id=%$1;regexp:/^(\\\\d+)_p\\\\d+/\r\njavascript:void(open(\"https://www.deviantart.com/\"+%$1.replace(/_/g,\"-\")+\"/art/\"+parseInt(%$2,36)));regexp:/^\\\\w+_by_(\\\\w+)[_-]d([\\\\da-z]{6})\\\\b/\r\nhttps://imgur.com/%$1;regexp:/^(?![a-zA-Z][a-z]{6})(?![A-Z]{7})(?!\\\\d{7})([\\\\da-zA-Z]{7})(?: \\\\(\\\\d+\\\\))?\\\\.\\\\w+$/\r\nhttps://flickr.com/photo.gne?id=%$1;regexp:/^(\\\\d+)_[\\\\da-f]{10}(?:_\\\\w)*\\\\b/\r\nhttps://www.facebook.com/photo.php?fbid=%$1;regexp:/^\\\\d+_(\\\\d+)_\\\\d+_[no]\\\\b/\r\n\r\n# Reverse image search:\r\nhttps://www.google.com/searchbyimage?sbisrc=4chanx&image_url=%IMG&safe=off\r\nhttps://yandex.com/images/search?rpt=imageview&url=%IMG\r\n#//tineye.com/search?url=%IMG\r\n#//www.bing.com/images/search?q=imgurl:%IMG&view=detailv2&iss=sbi#enterInsights\r\n#https://lens.google.com/uploadbyurl?url=%IMG;text:lens\r\n\r\n# Specialized reverse image search:\r\n//iqdb.org/?url=%IMG\r\nhttps://trace.moe/?auto&url=%IMG;text:wait\r\n#//3d.iqdb.org/?url=%IMG\r\n#//saucenao.com/search.php?url=%IMG\r\n\r\n# \"View Same\" in archives:\r\nhttp://eye.swfchan.com/search/?q=%name;types:swf\r\n#https://desuarchive.org/_/search/image/%sMD5/\r\n#https://archive.4plebs.org/_/search/image/%sMD5/\r\n#https://boards.fireden.net/_/search/image/%sMD5/\r\n#https://foolz.fireden.net/_/search/image/%sMD5/\r\n\r\n# Other tools:\r\n#http://exif.regex.info/exif.cgi?imgurl=%URL\r\n#//imgops.com/start?url=%URL;types:gif,jpg,png\r\n#//www.gif-explode.com/%URL;types:gif\\\r\n`,\r\n\r\n  FappeT: {\r\n    werk:  false\r\n  },\r\n\r\n  'Custom CSS': true,\r\n\r\n  Index: {\r\n    'Index Mode': 'paged',\r\n    'Previous Index Mode': 'paged',\r\n    'Index Size': 'small',\r\n    'Show Replies':          [true,  'Show replies in the index, and also in the catalog if \"Catalog hover expand\" is checked.'],\r\n    'Catalog Hover Expand':  [false, 'Expand the comment and show more details when you hover over a thread in the catalog.'],\r\n    'Catalog Hover Toggle':  [true,  'Turn \"Catalog hover expand\" on and off by clicking in the catalog.'],\r\n    'Pin Watched Threads':   [false, 'Move watched threads to the start of the index.'],\r\n    'Anchor Hidden Threads': [true,  'Move hidden threads to the end of the index.'],\r\n    'Refreshed Navigation':  [false, 'Refresh index when navigating through pages.']\r\n  },\r\n\r\n  Header: {\r\n    'Fixed Header':               true,\r\n    'Header auto-hide':           false,\r\n    'Header auto-hide on scroll': false,\r\n    'Bottom Header':              false,\r\n    'Centered links':             false,\r\n    'Header catalog links':       false,\r\n    'Bottom Board List':          true,\r\n    'Shortcut Icons':             true,\r\n    'Custom Board Navigation':    true\r\n  },\r\n\r\n  archives: {\r\n    archiveLists:      'https://4chenz.github.io/archives.json/archives.json',\r\n    lastarchivecheck:  0,\r\n    archiveAutoUpdate: true\r\n  },\r\n\r\n  externalCatalogURLs: `\\\r\n//catalog.neet.tv/%board/;boards:4chan.org:3,a,adv,an,asp,biz,c,cgl,ck,cm,co,diy,f,fa,fit,g,gd,his,i,int,jp,k,lgbt,lit,m,mlp,mu,n,news,o,out,p,po,pol,s4s,sci,sp,tg,toy,trv,tv,v,vg,vip,vp,vr,w,wg,wsg,wsr,x\\\r\n`,\r\n\r\n  boardnav: `\\\r\n[ toggle-all ]\r\n[current-index-text:\"Index\"\r\ncurrent-catalog-text:\"Catalog\"\r\ncurrent-expired-text:\"Expired\"\r\ncurrent-archive-text:\"Archive\"]\r\n[external-text:\"FAQ\",\"${meta.faq}\"]\\\r\n`,\r\n\r\n  QR: {\r\n    'QR.personas': `\\\r\n#options:\"sage\";boards:jp;always\\\r\n`,\r\n    sjisPreview: false\r\n  },\r\n\r\n  jsWhitelist: `\\\r\nhttp://s.4cdn.org\r\nhttps://s.4cdn.org\r\nhttp://www.google.com\r\nhttps://www.google.com\r\nhttps://www.gstatic.com\r\nhttp://cdn.mathjax.org\r\nhttps://cdn.mathjax.org\r\nhttps://cdnjs.cloudflare.com\r\nhttps://hcaptcha.com\r\nhttps://*.hcaptcha.com\r\n'self'\r\n'unsafe-inline'\r\n'unsafe-eval'\\\r\n`,\r\n\r\n  captchaLanguage: '',\r\n\r\n  time: '%m/%d/%y(%a)%H:%M:%S',\r\n  timeLocale: '',\r\n\r\n  backlink: '>>%id',\r\n\r\n  pastedname: 'file',\r\n\r\n  fileInfo: '%l %d (%p%s, %r%g)',\r\n\r\n  favicon: 'ferongr',\r\n\r\n  usercss: userCss,\r\n\r\n  hotkeys: {\r\n    // QR & Options\r\n    'Toggle board list': [\r\n      'Ctrl+b',\r\n      'Toggle the full board list.'\r\n    ],\r\n    'Toggle header': [\r\n      'Shift+h',\r\n      'Toggle the auto-hide option of the header.'\r\n    ],\r\n    'Open empty QR': [\r\n      'q',\r\n      'Open QR without post number inserted.'\r\n    ],\r\n    'Open QR': [\r\n      'Shift+q',\r\n      'Open QR with post number inserted.'\r\n    ],\r\n    'Open settings': [\r\n      'Alt+o',\r\n      'Open Settings.'\r\n    ],\r\n    'Close': [\r\n      'Esc',\r\n      'Close dialogs or notifications.'\r\n    ],\r\n    'Spoiler tags': [\r\n      'Ctrl+s',\r\n      'Insert spoiler tags.'\r\n    ],\r\n    'Code tags': [\r\n      'Alt+c',\r\n      'Insert code tags.'\r\n    ],\r\n    'Eqn tags':  [\r\n      'Alt+e',\r\n      'Insert eqn tags.'\r\n    ],\r\n    'Math tags': [\r\n      'Alt+m',\r\n      'Insert math tags.'\r\n    ],\r\n    'SJIS tags': [\r\n      'Alt+a',\r\n      'Insert SJIS tags.'\r\n    ],\r\n    'Toggle sage': [\r\n      'Alt+s',\r\n      'Toggle sage in options field.'\r\n    ],\r\n    'Toggle Cooldown': [\r\n      'Alt+Comma',\r\n      'Toggle custom cooldown timer.'\r\n    ],\r\n    'Post from URL': [\r\n      'Alt+l',\r\n      'Post from URL.'\r\n    ],\r\n    'Add new post': [\r\n      'Alt+n',\r\n      'Add new post to the QR dump list.'\r\n    ],\r\n    'Submit QR': [\r\n      'Ctrl+Enter',\r\n      'Submit post.'\r\n    ],\r\n    // Thread related\r\n    'Watch': [\r\n      'w',\r\n      'Watch thread.'\r\n    ],\r\n    'Update': [\r\n      'r',\r\n      'Update the thread / refresh the index.'\r\n    ],\r\n    'Update thread watcher': [\r\n      'Shift+r',\r\n      'Manually refresh thread watcher.'\r\n    ],\r\n    'Toggle thread watcher': [\r\n      't',\r\n      'Toggle visibility of thread watcher.'\r\n    ],\r\n    'Toggle threading': [\r\n      'Shift+t',\r\n      'Toggle threading.'\r\n    ],\r\n    'Mark thread read': [\r\n      'Ctrl+0',\r\n      'Mark thread read from index (requires \"Unread Line in Index\").'\r\n    ],\r\n    // Images\r\n    'Expand image': [\r\n      'Shift+e',\r\n      'Expand selected image.'\r\n    ],\r\n    'Expand images': [\r\n      'e',\r\n      'Expand all images.'\r\n    ],\r\n    'Open Gallery': [\r\n      'g',\r\n      'Opens the gallery.'\r\n    ],\r\n    'Next Gallery Image': [\r\n      'Right',\r\n      'Go to the next image in gallery mode.'\r\n    ],\r\n    'Previous Gallery Image': [\r\n      'Left',\r\n      'Go to the previous image in gallery mode.'\r\n    ],\r\n    'Advance Gallery': [\r\n      'Enter',\r\n      'Go to next image or, if Autoplay is off, play video.'\r\n    ],\r\n    'Pause': [\r\n      'p',\r\n      'Pause/play videos in the gallery.'\r\n    ],\r\n    'Slideshow': [\r\n      'Ctrl+Right',\r\n      'Toggle the gallery slideshow mode.'\r\n    ],\r\n    'Rotate image clockwise': [\r\n      'Shift+Right',\r\n      'Rotate image clockwise in gallery.'\r\n    ],\r\n    'Rotate image anticlockwise': [\r\n      'Shift+Left',\r\n      'Rotate image anticlockwise in gallery.'\r\n    ],\r\n    'Download Gallery Image': [\r\n      'Shift+j',\r\n      'Download current image in gallery.'\r\n    ],\r\n    'fappeTyme': [\r\n      'f',\r\n      'Toggle Fappe Tyme.'\r\n    ],\r\n    'werkTyme': [\r\n      'Shift+w',\r\n      'Toggle Werk Tyme.'\r\n    ],\r\n    // Board Navigation\r\n    'Front page': [\r\n      '1',\r\n      'Jump to front page.'\r\n    ],\r\n    'Open front page': [\r\n      'Shift+1',\r\n      'Open front page in a new tab.'\r\n    ],\r\n    'Next page': [\r\n      'Ctrl+Right',\r\n      'Jump to the next page.'\r\n    ],\r\n    'Previous page': [\r\n      'Ctrl+Left',\r\n      'Jump to the previous page.'\r\n    ],\r\n    'Paged mode': [\r\n      'Alt+1',\r\n      'Open the index in paged mode.'\r\n    ],\r\n    'Infinite scrolling mode': [\r\n      'Alt+2',\r\n      'Open the index in infinite scrolling mode.'\r\n    ],\r\n    'All pages mode': [\r\n      'Alt+3',\r\n      'Open the index in all threads mode.'\r\n    ],\r\n    'Open catalog': [\r\n      'Shift+c',\r\n      'Open the catalog of the current board.'\r\n    ],\r\n    'Search form': [\r\n      'Ctrl+Alt+s',\r\n      'Focus the search field on the board index.'\r\n    ],\r\n    'Cycle sort type': [\r\n      'Alt+x',\r\n      'Cycle through index sort types.'\r\n    ],\r\n    // Thread Navigation\r\n    'Next thread': [\r\n      'Ctrl+Down',\r\n      'See next thread.'\r\n    ],\r\n    'Previous thread': [\r\n      'Ctrl+Up',\r\n      'See previous thread.'\r\n    ],\r\n    'Expand thread': [\r\n      'Ctrl+e',\r\n      'Expand thread.'\r\n    ],\r\n    'Open thread': [\r\n      'o',\r\n      'Open thread in current tab.'\r\n    ],\r\n    'Open thread tab': [\r\n      'Shift+o',\r\n      'Open thread in new tab.'\r\n    ],\r\n    // Reply Navigation\r\n    'Next reply': [\r\n      'j',\r\n      'Select next reply.'\r\n    ],\r\n    'Previous reply': [\r\n      'k',\r\n      'Select previous reply.'\r\n    ],\r\n    'Deselect reply': [\r\n      'Shift+d',\r\n      'Deselect reply.'\r\n    ],\r\n    'Hide': [\r\n      'x',\r\n      'Hide thread.'\r\n    ],\r\n    'Quick Filter MD5': [\r\n      '5',\r\n      'Add the MD5 of the selected image to the filter list.'\r\n    ],\r\n    'Previous Post Quoting You': [\r\n      'Alt+Up',\r\n      'Scroll to the previous post that quotes you.'\r\n    ],\r\n    'Next Post Quoting You': [\r\n      'Alt+Down',\r\n      'Scroll to the next post that quotes you.'\r\n    ]\r\n  },\r\n\r\n  updater: {\r\n    checkbox: {\r\n      'Beep': [\r\n        false,\r\n        'Beep on new post to completely read thread.'\r\n      ],\r\n      'Beep Quoting You': [\r\n        false,\r\n        'Beep on new post quoting you.'\r\n      ],\r\n      'Auto Scroll': [\r\n        false,\r\n        'Scroll updated posts into view. Only enabled at bottom of page.'\r\n      ],\r\n      'Bottom Scroll': [\r\n        false,\r\n        'Always scroll to the bottom, not the first new post. Useful for event threads.'\r\n      ],\r\n      'Scroll BG': [\r\n        false,\r\n        'Auto-scroll background tabs.'\r\n      ],\r\n      'Auto Update': [\r\n        true,\r\n        'Automatically fetch new posts.'\r\n      ],\r\n      'Optional Increase': [\r\n        false,\r\n        'Increase the intervals between updates on threads without new posts.'\r\n      ]\r\n    },\r\n    'Interval': 5\r\n  },\r\n\r\n  customCooldown: 0,\r\n  customCooldownEnabled: true,\r\n\r\n  'Thread Quotes': false,\r\n\r\n  'Max Replies': 1000,\r\n\r\n  'Autohiding Scrollbar': false,\r\n\r\n  position: {\r\n    'embedding.position':      'top: 50px; right: 0px;',\r\n    'thread-stats.position':   'bottom: 0px; right: 0px;',\r\n    'updater.position':        'bottom: 0px; left: 0px;',\r\n    'thread-watcher.position': 'top: 50px; left: 0px;',\r\n    'qr.position':             'top: 50px; right: 0px;'\r\n  },\r\n\r\n  fourchanImageHost: 'i.4cdn.org',\r\n\r\n  hiddenPSAList: [{}],\r\n\r\n  knownBanners: banners.join(','),\r\n\r\n  passMessageClosed: false,\r\n\r\n  'Prerequest Captcha': false,\r\n\r\n  'PSAseen': [[]]\r\n};\r\nexport default Config;\r\n","import ferongr_unreadDead from './Favicon/ferongr.unreadDead.png';\r\nimport ferongr_unreadDeadY from './Favicon/ferongr.unreadDeadY.png';\r\nimport ferongr_unreadSFW from './Favicon/ferongr.unreadSFW.png';\r\nimport ferongr_unreadSFWY from './Favicon/ferongr.unreadSFWY.png';\r\nimport ferongr_unreadNSFW from './Favicon/ferongr.unreadNSFW.png';\r\nimport ferongr_unreadNSFWY from './Favicon/ferongr.unreadNSFWY.png';\r\nimport xat_unreadDead from './Favicon/xat-.unreadDead.png';\r\nimport xat_unreadDeadY from './Favicon/xat-.unreadDeadY.png';\r\nimport xat_unreadSFW from './Favicon/xat-.unreadSFW.png';\r\nimport xat_unreadSFWY from './Favicon/xat-.unreadSFWY.png';\r\nimport xat_unreadNSFW from './Favicon/xat-.unreadNSFW.png';\r\nimport xat_unreadNSFWY from './Favicon/xat-.unreadNSFWY.png';\r\nimport Mayhem_unreadDead from './Favicon/Mayhem.unreadDead.png';\r\nimport Mayhem_unreadDeadY from './Favicon/Mayhem.unreadDeadY.png';\r\nimport Mayhem_unreadSFW from './Favicon/Mayhem.unreadSFW.png';\r\nimport Mayhem_unreadSFWY from './Favicon/Mayhem.unreadSFWY.png';\r\nimport Mayhem_unreadNSFW from './Favicon/Mayhem.unreadNSFW.png';\r\nimport Mayhem_unreadNSFWY from './Favicon/Mayhem.unreadNSFWY.png';\r\nimport fourChanJS_unreadDead from './Favicon/4chanJS.unreadDead.png';\r\nimport fourChanJS_unreadDeadY from './Favicon/4chanJS.unreadDeadY.png';\r\nimport fourChanJS_unreadSFW from './Favicon/4chanJS.unreadSFW.png';\r\nimport fourChanJS_unreadSFWY from './Favicon/4chanJS.unreadSFWY.png';\r\nimport fourChanJS_unreadNSFW from './Favicon/4chanJS.unreadNSFW.png';\r\nimport fourChanJS_unreadNSFWY from './Favicon/4chanJS.unreadNSFWY.png';\r\nimport Original_unreadDead from './Favicon/Original.unreadDead.png';\r\nimport Original_unreadDeadY from './Favicon/Original.unreadDeadY.png';\r\nimport Original_unreadSFW from './Favicon/Original.unreadSFW.png';\r\nimport Original_unreadSFWY from './Favicon/Original.unreadSFWY.png';\r\nimport Original_unreadNSFW from './Favicon/Original.unreadNSFW.png';\r\nimport Original_unreadNSFWY from './Favicon/Original.unreadNSFWY.png';\r\nimport Metro_unreadDead from './Favicon/Metro.unreadDead.png';\r\nimport Metro_unreadDeadY from './Favicon/Metro.unreadDeadY.png';\r\nimport Metro_unreadSFW from './Favicon/Metro.unreadSFW.png';\r\nimport Metro_unreadSFWY from './Favicon/Metro.unreadSFWY.png';\r\nimport Metro_unreadNSFW from './Favicon/Metro.unreadNSFW.png';\r\nimport Metro_unreadNSFWY from './Favicon/Metro.unreadNSFWY.png';\r\nimport dead from './Favicon/dead.gif';\r\nimport empty from './Favicon/empty.gif';\r\nimport $ from '../platform/$';\r\nimport { Conf, d } from '../globals/globals';\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n\r\nvar Favicon = {\r\n  init() {\r\n    return $.asap((() => d.head && (Favicon.el = $('link[rel=\"shortcut icon\"]', d.head))), Favicon.initAsap);\r\n  },\r\n\r\n  set(status) {\r\n    Favicon.status = status;\r\n    if (Favicon.el) {\r\n      Favicon.el.href = Favicon[status];\r\n      // `favicon.href = href` doesn't work on Firefox.\r\n      return $.add(d.head, Favicon.el);\r\n    }\r\n  },\r\n\r\n  initAsap() {\r\n    Favicon.el.type = 'image/x-icon';\r\n    const {href}          = Favicon.el;\r\n    Favicon.isSFW   = /ws\\.ico$/.test(href);\r\n    Favicon.default = href;\r\n    Favicon.switch();\r\n    if (Favicon.status) {\r\n      return Favicon.set(Favicon.status);\r\n    }\r\n  },\r\n\r\n  switch() {\r\n    let items = {\r\n      ferongr: [\r\n        ferongr_unreadDead,\r\n        ferongr_unreadDeadY,\r\n        ferongr_unreadSFW,\r\n        ferongr_unreadSFWY,\r\n        ferongr_unreadNSFW,\r\n        ferongr_unreadNSFWY,\r\n      ],\r\n      'xat-': [\r\n        xat_unreadDead,\r\n        xat_unreadDeadY,\r\n        xat_unreadSFW,\r\n        xat_unreadSFWY,\r\n        xat_unreadNSFW,\r\n        xat_unreadNSFWY,\r\n      ],\r\n      Mayhem: [\r\n        Mayhem_unreadDead,\r\n        Mayhem_unreadDeadY,\r\n        Mayhem_unreadSFW,\r\n        Mayhem_unreadSFWY,\r\n        Mayhem_unreadNSFW,\r\n        Mayhem_unreadNSFWY,\r\n      ],\r\n      '4chanJS': [\r\n        fourChanJS_unreadDead,\r\n        fourChanJS_unreadDeadY,\r\n        fourChanJS_unreadSFW,\r\n        fourChanJS_unreadSFWY,\r\n        fourChanJS_unreadNSFW,\r\n        fourChanJS_unreadNSFWY,\r\n      ],\r\n      Original: [\r\n        Original_unreadDead,\r\n        Original_unreadDeadY,\r\n        Original_unreadSFW,\r\n        Original_unreadSFWY,\r\n        Original_unreadNSFW,\r\n        Original_unreadNSFWY,\r\n      ],\r\n      'Metro': [\r\n        Metro_unreadDead,\r\n        Metro_unreadDeadY,\r\n        Metro_unreadSFW,\r\n        Metro_unreadSFWY,\r\n        Metro_unreadNSFW,\r\n        Metro_unreadNSFWY,\r\n      ]\r\n    };\r\n    items = $.getOwn(items, Conf['favicon']);\r\n\r\n    const f = Favicon;\r\n    const t = 'data:image/png;base64,';\r\n    let i = 0;\r\n    while (items[i]) {\r\n      items[i] = t + items[i++];\r\n    }\r\n\r\n    [f.unreadDead, f.unreadDeadY, f.unreadSFW, f.unreadSFWY, f.unreadNSFW, f.unreadNSFWY] = items;\r\n    return f.update();\r\n  },\r\n\r\n  update() {\r\n    if (this.isSFW) {\r\n      this.unread  = this.unreadSFW;\r\n      return this.unreadY = this.unreadSFWY;\r\n    } else {\r\n      this.unread  = this.unreadNSFW;\r\n      return this.unreadY = this.unreadNSFWY;\r\n    }\r\n  },\r\n\r\n  SFW:   '//s.4cdn.org/image/favicon-ws.ico',\r\n  NSFW:  '//s.4cdn.org/image/favicon.ico',\r\n  dead: `data:image/gif;base64,${dead}`,\r\n  logo: `data:image/png;base64,${empty}`,\r\n};\r\nexport default Favicon;\r\n","import { d } from \"../globals/globals\";\r\n\r\nconst $$ = (selector, root = d.body) => Array.from(root.querySelectorAll(selector));\r\nexport default $$;\r\n","import { g, Conf, doc, d } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\n\r\nconst CaptchaReplace = {\r\n  init() {\r\n    if ((g.SITE.software !== 'yotsuba') || (d.cookie.indexOf('pass_enabled=1') >= 0)) { return; }\r\n\r\n    if (Conf['Force Noscript Captcha'] && Main.jsEnabled) {\r\n      $.ready(this.noscript);\r\n      return;\r\n    }\r\n\r\n    if (Conf['captchaLanguage'].trim()) {\r\n      if (['boards.4chan.org', 'boards.4channel.org'].includes(location.hostname)) {\r\n        $.onExists(doc, '#captchaFormPart', node => $.onExists(node, 'iframe[src^=\"https://www.google.com/recaptcha/\"]', this.iframe));\r\n      } else {\r\n        $.onExists(doc, 'iframe[src^=\"https://www.google.com/recaptcha/\"]', this.iframe);\r\n      }\r\n    }\r\n  },\r\n\r\n  noscript() {\r\n    let noscript, original, toggle;\r\n    if (!((original = $('#g-recaptcha')) && (noscript = $('noscript', original.parentNode)))) { return; }\r\n    const span = $.el('span',\r\n      {id: 'captcha-forced-noscript'});\r\n    $.replace(noscript, span);\r\n    $.rm(original);\r\n    const insert = function() {\r\n      span.innerHTML = noscript.textContent;\r\n      this.iframe($('iframe[src^=\"https://www.google.com/recaptcha/\"]', span));\r\n    };\r\n    if (toggle = $('#togglePostFormLink a, #form-link')) {\r\n      $.on(toggle, 'click', insert);\r\n    } else {\r\n      insert();\r\n    }\r\n  },\r\n\r\n  iframe(iframe) {\r\n    let lang;\r\n    if (lang = Conf['captchaLanguage'].trim()) {\r\n      const src = /[?&]hl=/.test(iframe.src) ?\r\n        iframe.src.replace(/([?&]hl=)[^&]*/, '$1' + encodeURIComponent(lang))\r\n      :\r\n        iframe.src + `&hl=${encodeURIComponent(lang)}`;\r\n      if (iframe.src !== src) { iframe.src = src; }\r\n    }\r\n  }\r\n};\r\nexport default CaptchaReplace;\r\n","import { d, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport QR from \"./QR\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst CaptchaT = {\r\n  init() {\r\n    if (d.cookie.indexOf('pass_enabled=1') >= 0) { return; }\r\n    if (!(this.isEnabled = !!$('#t-root') || !$.id('postForm'))) { return; }\r\n\r\n    const root = $.el('div', {className: 'captcha-root'});\r\n    this.nodes = {root};\r\n\r\n    $.addClass(QR.nodes.el, 'has-captcha', 'captcha-t');\r\n    return $.after(QR.nodes.com.parentNode, root);\r\n  },\r\n\r\n  moreNeeded() {\r\n  },\r\n\r\n  getThread() {\r\n    let threadID;\r\n    const boardID = g.BOARD.ID;\r\n    if (QR.posts[0].thread === 'new') {\r\n      threadID = '0';\r\n    } else {\r\n      threadID = '' + QR.posts[0].thread;\r\n    }\r\n    return {boardID, threadID};\r\n  },\r\n\r\n  setup(focus) {\r\n    if (!this.isEnabled) { return; }\r\n\r\n    if (!this.nodes.container) {\r\n      this.nodes.container = $.el('div', {className: 'captcha-container'});\r\n      $.prepend(this.nodes.root, this.nodes.container);\r\n      CaptchaT.currentThread = CaptchaT.getThread();\r\n      $.global(function() {\r\n        const el = document.querySelector('#qr .captcha-container');\r\n        window.TCaptcha.init(el, this.boardID, +this.threadID);\r\n        return window.TCaptcha.setErrorCb(err => window.dispatchEvent(new CustomEvent('CreateNotification', {detail: {\r\n          type: 'warning',\r\n          content: '' + err\r\n        }})\r\n        ));\r\n      }\r\n      , CaptchaT.currentThread);\r\n    }\r\n\r\n    if (focus) {\r\n      return $('#t-resp').focus();\r\n    }\r\n  },\r\n\r\n  destroy() {\r\n    if (!this.isEnabled || !this.nodes.container) { return; }\r\n    $.global(() => window.TCaptcha.destroy());\r\n    $.rm(this.nodes.container);\r\n    return delete this.nodes.container;\r\n  },\r\n\r\n  updateThread() {\r\n    if (!this.isEnabled) { return; }\r\n    const {boardID, threadID} = (CaptchaT.currentThread || {});\r\n    const newThread = CaptchaT.getThread();\r\n    if ((newThread.boardID !== boardID) || (newThread.threadID !== threadID)) {\r\n      CaptchaT.destroy();\r\n      return CaptchaT.setup();\r\n    }\r\n  },\r\n\r\n  getOne() {\r\n    let el;\r\n    let response = {};\r\n    if (this.nodes.container) {\r\n      for (var key of ['t-response', 't-challenge']) {\r\n        response[key] = $(`[name='${key}']`, this.nodes.container).value;\r\n      }\r\n    }\r\n    if (!response['t-response'] && !((el = $('#t-msg')) && /Verification not required/i.test(el.textContent))) {\r\n      response = null;\r\n    }\r\n    return response;\r\n  },\r\n\r\n  setUsed() {\r\n    if (!this.isEnabled) { return; }\r\n    if (this.nodes.container) {\r\n      return $.global(() => window.TCaptcha.clearChallenge());\r\n    }\r\n  },\r\n\r\n  occupied() {\r\n    return !!this.nodes.container;\r\n  }\r\n};\r\nexport default CaptchaT;\r\n",null,"import { Conf, d, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { dict, HOUR } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS206: Consider reworking classes to avoid initClass\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nexport default class DataBoard {\r\n  static initClass() {\r\n    this.keys = ['hiddenThreads', 'hiddenPosts', 'lastReadPosts', 'yourPosts', 'watchedThreads', 'watcherLastModified', 'customTitles'];\r\n  }\r\n\r\n  constructor(key, sync, dontClean) {\r\n    this.changes = [];\r\n    this.onSync = this.onSync.bind(this);\r\n    this.key = key;\r\n    this.initData(Conf[this.key]);\r\n    $.sync(this.key, this.onSync);\r\n    if (!dontClean) { this.clean(); }\r\n    if (!sync) { return; }\r\n    // Chrome also fires the onChanged callback on the current tab,\r\n    // so we only start syncing when we're ready.\r\n    var init = () => {\r\n      $.off(d, '4chanXInitFinished', init);\r\n      return this.sync = sync;\r\n    };\r\n    $.on(d, '4chanXInitFinished', init);\r\n  }\r\n\r\n  initData(data) {\r\n    let boards;\r\n    this.data = data;\r\n    if (this.data.boards) {\r\n      let lastChecked;\r\n      ({boards, lastChecked} = this.data);\r\n      this.data['4chan.org'] = {boards, lastChecked};\r\n      delete this.data.boards;\r\n      delete this.data.lastChecked;\r\n    }\r\n    return this.data[g.SITE.ID] || (this.data[g.SITE.ID] = { boards: dict() });\r\n  }\r\n\r\n  save(change, cb) {\r\n    change();\r\n    this.changes.push(change);\r\n    return $.get(this.key, { boards: dict() }, items => {\r\n      if (!this.changes.length) { return; }\r\n      const needSync = ((items[this.key].version || 0) > (this.data.version || 0));\r\n      if (needSync) {\r\n        this.initData(items[this.key]);\r\n        for (change of this.changes) { change(); }\r\n      }\r\n      this.changes = [];\r\n      this.data.version = (this.data.version || 0) + 1;\r\n      return $.set(this.key, this.data, () => {\r\n        if (needSync) { this.sync?.(); }\r\n        return cb?.();\r\n      });\r\n    });\r\n  }\r\n\r\n  forceSync(cb) {\r\n    return $.get(this.key, { boards: dict() }, items => {\r\n      if ((items[this.key].version || 0) > (this.data.version || 0)) {\r\n        this.initData(items[this.key]);\r\n        for (var change of this.changes) { change(); }\r\n        this.sync?.();\r\n      }\r\n      return cb?.();\r\n    });\r\n  }\r\n\r\n  delete({siteID, boardID, threadID, postID}, cb) {\r\n    if (!siteID) { siteID = g.SITE.ID; }\r\n    if (!this.data[siteID]) { return; }\r\n    return this.save(() => {\r\n      if (postID) {\r\n        if (!this.data[siteID].boards[boardID]?.[threadID]) { return; }\r\n        delete this.data[siteID].boards[boardID][threadID][postID];\r\n        return this.deleteIfEmpty({siteID, boardID, threadID});\r\n      } else if (threadID) {\r\n        if (!this.data[siteID].boards[boardID]) { return; }\r\n        delete this.data[siteID].boards[boardID][threadID];\r\n        return this.deleteIfEmpty({siteID, boardID});\r\n      } else {\r\n        return delete this.data[siteID].boards[boardID];\r\n      }\r\n    }\r\n    , cb);\r\n  }\r\n\r\n  deleteIfEmpty({siteID, boardID, threadID}) {\r\n    if (!this.data[siteID]) { return; }\r\n    if (threadID) {\r\n      if (!Object.keys(this.data[siteID].boards[boardID][threadID]).length) {\r\n        delete this.data[siteID].boards[boardID][threadID];\r\n        return this.deleteIfEmpty({siteID, boardID});\r\n      }\r\n    } else if (!Object.keys(this.data[siteID].boards[boardID]).length) {\r\n      return delete this.data[siteID].boards[boardID];\r\n    }\r\n  }\r\n\r\n  set(data, cb) {\r\n    return this.save(() => {\r\n      return this.setUnsafe(data);\r\n    }\r\n    , cb);\r\n  }\r\n\r\n  setUnsafe({siteID, boardID, threadID, postID, val}) {\r\n    if (!siteID) { siteID = g.SITE.ID; }\r\n    if (!this.data[siteID]) { this.data[siteID] = { boards: dict() }; }\r\n    if (postID !== undefined) {\r\n      let base;\r\n      return (((base = this.data[siteID].boards[boardID] || (this.data[siteID].boards[boardID] = dict())))[threadID] || (base[threadID] = dict()))[postID] = val;\r\n    } else if (threadID !== undefined) {\r\n      return (this.data[siteID].boards[boardID] || (this.data[siteID].boards[boardID] = dict()))[threadID] = val;\r\n    } else {\r\n      return this.data[siteID].boards[boardID] = val;\r\n    }\r\n  }\r\n\r\n  extend({siteID, boardID, threadID, postID, val}, cb) {\r\n    return this.save(() => {\r\n      const oldVal = this.get({ siteID, boardID, threadID, postID, defaultValue: dict() });\r\n      for (var key in val) {\r\n        var subVal = val[key];\r\n        if (typeof subVal === 'undefined') {\r\n          delete oldVal[key];\r\n        } else {\r\n          oldVal[key] = subVal;\r\n        }\r\n      }\r\n      return this.setUnsafe({siteID, boardID, threadID, postID, val: oldVal});\r\n    }\r\n    , cb);\r\n  }\r\n\r\n  setLastChecked(key='lastChecked') {\r\n    return this.save(() => {\r\n      return this.data[key] = Date.now();\r\n    });\r\n  }\r\n\r\n  get({siteID, boardID, threadID, postID, defaultValue}) {\r\n    let board, val;\r\n    if (!siteID) { siteID = g.SITE.ID; }\r\n    if (board = this.data[siteID]?.boards[boardID]) {\r\n      let thread;\r\n      if (threadID == null) {\r\n        if (postID != null) {\r\n          for (thread = 0; thread < board.length; thread++) {\r\n            var ID = board[thread];\r\n            if (postID in thread) {\r\n              val = thread[postID];\r\n              break;\r\n            }\r\n          }\r\n        } else {\r\n          val = board;\r\n        }\r\n      } else if (thread = board[threadID]) {\r\n        val = (postID != null) ?\r\n          thread[postID]\r\n        :\r\n          thread;\r\n      }\r\n    }\r\n    return val || defaultValue;\r\n  }\r\n\r\n  clean() {\r\n    let boardID, middle;\r\n    const siteID = g.SITE.ID;\r\n    for (boardID in this.data[siteID].boards) {\r\n      var val = this.data[siteID].boards[boardID];\r\n      this.deleteIfEmpty({siteID, boardID});\r\n    }\r\n    const now = Date.now();\r\n    if (now - (2 * HOUR) >= ((middle = this.data[siteID].lastChecked || 0)) || middle > now) {\r\n      this.data[siteID].lastChecked = now;\r\n      for (boardID in this.data[siteID].boards) {\r\n        this.ajaxClean(boardID);\r\n      }\r\n    }\r\n  }\r\n\r\n  ajaxClean(boardID) {\r\n    const that = this;\r\n    const siteID = g.SITE.ID;\r\n    const threadsList = g.SITE.urls.threadsListJSON?.({siteID, boardID});\r\n    if (!threadsList) { return; }\r\n    return $.cache(threadsList, function() {\r\n      if (this.status !== 200) { return; }\r\n      const archiveList = g.SITE.urls.archiveListJSON?.({siteID, boardID});\r\n      if (!archiveList) { return that.ajaxCleanParse(boardID, this.response); }\r\n      const response1 = this.response;\r\n      return $.cache(archiveList, function() {\r\n        if ((this.status !== 200) && (!!g.SITE.archivedBoardsKnown || (this.status !== 404))) { return; }\r\n        return that.ajaxCleanParse(boardID, response1, this.response);\r\n      });\r\n    });\r\n  }\r\n\r\n  ajaxCleanParse(boardID, response1, response2) {\r\n    let board, ID;\r\n    const siteID = g.SITE.ID;\r\n    if (!(board = this.data[siteID].boards[boardID])) { return; }\r\n    const threads = dict();\r\n    if (response1) {\r\n      for (var page of response1) {\r\n        for (var thread of page.threads) {\r\n          ID = thread.no;\r\n          if (ID in board) { threads[ID] = board[ID]; }\r\n        }\r\n      }\r\n    }\r\n    if (response2) {\r\n      for (ID of response2) {\r\n        if (ID in board) { threads[ID] = board[ID]; }\r\n      }\r\n    }\r\n    this.data[siteID].boards[boardID] = threads;\r\n    this.deleteIfEmpty({siteID, boardID});\r\n    return $.set(this.key, this.data);\r\n  }\r\n\r\n  onSync(data) {\r\n    if ((data.version || 0) <= (this.data.version || 0)) { return; }\r\n    this.initData(data);\r\n    return this.sync?.();\r\n  }\r\n}\r\nDataBoard.initClass();\r\n",null,null,"import $ from \"../platform/$\";\r\n\r\nexport default class CatalogThread {\r\n  toString() { return this.ID; }\r\n\r\n  constructor(root, thread) {\r\n    this.thread = thread;\r\n    this.ID    = this.thread.ID;\r\n    this.board = this.thread.board;\r\n    const {post} = this.thread.OP.nodes;\r\n    this.nodes = {\r\n      root,\r\n      thumb:     $('.catalog-thumb', post),\r\n      icons:     $('.catalog-icons', post),\r\n      postCount: $('.post-count',    post),\r\n      fileCount: $('.file-count',    post),\r\n      pageCount: $('.page-count',    post),\r\n      replies:   null\r\n    };\r\n    this.thread.catalogView = this;\r\n  }\r\n}\r\n","import { Conf, d, doc } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport Header from \"./Header\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS206: Consider reworking classes to avoid initClass\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst dialog = function(id, properties) {\r\n  const el = $.el('div', {\r\n    className: 'dialog',\r\n    id\r\n  }\r\n  );\r\n  $.extend(el, properties);\r\n  el.style.cssText = Conf[`${id}.position`];\r\n\r\n  const move = $('.move', el);\r\n  $.on(move, 'touchstart mousedown', dragstart);\r\n  for (var child of move.children) {\r\n    if (!child.tagName) { continue; }\r\n    $.on(child, 'touchstart mousedown', e => e.stopPropagation());\r\n  }\r\n\r\n  return el;\r\n};\r\n\r\nvar Menu = (function() {\r\n  let currentMenu = undefined;\r\n  let lastToggledButton = undefined;\r\n  Menu = class Menu {\r\n    static initClass() {\r\n      currentMenu       = null;\r\n      lastToggledButton = null;\r\n    }\r\n\r\n    constructor(type) {\r\n      // XXX AddMenuEntry event is deprecated\r\n      this.setPosition = this.setPosition.bind(this);\r\n      this.close = this.close.bind(this);\r\n      this.keybinds = this.keybinds.bind(this);\r\n      this.onFocus = this.onFocus.bind(this);\r\n      this.addEntry = this.addEntry.bind(this);\r\n      this.type = type;\r\n      $.on(d, 'AddMenuEntry', ({detail}) => {\r\n        if (detail.type !== this.type) { return; }\r\n        delete detail.open;\r\n        return this.addEntry(detail);\r\n      });\r\n      this.entries = [];\r\n    }\r\n\r\n    makeMenu() {\r\n      const menu = $.el('div', {\r\n        className: 'dialog',\r\n        id:        'menu',\r\n        tabIndex:  0\r\n      }\r\n      );\r\n      menu.dataset.type = this.type;\r\n      $.on(menu, 'click', e => e.stopPropagation());\r\n      $.on(menu, 'keydown', this.keybinds);\r\n      return menu;\r\n    }\r\n\r\n    toggle(e, button, data) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n\r\n      if (currentMenu) {\r\n        // Close if it's already opened.\r\n        // Reopen if we clicked on another button.\r\n        const previousButton = lastToggledButton;\r\n        currentMenu.close();\r\n        if (previousButton === button) { return; }\r\n      }\r\n\r\n      if (!this.entries.length) { return; }\r\n      return this.open(button, data);\r\n    }\r\n\r\n    open(button, data) {\r\n      let entry;\r\n      const menu = (this.menu = this.makeMenu());\r\n      currentMenu       = this;\r\n      lastToggledButton = button;\r\n\r\n      this.entries.sort((first, second) => first.order - second.order);\r\n\r\n      for (entry of this.entries) {\r\n        this.insertEntry(entry, menu, data);\r\n      }\r\n\r\n      $.addClass(lastToggledButton, 'active');\r\n\r\n      $.on(d, 'click CloseMenu', this.close);\r\n      $.on(d, 'scroll', this.setPosition);\r\n      $.on(window, 'resize', this.setPosition);\r\n      $.after(button, menu);\r\n\r\n      this.setPosition();\r\n\r\n      entry = $('.entry', menu);\r\n      // We've removed flexbox, so we don't use order anymore.\r\n      // while prevEntry = @findNextEntry entry, -1\r\n      //   entry = prevEntry\r\n      this.focus(entry);\r\n\r\n      return menu.focus();\r\n    }\r\n\r\n    setPosition() {\r\n      const mRect   = this.menu.getBoundingClientRect();\r\n      const bRect   = lastToggledButton.getBoundingClientRect();\r\n      const bTop    = window.scrollY + bRect.top;\r\n      const bLeft   = window.scrollX + bRect.left;\r\n      const cHeight = doc.clientHeight;\r\n      const cWidth  = doc.clientWidth;\r\n      const [top, bottom] = (bRect.top + bRect.height + mRect.height) < cHeight ?\r\n        [`${bRect.bottom}px`, '']\r\n      :\r\n        ['', `${cHeight - bRect.top}px`];\r\n      const [left, right] = (bRect.left + mRect.width) < cWidth ?\r\n        [`${bRect.left}px`, '']\r\n      :\r\n        ['', `${cWidth - bRect.right}px`];\r\n      $.extend(this.menu.style, {top, right, bottom, left});\r\n      return this.menu.classList.toggle('left', right);\r\n    }\r\n\r\n    insertEntry(entry, parent, data) {\r\n      let submenu;\r\n      if (typeof entry.open === 'function') {\r\n        try {\r\n          if (!entry.open(data)) { return; }\r\n        } catch (err) {\r\n          Main.handleErrors({\r\n            message: `Error in building the ${this.type} menu.`,\r\n            error: err\r\n          });\r\n          return;\r\n        }\r\n      }\r\n      $.add(parent, entry.el);\r\n\r\n      if (!entry.subEntries) { return; }\r\n      if (submenu = $('.submenu', entry.el)) {\r\n        // Reset sub menu, remove irrelevant entries.\r\n        $.rm(submenu);\r\n      }\r\n      submenu = $.el('div',\r\n        {className: 'dialog submenu'});\r\n      for (var subEntry of entry.subEntries) {\r\n        this.insertEntry(subEntry, submenu, data);\r\n      }\r\n      $.add(entry.el, submenu);\r\n    }\r\n\r\n    close() {\r\n      $.rm(this.menu);\r\n      delete this.menu;\r\n      $.rmClass(lastToggledButton, 'active');\r\n      currentMenu       = null;\r\n      lastToggledButton = null;\r\n      $.off(d, 'click scroll CloseMenu', this.close);\r\n      $.off(d, 'scroll', this.setPosition);\r\n      return $.off(window, 'resize', this.setPosition);\r\n    }\r\n\r\n    findNextEntry(entry, direction) {\r\n      const entries = [...entry.parentNode.children];\r\n      entries.sort((first, second) => first.style.order - second.style.order);\r\n      return entries[entries.indexOf(entry) + direction];\r\n    }\r\n\r\n    keybinds(e) {\r\n      let subEntry;\r\n      let next, submenu;\r\n      let entry = $('.focused', this.menu);\r\n      while ((subEntry = $('.focused', entry))) {\r\n        entry = subEntry;\r\n      }\r\n\r\n      switch (e.keyCode) {\r\n        case 27: // Esc\r\n          lastToggledButton.focus();\r\n          this.close();\r\n          break;\r\n        case 13: case 32: // Enter, Space\r\n          entry.click();\r\n          break;\r\n        case 38: // Up\r\n          if (next = this.findNextEntry(entry, -1)) {\r\n            this.focus(next);\r\n          }\r\n          break;\r\n        case 40: // Down\r\n          if (next = this.findNextEntry(entry, +1)) {\r\n            this.focus(next);\r\n          }\r\n          break;\r\n        case 39: // Right\r\n          if ((submenu = $('.submenu', entry)) && (next = submenu.firstElementChild)) {\r\n            let nextPrev;\r\n            while ((nextPrev = this.findNextEntry(next, -1))) {\r\n              next = nextPrev;\r\n            }\r\n            this.focus(next);\r\n          }\r\n          break;\r\n        case 37: // Left\r\n          if (next = $.x('parent::*[contains(@class,\"submenu\")]/parent::*', entry)) {\r\n            this.focus(next);\r\n          }\r\n          break;\r\n        default:\r\n          return;\r\n      }\r\n\r\n      e.preventDefault();\r\n      return e.stopPropagation();\r\n    }\r\n\r\n    onFocus(e) {\r\n      e.stopPropagation();\r\n      return this.focus(e.target);\r\n    }\r\n\r\n    focus(entry) {\r\n      let focused, submenu;\r\n      while ((focused = $.x('parent::*/child::*[contains(@class,\"focused\")]', entry))) {\r\n        $.rmClass(focused, 'focused');\r\n      }\r\n      for (focused of $$('.focused', entry)) {\r\n        $.rmClass(focused, 'focused');\r\n      }\r\n      $.addClass(entry, 'focused');\r\n\r\n      // Submenu positioning.\r\n      if (!(submenu = $('.submenu', entry))) { return; }\r\n      const sRect   = submenu.getBoundingClientRect();\r\n      const eRect   = entry.getBoundingClientRect();\r\n      const cHeight = doc.clientHeight;\r\n      const cWidth  = doc.clientWidth;\r\n      const [top, bottom] = (eRect.top + sRect.height) < cHeight ?\r\n        ['0px', 'auto']\r\n      :\r\n        ['auto', '0px'];\r\n      const [left, right] = (eRect.right + sRect.width) < (cWidth - 150) ?\r\n        ['100%', 'auto']\r\n      :\r\n        ['auto', '100%'];\r\n      const {style} = submenu;\r\n      style.top    = top;\r\n      style.bottom = bottom;\r\n      style.left   = left;\r\n      return style.right  = right;\r\n    }\r\n\r\n    addEntry(entry) {\r\n      this.parseEntry(entry);\r\n      return this.entries.push(entry);\r\n    }\r\n\r\n    parseEntry(entry) {\r\n      const {el, subEntries} = entry;\r\n      $.addClass(el, 'entry');\r\n      $.on(el, 'focus mouseover', this.onFocus);\r\n      el.style.order = entry.order || 100;\r\n      if (!subEntries) { return; }\r\n      $.addClass(el, 'has-submenu');\r\n      for (var subEntry of subEntries) {\r\n        this.parseEntry(subEntry);\r\n      }\r\n    }\r\n  };\r\n  Menu.initClass();\r\n  return Menu;\r\n})();\r\n\r\nexport var dragstart = function (e) {\r\n  let isTouching;\r\n  if ((e.type === 'mousedown') && (e.button !== 0)) { return; } // not LMB\r\n  // prevent text selection\r\n  e.preventDefault();\r\n  if (isTouching = e.type === 'touchstart') {\r\n    e = e.changedTouches[e.changedTouches.length - 1];\r\n  }\r\n  // distance from pointer to el edge is constant; calculate it here.\r\n  const el = $.x('ancestor::div[contains(@class,\"dialog\")][1]', this);\r\n  const rect = el.getBoundingClientRect();\r\n  const screenHeight = doc.clientHeight;\r\n  const screenWidth  = doc.clientWidth;\r\n  const o = {\r\n    id:     el.id,\r\n    style:  el.style,\r\n    dx:     e.clientX - rect.left,\r\n    dy:     e.clientY - rect.top,\r\n    height: screenHeight - rect.height,\r\n    width:  screenWidth  - rect.width,\r\n    screenHeight,\r\n    screenWidth,\r\n    isTouching\r\n  };\r\n\r\n  [o.topBorder, o.bottomBorder] = Conf['Header auto-hide'] || !Conf['Fixed Header'] ?\r\n    [0, 0]\r\n  : Conf['Bottom Header'] ?\r\n    [0, Header.bar.getBoundingClientRect().height]\r\n  :\r\n    [Header.bar.getBoundingClientRect().height, 0];\r\n\r\n  if (isTouching) {\r\n    o.identifier = e.identifier;\r\n    o.move = touchmove.bind(o);\r\n    o.up   = touchend.bind(o);\r\n    $.on(d, 'touchmove', o.move);\r\n    return $.on(d, 'touchend touchcancel', o.up);\r\n  } else { // mousedown\r\n    o.move = drag.bind(o);\r\n    o.up   = dragend.bind(o);\r\n    $.on(d, 'mousemove', o.move);\r\n    return $.on(d, 'mouseup',   o.up);\r\n  }\r\n};\r\n\r\nexport var touchmove = function (e) {\r\n  for (var touch of e.changedTouches) {\r\n    if (touch.identifier === this.identifier) {\r\n      drag.call(this, touch);\r\n      return;\r\n    }\r\n  }\r\n};\r\n\r\nexport var drag = function (e) {\r\n  const {clientX, clientY} = e;\r\n\r\n  let left = clientX - this.dx;\r\n  left = left < 10 ?\r\n    0\r\n  : (this.width - left) < 10 ?\r\n    ''\r\n  :\r\n    ((left / this.screenWidth) * 100) + '%';\r\n\r\n  let top = clientY - this.dy;\r\n  top = top < (10 + this.topBorder) ?\r\n    this.topBorder + 'px'\r\n  : (this.height - top) < (10 + this.bottomBorder) ?\r\n    ''\r\n  :\r\n    ((top / this.screenHeight) * 100) + '%';\r\n\r\n  const right = left === '' ?\r\n    0\r\n  :\r\n    '';\r\n\r\n  const bottom = top === '' ?\r\n    this.bottomBorder + 'px'\r\n  :\r\n    '';\r\n\r\n  const {style} = this;\r\n  style.left   = left;\r\n  style.right  = right;\r\n  style.top    = top;\r\n  return style.bottom = bottom;\r\n};\r\n\r\nexport var touchend = function (e) {\r\n  for (var touch of e.changedTouches) {\r\n    if (touch.identifier === this.identifier) {\r\n      dragend.call(this);\r\n      return;\r\n    }\r\n  }\r\n};\r\n\r\nexport var dragend = function () {\r\n  if (this.isTouching) {\r\n    $.off(d, 'touchmove', this.move);\r\n    $.off(d, 'touchend touchcancel', this.up);\r\n  } else { // mouseup\r\n    $.off(d, 'mousemove', this.move);\r\n    $.off(d, 'mouseup',   this.up);\r\n  }\r\n  return $.set(`${this.id}.position`, this.style.cssText);\r\n};\r\n\r\nconst hoverstart = function ({ root, el, latestEvent, endEvents, height, width, cb, noRemove }) {\r\n  const rect = root.getBoundingClientRect();\r\n  const o = {\r\n    root,\r\n    el,\r\n    style: el.style,\r\n    isImage: ['IMG', 'VIDEO'].includes(el.nodeName),\r\n    cb,\r\n    endEvents,\r\n    latestEvent,\r\n    clientHeight: doc.clientHeight,\r\n    clientWidth:  doc.clientWidth,\r\n    height,\r\n    width,\r\n    noRemove,\r\n    clientX: (rect.left + rect.right) / 2,\r\n    clientY: (rect.top + rect.bottom) / 2\r\n  };\r\n  o.hover    = hover.bind(o);\r\n  o.hoverend = hoverend.bind(o);\r\n\r\n  o.hover(o.latestEvent);\r\n  new MutationObserver(function() {\r\n    if (el.parentNode) { return o.hover(o.latestEvent); }\r\n  }).observe(el, {childList: true});\r\n\r\n  $.on(root, endEvents,   o.hoverend);\r\n  if ($.x('ancestor::div[contains(@class,\"inline\")][1]', root)) {\r\n    $.on(d,    'keydown',   o.hoverend);\r\n  }\r\n  $.on(root, 'mousemove', o.hover);\r\n\r\n  // Workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=674955\r\n  o.workaround = function(e) { if (!root.contains(e.target)) { return o.hoverend(e); } };\r\n  return $.on(doc,  'mousemove', o.workaround);\r\n};\r\n\r\nhoverstart.padding = 25;\r\n\r\nexport var hover = function (e) {\r\n  this.latestEvent = e;\r\n  const height = (this.height || this.el.offsetHeight) + hoverstart.padding;\r\n  const width  = (this.width  || this.el.offsetWidth);\r\n  const {clientX, clientY} = Conf['Follow Cursor'] ? e : this;\r\n\r\n  const top = this.isImage ?\r\n    Math.max(0, (clientY * (this.clientHeight - height)) / this.clientHeight)\r\n  :\r\n    Math.max(0, Math.min(this.clientHeight - height, clientY - 120));\r\n\r\n  let threshold = this.clientWidth / 2;\r\n  if (!this.isImage) { threshold = Math.max(threshold, this.clientWidth - 400); }\r\n  let marginX = (clientX <= threshold ? clientX : this.clientWidth - clientX) + 45;\r\n  if (this.isImage) { marginX = Math.min(marginX, this.clientWidth - width); }\r\n  marginX += 'px';\r\n  const [left, right] = clientX <= threshold ? [marginX, ''] : ['', marginX];\r\n\r\n  const {style} = this;\r\n  style.top   = top + 'px';\r\n  style.left  = left;\r\n  return style.right = right;\r\n};\r\n\r\nexport var hoverend = function (e) {\r\n  if (((e.type === 'keydown') && (e.keyCode !== 13)) || (e.target.nodeName === \"TEXTAREA\")) { return; }\r\n  if (!this.noRemove) { $.rm(this.el); }\r\n  $.off(this.root, this.endEvents,  this.hoverend);\r\n  $.off(d,     'keydown',   this.hoverend);\r\n  $.off(this.root, 'mousemove', this.hover);\r\n  // Workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=674955\r\n  $.off(doc,   'mousemove', this.workaround);\r\n  if (this.cb) { return this.cb.call(this); }\r\n};\r\n\r\nexport const checkbox = function (name, text, checked) {\r\n  if (checked == null) { checked = Conf[name]; }\r\n  const label = $.el('label');\r\n  const input = $.el('input', {type: 'checkbox', name, checked});\r\n  $.add(label, [input, $.tn(` ${text}`)]);\r\n  return label;\r\n};\r\n\r\nconst UI = {\r\n  dialog,\r\n  Menu,\r\n  hover:    hoverstart,\r\n  checkbox\r\n};\r\nexport default UI;\r\n","import Get from \"../General/Get\";\r\nimport Header from \"../General/Header\";\r\nimport { g, Conf, d, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Nav = {\r\n  init() {\r\n    switch (g.VIEW) {\r\n      case 'index':\r\n        if (!Conf['Index Navigation']) { return; }\r\n        break;\r\n      case 'thread':\r\n        if (!Conf['Reply Navigation']) { return; }\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n\r\n    const span = $.el('span',\r\n      {id: 'navlinks'});\r\n    const prev = $.el('a', {\r\n      textContent: '▲',\r\n      href: 'javascript:;'\r\n    }\r\n    );\r\n    const next = $.el('a', {\r\n      textContent: '▼',\r\n      href: 'javascript:;'\r\n    }\r\n    );\r\n\r\n    $.on(prev, 'click', this.prev);\r\n    $.on(next, 'click', this.next);\r\n\r\n    $.add(span, [prev, $.tn(' '), next]);\r\n    var append = function() {\r\n      $.off(d, '4chanXInitFinished', append);\r\n      return $.add(d.body, span);\r\n    };\r\n    return $.on(d, '4chanXInitFinished', append);\r\n  },\r\n\r\n  prev() {\r\n    if (g.VIEW === 'thread') {\r\n      return window.scrollTo(0, 0);\r\n    } else {\r\n      return Nav.scroll(-1);\r\n    }\r\n  },\r\n\r\n  next() {\r\n    if (g.VIEW === 'thread') {\r\n      return window.scrollTo(0, d.body.scrollHeight);\r\n    } else {\r\n      return Nav.scroll(+1);\r\n    }\r\n  },\r\n\r\n  getThread() {\r\n    if (g.VIEW === 'thread') { return g.threads.get(`${g.BOARD}.${g.THREADID}`).nodes.root; }\r\n    if ($.hasClass(doc, 'catalog-mode')) { return; }\r\n    for (var threadRoot of $$(g.SITE.selectors.thread)) {\r\n      var thread = Get.threadFromRoot(threadRoot);\r\n      if (thread.isHidden && !thread.stub) { continue; }\r\n      if (Header.getTopOf(threadRoot) >= -threadRoot.getBoundingClientRect().height) { // not scrolled past\r\n        return threadRoot;\r\n      }\r\n    }\r\n  },\r\n\r\n  scroll(delta) {\r\n    let next;\r\n    d.activeElement?.blur();\r\n    let thread = Nav.getThread();\r\n    if (!thread) { return; }\r\n    const axis = delta === +1 ?\r\n      'following'\r\n    :\r\n      'preceding';\r\n    if (next = $.x(`${axis}-sibling::${g.SITE.xpath.thread}[not(@hidden)][1]`, thread)) {\r\n      // Unless we're not at the beginning of the current thread,\r\n      // and thus wanting to move to beginning,\r\n      // or we're above the first thread and don't want to skip it.\r\n      const top = Header.getTopOf(thread);\r\n      if (((delta === +1) && (top < 5)) || ((delta === -1) && (top > -5))) { thread = next; }\r\n    }\r\n    // Add extra space to the end of the page if necessary so that all threads can be selected by keybinds.\r\n    const extra = (Header.getTopOf(thread) + doc.clientHeight) - d.body.getBoundingClientRect().bottom;\r\n    if (extra > 0) { d.body.style.marginBottom = `${extra}px`; }\r\n\r\n    Header.scrollTo(thread);\r\n\r\n    if ((extra > 0) && !Nav.haveExtra) {\r\n      Nav.haveExtra = true;\r\n      return $.on(d, 'scroll', Nav.removeExtra);\r\n    }\r\n  },\r\n\r\n  removeExtra() {\r\n    const extra = doc.clientHeight - d.body.getBoundingClientRect().bottom;\r\n    if (extra > 0) {\r\n      return d.body.style.marginBottom = `${extra}px`;\r\n    } else {\r\n      d.body.style.marginBottom = '';\r\n      delete Nav.haveExtra;\r\n      return $.off(d, 'scroll', Nav.removeExtra);\r\n    }\r\n  }\r\n};\r\nexport default Nav;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { Conf, g } from \"../globals/globals\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ImageHost = {\r\n  init() {\r\n    if ((!(this.useFaster = /\\S/.test(Conf['fourchanImageHost']))) || (g.SITE.software !== 'yotsuba') || !['index', 'thread'].includes(g.VIEW)) { return; }\r\n    return Callbacks.Post.push({\r\n      name: 'Image Host Rewriting',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  suggestions: ['i.4cdn.org', 'is2.4chan.org'],\r\n\r\n  host() {\r\n    return Conf['fourchanImageHost'].trim() || 'i.4cdn.org';\r\n  },\r\n  flashHost() {\r\n    return 'i.4cdn.org';\r\n  },\r\n  thumbHost() {\r\n    return 'i.4cdn.org';\r\n  },\r\n  test(hostname) {\r\n    return (hostname === 'i.4cdn.org') || ImageHost.regex.test(hostname);\r\n  },\r\n\r\n  regex: /^is\\d*\\.4chan(?:nel)?\\.org$/,\r\n\r\n  node() {\r\n    if (this.isClone) { return; }\r\n    const host = ImageHost.host();\r\n    if (this.file && ImageHost.test(this.file.url.split('/')[2]) && !/\\.swf$/.test(this.file.url)) {\r\n      this.file.link.hostname = host;\r\n      if (this.file.thumbLink) { this.file.thumbLink.hostname = host; }\r\n      this.file.url = this.file.link.href;\r\n    }\r\n    return ImageHost.fixLinks($$('a', this.nodes.comment));\r\n  },\r\n\r\n  fixLinks(links) {\r\n    for (var link of links) {\r\n      if (ImageHost.test(link.hostname) && !/\\.swf$/.test(link.pathname)) {\r\n        var host = ImageHost.host();\r\n        if (link.hostname !== host) { link.hostname = host; }\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default ImageHost;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Config from \"../config/Config\";\r\nimport Header from \"../General/Header\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf, E } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Volume = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) ||\r\n      (!Conf['Image Expansion'] && !Conf['Image Hover'] && !Conf['Image Hover in Catalog'] && !Conf['Gallery'])) { return; }\r\n\r\n    $.sync('Allow Sound', function(x) {\r\n      Conf['Allow Sound'] = x;\r\n      if (Volume.inputs) Volume.inputs.unmute.checked = x;\r\n    });\r\n\r\n    $.sync('Default Volume', function(x) {\r\n      Conf['Default Volume'] = x;\r\n      if (Volume.inputs) Volume.inputs.volume.value = x;\r\n    });\r\n\r\n    if (Conf['Mouse Wheel Volume']) {\r\n      Callbacks.Post.push({\r\n        name: 'Mouse Wheel Volume',\r\n        cb:   this.node\r\n      });\r\n    }\r\n\r\n    if (g.SITE.noAudio?.(g.BOARD)) { return; }\r\n\r\n    if (Conf['Mouse Wheel Volume']) {\r\n      Callbacks.CatalogThread.push({\r\n        name: 'Mouse Wheel Volume',\r\n        cb:   this.catalogNode\r\n      });\r\n    }\r\n\r\n    const unmuteEntry = UI.checkbox('Allow Sound', 'Allow Sound');\r\n    unmuteEntry.title = Config.main['Images and Videos']['Allow Sound'][1];\r\n\r\n    const volumeEntry = $.el('label',\r\n      {title: 'Default volume for videos.'});\r\n    $.extend(volumeEntry,\r\n      {innerHTML: \"<input name=\\\"Default Volume\\\" type=\\\"range\\\" min=\\\"0\\\" max=\\\"1\\\" step=\\\"0.01\\\" value=\\\"\" + E(Conf[\"Default Volume\"]) + \"\\\"> Volume\"});\r\n\r\n    this.inputs = {\r\n      unmute: unmuteEntry.firstElementChild,\r\n      volume: volumeEntry.firstElementChild\r\n    };\r\n\r\n    $.on(this.inputs.unmute, 'change', $.cb.checked);\r\n    $.on(this.inputs.volume, 'change', $.cb.value);\r\n\r\n    Header.menu.addEntry({el: unmuteEntry, order: 200});\r\n    return Header.menu.addEntry({el: volumeEntry, order: 201});\r\n  },\r\n\r\n  setup(video) {\r\n    video.muted  = !Conf['Allow Sound'];\r\n    video.volume = Conf['Default Volume'];\r\n    return $.on(video, 'volumechange', Volume.change);\r\n  },\r\n\r\n  change() {\r\n    const {muted, volume} = this;\r\n    const items = {\r\n      'Allow Sound': !muted,\r\n      'Default Volume': volume\r\n    };\r\n    for (var key in items) {\r\n      var val = items[key];\r\n      if (Conf[key] === val) {\r\n        delete items[key];\r\n      }\r\n    }\r\n    $.set(items);\r\n    $.extend(Conf, items);\r\n    if (Volume.inputs) {\r\n      Volume.inputs.unmute.checked = !muted;\r\n      return Volume.inputs.volume.value = volume;\r\n    }\r\n  },\r\n\r\n  node() {\r\n    if (g.SITE.noAudio?.(this.board)) { return; }\r\n    for (var file of this.files) {\r\n      if (file.isVideo) {\r\n        if (file.thumb) { $.on(file.thumb,                                'wheel', Volume.wheel.bind(Header.hover)); }\r\n        $.on(($('.file-info', file.text) || file.link), 'wheel', Volume.wheel.bind(file.thumbLink));\r\n      }\r\n    }\r\n  },\r\n\r\n  catalogNode() {\r\n    const file = this.thread.OP.files[0];\r\n    if (!file?.isVideo) { return; }\r\n    return $.on(this.nodes.thumb, 'wheel', Volume.wheel.bind(Header.hover));\r\n  },\r\n\r\n  wheel(e) {\r\n    let el;\r\n    if (e.shiftKey || e.altKey || e.ctrlKey || e.metaKey) { return; }\r\n    if (!(el = $('video:not([data-md5])', this))) { return; }\r\n    if (el.muted || !$.hasAudio(el)) { return; }\r\n    let volume = el.volume + 0.1;\r\n    if (e.deltaY < 0) { volume *= 1.1; }\r\n    if (e.deltaY > 0) { volume /= 1.1; }\r\n    el.volume = $.minmax(volume - 0.1, 0, 1);\r\n    return e.preventDefault();\r\n  }\r\n};\r\nexport default Volume;\r\n","import Redirect from \"../Archive/Redirect\";\r\nimport Notice from \"../classes/Notice\";\r\nimport { g, Conf, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport CrossOrigin from \"../platform/CrossOrigin\";\r\nimport ImageHost from \"./ImageHost\";\r\nimport Volume from \"./Volume\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS204: Change includes calls to have a more natural evaluation order\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ImageCommon = {\r\n  // Pause and mute video in preparation for removing the element from the document.\r\n  pause(video) {\r\n    if (video.nodeName !== 'VIDEO') { return; }\r\n    video.pause();\r\n    $.off(video, 'volumechange', Volume.change);\r\n    return video.muted = true;\r\n  },\r\n\r\n  rewind(el) {\r\n    if (el.nodeName === 'VIDEO') {\r\n      if (el.readyState >= el.HAVE_METADATA) { return el.currentTime = 0; }\r\n    } else if (/\\.gif$/.test(el.src)) {\r\n      return $.queueTask(() => el.src = el.src);\r\n    }\r\n  },\r\n\r\n  pushCache(el) {\r\n    ImageCommon.cache = el;\r\n    return $.on(el, 'error', ImageCommon.cacheError);\r\n  },\r\n\r\n  popCache() {\r\n    const el = ImageCommon.cache;\r\n    $.off(el, 'error', ImageCommon.cacheError);\r\n    delete ImageCommon.cache;\r\n    return el;\r\n  },\r\n\r\n  cacheError() {\r\n    if (ImageCommon.cache === this) { return delete ImageCommon.cache; }\r\n  },\r\n\r\n  decodeError(file, fileObj) {\r\n    let message;\r\n    if (file.error?.code !== MediaError.MEDIA_ERR_DECODE) { return false; }\r\n    if (!(message = $('.warning', fileObj.thumb.parentNode))) {\r\n      message = $.el('div', {className:   'warning'});\r\n      $.after(fileObj.thumb, message);\r\n    }\r\n    message.textContent = 'Error: Corrupt or unplayable video';\r\n    return true;\r\n  },\r\n\r\n  isFromArchive(file) {\r\n    return (g.SITE.software === 'yotsuba') && !ImageHost.test(file.src.split('/')[2]);\r\n  },\r\n\r\n  error(file, post, fileObj, delay, cb) {\r\n    let timeoutID;\r\n    const src = fileObj.url.split('/');\r\n    let url = null;\r\n    if ((g.SITE.software === 'yotsuba') && Conf['404 Redirect']) {\r\n      url = Redirect.to('file', {\r\n        boardID:  post.board.ID,\r\n        filename: src[src.length - 1]\r\n      });\r\n    }\r\n    if (!url || !Redirect.securityCheck(url)) { url = null; }\r\n\r\n    if ((post.isDead || fileObj.isDead) && !ImageCommon.isFromArchive(file)) { return cb(url); }\r\n\r\n    if (delay != null) { timeoutID = setTimeout((() => cb(url)), delay); }\r\n    if (post.isDead || fileObj.isDead) { return; }\r\n    const redirect = function() {\r\n      if (!ImageCommon.isFromArchive(file)) {\r\n        if (delay != null) { clearTimeout(timeoutID); }\r\n        return cb(url);\r\n      }\r\n    };\r\n\r\n    const threadJSON = g.SITE.urls.threadJSON?.(post);\r\n    if (!threadJSON) { return; }\r\n    var parseJSON = function(isArchiveURL) {\r\n      let needle, postObj;\r\n      if (this.status === 404) {\r\n        let archivedThreadJSON;\r\n        if (!isArchiveURL && (archivedThreadJSON = g.SITE.urls.archivedThreadJSON?.(post))) {\r\n          $.ajax(archivedThreadJSON, {onloadend() { return parseJSON.call(this, true); }});\r\n        } else {\r\n          post.kill(!post.isClone, fileObj.index);\r\n        }\r\n      }\r\n      if (this.status !== 200) { return redirect(); }\r\n      for (postObj of this.response.posts) {\r\n        if (postObj.no === post.ID) { break; }\r\n      }\r\n      if (postObj.no !== post.ID) {\r\n        post.kill();\r\n        return redirect();\r\n      } else if ((needle = fileObj.docIndex, g.SITE.Build.parseJSON(postObj, post.board).filesDeleted.includes(needle))) {\r\n        post.kill(true);\r\n        return redirect();\r\n      } else {\r\n        return url = fileObj.url;\r\n      }\r\n    };\r\n    return $.ajax(threadJSON, {onloadend() { return parseJSON.call(this); }});\r\n  },\r\n\r\n  // Add controls, but not until the mouse is moved over the video.\r\n  addControls(video) {\r\n    var handler = function() {\r\n      $.off(video, 'mouseover', handler);\r\n      // Hacky workaround for Firefox forever-loading bug for very short videos\r\n      const t = new Date().getTime();\r\n      return $.asap((() => ($.engine !== 'gecko') || ((video.readyState >= 3) && (video.currentTime <= Math.max(0.1, (video.duration - 0.5)))) || (new Date().getTime() >= (t + 1000))), () => video.controls = true);\r\n    };\r\n    return $.on(video, 'mouseover', handler);\r\n  },\r\n\r\n  // XXX Estimate whether clicks are on the video controls and should be ignored.\r\n  onControls(e) {\r\n    return (Conf['Show Controls'] && Conf['Click Passthrough'] && (e.target.nodeName === 'VIDEO')) ||\r\n      (e.target.controls && ((e.target.getBoundingClientRect().bottom - e.clientY) < 35));\r\n  },\r\n\r\n  download(e) {\r\n    if (this.protocol === 'blob:') { return true; }\r\n    e.preventDefault();\r\n    const {href, download} = this;\r\n    return CrossOrigin.file(href, function(blob) {\r\n      if (blob) {\r\n        const a = $.el('a', {\r\n          href: URL.createObjectURL(blob),\r\n          download,\r\n          hidden: true\r\n        }\r\n        );\r\n        $.add(d.body, a);\r\n        a.click();\r\n        return $.rm(a);\r\n      } else {\r\n        return new Notice('warning', `Could not download ${href}`, 20);\r\n      }\r\n    });\r\n  }\r\n};\r\nexport default ImageCommon;\r\n",null,null,null,"import Callbacks from \"../classes/Callbacks\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Menu = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu']) { return; }\r\n\r\n    this.button = $.el('a', {\r\n      className: 'menu-button',\r\n      href:      'javascript:;'\r\n    }\r\n    );\r\n\r\n    $.extend(this.button, {textContent: \"🞃\"});\r\n\r\n    this.menu = new UI.Menu('post');\r\n    Callbacks.Post.push({\r\n      name: 'Menu',\r\n      cb:   this.node\r\n    });\r\n\r\n    return Callbacks.CatalogThread.push({\r\n      name: 'Menu',\r\n      cb:   this.catalogNode\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) {\r\n      const button = $('.menu-button', this.nodes.info);\r\n      $.rmClass(button, 'active');\r\n      $.rm($('.dialog', this.nodes.info));\r\n      Menu.makeButton(this, button);\r\n      return;\r\n    }\r\n    return $.add(this.nodes.info, Menu.makeButton(this));\r\n  },\r\n\r\n  catalogNode() {\r\n    return $.after(this.nodes.icons, Menu.makeButton(this.thread.OP));\r\n  },\r\n\r\n  makeButton(post, button) {\r\n    if (!button) { button = Menu.button.cloneNode(true); }\r\n    $.on(button, 'click', function(e) {\r\n      return Menu.menu.toggle(e, this, post);\r\n    });\r\n    return button;\r\n  }\r\n};\r\nexport default Menu;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g } from \"../globals/globals\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Recursive = {\r\n  recursives: dict(),\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW)) { return; }\r\n    return Callbacks.Post.push({\r\n      name: 'Recursive',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone || this.isFetchedQuote) { return; }\r\n    for (var quote of this.quotes) {\r\n      var obj;\r\n      if ((obj = Recursive.recursives[quote])) {\r\n        for (var i = 0; i < obj.recursives.length; i++) {\r\n          var recursive = obj.recursives[i];\r\n          recursive(this, ...obj.args[i]);\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  add(recursive, post, ...args) {\r\n    const obj = Recursive.recursives[post.fullID] || (Recursive.recursives[post.fullID] = {\r\n      recursives: [],\r\n      args: []\r\n    });\r\n    obj.recursives.push(recursive);\r\n    return obj.args.push(args);\r\n  },\r\n\r\n  rm(recursive, post) {\r\n    let obj;\r\n    if (!(obj = Recursive.recursives[post.fullID])) { return; }\r\n    for (let i = 0; i < obj.recursives.length; i++) {\r\n      var rec = obj.recursives[i];\r\n      if (rec === recursive) {\r\n        obj.recursives.splice(i, 1);\r\n        obj.args.splice(i, 1);\r\n      }\r\n    }\r\n  },\r\n\r\n  apply(recursive, post, ...args) {\r\n    const {fullID} = post;\r\n    return g.posts.forEach(function(post) {\r\n      if (post.quotes.includes(fullID)) {\r\n        return recursive(post, ...args);\r\n      }\r\n    });\r\n  }\r\n};\r\nexport default Recursive;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport DataBoard from \"../classes/DataBoard\";\r\nimport Get from \"../General/Get\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport Menu from \"../Menu/Menu\";\r\nimport $ from \"../platform/$\";\r\nimport Recursive from \"./Recursive\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar PostHiding = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || (!Conf['Reply Hiding Buttons'] && !(Conf['Menu'] && Conf['Reply Hiding Link']))) { return; }\r\n\r\n    if (Conf['Reply Hiding Buttons']) {\r\n      $.addClass(doc, \"reply-hide\");\r\n    }\r\n\r\n    this.db = new DataBoard('hiddenPosts');\r\n    return Callbacks.Post.push({\r\n      name: 'Reply Hiding',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  isHidden(boardID, threadID, postID) {\r\n    return !!(PostHiding.db && PostHiding.db.get({boardID, threadID, postID}));\r\n  },\r\n\r\n  node() {\r\n    let data, sa;\r\n    if (!this.isReply || this.isClone || this.isFetchedQuote) { return; }\r\n\r\n    if (data = PostHiding.db.get({boardID: this.board.ID, threadID: this.thread.ID, postID: this.ID})) {\r\n      if (data.thisPost) {\r\n        PostHiding.hide(this, data.makeStub, data.hideRecursively);\r\n      } else {\r\n        Recursive.apply(PostHiding.hide, this, data.makeStub, true);\r\n        Recursive.add(PostHiding.hide, this, data.makeStub, true);\r\n      }\r\n    }\r\n\r\n    if (!Conf['Reply Hiding Buttons']) { return; }\r\n\r\n    const button = PostHiding.makeButton(this, 'hide');\r\n    if (sa = g.SITE.selectors.sideArrows) {\r\n      const sideArrows = $(sa, this.nodes.root);\r\n      $.replace(sideArrows.firstChild, button);\r\n      return sideArrows.className = 'replacedSideArrows';\r\n    } else {\r\n      return $.prepend(this.nodes.info, button);\r\n    }\r\n  },\r\n\r\n  menu: {\r\n    init() {\r\n      if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Reply Hiding Link']) { return; }\r\n\r\n      // Hide\r\n      let div = $.el('div', {\r\n        className: 'hide-reply-link',\r\n        textContent: 'Hide'\r\n      }\r\n      );\r\n\r\n      let apply = $.el('a', {\r\n        textContent: 'Apply',\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.on(apply, 'click', PostHiding.menu.hide);\r\n\r\n      let thisPost = UI.checkbox('thisPost', 'This post',    true);\r\n      let replies  = UI.checkbox('replies',  'Hide replies', Conf['Recursive Hiding']);\r\n      const makeStub = UI.checkbox('makeStub', 'Make stub',    Conf['Stubs']);\r\n\r\n      Menu.menu.addEntry({\r\n        el: div,\r\n        order: 20,\r\n        open(post) {\r\n          if (!post.isReply || post.isClone || post.isHidden) {\r\n            return false;\r\n          }\r\n          PostHiding.menu.post = post;\r\n          return true;\r\n        },\r\n        subEntries: [\r\n            {el: apply}\r\n          ,\r\n            {el: thisPost}\r\n          ,\r\n            {el: replies}\r\n          ,\r\n            {el: makeStub}\r\n        ]});\r\n\r\n      // Show\r\n      div = $.el('div', {\r\n        className: 'show-reply-link',\r\n        textContent: 'Show'\r\n      }\r\n      );\r\n\r\n      apply = $.el('a', {\r\n        textContent: 'Apply',\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.on(apply, 'click', PostHiding.menu.show);\r\n\r\n      thisPost = UI.checkbox('thisPost', 'This post',    false);\r\n      replies  = UI.checkbox('replies',  'Show replies', false);\r\n      const hideStubLink = $.el('a', {\r\n        textContent: 'Hide stub',\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.on(hideStubLink, 'click', PostHiding.menu.hideStub);\r\n\r\n      Menu.menu.addEntry({\r\n        el: div,\r\n        order: 20,\r\n        open(post) {\r\n          let data;\r\n          if (!post.isReply || post.isClone || !post.isHidden) {\r\n            return false;\r\n          }\r\n          if (!(data = PostHiding.db.get({boardID: post.board.ID, threadID: post.thread.ID, postID: post.ID}))) {\r\n            return false;\r\n          }\r\n          PostHiding.menu.post = post;\r\n          thisPost.firstChild.checked = post.isHidden;\r\n          replies.firstChild.checked  = (data?.hideRecursively != null) ? data.hideRecursively : Conf['Recursive Hiding'];\r\n          return true;\r\n        },\r\n        subEntries: [\r\n            {el: apply}\r\n          ,\r\n            {el: thisPost}\r\n          ,\r\n            {el: replies}\r\n        ]});\r\n\r\n      return Menu.menu.addEntry({\r\n        el: hideStubLink,\r\n        order: 15,\r\n        open(post) {\r\n          let data;\r\n          if (!post.isReply || post.isClone || !post.isHidden) {\r\n            return false;\r\n          }\r\n          if (!(data = PostHiding.db.get({boardID: post.board.ID, threadID: post.thread.ID, postID: post.ID}))) {\r\n            return false;\r\n          }\r\n          return PostHiding.menu.post = post;\r\n        }\r\n      });\r\n    },\r\n\r\n    hide() {\r\n      const parent   = this.parentNode;\r\n      const thisPost = $('input[name=thisPost]', parent).checked;\r\n      const replies  = $('input[name=replies]',  parent).checked;\r\n      const makeStub = $('input[name=makeStub]', parent).checked;\r\n      const {post}   = PostHiding.menu;\r\n      if (thisPost) {\r\n        PostHiding.hide(post, makeStub, replies);\r\n      } else if (replies) {\r\n        Recursive.apply(PostHiding.hide, post, makeStub, true);\r\n        Recursive.add(PostHiding.hide, post, makeStub, true);\r\n      } else {\r\n        return;\r\n      }\r\n      PostHiding.saveHiddenState(post, true, thisPost, makeStub, replies);\r\n      return $.event('CloseMenu');\r\n    },\r\n\r\n    show() {\r\n      let data;\r\n      const parent   = this.parentNode;\r\n      const thisPost = $('input[name=thisPost]', parent).checked;\r\n      const replies  = $('input[name=replies]',  parent).checked;\r\n      const {post}   = PostHiding.menu;\r\n      if (thisPost) {\r\n        PostHiding.show(post, replies);\r\n      } else if (replies) {\r\n        Recursive.apply(PostHiding.show, post, true);\r\n        Recursive.rm(PostHiding.hide, post, true);\r\n      } else {\r\n        return;\r\n      }\r\n      if (data = PostHiding.db.get({boardID: post.board.ID, threadID: post.thread.ID, postID: post.ID})) {\r\n        PostHiding.saveHiddenState(post, !(thisPost && replies), !thisPost, data.makeStub, !replies);\r\n      }\r\n      return $.event('CloseMenu');\r\n    },\r\n    hideStub() {\r\n      let data;\r\n      const {post} = PostHiding.menu;\r\n      if (data = PostHiding.db.get({boardID: post.board.ID, threadID: post.thread.ID, postID: post.ID})) {\r\n        PostHiding.show(post, data.hideRecursively);\r\n        PostHiding.hide(post, false, data.hideRecursively);\r\n        PostHiding.saveHiddenState(post, true, true, false, data.hideRecursively);\r\n      }\r\n      $.event('CloseMenu');\r\n    }\r\n  },\r\n\r\n  makeButton(post, type) {\r\n    const span = $.el('span', {\r\n      textContent: type === 'hide' ? '➖︎' : '➕︎',\r\n    });\r\n    const a = $.el('a', {\r\n      className: `${type}-reply-button`,\r\n      href:      'javascript:;'\r\n    }\r\n    );\r\n    $.add(a, span);\r\n    $.on(a, 'click', PostHiding.toggle);\r\n    return a;\r\n  },\r\n\r\n  saveHiddenState(post, isHiding, thisPost, makeStub, hideRecursively) {\r\n    const data = {\r\n      boardID:  post.board.ID,\r\n      threadID: post.thread.ID,\r\n      postID:   post.ID\r\n    };\r\n    if (isHiding) {\r\n      data.val = {\r\n        thisPost: thisPost !== false, // undefined -> true\r\n        makeStub,\r\n        hideRecursively\r\n      };\r\n      return PostHiding.db.set(data);\r\n    } else {\r\n      return PostHiding.db.delete(data);\r\n    }\r\n  },\r\n\r\n  toggle() {\r\n    const post = Get.postFromNode(this);\r\n    PostHiding[(post.isHidden ? 'show' : 'hide')](post);\r\n    return PostHiding.saveHiddenState(post, post.isHidden);\r\n  },\r\n\r\n  hide(post, makeStub=Conf['Stubs'], hideRecursively=Conf['Recursive Hiding']) {\r\n    if (post.isHidden) { return; }\r\n    post.isHidden = true;\r\n\r\n    if (hideRecursively) {\r\n      Recursive.apply(PostHiding.hide, post, makeStub, true);\r\n      Recursive.add(PostHiding.hide, post, makeStub, true);\r\n    }\r\n\r\n    for (var quotelink of Get.allQuotelinksLinkingTo(post)) {\r\n      $.addClass(quotelink, 'filtered');\r\n    }\r\n\r\n    if (!makeStub) {\r\n      post.nodes.root.hidden = true;\r\n      return;\r\n    }\r\n\r\n    const a = PostHiding.makeButton(post, 'show');\r\n    $.add(a, $.tn(` ${post.info.nameBlock}`));\r\n    post.nodes.stub = $.el('div',\r\n      {className: 'stub'});\r\n    $.add(post.nodes.stub, a);\r\n    if (Conf['Menu']) {\r\n      $.add(post.nodes.stub, Menu.makeButton(post));\r\n    }\r\n    return $.prepend(post.nodes.root, post.nodes.stub);\r\n  },\r\n\r\n  show(post, showRecursively=Conf['Recursive Hiding']) {\r\n    if (post.nodes.stub) {\r\n      $.rm(post.nodes.stub);\r\n      delete post.nodes.stub;\r\n    } else {\r\n      post.nodes.root.hidden = false;\r\n    }\r\n    post.isHidden = false;\r\n    if (showRecursively) {\r\n      Recursive.apply(PostHiding.show, post, true);\r\n      Recursive.rm(PostHiding.hide, post);\r\n    }\r\n    for (var quotelink of Get.allQuotelinksLinkingTo(post)) {\r\n      $.rmClass(quotelink, 'filtered');\r\n    }\r\n  }\r\n};\r\nexport default PostHiding;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Post from \"../classes/Post\";\r\nimport Index from \"../General/Index\";\r\nimport { g, Conf, d, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { DAY, HOUR, MINUTE, SECOND } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar RelativeDates = {\r\n  INTERVAL: 30000,\r\n\r\n  init() {\r\n    if (\r\n      (['index', 'thread', 'archive'].includes(g.VIEW) && Conf['Relative Post Dates'] && !Conf['Relative Date Title']) ||\r\n      Index.enabled\r\n    ) {\r\n      this.flush();\r\n      $.on(d, 'visibilitychange PostsInserted', this.flush);\r\n    }\r\n\r\n    if (Conf['Relative Post Dates']) {\r\n      return Callbacks.Post.push({\r\n        name: 'Relative Post Dates',\r\n        cb:   this.node\r\n      });\r\n    }\r\n  },\r\n\r\n  node() {\r\n    if (!this.info.date) { return; }\r\n    const dateEl = this.nodes.date;\r\n    if (Conf['Relative Date Title']) {\r\n      $.on(dateEl, 'mouseover', () => RelativeDates.hover(this));\r\n      return;\r\n    }\r\n    if (this.isClone) { return; }\r\n\r\n    // Show original absolute time as tooltip so users can still know exact times\r\n    // Since \"Time Formatting\" runs its `node` before us, the title tooltip will\r\n    // pick up the user-formatted time instead of 4chan time when enabled.\r\n    dateEl.title = dateEl.textContent;\r\n\r\n    return RelativeDates.update(this);\r\n  },\r\n\r\n  // diff is milliseconds from now.\r\n  relative(diff, now, date, abbrev) {\r\n    let number;\r\n    let unit = (() => {\r\n      if ((number = (diff / DAY)) >= 1) {\r\n      const years  = now.getFullYear()  - date.getFullYear();\r\n        let months = now.getMonth() - date.getMonth();\r\n      const days   = now.getDate()  - date.getDate();\r\n        if (years > 1) {\r\n          number = years - ((months < 0) || ((months === 0) && (days < 0)));\r\n          return 'year';\r\n        } else if ((years === 1) && ((months > 0) || ((months === 0) && (days >= 0)))) {\r\n          number = years;\r\n          return 'year';\r\n      } else if ((months = months + (12*years)) > 1) {\r\n          number = months - (days < 0);\r\n          return 'month';\r\n        } else if ((months === 1) && (days >= 0)) {\r\n          number = months;\r\n          return 'month';\r\n        } else {\r\n          return 'day';\r\n        }\r\n    } else if ((number = (diff / HOUR)) >= 1) {\r\n      return 'hour';\r\n    } else if ((number = (diff / MINUTE)) >= 1) {\r\n      return 'minute';\r\n    } else {\r\n      // prevent \"-1 seconds ago\"\r\n      number = Math.max(0, diff) / SECOND;\r\n      return 'second';\r\n    }\r\n    })();\r\n\r\n    const rounded = Math.round(number);\r\n\r\n    if (abbrev) {\r\n      unit = unit === 'month' ? 'mo' : unit[0];\r\n    } else {\r\n      if (rounded !== 1) { unit += 's'; } // pluralize\r\n    }\r\n\r\n    if (abbrev) { return `${rounded}${unit}`; } else { return `${rounded} ${unit} ago`; }\r\n  },\r\n\r\n  // Changing all relative dates as soon as possible incurs many annoying\r\n  // redraws and scroll stuttering. Thus, sacrifice accuracy for UX/CPU economy,\r\n  // and perform redraws when the DOM is otherwise being manipulated (and scroll\r\n  // stuttering won't be noticed), falling back to INTERVAL while the page\r\n  // is visible.\r\n  //\r\n  // Each individual dateTime element will add its update() function to the stale list\r\n  // when it is to be called.\r\n  stale: [],\r\n  flush() {\r\n    // No point in changing the dates until the user sees them.\r\n    if (d.hidden) { return; }\r\n\r\n    const now = new Date();\r\n    for (var data of RelativeDates.stale) { RelativeDates.update(data, now); }\r\n    RelativeDates.stale = [];\r\n\r\n    // Reset automatic flush.\r\n    clearTimeout(RelativeDates.timeout);\r\n    return RelativeDates.timeout = setTimeout(RelativeDates.flush, RelativeDates.INTERVAL);\r\n  },\r\n\r\n  hover(post) {\r\n    const {\r\n      date\r\n    } = post.info;\r\n    const now  = new Date();\r\n    const diff = now - date;\r\n    return post.nodes.date.title = RelativeDates.relative(diff, now, date);\r\n  },\r\n\r\n  // `update()`, when called from `flush()`, updates the elements,\r\n  // and re-calls `setOwnTimeout()` to re-add `data` to the stale list later.\r\n  update(data, now) {\r\n    let abbrev, date;\r\n    const isPost = data instanceof Post;\r\n    if (isPost) {\r\n      ({\r\n        date\r\n      } = data.info);\r\n      abbrev = false;\r\n    } else {\r\n      date = new Date(+data.dataset.utc);\r\n      abbrev = !!data.dataset.abbrev;\r\n    }\r\n    if (!now) { now = new Date(); }\r\n    const diff = now - date;\r\n    const relative = RelativeDates.relative(diff, now, date, abbrev);\r\n    if (isPost) {\r\n      for (var singlePost of [data].concat(data.clones)) {\r\n        singlePost.nodes.date.firstChild.textContent = relative;\r\n      }\r\n    } else {\r\n      data.firstChild.textContent = relative;\r\n    }\r\n    return RelativeDates.setOwnTimeout(diff, data);\r\n  },\r\n\r\n  setOwnTimeout(diff, data) {\r\n    const delay = diff < MINUTE ?\r\n      SECOND - ((diff + (SECOND / 2)) % SECOND)\r\n    : diff < HOUR ?\r\n      MINUTE - ((diff + (MINUTE / 2)) % MINUTE)\r\n    : diff < DAY ?\r\n      HOUR - ((diff + (HOUR / 2)) % HOUR)\r\n    :\r\n      DAY - ((diff + (DAY / 2)) % DAY);\r\n    return setTimeout(RelativeDates.markStale, delay, data);\r\n  },\r\n\r\n  markStale(data) {\r\n    if (RelativeDates.stale.includes(data)) { return; } // We can call RelativeDates.update() multiple times.\r\n    if (data instanceof Post && !g.posts.get(data.fullID)) { return; } // collected post.\r\n    if (data instanceof Element && !doc.contains(data)) { return; } // removed catalog reply.\r\n    return RelativeDates.stale.push(data);\r\n  }\r\n};\r\nexport default RelativeDates;\r\n","import Notice from \"../classes/Notice\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { dict, HOUR } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar BoardConfig = {\r\n  cbs: [],\r\n\r\n  init() {\r\n    let middle;\r\n    if (g.SITE.software !== 'yotsuba') { return; }\r\n    const now = Date.now();\r\n    if (now - (2 * HOUR) >= ((middle = Conf['boardConfig'].lastChecked || 0)) || middle > now) {\r\n      return $.ajax(`${location.protocol}//a.4cdn.org/boards.json`,\r\n        {onloadend: this.load});\r\n    } else {\r\n      const {boards} = Conf['boardConfig'];\r\n      return this.set(boards);\r\n    }\r\n  },\r\n\r\n  load() {\r\n    let boards;\r\n    if ((this.status === 200) && this.response && this.response.boards) {\r\n      boards = dict();\r\n      for (var board of this.response.boards) {\r\n        boards[board.board] = board;\r\n      }\r\n      $.set('boardConfig', {boards, lastChecked: Date.now()});\r\n    } else {\r\n      ({boards} = Conf['boardConfig']);\r\n      const err = (() => { switch (this.status) {\r\n        case 0:   return 'Connection Error';\r\n        case 200: return 'Invalid Data';\r\n        default:          return `Error ${this.statusText} (${this.status})`;\r\n      } })();\r\n      new Notice('warning', `Failed to load board configuration. ${err}`, 20);\r\n    }\r\n    return BoardConfig.set(boards);\r\n  },\r\n\r\n  set(boards) {\r\n    this.boards = boards;\r\n    for (var ID in g.boards) {\r\n      var board = g.boards[ID];\r\n      board.config = this.boards[ID] || {};\r\n    }\r\n    for (var cb of this.cbs) {\r\n      $.queueTask(cb);\r\n    }\r\n  },\r\n\r\n  ready(cb) {\r\n    if (this.boards) {\r\n      return cb();\r\n    } else {\r\n      return this.cbs.push(cb);\r\n    }\r\n  },\r\n\r\n  sfwBoards(sfw) {\r\n    return (() => {\r\n      const result = [];\r\n      const object = this.boards || Conf['boardConfig'].boards;\r\n      for (var board in object) {\r\n        var data = object[board];\r\n        if (!!data.ws_board === sfw) {\r\n          result.push(board);\r\n        }\r\n      }\r\n      return result;\r\n    })();\r\n  },\r\n\r\n  isSFW(board) {\r\n    return !!(this.boards || Conf['boardConfig'].boards)[board]?.ws_board;\r\n  },\r\n\r\n  domain(board) {\r\n    // return `boards.${BoardConfig.isSFW(board) ? '4channel' : '4chan'}.org`;\r\n    return 'boards.4chan.org';\r\n  },\r\n\r\n  isArchived(board) {\r\n    // assume archive exists if no data available to prevent cleaning of archived threads\r\n    const data = (this.boards || Conf['boardConfig'].boards)[board];\r\n    return !data || data.is_archived;\r\n  },\r\n\r\n  noAudio(boardID) {\r\n    if (g.SITE.software !== 'yotsuba') { return false; }\r\n    const boards = this.boards || Conf['boardConfig'].boards;\r\n    return boards && boards[boardID] && !boards[boardID].webm_audio;\r\n  },\r\n\r\n  title(boardID) {\r\n    return (this.boards || Conf['boardConfig'].boards)?.[boardID]?.title || '';\r\n  }\r\n};\r\nexport default BoardConfig;\r\n",null,"import { d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst PostRedirect = {\r\n  init() {\r\n    return $.on(d, 'QRPostSuccessful', e => {\r\n      if (!e.detail.redirect) { return; }\r\n      this.event = e;\r\n      this.delays = 0;\r\n      return $.queueTask(() => {\r\n        if ((e === this.event) && (this.delays === 0)) {\r\n          return location.href = e.detail.redirect;\r\n        }\r\n      });\r\n    });\r\n  },\r\n\r\n  delays: 0,\r\n\r\n  delay() {\r\n    if (!this.event) { return null; }\r\n    const e = this.event;\r\n    this.delays++;\r\n    return () => {\r\n      if (e !== this.event) { return; }\r\n      this.delays--;\r\n      if (this.delays === 0) {\r\n        return location.href = e.detail.redirect;\r\n      }\r\n    };\r\n  }\r\n};\r\nexport default PostRedirect;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Get from \"../General/Get\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ExpandComment = {\r\n  init() {\r\n    if ((g.VIEW !== 'index') || !Conf['Comment Expansion'] || Conf['JSON Index']) { return; }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Comment Expansion',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    let a;\r\n    if (a = $('.abbr > a:not([onclick])', this.nodes.comment)) {\r\n      return $.on(a, 'click', ExpandComment.cb);\r\n    }\r\n  },\r\n\r\n  callbacks: [],\r\n\r\n  cb(e) {\r\n    e.preventDefault();\r\n    return ExpandComment.expand(Get.postFromNode(this));\r\n  },\r\n\r\n  expand(post) {\r\n    let a;\r\n    if (post.nodes.longComment && !post.nodes.longComment.parentNode) {\r\n      $.replace(post.nodes.shortComment, post.nodes.longComment);\r\n      post.nodes.comment = post.nodes.longComment;\r\n      return;\r\n    }\r\n    if (!(a = $('.abbr > a', post.nodes.comment))) { return; }\r\n    a.textContent = `Post No.${post} Loading...`;\r\n    return $.cache(g.SITE.urls.threadJSON({boardID: post.boardID, threadID: post.threadID}), function() { return ExpandComment.parse(this, a, post); });\r\n  },\r\n\r\n  contract(post) {\r\n    if (!post.nodes.shortComment) { return; }\r\n    const a = $('.abbr > a', post.nodes.shortComment);\r\n    a.textContent = 'here';\r\n    $.replace(post.nodes.longComment, post.nodes.shortComment);\r\n    return post.nodes.comment = post.nodes.shortComment;\r\n  },\r\n\r\n  parse(req, a, post) {\r\n    let postObj, spoilerRange;\r\n    const {status} = req;\r\n    if (![200, 304].includes(status)) {\r\n      a.textContent = status ? `Error ${req.statusText} (${status})` : 'Connection Error';\r\n      return;\r\n    }\r\n\r\n    const {\r\n      posts\r\n    } = req.response;\r\n    if (spoilerRange = posts[0].custom_spoiler) {\r\n      g.SITE.Build.spoilerRange[g.BOARD] = spoilerRange;\r\n    }\r\n\r\n    for (postObj of posts) {\r\n      if (postObj.no === post.ID) { break; }\r\n    }\r\n    if (postObj.no !== post.ID) {\r\n      a.textContent = `Post No.${post} not found.`;\r\n      return;\r\n    }\r\n\r\n    const {comment} = post.nodes;\r\n    const clone = comment.cloneNode(false);\r\n    clone.innerHTML = postObj.com;\r\n    // Fix pathnames\r\n    for (var quote of $$('.quotelink', clone)) {\r\n      var href = quote.getAttribute('href');\r\n      if (href[0] === '/') { continue; } // Cross-board quote, or board link\r\n      if (href[0] === '#') {\r\n        quote.href = `${a.pathname.split(/\\/+/).splice(0,4).join('/')}${href}`;\r\n      } else {\r\n        quote.href = `${a.pathname.split(/\\/+/).splice(0,3).join('/')}/${href}`;\r\n      }\r\n    }\r\n    post.nodes.shortComment = comment;\r\n    $.replace(comment, clone);\r\n    post.nodes.comment = (post.nodes.longComment = clone);\r\n    post.parseComment();\r\n    post.parseQuotes();\r\n\r\n    for (var callback of ExpandComment.callbacks) {\r\n      callback.call(post);\r\n    }\r\n  }\r\n};\r\nexport default ExpandComment;;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport DataBoard from \"../classes/DataBoard\";\r\nimport Notice from \"../classes/Notice\";\r\nimport Get from \"../General/Get\";\r\nimport Header from \"../General/Header\";\r\nimport { Conf, d, doc, g } from \"../globals/globals\";\r\nimport Menu from \"../Menu/Menu\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport PostRedirect from \"../Posting/PostRedirect\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar QuoteYou = {\r\n  init() {\r\n    if (!Conf['Remember Your Posts']) { return; }\r\n\r\n    this.db = new DataBoard('yourPosts');\r\n    $.sync('Remember Your Posts', enabled => Conf['Remember Your Posts'] = enabled);\r\n    $.on(d, 'QRPostSuccessful', function(e) {\r\n      const cb = PostRedirect.delay();\r\n      return $.get('Remember Your Posts', Conf['Remember Your Posts'], function(items) {\r\n        if (!items['Remember Your Posts']) { return; }\r\n        const {boardID, threadID, postID} = e.detail;\r\n        return QuoteYou.db.set({boardID, threadID, postID, val: true}, cb);\r\n      });\r\n    });\r\n\r\n    if (!['index', 'thread', 'archive'].includes(g.VIEW)) { return; }\r\n\r\n    if (Conf['Highlight Own Posts']) {\r\n      $.addClass(doc, 'highlight-own');\r\n    }\r\n\r\n    if (Conf['Highlight Posts Quoting You']) {\r\n      $.addClass(doc, 'highlight-you');\r\n    }\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    // \\u00A0 is nbsp\r\n    this.mark = $.el('span', {\r\n      textContent: '\\u00A0(You)',\r\n      className:   'qmark-you'\r\n    }\r\n    );\r\n    Callbacks.Post.push({\r\n      name: 'Mark Quotes of You',\r\n      cb:   this.node\r\n    });\r\n\r\n    return QuoteYou.menu.init();\r\n  },\r\n\r\n  isYou(post) {\r\n    return !!QuoteYou.db?.get({\r\n      boardID:  post.boardID,\r\n      threadID: post.threadID,\r\n      postID:   post.ID\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) { return; }\r\n\r\n    if (QuoteYou.isYou(this)) {\r\n      $.addClass(this.nodes.root, 'yourPost');\r\n    }\r\n\r\n    // Stop there if there's no quotes in that post.\r\n    if (!this.quotes.length) { return; }\r\n\r\n    for (var quotelink of this.nodes.quotelinks) {\r\n      if (QuoteYou.db.get(Get.postDataFromLink(quotelink))) {\r\n        if (Conf['Mark Quotes of You']) { $.add(quotelink, QuoteYou.mark.cloneNode(true)); }\r\n        $.addClass(quotelink, 'you');\r\n        $.addClass(this.nodes.root, 'quotesYou');\r\n      }\r\n    }\r\n  },\r\n\r\n  menu: {\r\n    init() {\r\n      const label = $.el('label',\r\n        {className: 'toggle-you'}\r\n      ,\r\n        {innerHTML: '<input type=\"checkbox\"> You'});\r\n      const input = $('input', label);\r\n      $.on(input, 'change', QuoteYou.menu.toggle);\r\n      return Menu.menu?.addEntry({\r\n        el: label,\r\n        order: 80,\r\n        open(post) {\r\n          QuoteYou.menu.post = (post.origin || post);\r\n          input.checked = QuoteYou.isYou(post);\r\n          return true;\r\n        }\r\n      });\r\n    },\r\n\r\n    toggle() {\r\n      const {post} = QuoteYou.menu;\r\n      const data = {boardID: post.board.ID, threadID: post.thread.ID, postID: post.ID, val: true};\r\n      if (this.checked) {\r\n        QuoteYou.db.set(data);\r\n      } else {\r\n        QuoteYou.db.delete(data);\r\n      }\r\n      for (var clone of [post].concat(post.clones)) {\r\n        clone.nodes.root.classList.toggle('yourPost', this.checked);\r\n      }\r\n      for (var quotelink of Get.allQuotelinksLinkingTo(post)) {\r\n        if (this.checked) {\r\n          if (Conf['Mark Quotes of You']) { $.add(quotelink, QuoteYou.mark.cloneNode(true)); }\r\n        } else {\r\n          $.rm($('.qmark-you', quotelink));\r\n        }\r\n        quotelink.classList.toggle('you', this.checked);\r\n        if ($.hasClass(quotelink, 'quotelink')) {\r\n          var quoter = Get.postFromNode(quotelink).nodes.root;\r\n          quoter.classList.toggle('quotesYou', !!$('.quotelink.you', quoter));\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  cb: {\r\n    seek(type) {\r\n      let highlighted, post;\r\n      let result;\r\n      const {highlight} = g.SITE.classes;\r\n      if (highlighted = $(`.${highlight}`)) { $.rmClass(highlighted, highlight); }\r\n\r\n      if (!QuoteYou.lastRead || !doc.contains(QuoteYou.lastRead) || !$.hasClass(QuoteYou.lastRead, 'quotesYou')) {\r\n        if (!(post = (QuoteYou.lastRead = $('.quotesYou')))) {\r\n          new Notice('warning', 'No posts are currently quoting you, loser.', 20);\r\n          return;\r\n        }\r\n        if (QuoteYou.cb.scroll(post)) { return; }\r\n      } else {\r\n        post = QuoteYou.lastRead;\r\n      }\r\n\r\n      const str = `${type}::div[contains(@class,'quotesYou')]`;\r\n\r\n      while (post = (result = $.X(str, post)).snapshotItem(type === 'preceding' ? result.snapshotLength - 1 : 0)) {\r\n        if (QuoteYou.cb.scroll(post)) { return; }\r\n      }\r\n\r\n      const posts = $$('.quotesYou');\r\n      return QuoteYou.cb.scroll(posts[type === 'following' ? 0 : posts.length - 1]);\r\n    },\r\n\r\n    scroll(root) {\r\n      const post = Get.postFromRoot(root);\r\n      if (!post.nodes.post.getBoundingClientRect().height) {\r\n        return false;\r\n      } else {\r\n        QuoteYou.lastRead = root;\r\n        location.href = Get.url('post', post);\r\n        Header.scrollTo(post.nodes.post);\r\n        if (post.isReply) {\r\n          const sel = `${g.SITE.selectors.postContainer}${g.SITE.selectors.highlightable.reply}`;\r\n          let node = post.nodes.root;\r\n          if (!node.matches(sel)) { node = $(sel, node); }\r\n          $.addClass(node, g.SITE.classes.highlight);\r\n        }\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default QuoteYou;\r\n","/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nexport default class RandomAccessList {\r\n  constructor(items) {\r\n    this.length = 0;\r\n    if (items) { for (var item of items) { this.push(item); } }\r\n  }\r\n\r\n  push(data) {\r\n    let item;\r\n    let {ID} = data;\r\n    if (!ID) { ID = data.id; }\r\n    if (this[ID]) { return; }\r\n    const {last} = this;\r\n    this[ID] = (item = {\r\n      prev: last,\r\n      next: null,\r\n      data,\r\n      ID\r\n    });\r\n    item.prev = last;\r\n    this.last = last ?\r\n      (last.next = item)\r\n    :\r\n      (this.first = item);\r\n    return this.length++;\r\n  }\r\n\r\n  before(root, item) {\r\n    if ((item.next === root) || (item === root)) { return; }\r\n\r\n    this.rmi(item);\r\n\r\n    const {prev} = root;\r\n    root.prev = item;\r\n    item.next = root;\r\n    item.prev = prev;\r\n    if (prev) {\r\n      return prev.next = item;\r\n    } else {\r\n      return this.first = item;\r\n    }\r\n  }\r\n\r\n  after(root, item) {\r\n    if ((item.prev === root) || (item === root)) { return; }\r\n\r\n    this.rmi(item);\r\n\r\n    const {next} = root;\r\n    root.next = item;\r\n    item.prev = root;\r\n    item.next = next;\r\n    if (next) {\r\n      return next.prev = item;\r\n    } else {\r\n      return this.last = item;\r\n    }\r\n  }\r\n\r\n  prepend(item) {\r\n    const {first} = this;\r\n    if ((item === first) || !this[item.ID]) { return; }\r\n    this.rmi(item);\r\n    item.next  = first;\r\n    if (first) {\r\n      first.prev = item;\r\n    } else {\r\n      this.last = item;\r\n    }\r\n    this.first = item;\r\n    return delete item.prev;\r\n  }\r\n\r\n  shift() {\r\n    return this.rm(this.first.ID);\r\n  }\r\n\r\n  order() {\r\n    let item;\r\n    const order = [(item = this.first)];\r\n    while ((item = item.next)) { order.push(item); }\r\n    return order;\r\n  }\r\n\r\n  rm(ID) {\r\n    const item = this[ID];\r\n    if (!item) { return; }\r\n    delete this[ID];\r\n    this.length--;\r\n    this.rmi(item);\r\n    delete item.next;\r\n    return delete item.prev;\r\n  }\r\n\r\n  rmi(item) {\r\n    const {prev, next} = item;\r\n    if (prev) {\r\n      prev.next = next;\r\n    } else {\r\n      this.first = next;\r\n    }\r\n    if (next) {\r\n      return next.prev = prev;\r\n    } else {\r\n      return this.last = prev;\r\n    }\r\n  }\r\n}\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport DataBoard from \"../classes/DataBoard\";\r\nimport RandomAccessList from \"../classes/RandomAccessList\";\r\nimport Get from \"../General/Get\";\r\nimport Header from \"../General/Header\";\r\nimport { g, Conf, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { debounce, SECOND } from \"../platform/helpers\";\r\nimport QuoteYou from \"../Quotelinks/QuoteYou\";\r\nimport Favicon from \"./Favicon\";\r\nimport ThreadWatcher from \"./ThreadWatcher\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Unread = {\r\n  init() {\r\n    if ((g.VIEW !== 'thread') || (\r\n      !Conf['Unread Count'] &&\r\n      !Conf['Unread Favicon'] &&\r\n      !Conf['Unread Line'] &&\r\n      !Conf['Remember Last Read Post'] &&\r\n      !Conf['Desktop Notifications'] &&\r\n      !Conf['Quote Threading']\r\n    )) { return; }\r\n\r\n    if (Conf['Remember Last Read Post']) {\r\n      $.sync('Remember Last Read Post', enabled => Conf['Remember Last Read Post'] = enabled);\r\n      this.db = new DataBoard('lastReadPosts', this.sync);\r\n    }\r\n\r\n    this.hr = $.el('hr', {\r\n      id: 'unread-line',\r\n      className: 'unread-line'\r\n    }\r\n    );\r\n    this.posts = new Set();\r\n    this.postsQuotingYou = new Set();\r\n    this.order = new RandomAccessList();\r\n    this.position = null;\r\n\r\n    Callbacks.Thread.push({\r\n      name: 'Unread',\r\n      cb:   this.node\r\n    });\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Unread',\r\n      cb:   this.addPost\r\n    });\r\n  },\r\n\r\n  node() {\r\n    Unread.thread = this;\r\n    Unread.title  = d.title;\r\n    Unread.lastReadPost = Unread.db?.get({\r\n      boardID: this.board.ID,\r\n      threadID: this.ID\r\n    }) || 0;\r\n    Unread.readCount = 0;\r\n    for (var ID of this.posts.keys) { if (+ID <= Unread.lastReadPost) { Unread.readCount++; } }\r\n    $.one(d, '4chanXInitFinished', Unread.ready);\r\n    $.on(d, 'PostsInserted',      Unread.onUpdate);\r\n    $.on(d, 'ThreadUpdate',       function(e) { if (e.detail[404]) { return Unread.update(); } });\r\n    const resetLink = $.el('a', {\r\n      href: 'javascript:;',\r\n      className: 'unread-reset',\r\n      textContent: 'Mark all unread'\r\n    }\r\n    );\r\n    $.on(resetLink, 'click', Unread.reset);\r\n    return Header.menu.addEntry({\r\n      el: resetLink,\r\n      order: 70\r\n    });\r\n  },\r\n\r\n  ready() {\r\n    if (Conf['Remember Last Read Post'] && Conf['Scroll to Last Read Post']) { Unread.scroll(); }\r\n    Unread.setLine(true);\r\n    Unread.read();\r\n    Unread.update();\r\n    $.on(d, 'scroll visibilitychange', Unread.read);\r\n    if (Conf['Unread Line']) { return $.on(d, 'visibilitychange',        Unread.setLine); }\r\n  },\r\n\r\n  positionPrev() {\r\n    if (Unread.position) { return Unread.position.prev; } else { return Unread.order.last; }\r\n  },\r\n\r\n  scroll() {\r\n    // Let the header's onload callback handle it.\r\n    let hash;\r\n    if ((hash = location.hash.match(/\\d+/)) && hash[0] in Unread.thread.posts) { return; }\r\n\r\n    let position = Unread.positionPrev();\r\n    while (position) {\r\n      var {bottom} = position.data.nodes;\r\n      if (!bottom.getBoundingClientRect().height) {\r\n        // Don't try to scroll to posts with display: none\r\n        position = position.prev;\r\n      } else {\r\n        Header.scrollToIfNeeded(bottom, true);\r\n        break;\r\n      }\r\n    }\r\n  },\r\n\r\n  reset() {\r\n    if (Unread.lastReadPost == null) { return; }\r\n\r\n    Unread.posts = new Set();\r\n    Unread.postsQuotingYou = new Set();\r\n    Unread.order = new RandomAccessList();\r\n    Unread.position = null;\r\n    Unread.lastReadPost = 0;\r\n    Unread.readCount = 0;\r\n    Unread.thread.posts.forEach(post => Unread.addPost.call(post));\r\n\r\n    $.forceSync('Remember Last Read Post');\r\n    if (Conf['Remember Last Read Post'] && (!Unread.thread.isDead || Unread.thread.isArchived)) {\r\n      Unread.db.set({\r\n        boardID:  Unread.thread.board.ID,\r\n        threadID: Unread.thread.ID,\r\n        val:      0\r\n      });\r\n    }\r\n\r\n    Unread.updatePosition();\r\n    Unread.setLine();\r\n    return Unread.update();\r\n  },\r\n\r\n  sync() {\r\n    if (Unread.lastReadPost == null) { return; }\r\n    const lastReadPost = Unread.db.get({\r\n      boardID: Unread.thread.board.ID,\r\n      threadID: Unread.thread.ID,\r\n      defaultValue: 0\r\n    });\r\n    if (Unread.lastReadPost >= lastReadPost) { return; }\r\n    Unread.lastReadPost = lastReadPost;\r\n\r\n    const postIDs = Unread.thread.posts.keys;\r\n    for (let i = Unread.readCount, end = postIDs.length; i < end; i++) {\r\n      var ID = +postIDs[i];\r\n      if (!Unread.thread.posts.get(ID).isFetchedQuote) {\r\n        if (ID > Unread.lastReadPost) { break; }\r\n        Unread.posts.delete(ID);\r\n        Unread.postsQuotingYou.delete(ID);\r\n      }\r\n      Unread.readCount++;\r\n    }\r\n\r\n    Unread.updatePosition();\r\n    Unread.setLine();\r\n    return Unread.update();\r\n  },\r\n\r\n  addPost() {\r\n    if (this.isFetchedQuote || this.isClone) return;\r\n    Unread.order.push(this);\r\n    if ((this.ID <= Unread.lastReadPost) || this.isHidden || QuoteYou.isYou(this)) return;\r\n    Unread.posts.add((Unread.posts.last = this.ID));\r\n    Unread.addPostQuotingYou(this);\r\n    return Unread.position != null ? Unread.position : (Unread.position = Unread.order[this.ID]);\r\n  },\r\n\r\n  addPostQuotingYou(post) {\r\n    for (var quotelink of post.nodes.quotelinks) {\r\n      if (QuoteYou.db?.get(Get.postDataFromLink(quotelink))) {\r\n        Unread.postsQuotingYou.add((Unread.postsQuotingYou.last = post.ID));\r\n        Unread.openNotification(post);\r\n        return;\r\n      }\r\n    }\r\n  },\r\n\r\n  openNotification(post, predicate=' replied to you') {\r\n    if (!Header.areNotificationsEnabled) { return; }\r\n    const notif = new Notification(`${post.info.nameBlock}${predicate}`, {\r\n      body: post.commentDisplay(),\r\n      icon: Favicon.logo\r\n    }\r\n    );\r\n    notif.onclick = function() {\r\n      Header.scrollToIfNeeded(post.nodes.bottom, true);\r\n      return window.focus();\r\n    };\r\n    return notif.onshow = () => setTimeout(() => notif.close()\r\n    , 7 * SECOND);\r\n  },\r\n\r\n  onUpdate() {\r\n    return $.queueTask(function() { // ThreadUpdater may scroll immediately after inserting posts\r\n      Unread.setLine();\r\n      Unread.read();\r\n      return Unread.update();\r\n    });\r\n  },\r\n\r\n  readSinglePost(post) {\r\n    const {ID} = post;\r\n    if (!Unread.posts.has(ID)) { return; }\r\n    Unread.posts.delete(ID);\r\n    Unread.postsQuotingYou.delete(ID);\r\n    Unread.updatePosition();\r\n    Unread.saveLastReadPost();\r\n    return Unread.update();\r\n  },\r\n\r\n  read: debounce(100, function(e) {\r\n    // Update the lastReadPost when hidden posts are added to the thread.\r\n    if (!Unread.posts.size && (Unread.readCount !== Unread.thread.posts.keys.length)) {\r\n      Unread.saveLastReadPost();\r\n    }\r\n\r\n    if (d.hidden || !Unread.posts.size) { return; }\r\n\r\n    let count = 0;\r\n    while (Unread.position) {\r\n      var {ID, data} = Unread.position;\r\n      var {bottom} = data.nodes;\r\n      if (!!bottom.getBoundingClientRect().height && // post has been hidden\r\n        (Header.getBottomOf(bottom) <= -1)) { break; }                      // post is completely read\r\n      count++;\r\n      Unread.posts.delete(ID);\r\n      Unread.postsQuotingYou.delete(ID);\r\n      Unread.position = Unread.position.next;\r\n    }\r\n\r\n    if (!count) { return; }\r\n    Unread.updatePosition();\r\n    Unread.saveLastReadPost();\r\n    if (e) { return Unread.update(); }\r\n  }),\r\n\r\n  updatePosition() {\r\n    while (Unread.position && !Unread.posts.has(Unread.position.ID)) {\r\n      Unread.position = Unread.position.next;\r\n    }\r\n  },\r\n\r\n  saveLastReadPost: debounce(2 * SECOND, function() {\r\n    let ID;\r\n    $.forceSync('Remember Last Read Post');\r\n    if (!Conf['Remember Last Read Post'] || !Unread.db) { return; }\r\n    const postIDs = Unread.thread.posts.keys;\r\n    for (let i = Unread.readCount, end = postIDs.length; i < end; i++) {\r\n      ID = +postIDs[i];\r\n      if (!Unread.thread.posts.get(ID).isFetchedQuote) {\r\n        if (Unread.posts.has(ID)) { break; }\r\n        Unread.lastReadPost = ID;\r\n      }\r\n      Unread.readCount++;\r\n    }\r\n    if (Unread.thread.isDead && !Unread.thread.isArchived) { return; }\r\n    return Unread.db.set({\r\n      boardID:  Unread.thread.board.ID,\r\n      threadID: Unread.thread.ID,\r\n      val:      Unread.lastReadPost\r\n    });\r\n  }),\r\n\r\n  setLine(force) {\r\n    if (!Conf['Unread Line']) { return; }\r\n    if (Unread.hr.hidden || d.hidden || (force === true)) {\r\n      const oldPosition = Unread.linePosition;\r\n      if (Unread.linePosition = Unread.positionPrev()) {\r\n        if (Unread.linePosition !== oldPosition) {\r\n          let node = Unread.linePosition.data.nodes.bottom;\r\n          if (node.nextSibling?.tagName === 'BR') { node = node.nextSibling; }\r\n          $.after(node, Unread.hr);\r\n        }\r\n      } else {\r\n        $.rm(Unread.hr);\r\n      }\r\n    }\r\n    return Unread.hr.hidden = Unread.linePosition === Unread.order.last;\r\n  },\r\n\r\n  update() {\r\n    const count = Unread.posts.size;\r\n    const countQuotingYou = Unread.postsQuotingYou.size;\r\n\r\n    if (Conf['Unread Count']) {\r\n      const titleQuotingYou = Conf['Quoted Title'] && countQuotingYou ? '(!) ' : '';\r\n      const titleCount = count || !Conf['Hide Unread Count at (0)'] ? `(${count}) ` : '';\r\n      const titleDead = Unread.thread.isDead ?\r\n        Unread.title.replace('-', (Unread.thread.isArchived ? '- Archived -' : '- 404 -'))\r\n      :\r\n        Unread.title;\r\n      d.title = `${titleQuotingYou}${titleCount}${titleDead}`;\r\n    }\r\n\r\n    Unread.saveThreadWatcherCount();\r\n\r\n    if (Conf['Unread Favicon'] && (g.SITE.software === 'yotsuba')) {\r\n      const {isDead} = Unread.thread;\r\n      return Favicon.set((\r\n        countQuotingYou ?\r\n          (isDead ? 'unreadDeadY' : 'unreadY')\r\n        : count ?\r\n          (isDead ? 'unreadDead' : 'unread')\r\n        :\r\n          (isDead ? 'dead' : 'default')\r\n      )\r\n      );\r\n    }\r\n  },\r\n\r\n  saveThreadWatcherCount: debounce(2 * SECOND, function() {\r\n    $.forceSync('Remember Last Read Post');\r\n    if (Conf['Remember Last Read Post'] && (!Unread.thread.isDead || Unread.thread.isArchived)) {\r\n      let posts;\r\n      const quotingYou = !Conf['Require OP Quote Link'] && QuoteYou.isYou(Unread.thread.OP) ? Unread.posts : Unread.postsQuotingYou;\r\n      if (!quotingYou.size) {\r\n        quotingYou.last = 0;\r\n      } else if (!quotingYou.has(quotingYou.last)) {\r\n        quotingYou.last = 0;\r\n        posts = Unread.thread.posts.keys;\r\n        for (let i = posts.length - 1; i >= 0; i--) {\r\n          if (quotingYou.has(+posts[i])) {\r\n            quotingYou.last = posts[i];\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      return ThreadWatcher.update(g.SITE.ID, Unread.thread.board.ID, Unread.thread.ID, {\r\n        last: Unread.thread.lastPost,\r\n        isDead: Unread.thread.isDead,\r\n        isArchived: Unread.thread.isArchived,\r\n        unread: Unread.posts.size,\r\n        quotingYou: (quotingYou.last || 0)\r\n      }\r\n      );\r\n    }\r\n  })\r\n};\r\nexport default Unread;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Post from \"../classes/Post\";\r\nimport Get from \"../General/Get\";\r\nimport Index from \"../General/Index\";\r\nimport { g, Conf, d } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ExpandThread = {\r\n  statuses: dict(),\r\n  init() {\r\n    if (!((g.VIEW === 'index') && Conf['Thread Expansion'])) { return; }\r\n    if (Conf['JSON Index']) {\r\n      return $.on(d, 'IndexRefreshInternal', this.onIndexRefresh);\r\n    } else {\r\n      return Callbacks.Thread.push({\r\n        name: 'Expand Thread',\r\n        cb() { return ExpandThread.setButton(this); }\r\n      });\r\n    }\r\n  },\r\n\r\n  setButton(thread) {\r\n    let a;\r\n    if (!(thread.nodes.root && (a = $('.summary', thread.nodes.root)))) { return; }\r\n    a.textContent = g.SITE.Build.summaryText('+', ...a.textContent.match(/\\d+/g));\r\n    a.style.cursor = 'pointer';\r\n    return $.on(a, 'click', ExpandThread.cbToggle);\r\n  },\r\n  \r\n  disconnect(refresh) {\r\n    if ((g.VIEW === 'thread') || !Conf['Thread Expansion']) { return; }\r\n    for (var threadID in ExpandThread.statuses) {\r\n      var oldReq;\r\n      var status = ExpandThread.statuses[threadID];\r\n      if (oldReq = status.req) {\r\n        delete status.req;\r\n        oldReq.abort();\r\n      }\r\n      delete ExpandThread.statuses[threadID];\r\n    }\r\n\r\n    if (!refresh) { return $.off(d, 'IndexRefreshInternal', this.onIndexRefresh); }\r\n  },\r\n\r\n  onIndexRefresh() {\r\n    ExpandThread.disconnect(true);\r\n    return g.BOARD.threads.forEach(thread => ExpandThread.setButton(thread));\r\n  },\r\n\r\n  cbToggle(e) {\r\n    if ($.modifiedClick(e)) { return; }\r\n    e.preventDefault();\r\n    return ExpandThread.toggle(Get.threadFromNode(this));\r\n  },\r\n\r\n  cbToggleBottom(e) {\r\n    if ($.modifiedClick(e)) { return; }\r\n    e.preventDefault();\r\n    const thread = Get.threadFromNode(this);\r\n    $.rm(this); // remove before fixing bottom of thread position\r\n    const {bottom} = thread.nodes.root.getBoundingClientRect();\r\n    ExpandThread.toggle(thread);\r\n    return window.scrollBy(0, (thread.nodes.root.getBoundingClientRect().bottom - bottom));\r\n  },\r\n\r\n  toggle(thread) {\r\n    let a;\r\n    if (!(thread.nodes.root && (a = $('.summary', thread.nodes.root)))) { return; }\r\n    if (thread.ID in ExpandThread.statuses) {\r\n      return ExpandThread.contract(thread, a, thread.nodes.root);\r\n    } else {\r\n      return ExpandThread.expand(thread, a);\r\n    }\r\n  },\r\n\r\n  expand(thread, a) {\r\n    let status;\r\n    ExpandThread.statuses[thread] = (status = {});\r\n    a.textContent = g.SITE.Build.summaryText('...', ...a.textContent.match(/\\d+/g));\r\n    status.req = $.cache(g.SITE.urls.threadJSON({boardID: thread.board.ID, threadID: thread.ID}), function() {\r\n      if (this !== status.req) { return; } // aborted\r\n      delete status.req;\r\n      return ExpandThread.parse(this, thread, a);\r\n    });\r\n    return status.numReplies = $$(g.SITE.selectors.replyOriginal, thread.nodes.root).length;\r\n  },\r\n\r\n  contract(thread, a, threadRoot) {\r\n    let oldReq;\r\n    const status = ExpandThread.statuses[thread];\r\n    delete ExpandThread.statuses[thread];\r\n    if (oldReq = status.req) {\r\n      delete status.req;\r\n      oldReq.abort();\r\n      if (a) { a.textContent = g.SITE.Build.summaryText('+', ...a.textContent.match(/\\d+/g)); }\r\n      return;\r\n    }\r\n\r\n    let replies = $$('.thread > .replyContainer', threadRoot);\r\n    if (status.numReplies) { replies = replies.slice(0, (-status.numReplies)); }\r\n    let postsCount = 0;\r\n    let filesCount = 0;\r\n    for (var reply of replies) {\r\n      // rm clones\r\n      if (Conf['Quote Inlining']) { var inlined;\r\n      while ((inlined = $('.inlined', reply))) { inlined.click(); } }\r\n      postsCount++;\r\n      if ('file' in Get.postFromRoot(reply)) { filesCount++; }\r\n      $.rm(reply);\r\n    }\r\n    if (Index.enabled) { // otherwise handled by Main.addPosts\r\n      $.event('PostsRemoved', null, a.parentNode);\r\n    }\r\n    a.textContent = g.SITE.Build.summaryText('+', postsCount, filesCount);\r\n    return $.rm($('.summary-bottom', threadRoot));\r\n  },\r\n\r\n  parse(req, thread, a) {\r\n    let root;\r\n    if (![200, 304].includes(req.status)) {\r\n      a.textContent = req.status ? `Error ${req.statusText} (${req.status})` : 'Connection Error';\r\n      return;\r\n    }\r\n\r\n    g.SITE.Build.spoilerRange[thread.board] = req.response.posts[0].custom_spoiler;\r\n\r\n    const posts      = [];\r\n    const postsRoot  = [];\r\n    let filesCount = 0;\r\n    for (var postData of req.response.posts) {\r\n      var post;\r\n      if (postData.no === thread.ID) { continue; }\r\n      if ((post = thread.posts.get(postData.no)) && !post.isFetchedQuote) {\r\n        if ('file' in post) { filesCount++; }\r\n        ({root} = post.nodes);\r\n        postsRoot.push(root);\r\n        continue;\r\n      }\r\n      root = g.SITE.Build.postFromObject(postData, thread.board.ID);\r\n      post = new Post(root, thread, thread.board);\r\n      if ('file' in post) { filesCount++; }\r\n      posts.push(post);\r\n      postsRoot.push(root);\r\n    }\r\n    Main.callbackNodes('Post', posts);\r\n    $.after(a, postsRoot);\r\n    $.event('PostsInserted', null, a.parentNode);\r\n\r\n    const postsCount    = postsRoot.length;\r\n    a.textContent = g.SITE.Build.summaryText('-', postsCount, filesCount);\r\n\r\n    if (root) {\r\n      const a2 = a.cloneNode(true);\r\n      a2.classList.add('summary-bottom');\r\n      $.on(a2, 'click', ExpandThread.cbToggleBottom);\r\n      return $.after(root, a2);\r\n    }\r\n  }\r\n};\r\nexport default ExpandThread;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport DataBoard from \"../classes/DataBoard\";\r\nimport Get from \"../General/Get\";\r\nimport Header from \"../General/Header\";\r\nimport Index from \"../General/Index\";\r\nimport { g, Conf, d } from \"../globals/globals\";\r\nimport ExpandThread from \"../Miscellaneous/ExpandThread\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\nimport QuoteYou from \"../Quotelinks/QuoteYou\";\r\nimport ThreadWatcher from \"./ThreadWatcher\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar UnreadIndex = {\r\n  lastReadPost: dict(),\r\n  hr:           dict(),\r\n  markReadLink: dict(),\r\n\r\n  init() {\r\n    if ((g.VIEW !== 'index') || !Conf['Remember Last Read Post'] || !Conf['Unread Line in Index']) { return; }\r\n\r\n    this.enabled = true;\r\n    this.db = new DataBoard('lastReadPosts', this.sync);\r\n\r\n    Callbacks.Thread.push({\r\n      name: 'Unread Line in Index',\r\n      cb:   this.node\r\n    });\r\n\r\n    $.on(d, 'IndexRefreshInternal', this.onIndexRefresh);\r\n    return $.on(d, 'PostsInserted PostsRemoved', this.onPostsInserted);\r\n  },\r\n\r\n  node() {\r\n    UnreadIndex.lastReadPost[this.fullID] = UnreadIndex.db.get({\r\n      boardID: this.board.ID,\r\n      threadID: this.ID\r\n    }) || 0;\r\n    if (!Index.enabled) { // let onIndexRefresh handle JSON Index\r\n      return UnreadIndex.update(this);\r\n    }\r\n  },\r\n\r\n  onIndexRefresh(e) {\r\n    if (e.detail.isCatalog) { return; }\r\n    return (() => {\r\n      const result = [];\r\n      for (var threadID of e.detail.threadIDs) {\r\n        var thread = g.threads.get(threadID);\r\n        result.push(UnreadIndex.update(thread));\r\n      }\r\n      return result;\r\n    })();\r\n  },\r\n\r\n  onPostsInserted(e) {\r\n    if (e.target === Index.root) { return; } // onIndexRefresh handles this case\r\n    const thread = Get.threadFromNode(e.target);\r\n    if (!thread || (thread.nodes.root !== e.target)) { return; }\r\n    const wasVisible = !!UnreadIndex.hr[thread.fullID]?.parentNode;\r\n    UnreadIndex.update(thread);\r\n    if (Conf['Scroll to Last Read Post'] && (e.type === 'PostsInserted') && !wasVisible && !!UnreadIndex.hr[thread.fullID]?.parentNode) {\r\n      return Header.scrollToIfNeeded(UnreadIndex.hr[thread.fullID], true);\r\n    }\r\n  },\r\n\r\n  sync() {\r\n    return g.threads.forEach(function(thread) {\r\n      const lastReadPost = UnreadIndex.db.get({\r\n        boardID: thread.board.ID,\r\n        threadID: thread.ID\r\n      }) || 0;\r\n      if (lastReadPost !== UnreadIndex.lastReadPost[thread.fullID]) {\r\n        UnreadIndex.lastReadPost[thread.fullID] = lastReadPost;\r\n        if (thread.nodes.root?.parentNode) {\r\n          return UnreadIndex.update(thread);\r\n        }\r\n      }\r\n    });\r\n  },\r\n\r\n  update(thread) {\r\n    let divider;\r\n    const lastReadPost = UnreadIndex.lastReadPost[thread.fullID];\r\n    let repliesShown = 0;\r\n    let repliesRead = 0;\r\n    let firstUnread = null;\r\n    thread.posts.forEach(function(post) {\r\n      if (post.isReply && thread.nodes.root.contains(post.nodes.root)) {\r\n        repliesShown++;\r\n        if (post.ID <= lastReadPost) {\r\n          return repliesRead++;\r\n        } else if ((!firstUnread || (post.ID < firstUnread.ID)) && !post.isHidden && !QuoteYou.isYou(post)) {\r\n          return firstUnread = post;\r\n        }\r\n      }\r\n    });\r\n\r\n    let hr = UnreadIndex.hr[thread.fullID];\r\n    if (firstUnread && (repliesRead || ((lastReadPost === thread.OP.ID) && (!$(g.SITE.selectors.summary, thread.nodes.root) || thread.ID in ExpandThread.statuses)))) {\r\n      if (!hr) {\r\n        hr = (UnreadIndex.hr[thread.fullID] = $.el('hr',\r\n          {className: 'unread-line'}));\r\n      }\r\n      $.before(firstUnread.nodes.root, hr);\r\n    } else {\r\n      $.rm(hr);\r\n    }\r\n\r\n    const hasUnread = repliesShown ?\r\n      firstUnread || !repliesRead\r\n    : Index.enabled ?\r\n      thread.lastPost > lastReadPost\r\n    :\r\n      thread.OP.ID > lastReadPost;\r\n    thread.nodes.root.classList.toggle('unread-thread', hasUnread);\r\n\r\n    let link = UnreadIndex.markReadLink[thread.fullID];\r\n    if (!link) {\r\n      link = (UnreadIndex.markReadLink[thread.fullID] = $.el('a', {\r\n        className: 'unread-mark-read brackets-wrap',\r\n        href: 'javascript:;',\r\n        textContent: 'Mark Read'\r\n      }\r\n      ));\r\n      $.on(link, 'click', UnreadIndex.markRead);\r\n    }\r\n    if (divider = $(g.SITE.selectors.threadDivider, thread.nodes.root)) { // divider inside thread as in Tinyboard\r\n      return $.before(divider, link);\r\n    } else {\r\n      return $.add(thread.nodes.root, link);\r\n    }\r\n  },\r\n\r\n  markRead() {\r\n    const thread = Get.threadFromNode(this);\r\n    UnreadIndex.lastReadPost[thread.fullID] = thread.lastPost;\r\n    UnreadIndex.db.set({\r\n      boardID:  thread.board.ID,\r\n      threadID: thread.ID,\r\n      val:      thread.lastPost\r\n    });\r\n    $.rm(UnreadIndex.hr[thread.fullID]);\r\n    thread.nodes.root.classList.remove('unread-thread');\r\n    return ThreadWatcher.update(g.SITE.ID, thread.board.ID, thread.ID, {\r\n      last: thread.lastPost,\r\n      unread: 0,\r\n      quotingYou: 0\r\n    }\r\n    );\r\n  }\r\n};\r\nexport default UnreadIndex;\r\n","import ThreadWatcherPage from './ThreadWatcher/ThreadWatcher.html';\r\nimport $ from \"../platform/$\";\r\nimport Board from '../classes/Board';\r\nimport Callbacks from '../classes/Callbacks';\r\nimport DataBoard from '../classes/DataBoard';\r\nimport Thread from '../classes/Thread';\r\nimport Filter from '../Filtering/Filter';\r\nimport Main from '../main/Main';\r\nimport $$ from '../platform/$$';\r\nimport Config from '../config/Config';\r\nimport CrossOrigin from '../platform/CrossOrigin';\r\nimport PostRedirect from '../Posting/PostRedirect';\r\nimport QuoteYou from '../Quotelinks/QuoteYou';\r\nimport Unread from './Unread';\r\nimport UnreadIndex from './UnreadIndex';\r\nimport Header from '../General/Header';\r\nimport Index from '../General/Index';\r\nimport { Conf, d, doc, g } from '../globals/globals';\r\nimport Menu from '../Menu/Menu';\r\nimport UI from '../General/UI';\r\nimport Get from '../General/Get';\r\nimport { dict, HOUR, MINUTE } from '../platform/helpers';\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n\r\nvar ThreadWatcher = {\r\n  init() {\r\n    let sc;\r\n    if (!(this.enabled = Conf['Thread Watcher'])) { return; }\r\n\r\n    this.shortcut = (sc = $.el('a', {\r\n      id:          'watcher-link',\r\n      textContent: 'Watcher',\r\n      title:       'Thread Watcher',\r\n      href:        'javascript:;',\r\n    }\r\n    ));\r\n\r\n    this.db     = new DataBoard('watchedThreads', this.refresh, true);\r\n    this.dbLM   = new DataBoard('watcherLastModified', null, true);\r\n    this.dialog = UI.dialog('thread-watcher', { innerHTML: ThreadWatcherPage });\r\n    this.status = $('#watcher-status', this.dialog);\r\n    this.list   = this.dialog.lastElementChild;\r\n    this.refreshButton = $('.refresh', this.dialog);\r\n    this.closeButton = $('.move > .close', this.dialog);\r\n    this.unreaddb = Unread.db || UnreadIndex.db || new DataBoard('lastReadPosts');\r\n    this.unreadEnabled = Conf['Remember Last Read Post'];\r\n\r\n    $.on(d, 'QRPostSuccessful',   this.cb.post);\r\n    $.on(sc, 'click', this.toggleWatcher);\r\n    $.on(this.refreshButton, 'click', this.buttonFetchAll);\r\n    $.on(this.closeButton, 'click', this.toggleWatcher);\r\n\r\n    this.menu.addHeaderMenuEntry();\r\n    $.onExists(doc, 'body', this.addDialog);\r\n\r\n    switch (g.VIEW) {\r\n      case 'index':\r\n        $.on(d, 'IndexUpdate', this.cb.onIndexUpdate);\r\n        break;\r\n      case 'thread':\r\n        $.on(d, 'ThreadUpdate', this.cb.onThreadRefresh);\r\n        break;\r\n    }\r\n\r\n    if (Conf['Fixed Thread Watcher']) {\r\n      $.addClass(doc, 'fixed-watcher');\r\n    }\r\n    if (!Conf['Persistent Thread Watcher']) {\r\n      $.addClass(ThreadWatcher.shortcut, 'disabled');\r\n      this.dialog.hidden = true;\r\n    }\r\n\r\n    Header.addShortcut('watcher', sc, 510, '👁︎');\r\n\r\n    ThreadWatcher.initLastModified();\r\n    ThreadWatcher.fetchAuto();\r\n    $.on(window, 'visibilitychange focus', () => $.queueTask(ThreadWatcher.fetchAuto));\r\n\r\n    if (Conf['Menu'] && Index.enabled) {\r\n      Menu.menu.addEntry({\r\n        el: $.el('a', {\r\n          href:      'javascript:;',\r\n          className: 'has-shortcut-text'\r\n        }\r\n        , {innerHTML: '<span></span><span class=\"shortcut-text\">Alt+click</span>'}),\r\n        order: 6,\r\n        open({thread}) {\r\n          if (Conf['Index Mode'] !== 'catalog') { return false; }\r\n          this.el.firstElementChild.textContent = ThreadWatcher.isWatched(thread) ?\r\n            'Unwatch'\r\n          :\r\n            'Watch';\r\n          if (this.cb) { $.off(this.el, 'click', this.cb); }\r\n          this.cb = function() {\r\n            $.event('CloseMenu');\r\n            return ThreadWatcher.toggle(thread);\r\n          };\r\n          $.on(this.el, 'click', this.cb);\r\n          return true;\r\n        }\r\n      });\r\n    }\r\n\r\n    if (!['index', 'thread'].includes(g.VIEW)) { return; }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Thread Watcher',\r\n      cb:   this.node\r\n    });\r\n    return Callbacks.CatalogThread.push({\r\n      name: 'Thread Watcher',\r\n      cb:   this.catalogNode\r\n    });\r\n  },\r\n\r\n  isWatched(thread) {\r\n    return !!ThreadWatcher.db?.get({boardID: thread.board.ID, threadID: thread.ID});\r\n  },\r\n\r\n  isWatchedRaw(boardID, threadID) {\r\n    return !!ThreadWatcher.db?.get({boardID, threadID});\r\n  },\r\n\r\n  setToggler(toggler, isWatched) {\r\n    toggler.classList.toggle('watched', isWatched);\r\n    return toggler.title = `${isWatched ? 'Unwatch' : 'Watch'} Thread`;\r\n  },\r\n\r\n  node() {\r\n    let toggler;\r\n    if (this.isReply) { return; }\r\n    if (this.isClone) {\r\n      toggler = $('.watch-thread-link', this.nodes.info);\r\n    } else {\r\n      toggler = $.el('a', {\r\n        href: 'javascript:;',\r\n        className: 'watch-thread-link'\r\n      }\r\n      );\r\n      $.before($('input', this.nodes.info), toggler);\r\n    }\r\n    const siteID = g.SITE.ID;\r\n    const boardID = this.board.ID;\r\n    const threadID = this.thread.ID;\r\n    const data = ThreadWatcher.db.get({siteID, boardID, threadID});\r\n    ThreadWatcher.setToggler(toggler, !!data);\r\n    $.on(toggler, 'click', ThreadWatcher.cb.toggle);\r\n    // Add missing excerpt for threads added by Auto Watch\r\n    if (data && (data.excerpt == null)) {\r\n      return $.queueTask(() => {\r\n        return ThreadWatcher.update(siteID, boardID, threadID, {excerpt: Get.threadExcerpt(this.thread)});\r\n    });\r\n    }\r\n  },\r\n\r\n  catalogNode() {\r\n    if (ThreadWatcher.isWatched(this.thread)) { $.addClass(this.nodes.root, 'watched'); }\r\n    return $.on(this.nodes.root, 'mousedown click', e => {\r\n      if ((e.button !== 0) || !e.altKey) { return; }\r\n      if (e.type === 'click') { ThreadWatcher.toggle(this.thread); }\r\n      return e.preventDefault();\r\n    });\r\n  }, // Also on mousedown to prevent highlighting thumbnail in Firefox.\r\n\r\n  addDialog() {\r\n    if (!Main.isThisPageLegit()) { return; }\r\n    ThreadWatcher.build();\r\n    return $.prepend(d.body, ThreadWatcher.dialog);\r\n  },\r\n\r\n  toggleWatcher() {\r\n    $.toggleClass(ThreadWatcher.shortcut, 'disabled');\r\n    return ThreadWatcher.dialog.hidden = !ThreadWatcher.dialog.hidden;\r\n  },\r\n\r\n  cb: {\r\n    openAll() {\r\n      if ($.hasClass(this, 'disabled')) { return; }\r\n      for (var a of $$('a.watcher-link', ThreadWatcher.list)) {\r\n        $.open(a.href);\r\n      }\r\n      return $.event('CloseMenu');\r\n    },\r\n    openUnread() {\r\n      if ($.hasClass(this, 'disabled')) { return; }\r\n      for (var a of $$('.replies-unread > a.watcher-link', ThreadWatcher.list)) {\r\n        $.open(a.href);\r\n      }\r\n      return $.event('CloseMenu');\r\n    },\r\n    openDeads() {\r\n      if ($.hasClass(this, 'disabled')) { return; }\r\n      for (var a of $$('.dead-thread > a.watcher-link', ThreadWatcher.list)) {\r\n        $.open(a.href);\r\n      }\r\n      return $.event('CloseMenu');\r\n    },\r\n    pruneDeads() {\r\n      if ($.hasClass(this, 'disabled')) { return; }\r\n      for (var {siteID, boardID, threadID, data} of ThreadWatcher.getAll()) {\r\n        if (data.isDead) {\r\n          ThreadWatcher.db.delete({siteID, boardID, threadID});\r\n        }\r\n      }\r\n      ThreadWatcher.refresh();\r\n      return $.event('CloseMenu');\r\n    },\r\n    dismiss() {\r\n      for (var {siteID, boardID, threadID, data} of ThreadWatcher.getAll()) {\r\n        if (data.quotingYou) {\r\n          ThreadWatcher.update(siteID, boardID, threadID, {dismiss: data.quotingYou || 0});\r\n        }\r\n      }\r\n      return $.event('CloseMenu');\r\n    },\r\n    toggle() {\r\n      const {thread} = Get.postFromNode(this);\r\n      return ThreadWatcher.toggle(thread);\r\n    },\r\n    rm() {\r\n      const {siteID} = this.parentNode.dataset;\r\n      const [boardID, threadID] = this.parentNode.dataset.fullID.split('.');\r\n      return ThreadWatcher.rm(siteID, boardID, +threadID);\r\n    },\r\n    post(e) {\r\n      const {boardID, threadID, postID} = e.detail;\r\n      const cb = PostRedirect.delay();\r\n      if (postID === threadID) {\r\n        if (Conf['Auto Watch']) {\r\n          return ThreadWatcher.addRaw(boardID, threadID, {}, cb);\r\n        }\r\n      } else if (Conf['Auto Watch Reply']) {\r\n        return ThreadWatcher.add((g.threads.get(boardID + '.' + threadID) || new Thread(threadID, g.boards[boardID] || new Board(boardID))), cb);\r\n      }\r\n    },\r\n    onIndexUpdate(e) {\r\n      const {db}    = ThreadWatcher;\r\n      const siteID  = g.SITE.ID;\r\n      const boardID = g.BOARD.ID;\r\n      let nKilled = 0;\r\n      for (var threadID in db.data[siteID].boards[boardID]) {\r\n        // Don't prune threads that have yet to appear in index.\r\n        var data = db.data[siteID].boards[boardID][threadID];\r\n        if (!data?.isDead && !e.detail.threads.includes(`${boardID}.${threadID}`)) {\r\n          if (!e.detail.threads.some(fullID => +fullID.split('.')[1] > threadID)) { continue; }\r\n          if (Conf['Auto Prune'] || !(data && (typeof data === 'object'))) { // corrupt data\r\n            db.delete({boardID, threadID});\r\n            nKilled++;\r\n          } else {\r\n            ThreadWatcher.fetchStatus({siteID, boardID, threadID, data});\r\n          }\r\n        }\r\n      }\r\n      if (nKilled) { return ThreadWatcher.refresh(); }\r\n    },\r\n    onThreadRefresh(e) {\r\n      const thread = g.threads.get(e.detail.threadID);\r\n      if (!e.detail[404] || !ThreadWatcher.isWatched(thread)) { return; }\r\n      // Update dead status.\r\n      return ThreadWatcher.add(thread);\r\n    }\r\n  },\r\n\r\n  requests: [],\r\n  fetched:  0,\r\n\r\n  fetch(url, {siteID, force}, args, cb) {\r\n    if (ThreadWatcher.requests.length === 0) {\r\n      ThreadWatcher.status.textContent = '...';\r\n      $.addClass(ThreadWatcher.refreshButton, 'spin');\r\n    }\r\n    const onloadend = function() {\r\n      if (this.finished) { return; }\r\n      this.finished = true;\r\n      ThreadWatcher.fetched++;\r\n      if (ThreadWatcher.fetched === ThreadWatcher.requests.length) {\r\n        ThreadWatcher.clearRequests();\r\n      } else {\r\n        ThreadWatcher.status.textContent = `${Math.round((ThreadWatcher.fetched / ThreadWatcher.requests.length) * 100)}%`;\r\n      }\r\n      return cb.apply(this, args);\r\n    };\r\n    const ajax = siteID === g.SITE.ID ? $.ajax : CrossOrigin.ajax;\r\n    if (force) {\r\n      delete $.lastModified.ThreadWatcher?.[url];\r\n    }\r\n    const req = $.whenModified(\r\n      url,\r\n      'ThreadWatcher',\r\n      onloadend,\r\n      { timeout: MINUTE, ajax }\r\n    );\r\n    return ThreadWatcher.requests.push(req);\r\n  },\r\n\r\n  clearRequests() {\r\n    ThreadWatcher.requests = [];\r\n    ThreadWatcher.fetched = 0;\r\n    ThreadWatcher.status.textContent = '';\r\n    return $.rmClass(ThreadWatcher.refreshButton, 'spin');\r\n  },\r\n\r\n  abort() {\r\n    delete ThreadWatcher.syncing;\r\n    for (var req of ThreadWatcher.requests) {\r\n      if (!req.finished) {\r\n        req.finished = true;\r\n        req.abort();\r\n      }\r\n    }\r\n    return ThreadWatcher.clearRequests();\r\n  },\r\n\r\n  initLastModified() {\r\n    const lm = ($.lastModified['ThreadWatcher'] || ($.lastModified['ThreadWatcher'] = dict()));\r\n    for (var siteID in ThreadWatcher.dbLM.data) {\r\n      var boards = ThreadWatcher.dbLM.data[siteID];\r\n      for (var boardID in boards.boards) {\r\n        var data = boards.boards[boardID];\r\n        if (ThreadWatcher.db.get({siteID, boardID})) {\r\n          for (var url in data) {\r\n            var date = data[url];\r\n            lm[url] = date;\r\n          }\r\n        } else {\r\n          ThreadWatcher.dbLM.delete({siteID, boardID});\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  fetchAuto() {\r\n    let middle;\r\n    clearTimeout(ThreadWatcher.timeout);\r\n    if (!Conf['Auto Update Thread Watcher']) { return; }\r\n    const {db} = ThreadWatcher;\r\n    const interval = Conf['Show Page'] || (ThreadWatcher.unreadEnabled && Conf['Show Unread Count']) ? 5 * MINUTE : 2 * HOUR;\r\n    const now = Date.now();\r\n    if ((now - interval >= ((middle = db.data.lastChecked || 0)) || middle > now) && !d.hidden && !!d.hasFocus()) {\r\n      ThreadWatcher.fetchAllStatus(interval);\r\n    }\r\n    return ThreadWatcher.timeout = setTimeout(ThreadWatcher.fetchAuto, interval);\r\n  },\r\n\r\n  buttonFetchAll() {\r\n    if (ThreadWatcher.syncing || ThreadWatcher.requests.length) {\r\n      return ThreadWatcher.abort();\r\n    } else {\r\n      return ThreadWatcher.fetchAllStatus();\r\n    }\r\n  },\r\n\r\n  fetchAllStatus(interval=0) {\r\n    ThreadWatcher.status.textContent = '...';\r\n    $.addClass(ThreadWatcher.refreshButton, 'spin');\r\n    ThreadWatcher.syncing = true;\r\n    const dbs = [ThreadWatcher.db, ThreadWatcher.unreaddb, QuoteYou.db].filter(x => x);\r\n    let n = 0;\r\n    return dbs.map((dbi) =>\r\n      dbi.forceSync(function() {\r\n        if ((++n) === dbs.length) {\r\n          let middle;\r\n          if (!ThreadWatcher.syncing) { return; } // aborted\r\n          delete ThreadWatcher.syncing;\r\n          if (0 > (middle = Date.now() - (ThreadWatcher.db.data.lastChecked || 0)) || middle >= interval) { // not checked in another tab\r\n            // XXX On vichan boards, last_modified field of threads.json does not account for sage posts.\r\n            // Occasionally check replies field of catalog.json to find these posts.\r\n            let middle1;\r\n            const {db} = ThreadWatcher;\r\n            const now = Date.now();\r\n            const deep = !(now - (2 * HOUR) < ((middle1 = db.data.lastChecked2 || 0)) && middle1 <= now);\r\n            const boards = ThreadWatcher.getAll(true);\r\n            for (var board of boards) {\r\n              ThreadWatcher.fetchBoard(board, deep);\r\n            }\r\n            db.setLastChecked();\r\n            if (deep) { db.setLastChecked('lastChecked2'); }\r\n          }\r\n          if (ThreadWatcher.fetched === ThreadWatcher.requests.length) {\r\n            return ThreadWatcher.clearRequests();\r\n          }\r\n        }\r\n      }));\r\n  },\r\n\r\n  fetchBoard(board, deep) {\r\n    if (!board.some(thread => !thread.data.isDead)) { return; }\r\n    let force = false;\r\n    for (var thread of board) {\r\n      var {data} = thread;\r\n      if (!data.isDead && (data.last !== -1)) {\r\n        if (Conf['Show Page'] && (data.page == null)) { force = true; }\r\n        if ((data.modified == null)) { force = (thread.force = true); }\r\n      }\r\n    }\r\n    const {siteID, boardID} = board[0];\r\n    const site = g.sites[siteID];\r\n    if (!site) { return; }\r\n    const urlF = deep && site.threadModTimeIgnoresSage ? 'catalogJSON' : 'threadsListJSON';\r\n    const url = site.urls[urlF]?.({siteID, boardID});\r\n    if (!url) { return; }\r\n    return ThreadWatcher.fetch(url, {siteID, force}, [board, url], ThreadWatcher.parseBoard);\r\n  },\r\n\r\n  parseBoard(board, url) {\r\n    let page, thread;\r\n    if (this.status !== 200) { return; }\r\n    const {siteID, boardID} = board[0];\r\n    const lmDate = this.getResponseHeader('Last-Modified');\r\n    ThreadWatcher.dbLM.extend({siteID, boardID, val: $.item(url, lmDate)});\r\n    const threads = dict();\r\n    let pageLength = 0;\r\n    let nThreads = 0;\r\n    let oldest = null;\r\n    try {\r\n      pageLength = this.response[0]?.threads.length || 0;\r\n      for (let i = 0; i < this.response.length; i++) {\r\n        page = this.response[i];\r\n        for (var item of page.threads) {\r\n          threads[item.no] = {\r\n            page: i + 1,\r\n            index: nThreads,\r\n            modified: item.last_modified,\r\n            replies: item.replies\r\n          };\r\n          nThreads++;\r\n          if ((oldest == null) || (item.no < oldest)) {\r\n            oldest = item.no;\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      for (thread of board) {\r\n        ThreadWatcher.fetchStatus(thread);\r\n      }\r\n    }\r\n    for (thread of board) {\r\n      var {threadID, data} = thread;\r\n      if (threads[threadID]) {\r\n        var index, modified, replies;\r\n        ({page, index, modified, replies} = threads[threadID]);\r\n        if (Conf['Show Page']) {\r\n          var lastPage = g.sites[siteID].isPrunedByAge?.({siteID, boardID}) ?\r\n            threadID === oldest\r\n          :\r\n            index >= (nThreads - pageLength);\r\n          ThreadWatcher.update(siteID, boardID, threadID, {page, lastPage});\r\n        }\r\n        if (ThreadWatcher.unreadEnabled && Conf['Show Unread Count']) {\r\n          if ((modified !== data.modified) || ((replies != null) && (replies !== data.replies))) {\r\n            (thread.newData || (thread.newData = {})).modified = modified;\r\n            ThreadWatcher.fetchStatus(thread);\r\n          }\r\n        }\r\n      } else {\r\n        ThreadWatcher.fetchStatus(thread);\r\n      }\r\n    }\r\n  },\r\n\r\n  fetchStatus(thread) {\r\n    const {siteID, boardID, threadID, data, force} = thread;\r\n    const url = g.sites[siteID]?.urls.threadJSON?.({siteID, boardID, threadID});\r\n    if (!url) { return; }\r\n    if (data.isDead && !force) { return; }\r\n    if (data.last === -1) { return; } // 404 or no JSON API\r\n    return ThreadWatcher.fetch(url, {siteID, force}, [thread], ThreadWatcher.parseStatus);\r\n  },\r\n\r\n  parseStatus(thread, isArchiveURL) {\r\n    let isDead, last;\r\n    let {siteID, boardID, threadID, data, newData, force} = thread;\r\n    const site = g.sites[siteID];\r\n    if ((this.status === 200) && this.response) {\r\n      let isArchived;\r\n      last = this.response.posts[this.response.posts.length-1].no;\r\n      const replies = this.response.posts.length-1;\r\n      isDead = (isArchived = !!(this.response.posts[0].archived || isArchiveURL));\r\n      if (isDead && Conf['Auto Prune']) {\r\n        ThreadWatcher.rm(siteID, boardID, threadID);\r\n        return;\r\n      }\r\n\r\n      if ((last === data.last) && (isDead === data.isDead) && (isArchived === data.isArchived)) { return; }\r\n\r\n      const lastReadPost = ThreadWatcher.unreaddb.get({siteID, boardID, threadID, defaultValue: 0});\r\n      let unread = data.unread || 0;\r\n      let quotingYou = data.quotingYou || 0;\r\n      const youOP = !!QuoteYou.db?.get({siteID, boardID, threadID, postID: threadID});\r\n\r\n      for (var postObj of this.response.posts) {\r\n        if ((postObj.no <= (data.last || 0)) || (postObj.no <= lastReadPost)) { continue; }\r\n        if (QuoteYou.db?.get({siteID, boardID, threadID, postID: postObj.no})) { continue; }\r\n\r\n        var quotesYou = false;\r\n        if (!Conf['Require OP Quote Link'] && youOP) {\r\n          quotesYou = true;\r\n        } else if (QuoteYou.db && postObj.com) {\r\n          var match;\r\n          var regexp = site.regexp.quotelinkHTML;\r\n          regexp.lastIndex = 0;\r\n          while (match = regexp.exec(postObj.com)) {\r\n            if (QuoteYou.db.get({\r\n              siteID,\r\n              boardID:  match[1] ? encodeURIComponent(match[1]) : boardID,\r\n              threadID: match[2] || threadID,\r\n              postID:   match[3] || match[2] || threadID\r\n            })) {\r\n              quotesYou = true;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n\r\n        if (!unread || (!quotingYou && quotesYou)) {\r\n          if (Filter.isHidden(site.Build.parseJSON(postObj, {siteID, boardID}))) { continue; }\r\n        }\r\n\r\n        unread++;\r\n        if (quotesYou) { quotingYou = postObj.no; }\r\n      }\r\n\r\n      if (!newData) { newData = {}; }\r\n      $.extend(newData, {last, replies, isDead, isArchived, unread, quotingYou});\r\n      return ThreadWatcher.update(siteID, boardID, threadID, newData);\r\n\r\n    } else if (this.status === 404) {\r\n      const archiveURL = g.sites[siteID]?.urls.archivedThreadJSON?.({siteID, boardID, threadID});\r\n      if (!isArchiveURL && archiveURL) {\r\n        return ThreadWatcher.fetch(archiveURL, {siteID, force}, [thread, true], ThreadWatcher.parseStatus);\r\n      } else if (site.mayLackJSON && (data.last == null)) {\r\n        return ThreadWatcher.update(siteID, boardID, threadID, {last: -1});\r\n      } else {\r\n        return ThreadWatcher.update(siteID, boardID, threadID, {isDead: true});\r\n      }\r\n    }\r\n  },\r\n\r\n  getAll(groupByBoard) {\r\n    const all = [];\r\n    for (var siteID in ThreadWatcher.db.data) {\r\n      var boards = ThreadWatcher.db.data[siteID];\r\n      for (var boardID in boards.boards) {\r\n        var cont;\r\n        var threads = boards.boards[boardID];\r\n        if (Conf['Current Board'] && ((siteID !== g.SITE.ID) || (boardID !== g.BOARD.ID))) {\r\n          continue;\r\n        }\r\n        if (groupByBoard) {\r\n          all.push((cont = []));\r\n        }\r\n        for (var threadID in threads) {\r\n          var data = threads[threadID];\r\n          if (data && (typeof data === 'object')) {\r\n            (groupByBoard ? cont : all).push({siteID, boardID, threadID, data});\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return all;\r\n  },\r\n\r\n  makeLine(siteID, boardID, threadID, data) {\r\n    let page;\r\n    const x = $.el('a', {\r\n      textContent: '✕',\r\n      href: 'javascript:;'\r\n    }\r\n    );\r\n    $.on(x, 'click', ThreadWatcher.cb.rm);\r\n\r\n    let {excerpt, isArchived} = data;\r\n    if (!excerpt) { excerpt = `/${boardID}/ - No.${threadID}`; }\r\n    if (Conf['Show Site Prefix']) { excerpt = ThreadWatcher.prefixes[siteID] + excerpt; }\r\n\r\n    const link = $.el('a', {\r\n      href: g.sites[siteID]?.urls.thread({siteID, boardID, threadID}, isArchived) || '',\r\n      title: excerpt,\r\n      className: 'watcher-link'\r\n    }\r\n    );\r\n\r\n    if (Conf['Show Page'] && (data.page != null)) {\r\n      page = $.el('span', {\r\n        textContent: `[${data.page}]`,\r\n        className: 'watcher-page'\r\n      }\r\n      );\r\n      $.add(link, page);\r\n    }\r\n\r\n    if (ThreadWatcher.unreadEnabled && Conf['Show Unread Count'] && (data.unread != null)) {\r\n      const count = $.el('span', {\r\n        textContent: `(${data.unread})`,\r\n        className: 'watcher-unread'\r\n      }\r\n      );\r\n      $.add(link, count);\r\n    }\r\n\r\n    const title = $.el('span', {\r\n      textContent: excerpt,\r\n      className: 'watcher-title'\r\n    }\r\n    );\r\n    $.add(link, title);\r\n\r\n    const div = $.el('div');\r\n    const fullID = `${boardID}.${threadID}`;\r\n    div.dataset.fullID = fullID;\r\n    div.dataset.siteID = siteID;\r\n    if ((g.VIEW === 'thread') && (fullID === `${g.BOARD}.${g.THREADID}`)) { $.addClass(div, 'current'); }\r\n    if (data.isDead) { $.addClass(div, 'dead-thread'); }\r\n    if (Conf['Show Page']) {\r\n      if (data.lastPage) { $.addClass(div, 'last-page'); }\r\n      if (data.page != null) { div.dataset.page = data.page; }\r\n    }\r\n    if (ThreadWatcher.unreadEnabled && Conf['Show Unread Count']) {\r\n      if (data.unread === 0) { $.addClass(div, 'replies-read'); }\r\n      if (data.unread) { $.addClass(div, 'replies-unread'); }\r\n      if ((data.quotingYou || 0) > (data.dismiss || 0)) { $.addClass(div, 'replies-quoting-you'); }\r\n    }\r\n    $.add(div, [x, $.tn(' '), link]);\r\n    return div;\r\n  },\r\n\r\n  setPrefixes(threads) {\r\n    const prefixes = dict();\r\n    for (var {siteID} of threads) {\r\n      if (siteID in prefixes) { continue; }\r\n      var len = 0;\r\n      var prefix = '';\r\n      var conflicts = Object.keys(prefixes);\r\n      while (conflicts.length > 0) {\r\n        len++;\r\n        prefix = siteID.slice(0, len);\r\n        var conflicts2 = [];\r\n        for (var siteID2 of conflicts) {\r\n          if (siteID2.slice(0, len) === prefix) {\r\n            conflicts2.push(siteID2);\r\n          } else if (prefixes[siteID2].length < len) {\r\n            prefixes[siteID2] = siteID2.slice(0, len);\r\n          }\r\n        }\r\n        conflicts = conflicts2;\r\n      }\r\n      prefixes[siteID] = prefix;\r\n    }\r\n    return ThreadWatcher.prefixes = prefixes;\r\n  },\r\n\r\n  build() {\r\n    const nodes = [];\r\n    const threads = ThreadWatcher.getAll();\r\n    ThreadWatcher.setPrefixes(threads);\r\n    for (var {siteID, boardID, threadID, data} of threads) {\r\n      // Add missing excerpt for threads added by Auto Watch\r\n      var thread;\r\n      if ((data.excerpt == null) && (siteID === g.SITE.ID) && (thread = g.threads.get(`${boardID}.${threadID}`)) && thread.OP) {\r\n        ThreadWatcher.db.extend({boardID, threadID, val: {excerpt: Get.threadExcerpt(thread)}});\r\n      }\r\n      nodes.push(ThreadWatcher.makeLine(siteID, boardID, threadID, data));\r\n    }\r\n    const {list} = ThreadWatcher;\r\n    $.rmAll(list);\r\n    $.add(list, nodes);\r\n\r\n    return ThreadWatcher.refreshIcon();\r\n  },\r\n\r\n  refresh() {\r\n    ThreadWatcher.build();\r\n\r\n    g.threads.forEach(function(thread) {\r\n      const isWatched = ThreadWatcher.isWatched(thread);\r\n      if (thread.OP) {\r\n        for (var post of [thread.OP, ...thread.OP.clones]) {\r\n          var toggler;\r\n          if (toggler = $('.watch-thread-link', post.nodes.info)) {\r\n            ThreadWatcher.setToggler(toggler, isWatched);\r\n          }\r\n        }\r\n      }\r\n      if (thread.catalogView) { return thread.catalogView.nodes.root.classList.toggle('watched', isWatched); }\r\n    });\r\n\r\n    if (Conf['Pin Watched Threads']) {\r\n      return $.event('SortIndex', {deferred: Conf['Index Mode'] !== 'catalog'});\r\n    }\r\n  },\r\n\r\n  refreshIcon() {\r\n    for (var className of ['replies-unread', 'replies-quoting-you']) {\r\n      ThreadWatcher.shortcut.classList.toggle(className, !!$(`.${className}`, ThreadWatcher.dialog));\r\n    }\r\n  },\r\n\r\n  update(siteID, boardID, threadID, newData) {\r\n    let data, key, line, val;\r\n    if (!(data = ThreadWatcher.db?.get({siteID, boardID, threadID}))) { return; }\r\n    if (newData.isDead && Conf['Auto Prune']) {\r\n      ThreadWatcher.rm(siteID, boardID, threadID);\r\n      return;\r\n    }\r\n    if (newData.isDead || (newData.last === -1)) {\r\n      for (key of ['isArchived', 'page', 'lastPage', 'unread', 'quotingyou']) {\r\n        if (!(key in newData)) {\r\n          newData[key] = undefined;\r\n        }\r\n      }\r\n    }\r\n    if ((newData.last != null) && (newData.last < data.last)) {\r\n      newData.modified = undefined;\r\n    }\r\n    let n = 0;\r\n    for (key in newData) { val = newData[key]; if (data[key] !== val) { n++; } }\r\n    if (!n) { return; }\r\n    ThreadWatcher.db.extend({siteID, boardID, threadID, val: newData});\r\n    if (line = $(`#watched-threads > [data-site-i-d='${siteID}'][data-full-i-d='${boardID}.${threadID}']`, ThreadWatcher.dialog)) {\r\n      const newLine = ThreadWatcher.makeLine(siteID, boardID, threadID, data);\r\n      $.replace(line, newLine);\r\n      return ThreadWatcher.refreshIcon();\r\n    } else {\r\n      return ThreadWatcher.refresh();\r\n    }\r\n  },\r\n\r\n  set404(boardID, threadID, cb) {\r\n    let data;\r\n    if (!(data = ThreadWatcher.db?.get({boardID, threadID}))) { return cb(); }\r\n    if (Conf['Auto Prune']) {\r\n      ThreadWatcher.db.delete({boardID, threadID});\r\n      return cb();\r\n    }\r\n    if (data.isDead && !((data.isArchived != null) || (data.page != null) || (data.lastPage != null) || (data.unread != null) || (data.quotingYou != null))) { return cb(); }\r\n    return ThreadWatcher.db.extend({boardID, threadID, val: {isDead: true, isArchived: undefined, page: undefined, lastPage: undefined, unread: undefined, quotingYou: undefined}}, cb);\r\n  },\r\n\r\n  toggle(thread) {\r\n    const siteID   = g.SITE.ID;\r\n    const boardID  = thread.board.ID;\r\n    const threadID = thread.ID;\r\n    if (ThreadWatcher.db.get({boardID, threadID})) {\r\n      return ThreadWatcher.rm(siteID, boardID, threadID);\r\n    } else {\r\n      return ThreadWatcher.add(thread);\r\n    }\r\n  },\r\n\r\n  add(thread, cb) {\r\n    const data     = {};\r\n    const siteID   = g.SITE.ID;\r\n    const boardID  = thread.board.ID;\r\n    const threadID = thread.ID;\r\n    if (thread.isDead) {\r\n      if (Conf['Auto Prune'] && ThreadWatcher.db.get({boardID, threadID})) {\r\n        ThreadWatcher.rm(siteID, boardID, threadID, cb);\r\n        return;\r\n      }\r\n      data.isDead = true;\r\n    }\r\n    if (thread.OP) { data.excerpt = Get.threadExcerpt(thread); }\r\n    return ThreadWatcher.addRaw(boardID, threadID, data, cb);\r\n  },\r\n\r\n  addRaw(boardID, threadID, data, cb) {\r\n    const oldData = ThreadWatcher.db.get({ boardID, threadID, defaultValue: dict() });\r\n    delete oldData.last;\r\n    delete oldData.modified;\r\n    $.extend(oldData, data);\r\n    ThreadWatcher.db.set({boardID, threadID, val: oldData}, cb);\r\n    ThreadWatcher.refresh();\r\n    const thread = {siteID: g.SITE.ID, boardID, threadID, data, force: true};\r\n    if (Conf['Show Page'] && !data.isDead) {\r\n      return ThreadWatcher.fetchBoard([thread]);\r\n    } else if (ThreadWatcher.unreadEnabled && Conf['Show Unread Count']) {\r\n      return ThreadWatcher.fetchStatus(thread);\r\n    }\r\n  },\r\n\r\n  rm(siteID, boardID, threadID, cb) {\r\n    ThreadWatcher.db.delete({siteID, boardID, threadID}, cb);\r\n    return ThreadWatcher.refresh();\r\n  },\r\n\r\n  menu: {\r\n    init() {\r\n      if (!Conf['Thread Watcher']) { return; }\r\n      const menu = (this.menu = new UI.Menu('thread watcher'));\r\n      $.on($('.menu-button', ThreadWatcher.dialog), 'click', function(e) {\r\n        return menu.toggle(e, this, ThreadWatcher);\r\n      });\r\n      return this.addMenuEntries();\r\n    },\r\n\r\n    addHeaderMenuEntry() {\r\n      if (g.VIEW !== 'thread') { return; }\r\n      const entryEl = $.el('a',\r\n        {href: 'javascript:;'});\r\n      Header.menu.addEntry({\r\n        el: entryEl,\r\n        order: 60,\r\n        open() {\r\n          const [addClass, rmClass, text] = !!ThreadWatcher.db.get({boardID: g.BOARD.ID, threadID: g.THREADID}) ?\r\n            ['unwatch-thread', 'watch-thread', 'Unwatch thread']\r\n          :\r\n            ['watch-thread', 'unwatch-thread', 'Watch thread'];\r\n          $.addClass(entryEl, addClass);\r\n          $.rmClass(entryEl, rmClass);\r\n          entryEl.textContent = text;\r\n          return true;\r\n        }\r\n      });\r\n      return $.on(entryEl, 'click', () => ThreadWatcher.toggle(g.threads.get(`${g.BOARD}.${g.THREADID}`)));\r\n    },\r\n\r\n    addMenuEntries() {\r\n      const entries = [];\r\n\r\n      // `Open all` entry\r\n      entries.push({\r\n        text: 'Open all threads',\r\n        cb: ThreadWatcher.cb.openAll,\r\n        open() {\r\n          this.el.classList.toggle('disabled', !ThreadWatcher.list.firstElementChild);\r\n          return true;\r\n        }\r\n      });\r\n\r\n      // `Open Unread` entry\r\n      entries.push({\r\n        text: 'Open unread threads',\r\n        cb: ThreadWatcher.cb.openUnread,\r\n        open() {\r\n          this.el.classList.toggle('disabled', !$('.replies-unread', ThreadWatcher.list));\r\n          return true;\r\n        }\r\n      });\r\n\r\n      // `Open dead threads` entry\r\n      entries.push({\r\n        text: 'Open dead threads',\r\n        cb: ThreadWatcher.cb.openDeads,\r\n        open() {\r\n          this.el.classList.toggle('disabled', !$('.dead-thread', ThreadWatcher.list));\r\n          return true;\r\n        }\r\n      });\r\n\r\n      // `Prune dead threads` entry\r\n      entries.push({\r\n        text: 'Prune dead threads',\r\n        cb: ThreadWatcher.cb.pruneDeads,\r\n        open() {\r\n          this.el.classList.toggle('disabled', !$('.dead-thread', ThreadWatcher.list));\r\n          return true;\r\n        }\r\n      });\r\n\r\n      // `Dismiss posts quoting you` entry\r\n      entries.push({\r\n        text: 'Dismiss posts quoting you',\r\n        title: 'Unhighlight the thread watcher icon and threads until there are new replies quoting you.',\r\n        cb: ThreadWatcher.cb.dismiss,\r\n        open() {\r\n          this.el.classList.toggle('disabled', !$.hasClass(ThreadWatcher.shortcut, 'replies-quoting-you'));\r\n          return true;\r\n        }\r\n      });\r\n\r\n      for (var {text, title, cb, open} of entries) {\r\n        var entry = {\r\n          el: $.el('a', {\r\n            textContent: text,\r\n            href: 'javascript:;'\r\n          }\r\n          )\r\n        };\r\n        if (title) { entry.el.title = title; }\r\n        $.on(entry.el, 'click', cb);\r\n        entry.open = open.bind(entry);\r\n        this.menu.addEntry(entry);\r\n      }\r\n\r\n      // Settings checkbox entries:\r\n      for (var name in Config.threadWatcher) {\r\n        var conf = Config.threadWatcher[name];\r\n        this.addCheckbox(name, conf[1]);\r\n      }\r\n\r\n    },\r\n\r\n    addCheckbox(name, desc) {\r\n      const entry = {\r\n        type: 'thread watcher',\r\n        el: UI.checkbox(name, name.replace(' Thread Watcher', ''))\r\n      };\r\n      entry.el.title = desc;\r\n      const input = entry.el.firstElementChild;\r\n      if ((name === 'Show Unread Count') && !ThreadWatcher.unreadEnabled) {\r\n        input.disabled = true;\r\n        $.addClass(entry.el, 'disabled');\r\n        entry.el.title += '\\n[Remember Last Read Post is disabled.]';\r\n      }\r\n      $.on(input, 'change', $.cb.checked);\r\n      if (['Current Board', 'Show Page', 'Show Unread Count', 'Show Site Prefix'].includes(name)) { $.on(input, 'change', ThreadWatcher.refresh); }\r\n      if (['Show Page', 'Show Unread Count', 'Auto Update Thread Watcher'].includes(name)) { $.on(input, 'change', ThreadWatcher.fetchAuto); }\r\n      return this.menu.addEntry(entry);\r\n    }\r\n  }\r\n};\r\nexport default ThreadWatcher;\r\n",null,null,"import Callbacks from \"../classes/Callbacks\";\r\nimport Header from \"../General/Header\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf, E, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport QuoteThreading from \"../Quotelinks/QuoteThreading\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ReplyPruning = {\r\n  init() {\r\n    if ((g.VIEW !== 'thread') || !Conf['Reply Pruning']) { return; }\r\n\r\n    this.container = $.frag();\r\n\r\n    this.summary = $.el('span', {\r\n      hidden:    true,\r\n      className: 'summary'\r\n    }\r\n    );\r\n    this.summary.style.cursor = 'pointer';\r\n    $.on(this.summary, 'click', () => {\r\n      this.inputs.enabled.checked = !this.inputs.enabled.checked;\r\n      return $.event('change', null, this.inputs.enabled);\r\n    });\r\n\r\n    const label = UI.checkbox('Prune Replies', 'Show Last', Conf['Prune All Threads']);\r\n    const el = $.el('span',\r\n      {title: 'Maximum number of replies to show.'}\r\n    ,\r\n      {innerHTML: \" <input type=\\\"number\\\" name=\\\"Max Replies\\\" min=\\\"0\\\" step=\\\"1\\\" value=\\\"\" + E(Conf[\"Max Replies\"]) + \"\\\" class=\\\"field\\\">\"});\r\n    $.prepend(el, label);\r\n\r\n    this.inputs = {\r\n      enabled: label.firstElementChild,\r\n      replies: el.lastElementChild\r\n    };\r\n\r\n    this.setEnabled.call(this.inputs.enabled);\r\n    $.on(this.inputs.enabled, 'change', this.setEnabled);\r\n    $.on(this.inputs.replies, 'change', $.cb.value);\r\n\r\n    Header.menu.addEntry({\r\n      el,\r\n      order: 190\r\n    });\r\n\r\n    return Callbacks.Thread.push({\r\n      name: 'Reply Pruning',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  position: 0,\r\n  hidden: 0,\r\n  hiddenFiles: 0,\r\n  total: 0,\r\n  totalFiles: 0,\r\n\r\n  setEnabled() {\r\n    const other = QuoteThreading.input;\r\n    if (this.checked && other?.checked) {\r\n      other.checked = false;\r\n      $.event('change', null, other);\r\n    }\r\n    return ReplyPruning.active = this.checked;\r\n  },\r\n\r\n  showIfHidden(id) {\r\n    if (ReplyPruning.container && $(`#${id}`, ReplyPruning.container)) {\r\n      ReplyPruning.inputs.enabled.checked = false;\r\n      return $.event('change', null, ReplyPruning.inputs.enabled);\r\n    }\r\n  },\r\n\r\n  node() {\r\n    let middle;\r\n    ReplyPruning.thread = this;\r\n\r\n    if (this.isSticky) {\r\n      ReplyPruning.active = (ReplyPruning.inputs.enabled.checked = true);\r\n      if (QuoteThreading.input) {\r\n        // Disable Quote Threading for this thread but don't save the setting.\r\n        Conf['Thread Quotes'] = (QuoteThreading.input.checked = false);\r\n      }\r\n    }\r\n\r\n    this.posts.forEach(function(post) {\r\n      if (post.isReply) {\r\n        ReplyPruning.total++;\r\n        if (post.file) { return ReplyPruning.totalFiles++; }\r\n      }\r\n    });\r\n\r\n    // If we're linked to a post that we would hide, don't hide the posts in the first place.\r\n    if (\r\n      ReplyPruning.active &&\r\n      /^#p\\d+$/.test(location.hash) &&\r\n      (1 <= (middle = this.posts.keys.indexOf(location.hash.slice(2))) && middle < 1 + Math.max(ReplyPruning.total - +Conf[\"Max Replies\"], 0))\r\n    ) {\r\n      ReplyPruning.active = (ReplyPruning.inputs.enabled.checked = false);\r\n    }\r\n\r\n    $.after(this.OP.nodes.root, ReplyPruning.summary);\r\n\r\n    $.on(ReplyPruning.inputs.enabled, 'change', ReplyPruning.update);\r\n    $.on(ReplyPruning.inputs.replies, 'change', ReplyPruning.update);\r\n    $.on(d, 'ThreadUpdate', ReplyPruning.updateCount);\r\n    $.on(d, 'ThreadUpdate', ReplyPruning.update);\r\n\r\n    return ReplyPruning.update();\r\n  },\r\n\r\n  updateCount(e) {\r\n    if (e.detail[404]) { return; }\r\n    for (var fullID of e.detail.newPosts) {\r\n      ReplyPruning.total++;\r\n      if (g.posts.get(fullID).file) { ReplyPruning.totalFiles++; }\r\n    }\r\n  },\r\n\r\n  update() {\r\n    let boardTop, node, post;\r\n    const hidden1 = ReplyPruning.hidden;\r\n    const hidden2 = ReplyPruning.active ?\r\n      Math.max(ReplyPruning.total - +Conf[\"Max Replies\"], 0)\r\n    :\r\n      0;\r\n\r\n    // Record position from bottom of document\r\n    const oldPos = d.body.clientHeight - window.scrollY;\r\n\r\n    const {posts} = ReplyPruning.thread;\r\n\r\n    if (ReplyPruning.hidden < hidden2) {\r\n      while ((ReplyPruning.hidden < hidden2) && (ReplyPruning.position < posts.keys.length)) {\r\n        post = posts.get(posts.keys[ReplyPruning.position++]);\r\n        if (post.isReply && !post.isFetchedQuote) {\r\n          while ((node = ReplyPruning.summary.nextSibling) && (node !== post.nodes.root)) { $.add(ReplyPruning.container, node); }\r\n          $.add(ReplyPruning.container, post.nodes.root);\r\n          ReplyPruning.hidden++;\r\n          if (post.file) { ReplyPruning.hiddenFiles++; }\r\n        }\r\n      }\r\n\r\n    } else if (ReplyPruning.hidden > hidden2) {\r\n      const frag = $.frag();\r\n      while ((ReplyPruning.hidden > hidden2) && (ReplyPruning.position > 0)) {\r\n        post = posts.get(posts.keys[--ReplyPruning.position]);\r\n        if (post.isReply && !post.isFetchedQuote) {\r\n          while ((node = ReplyPruning.container.lastChild) && (node !== post.nodes.root)) { $.prepend(frag, node); }\r\n          $.prepend(frag, post.nodes.root);\r\n          ReplyPruning.hidden--;\r\n          if (post.file) { ReplyPruning.hiddenFiles--; }\r\n        }\r\n      }\r\n      $.after(ReplyPruning.summary, frag);\r\n      $.event('PostsInserted', null, ReplyPruning.summary.parentNode);\r\n    }\r\n\r\n    ReplyPruning.summary.textContent = ReplyPruning.active ?\r\n      g.SITE.Build.summaryText('+', ReplyPruning.hidden, ReplyPruning.hiddenFiles)\r\n    :\r\n      g.SITE.Build.summaryText('-', ReplyPruning.total, ReplyPruning.totalFiles);\r\n    ReplyPruning.summary.hidden = (ReplyPruning.total <= +Conf[\"Max Replies\"]);\r\n\r\n    // Maintain position in thread when posts are added/removed above\r\n    if ((hidden1 !== hidden2) && ((boardTop = Header.getTopOf($('.board'))) < 0)) {\r\n      return window.scrollBy(0, Math.max(d.body.clientHeight - oldPos, window.scrollY + boardTop) - window.scrollY);\r\n    }\r\n  }\r\n};\r\nexport default ReplyPruning;\r\n",null,null,"import Callbacks from \"../classes/Callbacks\";\r\nimport Fetcher from \"../classes/Fetcher\";\r\nimport Get from \"../General/Get\";\r\nimport Header from \"../General/Header\";\r\nimport UI from \"../General/UI\";\r\nimport { Conf, d, doc, g } from \"../globals/globals\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar QuotePreview = {\r\n  init() {\r\n    if (!Conf['Quote Previewing']) { return; }\r\n\r\n    if (g.VIEW === 'archive') {\r\n      $.on(d, 'mouseover', function(e) {\r\n        if ((e.target.nodeName === 'A') && $.hasClass(e.target, 'quotelink')) {\r\n          return QuotePreview.mouseover.call(e.target, e);\r\n        }\r\n      });\r\n    }\r\n\r\n    if (!['index', 'thread'].includes(g.VIEW)) { return; }\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Quote Previewing',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    for (var link of this.nodes.quotelinks.concat([...this.nodes.backlinks], this.nodes.archivelinks)) {\r\n      $.on(link, 'mouseover', QuotePreview.mouseover);\r\n    }\r\n  },\r\n\r\n  mouseover(e) {\r\n    let origin;\r\n    if (($.hasClass(this, 'inlined') && !$.hasClass(doc, 'catalog-mode')) || !d.contains(this)) { return; }\r\n\r\n    const {boardID, threadID, postID} = Get.postDataFromLink(this);\r\n\r\n    const qp = $.el('div', {\r\n      id: 'qp',\r\n      className: 'dialog'\r\n    }\r\n    );\r\n\r\n    $.add(Header.hover, qp);\r\n    new Fetcher(boardID, threadID, postID, qp, Get.postFromNode(this));\r\n\r\n    UI.hover({\r\n      root: this,\r\n      el: qp,\r\n      latestEvent: e,\r\n      endEvents: 'mouseout click',\r\n      cb: QuotePreview.mouseout\r\n    });\r\n\r\n    if (Conf['Quote Highlighting'] && (origin = g.posts.get(`${boardID}.${postID}`))) {\r\n      const posts = [origin].concat(origin.clones);\r\n      // Remove the clone that's in the qp from the array.\r\n      posts.pop();\r\n      for (var post of posts) {\r\n        $.addClass(post.nodes.post, 'qphl');\r\n      }\r\n    }\r\n  },\r\n\r\n  mouseout() {\r\n    // Stop if it only contains text.\r\n    let root;\r\n    if (!(root = this.el.firstElementChild)) { return; }\r\n\r\n    $.event('PostsRemoved', null, Header.hover);\r\n\r\n    const clone = Get.postFromRoot(root);\r\n    let post  = clone.origin;\r\n    post.rmClone(root.dataset.clone);\r\n\r\n    if (!Conf['Quote Highlighting']) { return; }\r\n    for (post of [post].concat(post.clones)) {\r\n      $.rmClass(post.nodes.post, 'qphl');\r\n    }\r\n  }\r\n};\r\nexport default QuotePreview;\r\n","/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nimport Callbacks from '../classes/Callbacks';\r\nimport CatalogThread from '../classes/CatalogThread';\r\nimport Notice from '../classes/Notice';\r\nimport Post from '../classes/Post';\r\nimport Thread from '../classes/Thread';\r\nimport Config from '../config/Config';\r\nimport Filter from '../Filtering/Filter';\r\nimport PostHiding from '../Filtering/PostHiding';\r\nimport ThreadHiding from '../Filtering/ThreadHiding';\r\nimport Main from '../main/Main';\r\nimport CatalogLinks from '../Miscellaneous/CatalogLinks';\r\nimport RelativeDates from '../Miscellaneous/RelativeDates';\r\nimport ThreadWatcher from '../Monitoring/ThreadWatcher';\r\nimport $$ from '../platform/$$';\r\nimport $ from '../platform/$';\r\nimport QuotePreview from '../Quotelinks/QuotePreview';\r\nimport { c, Conf, d, doc, g } from '../globals/globals';\r\nimport Header from './Header';\r\nimport UI from './UI';\r\nimport Menu from '../Menu/Menu';\r\n\r\nimport NavLinksPage from './Index/NavLinks.html';\r\nimport PageList from './Index/PageList.html';\r\nimport BoardConfig from './BoardConfig';\r\nimport Get from './Get';\r\nimport { dict, SECOND } from '../platform/helpers';\r\n\r\nvar Index = {\r\n  showHiddenThreads: false,\r\n  changed: {},\r\n\r\n  enabledOn({siteID, boardID}) {\r\n    return Conf['JSON Index'] && (g.sites[siteID].software === 'yotsuba') && (boardID !== 'f');\r\n  },\r\n\r\n  init() {\r\n    let input, inputs, name;\r\n    if (g.VIEW !== 'index') { return; }\r\n\r\n    // For IndexRefresh events\r\n    $.one(d, '4chanXInitFinished', this.cb.initFinished);\r\n    $.on(d, 'PostsInserted', this.cb.postsInserted);\r\n\r\n    if (!this.enabledOn(g.BOARD)) { return; }\r\n\r\n    this.enabled = true;\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Index Page Numbers',\r\n      cb:   this.node\r\n    });\r\n    Callbacks.CatalogThread.push({\r\n      name: 'Catalog Features',\r\n      cb:   this.catalogNode\r\n    });\r\n\r\n    this.search = history.state?.searched || '';\r\n    if (history.state?.mode) {\r\n      Conf['Index Mode'] = history.state?.mode;\r\n    }\r\n    this.currentSort = history.state?.sort;\r\n    if (!this.currentSort) { this.currentSort = typeof Conf['Index Sort'] === 'object' ? (\r\n        Conf['Index Sort'][g.BOARD.ID] || 'bump'\r\n      ) : (\r\n        Conf['Index Sort']\r\n      ); }\r\n    this.currentPage = this.getCurrentPage();\r\n    this.processHash();\r\n\r\n    $.addClass(doc, 'index-loading', `${Conf['Index Mode'].replace(/\\ /g, '-')}-mode`);\r\n    $.on(window, 'popstate', this.cb.popstate);\r\n    $.on(d, 'scroll', this.scroll);\r\n    $.on(d, 'SortIndex', this.cb.resort);\r\n\r\n    // Header refresh button\r\n    this.button = $.el('a', {\r\n      title: 'Refresh',\r\n      href: 'javascript:;',\r\n      textContent: 'Refresh',\r\n      className: 'bigger-icon',\r\n    });\r\n    $.on(this.button, 'click', () => Index.update());\r\n    Header.addShortcut('index-refresh', this.button, 590, '🗘');\r\n\r\n    // Header \"Index Navigation\" submenu\r\n    const entries = [];\r\n    this.inputs = (inputs = dict());\r\n    for (name in Config.Index) {\r\n      var arr = Config.Index[name];\r\n      if (arr instanceof Array) {\r\n        var label = UI.checkbox(name, `${name[0]}${name.slice(1).toLowerCase()}`);\r\n        label.title = arr[1];\r\n        entries.push({el: label});\r\n        input = label.firstChild;\r\n        $.on(input, 'change', $.cb.checked);\r\n        inputs[name] = input;\r\n      }\r\n    }\r\n    $.on(inputs['Show Replies'], 'change', this.cb.replies);\r\n    $.on(inputs['Catalog Hover Expand'], 'change', this.cb.hover);\r\n    $.on(inputs['Pin Watched Threads'], 'change', this.cb.resort);\r\n    $.on(inputs['Anchor Hidden Threads'], 'change', this.cb.resort);\r\n\r\n    const watchSettings = function(e) {\r\n      if (input = $.getOwn(inputs, e.target.name)) {\r\n        input.checked = e.target.checked;\r\n        return $.event('change', null, input);\r\n      }\r\n    };\r\n    $.on(d, 'OpenSettings', () => $.on($.id('fourchanx-settings'), 'change', watchSettings));\r\n\r\n    const sortEntry = UI.checkbox('Per-Board Sort Type', 'Per-board sort type', (typeof Conf['Index Sort'] === 'object'));\r\n    sortEntry.title = 'Set the sorting order of each board independently.';\r\n    $.on(sortEntry.firstChild, 'change', this.cb.perBoardSort);\r\n    entries.splice(3, 0, {el: sortEntry});\r\n\r\n    Header.menu.addEntry({\r\n      el: $.el('span',\r\n        {textContent: 'Index Navigation'}),\r\n      order: 100,\r\n      subEntries: entries\r\n    });\r\n\r\n    // Navigation links at top of index\r\n    this.navLinks = $.el('div', {className: 'navLinks json-index'});\r\n    $.extend(this.navLinks, {innerHTML: NavLinksPage});\r\n    $('.cataloglink a', this.navLinks).href = CatalogLinks.catalog();\r\n    if (!BoardConfig.isArchived(g.BOARD.ID)) { $('.archlistlink', this.navLinks).hidden = true; }\r\n    $.on($('#index-last-refresh a', this.navLinks), 'click', this.cb.refreshFront);\r\n\r\n    // Search field\r\n    this.searchInput = $('#index-search', this.navLinks);\r\n    this.setupSearch();\r\n    $.on(this.searchInput, 'input', this.onSearchInput);\r\n    $.on($('#index-search-clear', this.navLinks), 'click', this.clearSearch);\r\n\r\n    // Hidden threads toggle\r\n    this.hideLabel = $('#hidden-label', this.navLinks);\r\n    $.on($('#hidden-toggle a', this.navLinks), 'click', this.cb.toggleHiddenThreads);\r\n\r\n    // Drop-down menus and reverse sort toggle\r\n    this.selectRev   = $('#index-rev',  this.navLinks);\r\n    this.selectMode  = $('#index-mode', this.navLinks);\r\n    this.selectSort  = $('#index-sort', this.navLinks);\r\n    this.selectSize  = $('#index-size', this.navLinks);\r\n    $.on(this.selectRev,  'change', this.cb.sort);\r\n    $.on(this.selectMode, 'change', this.cb.mode);\r\n    $.on(this.selectSort, 'change', this.cb.sort);\r\n    $.on(this.selectSize, 'change', $.cb.value);\r\n    $.on(this.selectSize, 'change', this.cb.size);\r\n    for (var select of [this.selectMode, this.selectSize]) {\r\n      select.value = Conf[select.name];\r\n    }\r\n    this.selectRev.checked = /-rev$/.test(Index.currentSort);\r\n    this.selectSort.value  = Index.currentSort.replace(/-rev$/, '');\r\n\r\n    // Last Long Reply options\r\n    this.lastLongOptions = $('#lastlong-options', this.navLinks);\r\n    this.lastLongInputs = $$('input', this.lastLongOptions);\r\n    this.lastLongThresholds = [0, 0];\r\n    this.lastLongOptions.hidden = (this.selectSort.value !== 'lastlong');\r\n    for (let i = 0; i < this.lastLongInputs.length; i++) {\r\n      input = this.lastLongInputs[i];\r\n      $.on(input, 'change', this.cb.lastLongThresholds);\r\n      var tRaw = Conf[`Last Long Reply Thresholds ${i}`];\r\n      input.value = (this.lastLongThresholds[i] =\r\n        typeof tRaw === 'object' ? (tRaw[g.BOARD.ID] ?? 100) : tRaw);\r\n    }\r\n\r\n    // Thread container\r\n    this.root = $.el('div', {className: 'board json-index'});\r\n    $.on(this.root, 'click', this.cb.hoverToggle);\r\n    this.cb.size();\r\n    this.cb.hover();\r\n\r\n    // Page list\r\n    this.pagelist = $.el('div', {className: 'pagelist json-index'});\r\n    $.extend(this.pagelist, {innerHTML: PageList});\r\n    $('.cataloglink a', this.pagelist).href = CatalogLinks.catalog();\r\n    $.on(this.pagelist, 'click', this.cb.pageNav);\r\n\r\n    this.update(true);\r\n\r\n    $.onExists(doc, 'title + *', () => d.title = d.title.replace(/\\ -\\ Page\\ \\d+/, ''));\r\n\r\n    $.onExists(doc, '.board > .thread > .postContainer, .board + *', function() {\r\n      let el;\r\n      g.SITE.Build.hat = $('.board > .thread > img:first-child');\r\n      if (g.SITE.Build.hat) {\r\n        g.BOARD.threads.forEach(function(thread) {\r\n          if (thread.nodes.root) {\r\n            return $.prepend(thread.nodes.root, g.SITE.Build.hat.cloneNode(false));\r\n          }\r\n        });\r\n        $.addClass(doc, 'hats-enabled');\r\n        $.addStyle(`.catalog-thread::after {background-image: url(${g.SITE.Build.hat.src});}`);\r\n      }\r\n\r\n      const board = $('.board');\r\n      $.replace(board, Index.root);\r\n      if (Index.loaded) {\r\n        $.event('PostsInserted', null, Index.root);\r\n      }\r\n      // Hacks:\r\n      // - When removing an element from the document during page load,\r\n      //   its ancestors will still be correctly created inside of it.\r\n      // - Creating loadable elements inside of an origin-less document\r\n      //   will not download them.\r\n      // - Combine the two and you get a download canceller!\r\n      //   Does not work on Firefox unfortunately. bugzil.la/939713\r\n      try {\r\n        d.implementation.createDocument(null, null, null).appendChild(board);\r\n      } catch (error) {}\r\n\r\n      for (el of $$('.navLinks')) { $.rm(el); }\r\n      $.rm($.id('ctrl-top'));\r\n      const topNavPos = $.id('delform').previousElementSibling;\r\n      $.before(topNavPos, $.el('hr'));\r\n      $.before(topNavPos, Index.navLinks);\r\n      const timeEl = $('#index-last-refresh time', Index.navLinks);\r\n      if (timeEl.dataset.utc) { return RelativeDates.update(timeEl); }\r\n    });\r\n\r\n    return Main.ready(function() {\r\n      let pagelist;\r\n      if (pagelist = $('.pagelist')) {\r\n        $.replace(pagelist, Index.pagelist);\r\n      }\r\n      return $.rmClass(doc, 'index-loading');\r\n    });\r\n  },\r\n\r\n  scroll() {\r\n    if (Index.req || !Index.liveThreadData || (Conf['Index Mode'] !== 'infinite') || (window.scrollY <= (doc.scrollHeight - (300 + window.innerHeight)))) { return; }\r\n    if (Index.pageNum == null) { Index.pageNum = Index.currentPage; } // Avoid having to pushState to keep track of the current page\r\n\r\n    const pageNum = ++Index.pageNum;\r\n    if (pageNum > Index.pagesNum) { return Index.endNotice(); }\r\n\r\n    const threadIDs = Index.threadsOnPage(pageNum);\r\n    return Index.buildStructure(threadIDs);\r\n  },\r\n\r\n  endNotice: (function() {\r\n    let notify = false;\r\n    const reset = () => notify = false;\r\n    return function() {\r\n      if (notify) { return; }\r\n      notify = true;\r\n      new Notice('info', \"Last page reached.\", 2);\r\n      return setTimeout(reset, 3 * SECOND);\r\n    };\r\n  })(),\r\n\r\n  menu: {\r\n    init() {\r\n      if ((g.VIEW !== 'index') || !Conf['Menu'] || !Conf['Thread Hiding Link'] || !Index.enabledOn(g.BOARD)) { return; }\r\n\r\n      return Menu.menu.addEntry({\r\n        el: $.el('a', {\r\n          href:      'javascript:;',\r\n          className: 'has-shortcut-text'\r\n        }\r\n        , {innerHTML: \"<span></span><span class=\\\"shortcut-text\\\">Shift+click</span>\"}),\r\n        order: 20,\r\n        open({thread}) {\r\n          if (Conf['Index Mode'] !== 'catalog') { return false; }\r\n          this.el.firstElementChild.textContent = thread.isHidden ?\r\n            'Unhide'\r\n          :\r\n            'Hide';\r\n          if (this.cb) { $.off(this.el, 'click', this.cb); }\r\n          this.cb = function() {\r\n            $.event('CloseMenu');\r\n            return Index.toggleHide(thread);\r\n          };\r\n          $.on(this.el, 'click', this.cb);\r\n          return true;\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  node() {\r\n    if (this.isReply || this.isClone || (Index.threadPosition[this.ID] == null)) { return; }\r\n    return this.thread.setPage(Math.floor(Index.threadPosition[this.ID] / Index.threadsNumPerPage) + 1);\r\n  },\r\n\r\n  catalogNode() {\r\n    return $.on(this.nodes.root, 'mousedown click', e => {\r\n      if ((e.button !== 0) || !e.shiftKey) { return; }\r\n      if (e.type === 'click') { Index.toggleHide(this.thread); }\r\n      return e.preventDefault();\r\n    });\r\n  }, // Also on mousedown to prevent highlighting text.\r\n\r\n  toggleHide(thread) {\r\n    if (Index.showHiddenThreads) {\r\n      ThreadHiding.show(thread);\r\n      if (!ThreadHiding.db.get({boardID: thread.board.ID, threadID: thread.ID})) { return; }\r\n      // Don't save when un-hiding filtered threads.\r\n    } else {\r\n      ThreadHiding.hide(thread);\r\n    }\r\n    return ThreadHiding.saveHiddenState(thread);\r\n  },\r\n\r\n  cycleSortType() {\r\n    let i;\r\n    const types = Index.selectSort.options.filter(option => !option.disabled);\r\n    for (i = 0; i < types.length; i++) {\r\n      var type = types[i];\r\n      if (type.selected) { break; }\r\n    }\r\n    types[(i + 1) % types.length].selected = true;\r\n    return $.event('change', null, Index.selectSort);\r\n  },\r\n\r\n  cb: {\r\n    initFinished() {\r\n      Index.initFinishedFired = true;\r\n      return $.queueTask(() => Index.cb.postsInserted());\r\n    },\r\n\r\n    postsInserted() {\r\n      if (!Index.initFinishedFired) { return; }\r\n      let n = 0;\r\n      g.posts.forEach(function(post) {\r\n        if (!post.isFetchedQuote && !post.indexRefreshSeen && doc.contains(post.nodes.root)) {\r\n          post.indexRefreshSeen = true;\r\n          return n++;\r\n        }\r\n      });\r\n      if (n) { return $.event('IndexRefresh'); }\r\n    },\r\n\r\n    toggleHiddenThreads() {\r\n      $('#hidden-toggle a', Index.navLinks).textContent = (Index.showHiddenThreads = !Index.showHiddenThreads) ?\r\n        'Hide'\r\n      :\r\n        'Show';\r\n      Index.sort();\r\n      return Index.buildIndex();\r\n    },\r\n\r\n    mode() {\r\n      Index.pushState({mode: this.value});\r\n      return Index.pageLoad(false);\r\n    },\r\n\r\n    sort() {\r\n      const value = Index.selectRev.checked ? Index.selectSort.value + \"-rev\" : Index.selectSort.value;\r\n      Index.pushState({sort: value});\r\n      return Index.pageLoad(false);\r\n    },\r\n\r\n    resort(e) {\r\n      Index.changed.order = true;\r\n      if (!e?.detail?.deferred) { return Index.pageLoad(false); }\r\n    },\r\n\r\n    perBoardSort() {\r\n      Conf['Index Sort'] = this.checked ? dict() : '';\r\n      Index.saveSort();\r\n      for (let i = 0; i < 2; i++) {\r\n        Conf[`Last Long Reply Thresholds ${i}`] = this.checked ? dict() : '';\r\n        Index.saveLastLongThresholds(i);\r\n      }\r\n    },\r\n\r\n    lastLongThresholds() {\r\n      const i = [...this.parentNode.children].indexOf(this);\r\n      const value = +this.value;\r\n      if (!Number.isFinite(value)) {\r\n        this.value = Index.lastLongThresholds[i];\r\n        return;\r\n      }\r\n      Index.lastLongThresholds[i] = value;\r\n      Index.saveLastLongThresholds(i);\r\n      Index.changed.order = true;\r\n      return Index.pageLoad(false);\r\n    },\r\n\r\n    size(e) {\r\n      if (Conf['Index Mode'] !== 'catalog') {\r\n        $.rmClass(Index.root, 'catalog-small');\r\n        $.rmClass(Index.root, 'catalog-large');\r\n      } else if (Conf['Index Size'] === 'small') {\r\n        $.addClass(Index.root, 'catalog-small');\r\n        $.rmClass(Index.root,  'catalog-large');\r\n      } else {\r\n        $.addClass(Index.root, 'catalog-large');\r\n        $.rmClass(Index.root,  'catalog-small');\r\n      }\r\n      if (e) { return Index.buildIndex(); }\r\n    },\r\n\r\n    replies() {\r\n      return Index.buildIndex();\r\n    },\r\n\r\n    hover() {\r\n      return doc.classList.toggle('catalog-hover-expand', Conf['Catalog Hover Expand']);\r\n    },\r\n\r\n    hoverToggle(e) {\r\n      if (Conf['Catalog Hover Toggle'] && $.hasClass(doc, 'catalog-mode') && !$.modifiedClick(e) && !$.x('ancestor-or-self::a', e.target)) {\r\n        let thread;\r\n        const input = Index.inputs['Catalog Hover Expand'];\r\n        input.checked = !input.checked;\r\n        $.event('change', null, input);\r\n        if (thread = Get.threadFromNode(e.target)) {\r\n          Index.cb.catalogReplies.call(thread);\r\n          return Index.cb.hoverAdjust.call(thread.OP.nodes);\r\n        }\r\n      }\r\n    },\r\n\r\n    popstate(e) {\r\n      if (e?.state) {\r\n        const {searched, mode, sort} = e.state;\r\n        const page = Index.getCurrentPage();\r\n        Index.setState({search: searched, mode, sort, page});\r\n        return Index.pageLoad(false);\r\n      } else {\r\n        // page load or hash change\r\n        const nCommands = Index.processHash();\r\n        if (Conf['Refreshed Navigation'] && nCommands) {\r\n          return Index.update();\r\n        } else {\r\n          return Index.pageLoad();\r\n        }\r\n      }\r\n    },\r\n\r\n    pageNav(e) {\r\n      let a;\r\n      if ($.modifiedClick(e)) { return; }\r\n      switch (e.target.nodeName) {\r\n        case 'BUTTON':\r\n          e.target.blur();\r\n          a = e.target.parentNode;\r\n          break;\r\n        case 'A':\r\n          a = e.target;\r\n          break;\r\n        default:\r\n          return;\r\n      }\r\n      if (a.textContent === 'Catalog') { return; }\r\n      e.preventDefault();\r\n      return Index.userPageNav(+a.pathname.split(/\\/+/)[2] || 1);\r\n    },\r\n\r\n    refreshFront() {\r\n      Index.pushState({page: 1});\r\n      return Index.update();\r\n    },\r\n\r\n    catalogReplies() {\r\n      if (Conf['Show Replies'] && $.hasClass(doc, 'catalog-hover-expand') && !this.catalogView.nodes.replies) {\r\n        return Index.buildCatalogReplies(this);\r\n      }\r\n    },\r\n\r\n    hoverAdjust() {\r\n      // Prevent hovered catalog threads from going offscreen.\r\n      let x;\r\n      if (!$.hasClass(doc, 'catalog-hover-expand')) { return; }\r\n      const rect = this.post.getBoundingClientRect();\r\n      if (x = $.minmax(0, -rect.left, doc.clientWidth - rect.right)) {\r\n        const {style} = this.post;\r\n        style.left = `${x}px`;\r\n        style.right = `${-x}px`;\r\n        return $.one(this.root, 'mouseleave', () => style.left = (style.right = null));\r\n      }\r\n    }\r\n  },\r\n\r\n  scrollToIndex() {\r\n    // Scroll to navlinks, or top of board if navlinks are hidden.\r\n    return Header.scrollToIfNeeded((Index.navLinks.getBoundingClientRect().height ? Index.navLinks : Index.root));\r\n  },\r\n\r\n  getCurrentPage() {\r\n    return +window.location.pathname.split(/\\/+/)[2] || 1;\r\n  },\r\n\r\n  userPageNav(page) {\r\n    Index.pushState({page});\r\n    if (Conf['Refreshed Navigation']) {\r\n      return Index.update();\r\n    } else {\r\n      return Index.pageLoad();\r\n    }\r\n  },\r\n\r\n  hashCommands: {\r\n    mode: {\r\n      'paged':         'paged',\r\n      'infinite-scrolling': 'infinite',\r\n      'infinite':      'infinite',\r\n      'all-threads':   'all pages',\r\n      'all-pages':     'all pages',\r\n      'catalog':       'catalog'\r\n    },\r\n    sort: {\r\n      'bump-order':        'bump',\r\n      'last-reply':        'lastreply',\r\n      'last-long-reply':   'lastlong',\r\n      'creation-date':     'birth',\r\n      'reply-count':       'replycount',\r\n      'file-count':        'filecount',\r\n      'posts-per-minute':  'activity'\r\n    }\r\n  },\r\n\r\n  processHash() {\r\n    // XXX https://bugzilla.mozilla.org/show_bug.cgi?id=483304\r\n    let hash = location.href.match(/#.*/)?.[0] || '';\r\n    const state =\r\n      {replace: true};\r\n    const commands = hash.slice(1).split('/');\r\n    const leftover = [];\r\n    for (var command of commands) {\r\n      var mode, sort;\r\n      if (mode = $.getOwn(Index.hashCommands.mode, command)) {\r\n        state.mode = mode;\r\n      } else if (command === 'index') {\r\n        state.mode = Conf['Previous Index Mode'];\r\n        state.page = 1;\r\n      } else if (sort = $.getOwn(Index.hashCommands.sort, command.replace(/-rev$/, ''))) {\r\n        state.sort = sort;\r\n        if (/-rev$/.test(command)) { state.sort += '-rev'; }\r\n      } else if (/^s=/.test(command)) {\r\n        state.search = decodeURIComponent(command.slice(2)).replace(/\\+/g, ' ').trim();\r\n      } else {\r\n        leftover.push(command);\r\n      }\r\n    }\r\n    hash = leftover.join('/');\r\n    if (hash) { state.hash = `#${hash}`; }\r\n    Index.pushState(state);\r\n    return commands.length - leftover.length;\r\n  },\r\n\r\n  pushState(state) {\r\n    let {search, hash, replace} = state;\r\n    let pageBeforeSearch = history.state?.oldpage;\r\n    if ((search != null) && (search !== Index.search)) {\r\n      state.page = search ? 1 : (pageBeforeSearch || 1);\r\n      if (!search) {\r\n        pageBeforeSearch = undefined;\r\n      } else if (!Index.search) {\r\n        pageBeforeSearch = Index.currentPage;\r\n      }\r\n    }\r\n    Index.setState(state);\r\n    const pathname = Index.currentPage === 1 ? `/${g.BOARD}/` : `/${g.BOARD}/${Index.currentPage}`;\r\n    if (!hash) { hash = ''; }\r\n    return history[replace ? 'replaceState' : 'pushState']({\r\n      mode:     Conf['Index Mode'],\r\n      sort:     Index.currentSort,\r\n      searched: Index.search,\r\n      oldpage:  pageBeforeSearch\r\n    }\r\n    , '', `${location.protocol}//${location.host}${pathname}${hash}`);\r\n  },\r\n\r\n  setState({search, mode, sort, page, hash}) {\r\n    if ((search != null) && (search !== Index.search)) {\r\n      Index.changed.search = true;\r\n      Index.search = search;\r\n    }\r\n    if ((mode != null) && (mode !== Conf['Index Mode'])) {\r\n      Index.changed.mode = true;\r\n      Conf['Index Mode'] = mode;\r\n      $.set('Index Mode', mode);\r\n      if ((mode !== 'catalog') && (Conf['Previous Index Mode'] !== mode)) {\r\n        Conf['Previous Index Mode'] = mode;\r\n        $.set('Previous Index Mode', mode);\r\n      }\r\n    }\r\n    if ((sort != null) && (sort !== Index.currentSort)) {\r\n      Index.changed.sort = true;\r\n      Index.currentSort = sort;\r\n      Index.saveSort();\r\n    }\r\n    if (['all pages', 'catalog'].includes(Conf['Index Mode'])) { page = 1; }\r\n    if ((page != null) && (page !== Index.currentPage)) {\r\n      Index.changed.page = true;\r\n      Index.currentPage = page;\r\n    }\r\n    if (hash != null) {\r\n      return Index.changed.hash = true;\r\n    }\r\n  },\r\n\r\n  savePerBoard(key, value) {\r\n    if (typeof Conf[key] === 'object') {\r\n      Conf[key][g.BOARD.ID] = value;\r\n    } else {\r\n      Conf[key] = value;\r\n    }\r\n    return $.set(key, Conf[key]);\r\n  },\r\n\r\n  saveSort() {\r\n    return Index.savePerBoard('Index Sort', Index.currentSort);\r\n  },\r\n\r\n  saveLastLongThresholds(i) {\r\n    return Index.savePerBoard(`Last Long Reply Thresholds ${i}`, Index.lastLongThresholds[i]);\r\n  },\r\n\r\n  pageLoad(scroll=true) {\r\n    if (!Index.liveThreadData) { return; }\r\n    let {threads, order, search, mode, sort, page, hash} = Index.changed;\r\n    if (!threads) { threads = search; }\r\n    if (!order) { order = sort; }\r\n    if (threads || order) { Index.sort(); }\r\n    if (threads) { Index.buildPagelist(); }\r\n    if (search) { Index.setupSearch(); }\r\n    if (mode) { Index.setupMode(); }\r\n    if (sort) { Index.setupSort(); }\r\n    if (threads || mode || page || order) { Index.buildIndex(); }\r\n    if (threads || page) { Index.setPage(); }\r\n    if (scroll && !hash) { Index.scrollToIndex(); }\r\n    return Index.changed = {};\r\n  },\r\n\r\n  setupMode() {\r\n    for (var mode of ['paged', 'infinite', 'all pages', 'catalog']) {\r\n      $[mode === Conf['Index Mode'] ? 'addClass' : 'rmClass'](doc, `${mode.replace(/\\ /g, '-')}-mode`);\r\n    }\r\n    Index.selectMode.value = Conf['Index Mode'];\r\n    Index.cb.size();\r\n    Index.showHiddenThreads = false;\r\n    return $('#hidden-toggle a', Index.navLinks).textContent = 'Show';\r\n  },\r\n\r\n  setupSort() {\r\n    Index.selectRev.checked = /-rev$/.test(Index.currentSort);\r\n    Index.selectSort.value  = Index.currentSort.replace(/-rev$/, '');\r\n    return Index.lastLongOptions.hidden = (Index.selectSort.value !== 'lastlong');\r\n  },\r\n\r\n  getPagesNum() {\r\n    if (Index.search) {\r\n      return Math.ceil(Index.sortedThreadIDs.length / Index.threadsNumPerPage);\r\n    } else {\r\n      return Index.pagesNum;\r\n    }\r\n  },\r\n\r\n  getMaxPageNum() {\r\n    return Math.max(1, Index.getPagesNum());\r\n  },\r\n\r\n  buildPagelist() {\r\n    const pagesRoot = $('.pages', Index.pagelist);\r\n    const maxPageNum = Index.getMaxPageNum();\r\n    if (pagesRoot.childElementCount !== maxPageNum) {\r\n      const nodes = [];\r\n      for (let i = 1, end = maxPageNum; i <= end; i++) {\r\n        var a = $.el('a', {\r\n          textContent: i,\r\n          href: i === 1 ? './' : i\r\n        }\r\n        );\r\n        nodes.push($.tn('['), a, $.tn('] '));\r\n      }\r\n      $.rmAll(pagesRoot);\r\n      return $.add(pagesRoot, nodes);\r\n    }\r\n  },\r\n\r\n  setPage() {\r\n    let a, strong;\r\n    const pageNum    = Index.currentPage;\r\n    const maxPageNum = Index.getMaxPageNum();\r\n    const pagesRoot  = $('.pages', Index.pagelist);\r\n\r\n    // Previous/Next buttons\r\n    const prev = pagesRoot.previousElementSibling.firstElementChild;\r\n    const next = pagesRoot.nextElementSibling.firstElementChild;\r\n    let href = Math.max(pageNum - 1, 1);\r\n    prev.href = href === 1 ? './' : href;\r\n    prev.firstElementChild.disabled = href === pageNum;\r\n    href = Math.min(pageNum + 1, maxPageNum);\r\n    next.href = href === 1 ? './' : href;\r\n    next.firstElementChild.disabled = href === pageNum;\r\n\r\n    // <strong> current page\r\n    if (strong = $('strong', pagesRoot)) {\r\n      if (+strong.textContent === pageNum) { return; }\r\n      $.replace(strong, strong.firstChild);\r\n    } else {\r\n      strong = $.el('strong');\r\n    }\r\n\r\n    if (a = pagesRoot.children[pageNum - 1]) {\r\n      $.before(a, strong);\r\n      return $.add(strong, a);\r\n    }\r\n  },\r\n\r\n  updateHideLabel() {\r\n    if (!Index.hideLabel) { return; }\r\n    let hiddenCount = 0;\r\n    for (var threadID of Index.liveThreadIDs) {\r\n      if (Index.isHidden(threadID)) {\r\n        hiddenCount++;\r\n      }\r\n    }\r\n    if (!hiddenCount) {\r\n      Index.hideLabel.hidden = true;\r\n      if (Index.showHiddenThreads) { Index.cb.toggleHiddenThreads(); }\r\n      return;\r\n    }\r\n    Index.hideLabel.hidden = false;\r\n    return $('#hidden-count', Index.navLinks).textContent = hiddenCount === 1 ?\r\n      '1 hidden thread'\r\n    :\r\n      `${hiddenCount} hidden threads`;\r\n  },\r\n\r\n  update(firstTime) {\r\n    let oldReq;\r\n    if (oldReq = Index.req) {\r\n      delete Index.req;\r\n      oldReq.abort();\r\n    }\r\n\r\n    if (Conf['Index Refresh Notifications']) {\r\n      // Optional notification for manual refreshes\r\n      if (!Index.notice) { Index.notice = new Notice('info', 'Refreshing index...'); }\r\n      if (!Index.nTimeout) { Index.nTimeout = setTimeout(() => {\r\n          if (Index.notice) {\r\n            Index.notice.el.lastElementChild.textContent += ' (disable JSON Index if this takes too long)';\r\n          }\r\n        }\r\n        , 3 * SECOND); }\r\n    } else {\r\n      // Also display notice if Index Refresh is taking too long\r\n      if (!Index.nTimeout) { Index.nTimeout = setTimeout(() => Index.notice || (Index.notice = new Notice('info', 'Refreshing index... (disable JSON Index if this takes too long)'))\r\n      , 3 * SECOND); }\r\n    }\r\n\r\n    // Hard refresh in case of incomplete page load.\r\n    if (!firstTime && (d.readyState !== 'loading') && !$('.board + *')) {\r\n      location.reload();\r\n      return;\r\n    }\r\n\r\n    Index.req = $.whenModified(\r\n      g.SITE.urls.catalogJSON({boardID: g.BOARD.ID}),\r\n      'Index',\r\n      Index.load\r\n    );\r\n    return $.addClass(Index.button, 'spin');\r\n  },\r\n\r\n  load() {\r\n    let err;\r\n    if (this !== Index.req) { return; } // aborted\r\n\r\n    $.rmClass(Index.button, 'spin');\r\n    const {notice, nTimeout} = Index;\r\n    if (nTimeout) { clearTimeout(nTimeout); }\r\n    delete Index.nTimeout;\r\n    delete Index.req;\r\n    delete Index.notice;\r\n\r\n    if (![200, 304].includes(this.status)) {\r\n      err = `Index refresh failed. ${this.status ? `Error ${this.statusText} (${this.status})` : 'Connection Error'}`;\r\n      if (notice) {\r\n        notice.setType('warning');\r\n        notice.el.lastElementChild.textContent = err;\r\n        setTimeout(notice.close, SECOND);\r\n      } else {\r\n        new Notice('warning', err, 1);\r\n      }\r\n      return;\r\n    }\r\n\r\n    try {\r\n      if (this.status === 200) {\r\n        Index.parse(this.response);\r\n      } else if (this.status === 304) {\r\n        Index.pageLoad();\r\n      }\r\n    } catch (error) {\r\n      err = error;\r\n      c.error(`Index failure: ${err.message}`, err.stack);\r\n      if (notice) {\r\n        notice.setType('error');\r\n        notice.el.lastElementChild.textContent = 'Index refresh failed.';\r\n        setTimeout(notice.close, SECOND);\r\n      } else {\r\n        new Notice('error', 'Index refresh failed.', 1);\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (notice) {\r\n      if (Conf['Index Refresh Notifications']) {\r\n        notice.setType('success');\r\n        notice.el.lastElementChild.textContent = 'Index refreshed!';\r\n        setTimeout(notice.close, SECOND);\r\n      } else {\r\n        notice.close();\r\n      }\r\n    }\r\n\r\n    const timeEl = $('#index-last-refresh time', Index.navLinks);\r\n    timeEl.dataset.utc = Date.parse(this.getResponseHeader('Last-Modified'));\r\n    return RelativeDates.update(timeEl);\r\n  },\r\n\r\n  parse(pages) {\r\n    $.cleanCache(url => /^https?:\\/\\/a\\.4cdn\\.org\\//.test(url));\r\n    Index.parseThreadList(pages);\r\n    Index.changed.threads = true;\r\n    return Index.pageLoad();\r\n  },\r\n\r\n  parseThreadList(pages) {\r\n    Index.pagesNum          = pages.length;\r\n    Index.threadsNumPerPage = pages[0]?.threads.length || 1;\r\n    Index.liveThreadData    = pages.reduce(((arr, next) => arr.concat(next.threads)), []);\r\n    Index.liveThreadIDs     = Index.liveThreadData.map(data => data.no);\r\n    Index.liveThreadDict    = dict();\r\n    Index.threadPosition    = dict();\r\n    Index.parsedThreads     = dict();\r\n    Index.replyData         = dict();\r\n    for (let i = 0; i < Index.liveThreadData.length; i++) {\r\n      var obj, results;\r\n      var data = Index.liveThreadData[i];\r\n      Index.liveThreadDict[data.no] = data;\r\n      Index.threadPosition[data.no] = i;\r\n      Index.parsedThreads[data.no] = (obj = g.SITE.Build.parseJSON(data, g.BOARD));\r\n      obj.filterResults = (results = Filter.test(obj));\r\n      obj.isOnTop  = results.top;\r\n      obj.isHidden = results.hide || ThreadHiding.isHidden(obj.boardID, obj.threadID);\r\n      if (data.last_replies) {\r\n        for (var reply of data.last_replies) {\r\n          Index.replyData[`${g.BOARD}.${reply.no}`] = reply;\r\n        }\r\n      }\r\n    }\r\n    if (Index.liveThreadData[0]) {\r\n      g.SITE.Build.spoilerRange[g.BOARD.ID] = Index.liveThreadData[0].custom_spoiler;\r\n    }\r\n    g.BOARD.threads.forEach(function(thread) {\r\n      if (!Index.liveThreadIDs.includes(thread.ID)) { return thread.collect(); }\r\n    });\r\n    $.event('IndexUpdate',\r\n      {threads: ((Index.liveThreadIDs.map((ID) => `${g.BOARD}.${ID}`)))});\r\n  },\r\n\r\n  isHidden(threadID) {\r\n    let thread;\r\n    if ((thread = g.BOARD.threads.get(threadID)) && thread.OP && !thread.OP.isFetchedQuote) {\r\n      return thread.isHidden;\r\n    } else {\r\n      return Index.parsedThreads[threadID].isHidden;\r\n    }\r\n  },\r\n\r\n  isHiddenReply(threadID, replyData) {\r\n    return PostHiding.isHidden(g.BOARD.ID, threadID, replyData.no) || Filter.isHidden(g.SITE.Build.parseJSON(replyData, g.BOARD));\r\n  },\r\n\r\n  buildThreads(threadIDs, isCatalog, withReplies) {\r\n    let errors;\r\n    const threads    = [];\r\n    const newThreads = [];\r\n    let newPosts   = [];\r\n    for (var ID of threadIDs) {\r\n      var opRoot, thread;\r\n      try {\r\n        var OP;\r\n        var threadData = Index.liveThreadDict[ID];\r\n\r\n        if (thread = g.BOARD.threads.get(ID)) {\r\n          var isStale = (thread.json !== threadData) && (JSON.stringify(thread.json) !== JSON.stringify(threadData));\r\n          if (isStale) {\r\n            thread.setCount('post', threadData.replies + 1,                threadData.bumplimit);\r\n            thread.setCount('file', threadData.images  + !!threadData.ext, threadData.imagelimit);\r\n            thread.setStatus('Sticky', !!threadData.sticky);\r\n            thread.setStatus('Closed', !!threadData.closed);\r\n          }\r\n          if (thread.catalogView) {\r\n            $.rm(thread.catalogView.nodes.replies);\r\n            thread.catalogView.nodes.replies = null;\r\n          }\r\n        } else {\r\n          thread = new Thread(ID, g.BOARD);\r\n          newThreads.push(thread);\r\n        }\r\n        var lastPost = threadData.last_replies && threadData.last_replies.length ? threadData.last_replies[threadData.last_replies.length - 1].no : ID;\r\n        if (lastPost > thread.lastPost) { thread.lastPost = lastPost; }\r\n        thread.json = threadData;\r\n        threads.push(thread);\r\n\r\n        if ((OP = thread.OP) && !OP.isFetchedQuote) {\r\n          OP.setCatalogOP(isCatalog);\r\n          thread.setPage(Math.floor(Index.threadPosition[ID] / Index.threadsNumPerPage) + 1);\r\n        } else {\r\n          var obj = Index.parsedThreads[ID];\r\n          opRoot = g.SITE.Build.post(obj);\r\n          OP = new Post(opRoot, thread, g.BOARD);\r\n          OP.filterResults = obj.filterResults;\r\n          newPosts.push(OP);\r\n        }\r\n\r\n        if (!isCatalog || !thread.nodes.root) {\r\n          g.SITE.Build.thread(thread, threadData, withReplies);\r\n        }\r\n      } catch (err) {\r\n        // Skip posts that we failed to parse.\r\n        if (!errors) { errors = []; }\r\n        errors.push({\r\n          message: `Parsing of Thread No.${thread} failed. Thread will be skipped.`,\r\n          error: err,\r\n          html: opRoot?.outerHTML\r\n        });\r\n      }\r\n    }\r\n    if (errors) { Main.handleErrors(errors); }\r\n\r\n    if (withReplies) {\r\n      newPosts = newPosts.concat(Index.buildReplies(threads));\r\n    }\r\n\r\n    Main.callbackNodes('Thread', newThreads);\r\n    Main.callbackNodes('Post',   newPosts);\r\n    Index.updateHideLabel();\r\n    $.event('IndexRefreshInternal', {threadIDs: (threads.map((t) => t.fullID)), isCatalog});\r\n\r\n    return threads;\r\n  },\r\n\r\n  buildReplies(threads) {\r\n    let errors;\r\n    const posts = [];\r\n    for (var thread of threads) {\r\n      var lastReplies;\r\n      if (!(lastReplies = Index.liveThreadDict[thread.ID].last_replies)) { continue; }\r\n      var nodes = [];\r\n      for (var data of lastReplies) {\r\n        var node, post;\r\n        if ((post = thread.posts.get(data.no)) && !post.isFetchedQuote) {\r\n          nodes.push(post.nodes.root);\r\n          continue;\r\n        }\r\n        nodes.push(node = g.SITE.Build.postFromObject(data, thread.board.ID));\r\n        try {\r\n          posts.push(new Post(node, thread, thread.board));\r\n        } catch (err) {\r\n          // Skip posts that we failed to parse.\r\n          if (!errors) { errors = []; }\r\n          errors.push({\r\n            message: `Parsing of Post No.${data.no} failed. Post will be skipped.`,\r\n            error: err,\r\n            html: node?.outerHTML\r\n          });\r\n        }\r\n      }\r\n      $.add(thread.nodes.root, nodes);\r\n    }\r\n\r\n    if (errors) { Main.handleErrors(errors); }\r\n    return posts;\r\n  },\r\n\r\n  buildCatalogViews(threads) {\r\n    const catalogThreads = [];\r\n    for (var thread of threads) {\r\n      if (!thread.catalogView) {\r\n        var {ID} = thread;\r\n        var page = Math.floor(Index.threadPosition[ID] / Index.threadsNumPerPage) + 1;\r\n        var root = g.SITE.Build.catalogThread(thread, Index.liveThreadDict[ID], page);\r\n        catalogThreads.push(new CatalogThread(root, thread));\r\n      }\r\n    }\r\n    Main.callbackNodes('CatalogThread', catalogThreads);\r\n  },\r\n\r\n  sizeCatalogViews(threads) {\r\n    // XXX When browsers support CSS3 attr(), use it instead.\r\n    const size = Conf['Index Size'] === 'small' ? 150 : 250;\r\n    for (var thread of threads) {\r\n      var {thumb} = thread.catalogView.nodes;\r\n      var {width, height} = thumb.dataset;\r\n      if (!width) { continue; }\r\n      var ratio = size / Math.max(width, height);\r\n      thumb.style.width  = (width  * ratio) + 'px';\r\n      thumb.style.height = (height * ratio) + 'px';\r\n    }\r\n  },\r\n\r\n  buildCatalogReplies(thread) {\r\n    let lastReplies;\r\n    const {nodes} = thread.catalogView;\r\n    if (!(lastReplies = Index.liveThreadDict[thread.ID].last_replies)) { return; }\r\n\r\n    const replies = [];\r\n    for (var data of lastReplies) {\r\n      if (Index.isHiddenReply(thread.ID, data)) { continue; }\r\n      var reply = g.SITE.Build.catalogReply(thread, data);\r\n      RelativeDates.update($('time', reply));\r\n      $.on($('.catalog-reply-preview', reply), 'mouseover', QuotePreview.mouseover);\r\n      replies.push(reply);\r\n    }\r\n\r\n    nodes.replies = $.el('div', {className: 'catalog-replies'});\r\n    $.add(nodes.replies, replies);\r\n    $.add(thread.OP.nodes.post, nodes.replies);\r\n  },\r\n\r\n  sort() {\r\n    let threadIDs;\r\n    const {liveThreadIDs, liveThreadData} = Index;\r\n    if (!liveThreadData) { return; }\r\n    const tmp_time = new Date().getTime()/1000;\r\n    const sortType = Index.currentSort.replace(/-rev$/, '');\r\n    Index.sortedThreadIDs = (() => { switch (sortType) {\r\n      case 'lastreply': case 'lastlong':\r\n        var repliesAvailable = liveThreadData.some(thread => thread.last_replies?.length);\r\n        var lastlong = function(thread) {\r\n          if (!repliesAvailable) {\r\n            return thread.last_modified;\r\n          }\r\n          const iterable = thread.last_replies || [];\r\n          for (let i = iterable.length - 1; i >= 0; i--) {\r\n            var r = iterable[i];\r\n            if (Index.isHiddenReply(thread.no, r)) { continue; }\r\n            if (sortType === 'lastreply') {\r\n              return r;\r\n            }\r\n            var len = r.com ? g.SITE.Build.parseComment(r.com).replace(/[^a-z]/ig, '').length : 0;\r\n            if (len >= Index.lastLongThresholds[+!!r.ext]) {\r\n              return r;\r\n            }\r\n          }\r\n          if (thread.omitted_posts && thread.last_replies?.length) { return thread.last_replies[0]; } else { return thread; }\r\n        };\r\n        var lastlongD = dict();\r\n        for (var thread of liveThreadData) {\r\n          lastlongD[thread.no] = lastlong(thread).no;\r\n        }\r\n        return [...liveThreadData].sort((a, b) => lastlongD[b.no] - lastlongD[a.no]).map(post => post.no);\r\n      case 'bump':       return liveThreadIDs;\r\n      case 'birth':      return [...liveThreadIDs ].sort((a, b) => b - a);\r\n      case 'replycount': return [...liveThreadData].sort((a, b) => b.replies - a.replies).map(post => post.no);\r\n      case 'filecount':  return [...liveThreadData].sort((a, b) => b.images  - a.images).map(post => post.no);\r\n      case 'activity':   return [...liveThreadData].sort((a, b) => ((tmp_time-a.time)/(a.replies+1)) - ((tmp_time-b.time)/(b.replies+1))).map(post => post.no);\r\n      default: return liveThreadIDs;\r\n    } })();\r\n    if (/-rev$/.test(Index.currentSort)) {\r\n      Index.sortedThreadIDs.reverse();\r\n    }\r\n    if (Index.search && (threadIDs = Index.querySearch(Index.search))) {\r\n      Index.sortedThreadIDs = threadIDs;\r\n    }\r\n    // Sticky threads\r\n    Index.sortOnTop(obj => obj.isSticky);\r\n    // Highlighted threads\r\n    Index.sortOnTop(obj => obj.isOnTop || (Conf['Pin Watched Threads'] && ThreadWatcher.isWatchedRaw(obj.boardID, obj.threadID)));\r\n    // Non-hidden threads\r\n    if (Conf['Anchor Hidden Threads']) { return Index.sortOnTop(obj => !Index.isHidden(obj.threadID)); }\r\n  },\r\n\r\n  sortOnTop(match) {\r\n    const topThreads    = [];\r\n    const bottomThreads = [];\r\n    for (var ID of Index.sortedThreadIDs) {\r\n      (match(Index.parsedThreads[ID]) ? topThreads : bottomThreads).push(ID);\r\n    }\r\n    return Index.sortedThreadIDs = topThreads.concat(bottomThreads);\r\n  },\r\n\r\n  buildIndex() {\r\n    let threadIDs;\r\n    if (!Index.liveThreadData) { return; }\r\n    switch (Conf['Index Mode']) {\r\n      case 'all pages':\r\n        threadIDs = Index.sortedThreadIDs;\r\n        break;\r\n      case 'catalog':\r\n        threadIDs = Index.sortedThreadIDs.filter(ID => !Index.isHidden(ID) !== Index.showHiddenThreads);\r\n        break;\r\n      default:\r\n        threadIDs = Index.threadsOnPage(Index.currentPage);\r\n    }\r\n    delete Index.pageNum;\r\n    $.rmAll(Index.root);\r\n    $.rmAll(Header.hover);\r\n    if (Index.loaded && Index.root.parentNode) {\r\n      $.event('PostsRemoved', null, Index.root);\r\n    }\r\n    if (Conf['Index Mode'] === 'catalog') {\r\n      Index.buildCatalog(threadIDs);\r\n    } else {\r\n      Index.buildStructure(threadIDs);\r\n    }\r\n  },\r\n\r\n  threadsOnPage(pageNum) {\r\n    const nodesPerPage = Index.threadsNumPerPage;\r\n    const offset = nodesPerPage * (pageNum - 1);\r\n    return Index.sortedThreadIDs.slice(offset ,  offset + nodesPerPage);\r\n  },\r\n\r\n  buildStructure(threadIDs) {\r\n    const threads = Index.buildThreads(threadIDs, false, Conf['Show Replies']);\r\n    const nodes = [];\r\n    for (var thread of threads) {\r\n      nodes.push(thread.nodes.root, $.el('hr'));\r\n    }\r\n    $.add(Index.root, nodes);\r\n    if (Index.root.parentNode) {\r\n      $.event('PostsInserted', null, Index.root);\r\n    }\r\n    Index.loaded = true;\r\n  },\r\n\r\n  buildCatalog(threadIDs) {\r\n    let i = 0;\r\n    const n = threadIDs.length;\r\n    let node0 = null;\r\n    var fn = function() {\r\n      if (node0 && !node0.parentNode) { return; } // Index.root cleared\r\n      const j = (i > 0) && Index.root.parentNode ? n : i + 30;\r\n      node0 = Index.buildCatalogPart(threadIDs.slice(i, j))[0];\r\n      i = j;\r\n      if (i < n) {\r\n        return $.queueTask(fn);\r\n      } else {\r\n        if (Index.root.parentNode) {\r\n          $.event('PostsInserted', null, Index.root);\r\n        }\r\n        return Index.loaded = true;\r\n      }\r\n    };\r\n    fn();\r\n  },\r\n\r\n  buildCatalogPart(threadIDs) {\r\n    const threads = Index.buildThreads(threadIDs, true);\r\n    Index.buildCatalogViews(threads);\r\n    Index.sizeCatalogViews(threads);\r\n    const nodes = [];\r\n    for (var thread of threads) {\r\n      thread.OP.setCatalogOP(true);\r\n      $.add(thread.catalogView.nodes.root, thread.OP.nodes.root);\r\n      nodes.push(thread.catalogView.nodes.root);\r\n      $.on(thread.catalogView.nodes.root, 'mouseenter', Index.cb.catalogReplies.bind(thread));\r\n      $.on(thread.OP.nodes.root, 'mouseenter', Index.cb.hoverAdjust.bind(thread.OP.nodes));\r\n    }\r\n    $.add(Index.root, nodes);\r\n    return nodes;\r\n  },\r\n\r\n  clearSearch() {\r\n    Index.searchInput.value = '';\r\n    Index.onSearchInput();\r\n    return Index.searchInput.focus();\r\n  },\r\n\r\n  setupSearch() {\r\n    Index.searchInput.value = Index.search;\r\n    if (Index.search) {\r\n      return Index.searchInput.dataset.searching = 1;\r\n    } else {\r\n      // XXX https://bugzilla.mozilla.org/show_bug.cgi?id=1021289\r\n      return Index.searchInput.removeAttribute('data-searching');\r\n    }\r\n  },\r\n\r\n  onSearchInput() {\r\n    const search = Index.searchInput.value.trim();\r\n    if (search === Index.search) { return; }\r\n    Index.pushState({\r\n      search,\r\n      replace: !!search === !!Index.search\r\n    });\r\n    return Index.pageLoad(false);\r\n  },\r\n\r\n  querySearch(query) {\r\n    let keywords, match;\r\n    if (match = query.match(/^([\\w+]+):\\/(.*)\\/(\\w*)$/)) {\r\n      let regexp;\r\n      try {\r\n        regexp = RegExp(match[2], match[3]);\r\n      } catch (error) {\r\n        return [];\r\n      }\r\n      return Index.sortedThreadIDs.filter(ID => regexp.test(Filter.values(match[1], Index.parsedThreads[ID]).join('\\n')));\r\n    }\r\n    if (!(keywords = query.toLowerCase().match(/\\S+/g))) { return; }\r\n    return Index.sortedThreadIDs.filter(ID => Index.searchMatch(Index.parsedThreads[ID], keywords));\r\n  },\r\n\r\n  searchMatch(obj, keywords) {\r\n    const {info, file} = obj;\r\n    if (info.comment == null) { info.comment = g.SITE.Build.parseComment(info.commentHTML.innerHTML); }\r\n    let text = [];\r\n    for (var key of ['comment', 'subject', 'name', 'tripcode']) {\r\n      if (key in info) { text.push(info[key]); }\r\n    }\r\n    if (file) { text.push(file.name); }\r\n    text = text.join(' ').toLowerCase();\r\n    for (var keyword of keywords) {\r\n      if (-1 === text.indexOf(keyword)) { return false; }\r\n    }\r\n    return true;\r\n  }\r\n};\r\nexport default Index;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport DataBoard from \"../classes/DataBoard\";\r\nimport Thread from \"../classes/Thread\";\r\nimport Index from \"../General/Index\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf, d, doc } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport Menu from \"../Menu/Menu\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ThreadHiding = {\r\n  init() {\r\n    if (!['index', 'catalog'].includes(g.VIEW) || (!Conf['Thread Hiding Buttons'] && !(Conf['Menu'] && Conf['Thread Hiding Link']) && !Conf['JSON Index'])) { return; }\r\n    this.db = new DataBoard('hiddenThreads');\r\n    if (g.VIEW === 'catalog') { return this.catalogWatch(); }\r\n    this.catalogSet(g.BOARD);\r\n    $.on(d, 'IndexRefreshInternal', this.onIndexRefresh);\r\n    if (Conf['Thread Hiding Buttons']) {\r\n      $.addClass(doc, 'thread-hide');\r\n    }\r\n    return Callbacks.Post.push({\r\n      name: 'Thread Hiding',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  catalogSet(board) {\r\n    if (!$.hasStorage || (g.SITE.software !== 'yotsuba')) { return; }\r\n    const hiddenThreads = ThreadHiding.db.get({\r\n      boardID: board.ID,\r\n      defaultValue: dict()\r\n    });\r\n    for (var threadID in hiddenThreads) { hiddenThreads[threadID] = true; }\r\n    return localStorage.setItem(`4chan-hide-t-${board}`, JSON.stringify(hiddenThreads));\r\n  },\r\n\r\n  catalogWatch() {\r\n    if (!$.hasStorage || (g.SITE.software !== 'yotsuba')) { return; }\r\n    this.hiddenThreads = JSON.parse(localStorage.getItem(`4chan-hide-t-${g.BOARD}`)) || {};\r\n    return Main.ready(() => // 4chan's catalog sets the style to \"display: none;\" when hiding or unhiding a thread.\r\n    new MutationObserver(ThreadHiding.catalogSave).observe($.id('threads'), {\r\n      attributes: true,\r\n      subtree: true,\r\n      attributeFilter: ['style']\r\n    }));\r\n  },\r\n\r\n  catalogSave() {\r\n    let threadID;\r\n    const hiddenThreads2 = JSON.parse(localStorage.getItem(`4chan-hide-t-${g.BOARD}`)) || {};\r\n    for (threadID in hiddenThreads2) {\r\n      if (!$.hasOwn(ThreadHiding.hiddenThreads, threadID)) {\r\n        ThreadHiding.db.set({\r\n          boardID:  g.BOARD.ID,\r\n          threadID,\r\n          val:      {makeStub: Conf['Stubs']}});\r\n      }\r\n    }\r\n    for (threadID in ThreadHiding.hiddenThreads) {\r\n      if (!$.hasOwn(hiddenThreads2, threadID)) {\r\n        ThreadHiding.db.delete({\r\n          boardID:  g.BOARD.ID,\r\n          threadID\r\n        });\r\n      }\r\n    }\r\n    return ThreadHiding.hiddenThreads = hiddenThreads2;\r\n  },\r\n\r\n  isHidden(boardID, threadID) {\r\n    return !!(ThreadHiding.db && ThreadHiding.db.get({boardID, threadID}));\r\n  },\r\n\r\n  node() {\r\n    let data;\r\n    if (this.isReply || this.isClone || this.isFetchedQuote) { return; }\r\n\r\n    if (Conf['Thread Hiding Buttons']) {\r\n      $.prepend(this.nodes.root, ThreadHiding.makeButton(this.thread, 'hide'));\r\n    }\r\n\r\n    if (data = ThreadHiding.db.get({boardID: this.board.ID, threadID: this.ID})) {\r\n      return ThreadHiding.hide(this.thread, data.makeStub);\r\n    }\r\n  },\r\n\r\n  onIndexRefresh() {\r\n    return g.BOARD.threads.forEach(function(thread) {\r\n      const {root} = thread.nodes;\r\n      if (thread.isHidden && thread.stub && !root.contains(thread.stub)) {\r\n        return ThreadHiding.makeStub(thread, root);\r\n      }\r\n    });\r\n  },\r\n\r\n  menu: {\r\n    init() {\r\n      if ((g.VIEW !== 'index') || !Conf['Menu'] || !Conf['Thread Hiding Link']) { return; }\r\n\r\n      let div = $.el('div', {\r\n        className: 'hide-thread-link',\r\n        textContent: 'Hide'\r\n      }\r\n      );\r\n\r\n      const apply = $.el('a', {\r\n        textContent: 'Apply',\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.on(apply, 'click', ThreadHiding.menu.hide);\r\n\r\n      const makeStub = UI.checkbox('Stubs', 'Make stub');\r\n\r\n      Menu.menu.addEntry({\r\n        el: div,\r\n        order: 20,\r\n        open({thread, isReply}) {\r\n          if (isReply || thread.isHidden || (Conf['JSON Index'] && (Conf['Index Mode'] === 'catalog'))) {\r\n            return false;\r\n          }\r\n          ThreadHiding.menu.thread = thread;\r\n          return true;\r\n        },\r\n        subEntries: [{el: apply}, {el: makeStub}]});\r\n\r\n      div = $.el('a', {\r\n        className: 'show-thread-link',\r\n        textContent: 'Show',\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.on(div, 'click', ThreadHiding.menu.show);\r\n\r\n      Menu.menu.addEntry({\r\n        el: div,\r\n        order: 20,\r\n        open({thread, isReply}) {\r\n          if (isReply || !thread.isHidden || (Conf['JSON Index'] && (Conf['Index Mode'] === 'catalog'))) {\r\n            return false;\r\n          }\r\n          ThreadHiding.menu.thread = thread;\r\n          return true;\r\n        }\r\n      });\r\n\r\n      const hideStubLink = $.el('a', {\r\n        textContent: 'Hide stub',\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.on(hideStubLink, 'click', ThreadHiding.menu.hideStub);\r\n\r\n      return Menu.menu.addEntry({\r\n        el: hideStubLink,\r\n        order: 15,\r\n        open({thread, isReply}) {\r\n          if (isReply || !thread.isHidden || (Conf['JSON Index'] && (Conf['Index Mode'] === 'catalog'))) {\r\n            return false;\r\n          }\r\n          return ThreadHiding.menu.thread = thread;\r\n        }\r\n      });\r\n    },\r\n\r\n    hide() {\r\n      const makeStub = $('input', this.parentNode).checked;\r\n      const {thread} = ThreadHiding.menu;\r\n      ThreadHiding.hide(thread, makeStub);\r\n      ThreadHiding.saveHiddenState(thread, makeStub);\r\n      return $.event('CloseMenu');\r\n    },\r\n\r\n    show() {\r\n      const {thread} = ThreadHiding.menu;\r\n      ThreadHiding.show(thread);\r\n      ThreadHiding.saveHiddenState(thread);\r\n      return $.event('CloseMenu');\r\n    },\r\n\r\n    hideStub() {\r\n      const {thread} = ThreadHiding.menu;\r\n      ThreadHiding.show(thread);\r\n      ThreadHiding.hide(thread, false);\r\n      ThreadHiding.saveHiddenState(thread, false);\r\n      $.event('CloseMenu');\r\n    }\r\n  },\r\n\r\n  makeButton(thread, type) {\r\n    const a = $.el('a', {\r\n      className: `${type}-thread-button`,\r\n      href:      'javascript:;'\r\n    });\r\n    $.add(a, $.el('span', { textContent: type === 'hide' ? '➖︎' : '➕︎' }));\r\n    a.dataset.fullID = thread.fullID;\r\n    $.on(a, 'click', ThreadHiding.toggle);\r\n    return a;\r\n  },\r\n\r\n  makeStub(thread, root) {\r\n    let summary, threadDivider;\r\n    let numReplies  = $$(g.SITE.selectors.replyOriginal, root).length;\r\n    if (summary = $(g.SITE.selectors.summary, root)) { numReplies += +summary.textContent.match(/\\d+/); }\r\n\r\n    const a = ThreadHiding.makeButton(thread, 'show');\r\n    $.add(a, $.tn(` ${thread.OP.info.nameBlock} (${numReplies === 1 ? '1 reply' : `${numReplies} replies`})`));\r\n    thread.stub = $.el('div',\r\n      {className: 'stub'});\r\n    if (Conf['Menu']) {\r\n      $.add(thread.stub, [a, Menu.makeButton(thread.OP)]);\r\n    } else {\r\n      $.add(thread.stub, a);\r\n    }\r\n    $.prepend(root, thread.stub);\r\n\r\n    // Prevent hiding of thread divider on sites that put it inside the thread\r\n    if (threadDivider = $(g.SITE.selectors.threadDivider, root)) {\r\n      return $.addClass(threadDivider, 'threadDivider');\r\n    }\r\n  },\r\n\r\n  saveHiddenState(thread, makeStub) {\r\n    if (thread.isHidden) {\r\n      ThreadHiding.db.set({\r\n        boardID:  thread.board.ID,\r\n        threadID: thread.ID,\r\n        val: {makeStub}});\r\n    } else {\r\n      ThreadHiding.db.delete({\r\n        boardID:  thread.board.ID,\r\n        threadID: thread.ID\r\n      });\r\n    }\r\n    return ThreadHiding.catalogSet(thread.board);\r\n  },\r\n\r\n  toggle(thread) {\r\n    if (!(thread instanceof Thread)) {\r\n      thread = g.threads.get(this.dataset.fullID);\r\n    }\r\n    if (thread.isHidden) {\r\n      ThreadHiding.show(thread);\r\n    } else {\r\n      ThreadHiding.hide(thread);\r\n    }\r\n    return ThreadHiding.saveHiddenState(thread);\r\n  },\r\n\r\n  hide(thread, makeStub=Conf['Stubs']) {\r\n    if (thread.isHidden) { return; }\r\n    const threadRoot = thread.nodes.root;\r\n    thread.isHidden = true;\r\n    Index.updateHideLabel();\r\n    if (thread.catalogView && !Index.showHiddenThreads) {\r\n      $.rm(thread.catalogView.nodes.root);\r\n      $.event('PostsRemoved', null, Index.root);\r\n    }\r\n\r\n    if (!makeStub) { return threadRoot.hidden = true; }\r\n\r\n    return ThreadHiding.makeStub(thread, threadRoot);\r\n  },\r\n\r\n  show(thread) {\r\n    if (thread.stub) {\r\n      $.rm(thread.stub);\r\n      delete thread.stub;\r\n    }\r\n    const threadRoot = thread.nodes.root;\r\n    threadRoot.hidden = (thread.isHidden = false);\r\n    Index.updateHideLabel();\r\n    if (thread.catalogView && Index.showHiddenThreads) {\r\n      $.rm(thread.catalogView.nodes.root);\r\n      return $.event('PostsRemoved', null, Index.root);\r\n    }\r\n  }\r\n};\r\nexport default ThreadHiding;\r\n",null,null,null,"import $ from \"../platform/$\";\r\nimport CSS from \"../css/CSS\";\r\nimport { Conf } from \"../globals/globals\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst CustomCSS = {\r\n  init() {\r\n    if (!Conf['Custom CSS']) { return; }\r\n    return this.addStyle();\r\n  },\r\n\r\n  addStyle() {\r\n    return this.style = $.addStyle(CSS.sub(Conf['usercss']), 'custom-css', '#fourchanx-css');\r\n  },\r\n\r\n  rmStyle() {\r\n    if (this.style) {\r\n      $.rm(this.style);\r\n      return delete this.style;\r\n    }\r\n  },\r\n\r\n  update() {\r\n    if (!this.style) {\r\n      return this.addStyle();\r\n    }\r\n    return this.style.textContent = CSS.sub(Conf['usercss']);\r\n  }\r\n};\r\nexport default CustomCSS;\r\n","import { Conf, d } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst SWTinyboard = {\r\n  isOPContainerThread: true,\r\n  mayLackJSON: true,\r\n  threadModTimeIgnoresSage: true,\r\n\r\n  disabledFeatures: [\r\n    'Resurrect Quotes',\r\n    'Quick Reply Personas',\r\n    'Quick Reply',\r\n    'Cooldown',\r\n    'Report Link',\r\n    'Delete Link',\r\n    'Edit Link',\r\n    'Quote Inlining',\r\n    'Quote Previewing',\r\n    'Quote Backlinks',\r\n    'File Info Formatting',\r\n    'Image Expansion',\r\n    'Image Expansion (Menu)',\r\n    'Comment Expansion',\r\n    'Thread Expansion',\r\n    'Favicon',\r\n    'Quote Threading',\r\n    'Thread Updater',\r\n    'Banner',\r\n    'Flash Features',\r\n    'Reply Pruning'\r\n  ],\r\n\r\n  detect() {\r\n    for (var script of $$('script:not([src])', d.head)) {\r\n      var m;\r\n      if (m = script.textContent.match(/\\bvar configRoot=(\".*?\")/)) {\r\n        var properties = dict();\r\n        try {\r\n          var root = JSON.parse(m[1]);\r\n          if (root[0] === '/') {\r\n            properties.root = location.origin + root;\r\n          } else if (/^https?:/.test(root)) {\r\n            properties.root = root;\r\n          }\r\n        } catch (error) {}\r\n        return properties;\r\n      }\r\n    }\r\n    return false;\r\n  },\r\n\r\n  awaitBoard(cb) {\r\n    let reactUI;\r\n    if (reactUI = $.id('react-ui')) {\r\n      const s = (this.selectors = Object.create(this.selectors));\r\n      s.boardFor = {index: '.page-container'};\r\n      s.thread = 'div[id^=\"thread_\"]';\r\n      return Main.mounted(cb);\r\n    } else {\r\n      return cb();\r\n    }\r\n  },\r\n\r\n  urls: {\r\n    thread({siteID, boardID, threadID}, isArchived) {\r\n      return `${Conf['siteProperties'][siteID]?.root || `http://${siteID}/`}${boardID}/${isArchived ? 'archive/' : ''}res/${threadID}.html`;\r\n    },\r\n    post({postID})                   { return `#${postID}`; },\r\n    index({siteID, boardID})          { return `${Conf['siteProperties'][siteID]?.root || `http://${siteID}/`}${boardID}/`; },\r\n    catalog({siteID, boardID})          { return `${Conf['siteProperties'][siteID]?.root || `http://${siteID}/`}${boardID}/catalog.html`; },\r\n    threadJSON({siteID, boardID, threadID}, isArchived) {\r\n      const root = Conf['siteProperties'][siteID]?.root;\r\n      if (root) { return `${root}${boardID}/${isArchived ? 'archive/' : ''}res/${threadID}.json`; } else { return ''; }\r\n    },\r\n    archivedThreadJSON(thread) {\r\n      return SWTinyboard.urls.threadJSON(thread, true);\r\n    },\r\n    threadsListJSON({siteID, boardID}) {\r\n      const root = Conf['siteProperties'][siteID]?.root;\r\n      if (root) { return `${root}${boardID}/threads.json`; } else { return ''; }\r\n    },\r\n    archiveListJSON({siteID, boardID}) {\r\n      const root = Conf['siteProperties'][siteID]?.root;\r\n      if (root) { return `${root}${boardID}/archive/archive.json`; } else { return ''; }\r\n    },\r\n    catalogJSON({siteID, boardID}) {\r\n      const root = Conf['siteProperties'][siteID]?.root;\r\n      if (root) { return `${root}${boardID}/catalog.json`; } else { return ''; }\r\n    },\r\n    file({siteID, boardID}, filename) {\r\n      return `${Conf['siteProperties'][siteID]?.root || `http://${siteID}/`}${boardID}/${filename}`;\r\n    },\r\n    thumb(board, filename) {\r\n      return SWTinyboard.urls.file(board, filename);\r\n    }\r\n  },\r\n\r\n  selectors: {\r\n    board:         'form[name=\"postcontrols\"]',\r\n    thread:        'input[name=\"board\"] ~ div[id^=\"thread_\"]',\r\n    threadDivider: 'div[id^=\"thread_\"] > hr:last-child',\r\n    summary:       '.omitted',\r\n    postContainer: 'div[id^=\"reply_\"]:not(.hidden)', // postContainer is thread for OP\r\n    opBottom:      '.op',\r\n    replyOriginal: 'div[id^=\"reply_\"]:not(.hidden)',\r\n    infoRoot:      '.intro',\r\n    info: {\r\n      subject:   '.subject',\r\n      name:      '.name',\r\n      email:     '.email',\r\n      tripcode:  '.trip',\r\n      uniqueID:  '.poster_id',\r\n      capcode:   '.capcode',\r\n      flag:      '.flag',\r\n      date:      'time',\r\n      nameBlock: 'label',\r\n      quote:     'a[href*=\"#q\"]',\r\n      reply:     'a[href*=\"/res/\"]:not([href*=\"#\"])'\r\n    },\r\n    icons: {\r\n      isSticky:   '.fa-thumb-tack',\r\n      isClosed:   '.fa-lock'\r\n    },\r\n    file: {\r\n      text:  '.fileinfo',\r\n      link:  '.fileinfo > a',\r\n      thumb: 'a > .post-image'\r\n    },\r\n    thumbLink: '.file > a',\r\n    multifile: '.files > .file',\r\n    highlightable: {\r\n      op:      ' > .op',\r\n      reply:   '.reply',\r\n      catalog: ' > .thread'\r\n    },\r\n    comment:   '.body',\r\n    spoiler:   '.spoiler',\r\n    quotelink: 'a[onclick*=\"highlightReply(\"]',\r\n    catalog: {\r\n      board:  '#Grid',\r\n      thread: '.mix',\r\n      thumb:  '.thread-image'\r\n    },\r\n    boardList: '.boardlist',\r\n    boardListBottom: '.boardlist.bottom',\r\n    styleSheet: '#stylesheet',\r\n    psa:       '.blotter',\r\n    nav: {\r\n      prev: '.pages > form > [value=Previous]',\r\n      next: '.pages > form > [value=Next]'\r\n    }\r\n  },\r\n\r\n  classes: {\r\n    highlight: 'highlighted'\r\n  },\r\n\r\n  xpath: {\r\n    thread:         'div[starts-with(@id,\"thread_\")]',\r\n    postContainer:  'div[starts-with(@id,\"reply_\") or starts-with(@id,\"thread_\")]',\r\n    replyContainer: 'div[starts-with(@id,\"reply_\")]'\r\n  },\r\n\r\n  regexp: {\r\n    quotelink:\r\n      new RegExp(`\\\r\n/\\\r\n([^/]+)\\\r\n/res/\\\r\n(\\\\d+)\\\r\n(?:\\\\.\\\\w+)?#\\\r\n(\\\\d+)\\\r\n$\\\r\n`),\r\n    quotelinkHTML:\r\n      /<a [^>]*\\bhref=\"[^\"]*\\/([^\\/]+)\\/res\\/(\\d+)(?:\\.\\w+)?#(\\d+)\"/g\r\n  },\r\n\r\n  Build: {\r\n    parseJSON(data, board) {\r\n      const o = this.parseJSON(data, board);\r\n      if (data.ext === 'deleted') {\r\n        delete o.file;\r\n        $.extend(o, {\r\n          files: [],\r\n          fileDeleted: true,\r\n          filesDeleted: [0]\r\n        });\r\n      }\r\n      if (data.extra_files) {\r\n        let file;\r\n        for (let i = 0; i < data.extra_files.length; i++) {\r\n          var extra_file = data.extra_files[i];\r\n          if (extra_file.ext === 'deleted') {\r\n            o.filesDeleted.push(i);\r\n          } else {\r\n            file = this.parseJSONFile(data, board);\r\n            o.files.push(file);\r\n          }\r\n        }\r\n        if (o.files.length) {\r\n          o.file = o.files[0];\r\n        }\r\n      }\r\n      return o;\r\n    },\r\n\r\n    parseComment(html) {\r\n      html = html\r\n        .replace(/<br\\b[^<]*>/gi, '\\n')\r\n        .replace(/<[^>]*>/g, '');\r\n      return $.unescape(html);\r\n    }\r\n  },\r\n\r\n  bgColoredEl() {\r\n    return $.el('div', {className: 'post reply'});\r\n  },\r\n\r\n  isFileURL(url) {\r\n    return /\\/src\\/[^\\/]+/.test(url.pathname);\r\n  },\r\n\r\n  preParsingFixes(board) {\r\n    // fixes effects of unclosed link in announcement\r\n    let broken;\r\n    if (broken = $('a > input[name=\"board\"]', board)) {\r\n      return $.before(broken.parentNode, broken);\r\n    }\r\n  },\r\n\r\n  parseNodes(post, nodes) {\r\n    // Add vichan's span.poster_id around the ID if not already present.\r\n    let m;\r\n    if (nodes.uniqueID) { return; }\r\n    let text = '';\r\n    let node = nodes.nameBlock.nextSibling;\r\n    while (node && (node.nodeType === 3)) {\r\n      text += node.textContent;\r\n      node = node.nextSibling;\r\n    }\r\n    if (m = text.match(/(\\s*ID:\\s*)(\\S+)/)) {\r\n      let uniqueID;\r\n      nodes.info.normalize();\r\n      let {nextSibling} = nodes.nameBlock;\r\n      nextSibling = nextSibling.splitText(m[1].length);\r\n      nextSibling.splitText(m[2].length);\r\n      nodes.uniqueID = (uniqueID = $.el('span', {className: 'poster_id'}));\r\n      $.replace(nextSibling, uniqueID);\r\n      return $.add(uniqueID, nextSibling);\r\n    }\r\n  },\r\n\r\n  parseDate(node) {\r\n    let date = Date.parse(node.getAttribute('datetime')?.trim());\r\n    if (!isNaN(date)) { return new Date(date); }\r\n    date = Date.parse(node.textContent.trim() + ' UTC'); // e.g. onesixtwo.club\r\n    if (!isNaN(date)) { return new Date(date); }\r\n    return undefined;\r\n  },\r\n\r\n  parseFile(post, file) {\r\n    let info, infoNode;\r\n    const {text, link, thumb} = file;\r\n    if ($.x(`ancestor::${this.xpath.postContainer}[1]`, text) !== post.nodes.root) { return false; } // file belongs to a reply\r\n    if (!(infoNode = link.nextSibling?.textContent.includes('(') ? link.nextSibling : link.nextElementSibling)) { return false; }\r\n    if (!(info = infoNode.textContent.match(/\\((.*,\\s*)?([\\d.]+ ?[KMG]?B).*\\)/))) { return false; }\r\n    const nameNode = $('.postfilename', text);\r\n    $.extend(file, {\r\n      name:       nameNode ? (nameNode.title || nameNode.textContent) : link.pathname.match(/[^/]*$/)[0],\r\n      size:       info[2],\r\n      dimensions: info[0].match(/\\d+x\\d+/)?.[0]\r\n    });\r\n    if (thumb) {\r\n      $.extend(file, {\r\n        thumbURL:  /\\/static\\//.test(thumb.src) && $.isImage(link.href) ? link.href : thumb.src,\r\n        isSpoiler: /^Spoiler/i.test(info[1] || '') || (link.textContent === 'Spoiler Image')\r\n      }\r\n      );\r\n    }\r\n    return true;\r\n  },\r\n\r\n  isThumbExpanded(file) {\r\n    // Detect old Tinyboard image expansion that changes src attribute on thumbnail.\r\n    return $.hasClass(file.thumb.parentNode, 'expanded') || (file.thumb.parentNode.dataset.expanded === 'true');\r\n  },\r\n\r\n  isLinkified(link) {\r\n    return /\\bnofollow\\b/.test(link.rel);\r\n  },\r\n\r\n  catalogPin(threadRoot) {\r\n    return threadRoot.dataset.sticky = 'true';\r\n  }\r\n};\r\nexport default SWTinyboard;\r\n",null,"import { Conf, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport PassMessagePage from './PassMessage/PassMessageHtml';\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n\r\nconst PassMessage = {\r\n  init() {\r\n    if (Conf['passMessageClosed']) { return; }\r\n    const msg = $.el('div',\r\n      {className: 'box-outer top-box'}\r\n    ,\r\n      PassMessagePage);\r\n    msg.style.cssText = 'padding-bottom: 0;';\r\n    const close = $('a', msg);\r\n    $.on(close, 'click', function() {\r\n      $.rm(msg);\r\n      return $.set('passMessageClosed', true);\r\n    });\r\n    return $.ready(function() {\r\n      let hd;\r\n      if (hd = $.id('hd')) {\r\n        return $.after(hd, msg);\r\n      } else {\r\n        return $.prepend(d.body, msg);\r\n      }\r\n    });\r\n  }\r\n};\r\nexport default PassMessage;\r\n","import Redirect from \"../Archive/Redirect\";\r\nimport $ from \"../platform/$\";\r\nimport ReportPage from './Report/ArchiveReport.html';\r\nimport CSS from \"../css/CSS\";\r\nimport Captcha from \"../Posting/Captcha\";\r\nimport { Conf, d, doc, g } from \"../globals/globals\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n\r\nvar Report = {\r\n  init() {\r\n    let match;\r\n    if (!(match = location.search.match(/\\bno=(\\d+)/))) { return; }\r\n    Captcha.replace.init();\r\n    this.postID = +match[1];\r\n    return $.ready(this.ready);\r\n  },\r\n\r\n  ready() {\r\n    $.addStyle(CSS.report);\r\n\r\n    if (Conf['Archive Report']) { Report.archive(); }\r\n\r\n    new MutationObserver(function() {\r\n      Report.fit('iframe[src^=\"https://www.google.com/recaptcha/api2/frame\"]');\r\n      return Report.fit('body');\r\n    }).observe(d.body, {\r\n      childList:  true,\r\n      attributes: true,\r\n      subtree:    true\r\n    }\r\n    );\r\n    return Report.fit('body');\r\n  },\r\n\r\n  fit(selector) {\r\n    let el;\r\n    if (!((el = $(selector, doc)) && (getComputedStyle(el).visibility !== 'hidden'))) { return; }\r\n    const dy = (el.getBoundingClientRect().bottom - doc.clientHeight) + 8;\r\n    if (dy > 0) { return window.resizeBy(0, dy); }\r\n  },\r\n\r\n  archive() {\r\n    let match, urls;\r\n    if (!(urls = Redirect.report(g.BOARD.ID)).length) { return; }\r\n\r\n    const form    = $('form');\r\n    const types   = $.id('reportTypes');\r\n    const message = $('h3');\r\n\r\n    const fieldset = $.el('fieldset', {\r\n      id: 'archive-report',\r\n      hidden: true\r\n    }\r\n    ,\r\n      { innerHTML: ReportPage });\r\n    const enabled = $('#archive-report-enabled', fieldset);\r\n    const reason  = $('#archive-report-reason',  fieldset);\r\n    const submit  = $('#archive-report-submit',  fieldset);\r\n\r\n    $.on(enabled, 'change', function() {\r\n      return reason.disabled = !this.checked;\r\n    });\r\n\r\n    if (form && types) {\r\n      fieldset.hidden = !$('[value=\"31\"]', types).checked;\r\n      $.on(types, 'change', function(e) {\r\n        fieldset.hidden = (e.target.value !== '31');\r\n        return Report.fit('body');\r\n      });\r\n      $.after(types, fieldset);\r\n      Report.fit('body');\r\n      $.one(form, 'submit', function(e) {\r\n        if (!fieldset.hidden && enabled.checked) {\r\n          e.preventDefault();\r\n          return Report.archiveSubmit(urls, reason.value, results => {\r\n            this.action = '#archiveresults=' + encodeURIComponent(JSON.stringify(results));\r\n            return this.submit();\r\n          });\r\n        }\r\n      });\r\n    } else if (message) {\r\n      fieldset.hidden = /Report submitted!/.test(message.textContent);\r\n      $.on(enabled, 'change', function() {\r\n        return submit.hidden = !this.checked;\r\n      });\r\n      $.after(message, fieldset);\r\n      $.on(submit, 'click', () => Report.archiveSubmit(urls, reason.value, Report.archiveResults));\r\n    }\r\n\r\n    if (match = location.hash.match(/^#archiveresults=(.*)$/)) {\r\n      try {\r\n        return Report.archiveResults(JSON.parse(decodeURIComponent(match[1])));\r\n      } catch (error) {}\r\n    }\r\n  },\r\n\r\n  archiveSubmit(urls, reason, cb) {\r\n    const form = $.formData({\r\n      board:  g.BOARD.ID,\r\n      num:    Report.postID,\r\n      reason\r\n    });\r\n    const results = [];\r\n    for (var [name, url] of urls) {\r\n      (function(name, url) {\r\n        return $.ajax(url, {\r\n          onloadend() {\r\n            results.push([name, this.response || {error: ''}]);\r\n            if (results.length === urls.length) {\r\n              return cb(results);\r\n            }\r\n          },\r\n          form\r\n        });\r\n      })(name, url);\r\n    }\r\n  },\r\n\r\n  archiveResults(results) {\r\n    const fieldset = $.id('archive-report');\r\n    for (var [name, response] of results) {\r\n      var line = $.el('h3',\r\n        {className: 'archive-report-response'});\r\n      if ('success' in response) {\r\n        $.addClass(line, 'archive-report-success');\r\n        line.textContent = `${name}: ${response.success}`;\r\n      } else {\r\n        $.addClass(line, 'archive-report-error');\r\n        line.textContent = `${name}: ${response.error || 'Error reporting post.'}`;\r\n      }\r\n      if (fieldset) {\r\n        $.before(fieldset, line);\r\n      } else {\r\n        $.add(d.body, line);\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default Report;\r\n","import DataBoard from \"../classes/DataBoard\";\r\nimport { Conf, d, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst PostSuccessful = {\r\n  init() {\r\n    if (!Conf['Remember Your Posts']) { return; }\r\n    return $.ready(this.ready);\r\n  },\r\n\r\n  ready() {\r\n    if (d.title !== 'Post successful!') { return; }\r\n\r\n    let [_, threadID, postID] = $('h1').nextSibling.textContent.match(/thread:(\\d+),no:(\\d+)/);\r\n    postID   = +postID;\r\n    threadID = +threadID || postID;\r\n\r\n    const db = new DataBoard('yourPosts');\r\n    return db.set({\r\n      boardID: g.BOARD.ID,\r\n      threadID,\r\n      postID,\r\n      val: true\r\n    });\r\n  }\r\n};\r\nexport default PostSuccessful;\r\n",null,null,null,null,"import SWTinyboard from \"./SW.tinyboard\";\r\nimport SWYotsuba from \"./SW.yotsuba\";\r\n\r\nconst SW = { tinyboard: SWTinyboard, yotsuba: SWYotsuba };\r\nexport default SW;\r\n",null,null,null,null,"import Callbacks from \"../classes/Callbacks\";\r\nimport Header from \"../General/Header\";\r\nimport UI from \"../General/UI\";\r\nimport { Conf, doc, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar FappeTyme = {\r\n  init() {\r\n    if ((!Conf['Fappe Tyme'] && !Conf['Werk Tyme']) || !['index', 'thread', 'archive'].includes(g.VIEW)) { return; }\r\n\r\n    this.nodes = {};\r\n    this.enabled = {\r\n      fappe: false,\r\n      werk:  Conf['werk']\r\n    };\r\n\r\n    for (var type of [\"Fappe\", \"Werk\"]) {\r\n      if (Conf[`${type} Tyme`]) {\r\n        var lc = type.toLowerCase();\r\n        var el = UI.checkbox(lc, `${type} Tyme`, false);\r\n        el.title = `${type} Tyme`;\r\n\r\n        this.nodes[lc] = el.firstElementChild;\r\n        if (Conf[lc]) { this.set(lc, true); }\r\n        $.on(this.nodes[lc], 'change', this.toggle.bind(this, lc));\r\n\r\n        Header.menu.addEntry({\r\n          el,\r\n          order: 97\r\n        });\r\n\r\n        var indicator = $.el('span', {\r\n          className: 'indicator',\r\n          textContent: type[0],\r\n          title: `${type} Tyme active`\r\n        }\r\n        );\r\n        $.on(indicator, 'click', function() {\r\n          const check = $.getOwn(FappeTyme.nodes, this.parentNode.id.replace('shortcut-', ''));\r\n          check.checked = !check.checked;\r\n          return $.event('change', null, check);\r\n        });\r\n        Header.addShortcut(lc, indicator, 410);\r\n      }\r\n    }\r\n\r\n    if (Conf['Werk Tyme']) {\r\n      $.sync('werk', this.set.bind(this, 'werk'));\r\n    }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Fappe Tyme',\r\n      cb:   this.node\r\n    });\r\n\r\n    return Callbacks.CatalogThread.push({\r\n      name: 'Werk Tyme',\r\n      cb:   this.catalogNode\r\n    });\r\n  },\r\n\r\n  node() {\r\n    return this.nodes.root.classList.toggle('noFile', !this.files.length);\r\n  },\r\n\r\n  catalogNode() {\r\n    const file = this.thread.OP.files[0];\r\n    if (!file) { return; }\r\n    const filename = $.el('div', {\r\n      textContent: file.name,\r\n      className:   'werkTyme-filename'\r\n    }\r\n    );\r\n    return $.add(this.nodes.thumb.parentNode, filename);\r\n  },\r\n\r\n  set(type, enabled) {\r\n    this.enabled[type] = (this.nodes[type].checked = enabled);\r\n    return $[`${enabled ? 'add' : 'rm'}Class`](doc, `${type}Tyme`);\r\n  },\r\n\r\n  toggle(type) {\r\n    this.set(type, !this.enabled[type]);\r\n    if (type === 'werk') { return $.cb.checked.call(this.nodes[type]); }\r\n  }\r\n};\r\nexport default FappeTyme;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Notice from \"../classes/Notice\";\r\nimport Filter from \"../Filtering/Filter\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS204: Change includes calls to have a more natural evaluation order\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Sauce = {\r\n  init() {\r\n    let link;\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Sauce']) { return; }\r\n    $.addClass(doc, 'show-sauce');\r\n\r\n    const links = [];\r\n    for (link of Conf['sauces'].split('\\n')) {\r\n      var linkData;\r\n      if ((link[0] !== '#') && (linkData = this.parseLink(link))) {\r\n        links.push(linkData);\r\n      }\r\n    }\r\n    if (!links.length) { return; }\r\n\r\n    this.links = links;\r\n    this.link  = $.el('a', {\r\n      target:    '_blank',\r\n      className: 'sauce'\r\n    }\r\n    );\r\n    return Callbacks.Post.push({\r\n      name: 'Sauce',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  parseLink(link) {\r\n    if (!(link = link.trim())) { return null; }\r\n    const parts = dict();\r\n    const iterable = link.split(/;(?=(?:text|boards|types|regexp|sandbox):?)/);\r\n    for (let i = 0; i < iterable.length; i++) {\r\n      var part = iterable[i];\r\n      if (i === 0) {\r\n        parts['url'] = part;\r\n      } else {\r\n        var m = part.match(/^(\\w*):?(.*)$/);\r\n        parts[m[1]] = m[2];\r\n      }\r\n    }\r\n    if (!parts['text']) { parts['text'] = parts['url'].match(/(\\w+)\\.\\w+\\//)?.[1] || '?'; }\r\n    if ('boards' in parts) {\r\n      parts['boards'] = Filter.parseBoards(parts['boards']);\r\n    }\r\n    if ('regexp' in parts) {\r\n      try {\r\n        let regexp;\r\n        if (regexp = parts['regexp'].match(/^\\/(.*)\\/(\\w*)$/)) {\r\n          parts['regexp'] = RegExp(regexp[1], regexp[2]);\r\n        } else {\r\n          parts['regexp'] = RegExp(parts['regexp']);\r\n        }\r\n      } catch (err) {\r\n        new Notice('warning', [\r\n          $.tn(\"Invalid regexp for Sauce link:\"),\r\n          $.el('br'),\r\n          $.tn(link),\r\n          $.el('br'),\r\n          $.tn(err.message)\r\n        ], 60);\r\n        return null;\r\n      }\r\n    }\r\n    return parts;\r\n  },\r\n\r\n  createSauceLink(link, post, file) {\r\n    let a, matches, needle;\r\n    const ext = file.url.match(/[^.]*$/)[0];\r\n    const parts = dict();\r\n    $.extend(parts, link);\r\n\r\n    if (!!parts['boards'] && !parts['boards'][`${post.siteID}/${post.boardID}`] && !parts['boards'][`${post.siteID}/*`]) { return null; }\r\n    if (!!parts['types']  && (needle = ext, !parts['types'].split(',').includes(needle))) { return null; }\r\n    if (!!parts['regexp'] && (!(matches = file.name.match(parts['regexp'])))) { return null; }\r\n\r\n    const missing = [];\r\n    for (var key of ['url', 'text']) {\r\n      parts[key] = parts[key].replace(/%(T?URL|IMG|[sh]?MD5|board|name|%|semi|\\$\\d+)/g, function(orig, parameter) {\r\n        let type;\r\n        if (parameter[0] === '$') {\r\n          if (!matches) { return orig; }\r\n          type = matches[parameter.slice(1)] || '';\r\n        } else {\r\n          type = Sauce.formatters[parameter](post, file, ext);\r\n          if ((type == null)) {\r\n            missing.push(parameter);\r\n            return '';\r\n          }\r\n        }\r\n\r\n        if ((key === 'url') && !['%', 'semi'].includes(parameter)) {\r\n          if (/^javascript:/i.test(parts['url'])) { type = JSON.stringify(type); }\r\n          type = encodeURIComponent(type);\r\n        }\r\n        return type;\r\n      });\r\n    }\r\n\r\n    if (g.SITE.areMD5sDeferred?.(post.board) && missing.length && !missing.filter(x => !/^.?MD5$/.test(x)).length) {\r\n      a = Sauce.link.cloneNode(false);\r\n      a.dataset.skip = '1';\r\n      return a;\r\n    }\r\n\r\n    if (missing.length) { return null; }\r\n\r\n    a = Sauce.link.cloneNode(false);\r\n    a.href = parts['url'];\r\n    a.textContent = parts['text'];\r\n    if (/^javascript:/i.test(parts['url'])) { a.removeAttribute('target'); }\r\n    return a;\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) { return; }\r\n    for (var file of this.files) {\r\n      Sauce.file(this, file);\r\n    }\r\n  },\r\n\r\n  file(post, file) {\r\n    let link, node;\r\n    const nodes = [];\r\n    const skipped = [];\r\n    for (link of Sauce.links) {\r\n      if (node = Sauce.createSauceLink(link, post, file)) {\r\n        nodes.push($.tn(' '), node);\r\n        if (node.dataset.skip) { skipped.push([link, node]); }\r\n      }\r\n    }\r\n    $.add(file.text, nodes);\r\n\r\n    if (skipped.length) {\r\n      var observer = new MutationObserver(function() {\r\n        if (file.text.dataset.md5) {\r\n          for ([link, node] of skipped) {\r\n            var node2;\r\n            if (node2 = Sauce.createSauceLink(link, post, file)) {\r\n              $.replace(node, node2);\r\n            }\r\n          }\r\n          return observer.disconnect();\r\n        }\r\n      });\r\n      return observer.observe(file.text, {attributes: true});\r\n    }\r\n  },\r\n\r\n  formatters: {\r\n    TURL(post, file) { return file.thumbURL; },\r\n    URL(post, file) { return file.url; },\r\n    IMG(post, file, ext) { if (['gif', 'jpg', 'jpeg', 'png'].includes(ext)) { return file.url; } else { return file.thumbURL; } },\r\n    MD5(post, file) { return file.MD5; },\r\n    sMD5(post, file) { return file.MD5?.replace(/[+/=]/g, c => ({'+': '-', '/': '_', '=': ''})[c]); },\r\n    hMD5(post, file) { if (file.MD5) { return (atob(file.MD5).map((c) => `0${c.charCodeAt(0).toString(16)}`.slice(-2))).join(''); } },\r\n    board(post) { return post.board.ID; },\r\n    name(post, file) { return file.name; },\r\n    '%'() { return '%'; },\r\n    semi() { return ';'; }\r\n  }\r\n};\r\nexport default Sauce;\r\n","/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nimport galleryPage from './Gallery/Gallery.html';\r\nimport $ from '../platform/$';\r\nimport Callbacks from '../classes/Callbacks';\r\nimport Notice from '../classes/Notice';\r\nimport Main from '../main/Main';\r\nimport Keybinds from '../Miscellaneous/Keybinds';\r\nimport $$ from '../platform/$$';\r\nimport ImageCommon from './ImageCommon';\r\nimport Sauce from './Sauce';\r\nimport Volume from './Volume';\r\nimport Header from '../General/Header';\r\nimport { Conf, d, doc, g } from '../globals/globals';\r\nimport UI from '../General/UI';\r\nimport Get from '../General/Get';\r\nimport { debounce, dict, SECOND } from '../platform/helpers';\r\n\r\nvar Gallery = {\r\n  init() {\r\n    if (!(this.enabled = Conf['Gallery'] && ['index', 'thread'].includes(g.VIEW))) { return; }\r\n\r\n    this.delay = Conf['Slide Delay'];\r\n\r\n    const el = $.el('a', {\r\n      href: 'javascript:;',\r\n      title: 'Gallery',\r\n      textContent: 'Gallery',\r\n    });\r\n\r\n    $.on(el, 'click', this.cb.toggle);\r\n\r\n    Header.addShortcut('gallery', el, 530, '🖼︎');\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Gallery',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    return (() => {\r\n      const result = [];\r\n      for (var file of this.files) {\r\n        if (file.thumb) {\r\n          if (Gallery.nodes) {\r\n            Gallery.generateThumb(this, file);\r\n            Gallery.nodes.total.textContent = Gallery.images.length;\r\n          }\r\n\r\n          if (!Conf['Image Expansion'] && ((g.SITE.software !== 'tinyboard') || !Main.jsEnabled)) {\r\n            result.push($.on(file.thumbLink, 'click', Gallery.cb.image));\r\n          } else {\r\n            result.push(undefined);\r\n          }\r\n        }\r\n      }\r\n      return result;\r\n    })();\r\n  },\r\n\r\n  build(image) {\r\n    let dialog, thumb;\r\n    const {cb} = Gallery;\r\n\r\n    if (Conf['Fullscreen Gallery']) {\r\n      $.one(d, 'fullscreenchange mozfullscreenchange webkitfullscreenchange', () => $.on(d, 'fullscreenchange mozfullscreenchange webkitfullscreenchange', cb.close));\r\n      doc.mozRequestFullScreen?.();\r\n      doc.webkitRequestFullScreen?.(Element.ALLOW_KEYBOARD_INPUT);\r\n    }\r\n\r\n    Gallery.images  = [];\r\n    const nodes = (Gallery.nodes = {});\r\n    Gallery.fileIDs = dict();\r\n    Gallery.slideshow = false;\r\n\r\n    nodes.el = (dialog = $.el('div',\r\n      {id: 'a-gallery'}));\r\n    $.extend(dialog, {innerHTML: galleryPage });\r\n\r\n    const object = {\r\n      buttons: '.gal-buttons',\r\n      frame:   '.gal-image',\r\n      name:    '.gal-name',\r\n      count:   '.count',\r\n      total:   '.total',\r\n      sauce:   '.gal-sauce',\r\n      thumbs:  '.gal-thumbnails',\r\n      next:    '.gal-image a',\r\n      current: '.gal-image img'\r\n    };\r\n    for (var key in object) { var value = object[key]; nodes[key] = $(value, dialog); }\r\n\r\n    const menuButton = $('.menu-button', dialog);\r\n    nodes.menu = new UI.Menu('gallery');\r\n\r\n    $.on(nodes.frame, 'click', cb.blank);\r\n    if (Conf['Mouse Wheel Volume']) { $.on(nodes.frame, 'wheel', Volume.wheel); }\r\n    $.on(nodes.next,  'click', cb.click);\r\n    $.on(nodes.name,  'click', ImageCommon.download);\r\n\r\n    $.on($('.gal-prev',  dialog), 'click', cb.prev);\r\n    $.on($('.gal-next',  dialog), 'click', cb.next);\r\n    $.on($('.gal-start', dialog), 'click', cb.start);\r\n    $.on($('.gal-stop',  dialog), 'click', cb.stop);\r\n    $.on($('.gal-close', dialog), 'click', cb.close);\r\n\r\n    $.on(menuButton, 'click', function(e) {\r\n      return nodes.menu.toggle(e, this, g);\r\n    });\r\n\r\n    for (var entry of Gallery.menu.createSubEntries()) {\r\n      entry.order = 0;\r\n      nodes.menu.addEntry(entry);\r\n    }\r\n\r\n    $.on(d, 'keydown', cb.keybinds);\r\n    if (Conf['Keybinds']) { $.off(d, 'keydown', Keybinds.keydown); }\r\n\r\n    $.on(window, 'resize', Gallery.cb.setHeight);\r\n\r\n    for (var postThumb of $$(g.SITE.selectors.file.thumb)) {\r\n      var post;\r\n      if (!(post = Get.postFromNode(postThumb))) { continue; }\r\n      for (var file of post.files) {\r\n        if (file.thumb) {\r\n          Gallery.generateThumb(post, file);\r\n          // If no image to open is given, pick image we have scrolled to.\r\n          if (!image && Gallery.fileIDs[`${post.fullID}.${file.index}`]) {\r\n            var candidate = file.thumbLink;\r\n            if ((Header.getTopOf(candidate) + candidate.getBoundingClientRect().height) >= 0) {\r\n              image = candidate;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    $.addClass(doc, 'gallery-open');\r\n\r\n    $.add(d.body, dialog);\r\n\r\n    nodes.thumbs.scrollTop = 0;\r\n    nodes.current.parentElement.scrollTop = 0;\r\n\r\n    if (image) { thumb = $(`[href='${image.href}']`, nodes.thumbs); }\r\n    if (!thumb) { thumb = Gallery.images[Gallery.images.length-1]; }\r\n    if (thumb) { Gallery.open(thumb); }\r\n\r\n    doc.style.overflow = 'hidden';\r\n    return nodes.total.textContent = Gallery.images.length;\r\n  },\r\n\r\n  generateThumb(post, file) {\r\n    if (post.isClone || post.isHidden) { return; }\r\n    if (!file || !file.thumb || (!file.isImage && !file.isVideo && !Conf['PDF in Gallery'])) { return; }\r\n    if (Gallery.fileIDs[`${post.fullID}.${file.index}`]) { return; }\r\n\r\n    Gallery.fileIDs[`${post.fullID}.${file.index}`] = true;\r\n\r\n    const thumb = $.el('a', {\r\n      className: 'gal-thumb',\r\n      href:      file.url,\r\n      target:    '_blank',\r\n      title:     file.name\r\n    }\r\n    );\r\n\r\n    thumb.dataset.id   = Gallery.images.length;\r\n    thumb.dataset.post = post.fullID;\r\n    thumb.dataset.file = file.index;\r\n\r\n    const thumbImg = file.thumb.cloneNode(false);\r\n    thumbImg.style.cssText = '';\r\n    $.add(thumb, thumbImg);\r\n\r\n    $.on(thumb, 'click', Gallery.cb.open);\r\n\r\n    Gallery.images.push(thumb);\r\n    return $.add(Gallery.nodes.thumbs, thumb);\r\n  },\r\n\r\n  load(thumb, errorCB) {\r\n    const ext = thumb.href.match(/\\w*$/);\r\n    const elType = $.getOwn({'webm': 'video', 'mp4': 'video', 'ogv': 'video', 'pdf': 'iframe'}, ext) || 'img';\r\n    const file = $.el(elType);\r\n    $.extend(file.dataset, thumb.dataset);\r\n    $.on(file, 'error', errorCB);\r\n    file.src = thumb.href;\r\n    return file;\r\n  },\r\n\r\n  open(thumb) {\r\n    let el, file, post;\r\n    const {nodes} = Gallery;\r\n    const oldID = +nodes.current.dataset.id;\r\n    const newID = +thumb.dataset.id;\r\n\r\n    // Highlight, center selected thumbnail\r\n    if (el = Gallery.images[oldID]) { $.rmClass(el,    'gal-highlight'); }\r\n    $.addClass(thumb, 'gal-highlight');\r\n    nodes.thumbs.scrollTop = (thumb.offsetTop + (thumb.offsetHeight/2)) - (nodes.thumbs.clientHeight/2);\r\n\r\n    // Load image or use preloaded image\r\n    if (Gallery.cache?.dataset.id === (''+newID)) {\r\n      file = Gallery.cache;\r\n      $.off(file, 'error', Gallery.cacheError);\r\n      $.on(file, 'error', Gallery.error);\r\n    } else {\r\n      file = Gallery.load(thumb, Gallery.error);\r\n    }\r\n\r\n    // Replace old image with new one\r\n    $.off(nodes.current, 'error', Gallery.error);\r\n    ImageCommon.pause(nodes.current);\r\n    $.replace(nodes.current, file);\r\n    nodes.current = file;\r\n\r\n    if (file.nodeName === 'VIDEO') {\r\n      file.loop = true;\r\n      Volume.setup(file);\r\n      if (Conf['Autoplay']) { file.play(); }\r\n      if (Conf['Show Controls']) { ImageCommon.addControls(file); }\r\n    }\r\n\r\n    doc.classList.toggle('gal-pdf', file.nodeName === 'IFRAME');\r\n    Gallery.cb.setHeight();\r\n    nodes.count.textContent = +thumb.dataset.id + 1;\r\n    nodes.name.download     = (nodes.name.textContent = thumb.title);\r\n    nodes.name.href         = thumb.href;\r\n    nodes.frame.scrollTop   = 0;\r\n    nodes.next.focus();\r\n\r\n    // Set sauce links\r\n    $.rmAll(nodes.sauce);\r\n    if (Conf['Sauce'] && Sauce.links && (post = g.posts.get(file.dataset.post))) {\r\n      const sauces = [];\r\n      for (var link of Sauce.links) {\r\n        var node;\r\n        if (node = Sauce.createSauceLink(link, post, post.files[+file.dataset.file])) {\r\n          sauces.push($.tn(' '), node);\r\n        }\r\n      }\r\n      $.add(nodes.sauce, sauces);\r\n    }\r\n\r\n    // Continue slideshow if moving forward, stop otherwise\r\n    if (Gallery.slideshow && ((newID > oldID) || ((oldID === (Gallery.images.length-1)) && (newID === 0)))) {\r\n      Gallery.setupTimer();\r\n    } else {\r\n      Gallery.cb.stop();\r\n    }\r\n\r\n    // Scroll to post\r\n    if (Conf['Scroll to Post'] && (post = g.posts.get(file.dataset.post))) {\r\n      Header.scrollTo(post.nodes.root);\r\n    }\r\n\r\n    // Preload next image\r\n    if (isNaN(oldID) || (newID === ((oldID + 1) % Gallery.images.length))) {\r\n      return Gallery.cache = Gallery.load(Gallery.images[(newID + 1) % Gallery.images.length], Gallery.cacheError);\r\n    }\r\n  },\r\n\r\n  error() {\r\n    if (this.error?.code === MediaError.MEDIA_ERR_DECODE) {\r\n      return new Notice('error', 'Corrupt or unplayable video', 30);\r\n    }\r\n    if (ImageCommon.isFromArchive(this)) { return; }\r\n    const post = g.posts.get(this.dataset.post);\r\n    const file = post.files[+this.dataset.file];\r\n    return ImageCommon.error(this, post, file, null, url => {\r\n      if (!url) { return; }\r\n      Gallery.images[+this.dataset.id].href = url;\r\n      if (Gallery.nodes.current === this) { return this.src = url; }\r\n    });\r\n  },\r\n\r\n  cacheError() {\r\n    return delete Gallery.cache;\r\n  },\r\n\r\n  cleanupTimer() {\r\n    clearTimeout(Gallery.timeoutID);\r\n    const {current} = Gallery.nodes;\r\n    $.off(current, 'canplaythrough load', Gallery.startTimer);\r\n    return $.off(current, 'ended', Gallery.cb.next);\r\n  },\r\n\r\n  startTimer() {\r\n    return Gallery.timeoutID = setTimeout(Gallery.checkTimer, Gallery.delay * SECOND);\r\n  },\r\n\r\n  setupTimer() {\r\n    Gallery.cleanupTimer();\r\n    const {current} = Gallery.nodes;\r\n    const isVideo = current.nodeName === 'VIDEO';\r\n    if (isVideo) { current.play(); }\r\n    if ((isVideo ? current.readyState >= 4 : current.complete) || (current.nodeName === 'IFRAME')) {\r\n      return Gallery.startTimer();\r\n    } else {\r\n      return $.on(current, (isVideo ? 'canplaythrough' : 'load'), Gallery.startTimer);\r\n    }\r\n  },\r\n\r\n  checkTimer() {\r\n    const {current} = Gallery.nodes;\r\n    if ((current.nodeName === 'VIDEO') && !current.paused) {\r\n      $.on(current, 'ended', Gallery.cb.next);\r\n      return current.loop = false;\r\n    } else {\r\n      return Gallery.cb.next();\r\n    }\r\n  },\r\n\r\n  cb: {\r\n    keybinds(e) {\r\n      let key;\r\n      if (!(key = Keybinds.keyCode(e))) { return; }\r\n\r\n      const cb = (() => { switch (key) {\r\n        case Conf['Close']: case Conf['Open Gallery']:\r\n          return Gallery.cb.close;\r\n        case Conf['Next Gallery Image']:\r\n          return Gallery.cb.next;\r\n        case Conf['Advance Gallery']:\r\n          return Gallery.cb.advance;\r\n        case Conf['Previous Gallery Image']:\r\n          return Gallery.cb.prev;\r\n        case Conf['Pause']:\r\n          return Gallery.cb.pause;\r\n        case Conf['Slideshow']:\r\n          return Gallery.cb.toggleSlideshow;\r\n        case Conf['Rotate image anticlockwise']:\r\n          return Gallery.cb.rotateLeft;\r\n        case Conf['Rotate image clockwise']:\r\n          return Gallery.cb.rotateRight;\r\n        case Conf['Download Gallery Image']:\r\n          return Gallery.cb.download;\r\n      } })();\r\n\r\n      if (!cb) { return; }\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n      return cb();\r\n    },\r\n\r\n    open(e) {\r\n      if (e) { e.preventDefault(); }\r\n      if (this) { return Gallery.open(this); }\r\n    },\r\n\r\n    image(e) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      return Gallery.build(this);\r\n    },\r\n\r\n    prev() {\r\n      return Gallery.cb.open.call(\r\n        Gallery.images[+Gallery.nodes.current.dataset.id - 1] || Gallery.images[Gallery.images.length - 1]\r\n      );\r\n    },\r\n    next() {\r\n      return Gallery.cb.open.call(\r\n        Gallery.images[+Gallery.nodes.current.dataset.id + 1] || Gallery.images[0]\r\n      );\r\n    },\r\n\r\n    click(e) {\r\n      if (ImageCommon.onControls(e)) { return; }\r\n      e.preventDefault();\r\n      return Gallery.cb.advance();\r\n    },\r\n\r\n    advance() { if (!Conf['Autoplay'] && Gallery.nodes.current.paused) { return Gallery.nodes.current.play(); } else { return Gallery.cb.next(); } },\r\n    toggle() { return (Gallery.nodes ? Gallery.cb.close : Gallery.build)(); },\r\n    blank(e) { if (e.target === this) { return Gallery.cb.close(); } },\r\n    toggleSlideshow() {  return Gallery.cb[Gallery.slideshow ? 'stop' : 'start'](); },\r\n\r\n    download() {\r\n      const name = $('.gal-name');\r\n      return name.click();\r\n    },\r\n\r\n    pause() {\r\n      Gallery.cb.stop();\r\n      const {current} = Gallery.nodes;\r\n      if (current.nodeName === 'VIDEO') { return current[current.paused ? 'play' : 'pause'](); }\r\n    },\r\n\r\n    start() {\r\n      $.addClass(Gallery.nodes.buttons, 'gal-playing');\r\n      Gallery.slideshow = true;\r\n      return Gallery.setupTimer();\r\n    },\r\n\r\n    stop() {\r\n      if (!Gallery.slideshow) { return; }\r\n      Gallery.cleanupTimer();\r\n      const {current} = Gallery.nodes;\r\n      if (current.nodeName === 'VIDEO') { current.loop = true; }\r\n      $.rmClass(Gallery.nodes.buttons, 'gal-playing');\r\n      return Gallery.slideshow = false;\r\n    },\r\n\r\n    rotateLeft() { return Gallery.cb.rotate(270); },\r\n    rotateRight() { return Gallery.cb.rotate(90); },\r\n\r\n    rotate: debounce(100, function(delta) {\r\n      const {current} = Gallery.nodes;\r\n      if (current.nodeName === 'IFRAME') { return; }\r\n      current.dataRotate = ((current.dataRotate || 0) + delta) % 360;\r\n      current.style.transform = `rotate(${current.dataRotate}deg)`;\r\n      return Gallery.cb.setHeight();\r\n    }),\r\n\r\n    close() {\r\n      $.off(Gallery.nodes.current, 'error', Gallery.error);\r\n      ImageCommon.pause(Gallery.nodes.current);\r\n      $.rm(Gallery.nodes.el);\r\n      $.rmClass(doc, 'gallery-open');\r\n      if (Conf['Fullscreen Gallery']) {\r\n        $.off(d, 'fullscreenchange mozfullscreenchange webkitfullscreenchange', Gallery.cb.close);\r\n        d.mozCancelFullScreen?.();\r\n        d.webkitExitFullscreen?.();\r\n      }\r\n      delete Gallery.nodes;\r\n      delete Gallery.fileIDs;\r\n      doc.style.overflow = '';\r\n\r\n      $.off(d, 'keydown', Gallery.cb.keybinds);\r\n      if (Conf['Keybinds']) { $.on(d, 'keydown', Keybinds.keydown); }\r\n      $.off(window, 'resize', Gallery.cb.setHeight);\r\n      return clearTimeout(Gallery.timeoutID);\r\n    },\r\n\r\n    setFitness() {\r\n      return (this.checked ? $.addClass : $.rmClass)(doc, `gal-${this.name.toLowerCase().replace(/\\s+/g, '-')}`);\r\n    },\r\n\r\n    setHeight: debounce(100, function () {\r\n      let dim, margin, minHeight;\r\n      const {current, frame} = Gallery.nodes;\r\n      const {style} = current;\r\n\r\n      if (Conf['Stretch to Fit'] && (dim = g.posts.get(current.dataset.post)?.files[+current.dataset.file].dimensions)) {\r\n        const [width, height] = dim.split('x');\r\n        let containerWidth = frame.clientWidth;\r\n        let containerHeight = doc.clientHeight - 25;\r\n        if (((current.dataRotate || 0) % 180) === 90) {\r\n          [containerWidth, containerHeight] = [containerHeight, containerWidth];\r\n        }\r\n        minHeight = Math.min(containerHeight, (height / width) * containerWidth);\r\n        style.minHeight = minHeight + 'px';\r\n        style.minWidth = ((width / height) * minHeight) + 'px';\r\n      } else {\r\n        style.minHeight = (style.minWidth = '');\r\n      }\r\n\r\n      if (((current.dataRotate || 0) % 180) === 90) {\r\n        style.maxWidth  = Conf['Fit Height'] ? `${doc.clientHeight - 25}px` : 'none';\r\n        style.maxHeight = Conf['Fit Width']  ? `${frame.clientWidth}px`     : 'none';\r\n        margin = (current.clientWidth - current.clientHeight)/2;\r\n        return style.margin = `${margin}px ${-margin}px`;\r\n      } else {\r\n        return style.maxWidth = (style.maxHeight = (style.margin = ''));\r\n      }\r\n    }),\r\n\r\n    setDelay() { return Gallery.delay = +this.value; }\r\n  },\r\n\r\n  menu: {\r\n    init() {\r\n      if (!Gallery.enabled) { return; }\r\n\r\n      const el = $.el('span', {\r\n        textContent: 'Gallery',\r\n        className: 'gallery-link'\r\n      }\r\n      );\r\n\r\n      return Header.menu.addEntry({\r\n        el,\r\n        order: 105,\r\n        subEntries: Gallery.menu.createSubEntries()\r\n      });\r\n    },\r\n\r\n    createSubEntry(name) {\r\n      const label = UI.checkbox(name, name);\r\n      const input = label.firstElementChild;\r\n      if (['Hide Thumbnails', 'Fit Width', 'Fit Height'].includes(name)) { $.on(input, 'change', Gallery.cb.setFitness); }\r\n      $.event('change', null, input);\r\n      $.on(input, 'change', $.cb.checked);\r\n      if (['Hide Thumbnails', 'Fit Width', 'Fit Height', 'Stretch to Fit'].includes(name)) { $.on(input, 'change', Gallery.cb.setHeight); }\r\n      return {el: label};\r\n    },\r\n\r\n    createSubEntries() {\r\n      const subEntries = (['Hide Thumbnails', 'Fit Width', 'Fit Height', 'Stretch to Fit', 'Scroll to Post'].map((item) => Gallery.menu.createSubEntry(item)));\r\n\r\n      const delayLabel = $.el('label', {innerHTML: 'Slide Delay: <input type=\"number\" name=\"Slide Delay\" min=\"0\" step=\"any\" class=\"field\">'});\r\n      const delayInput = delayLabel.firstElementChild;\r\n      delayInput.value = Gallery.delay;\r\n      $.on(delayInput, 'change', Gallery.cb.setDelay);\r\n      $.on(delayInput, 'change', $.cb.value);\r\n      subEntries.push({el: delayLabel});\r\n\r\n      return subEntries;\r\n    }\r\n  }\r\n};\r\nexport default Gallery;\r\n","import Get from '../General/Get';\r\nimport Header from '../General/Header';\r\nimport UI from '../General/UI';\r\nimport { g, Conf, d, doc, E } from '../globals/globals';\r\nimport ImageHost from '../Images/ImageHost';\r\nimport Main from '../main/Main';\r\nimport $ from '../platform/$';\r\nimport $$ from '../platform/$$';\r\nimport CrossOrigin from '../platform/CrossOrigin';\r\nimport { dict } from '../platform/helpers';\r\nimport EmbeddingPage from './Embedding/Embed.html';\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n\r\nvar Embedding = {\r\n  init() {\r\n    if (!['index', 'thread', 'archive'].includes(g.VIEW) || !Conf['Linkify'] || (!Conf['Embedding'] && !Conf['Link Title'] && !Conf['Cover Preview'])) { return; }\r\n    this.types = dict();\r\n    for (var type of this.ordered_types) { this.types[type.key] = type; }\r\n\r\n    if (Conf['Embedding'] && (g.VIEW !== 'archive')) {\r\n      this.dialog = UI.dialog('embedding',\r\n        { innerHTML: EmbeddingPage });\r\n      this.media = $('#media-embed', this.dialog);\r\n      $.one(d, '4chanXInitFinished', this.ready);\r\n      $.on(d, 'IndexRefreshInternal', () => g.posts.forEach(function(post) {\r\n        for (post of [post, ...post.clones]) {\r\n          for (var embed of post.nodes.embedlinks) {\r\n            Embedding.cb.catalogRemove.call(embed);\r\n          }\r\n        }\r\n      }));\r\n    }\r\n    if (Embedding.shouldFetchTitles()) {\r\n      $.on(d, '4chanXInitFinished PostsInserted', function() {\r\n        for (const service of Object.values(Embedding.types)) {\r\n          if (service.title?.batchSize) {\r\n            Embedding.flushTitles(service.title);\r\n          }\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  events(post) {\r\n    let el, i, items;\r\n    if (g.VIEW === 'archive') { return; }\r\n    if (Conf['Embedding']) {\r\n      i = 0;\r\n      items = (post.nodes.embedlinks = $$('.embedder', post.nodes.comment));\r\n      while ((el = items[i++])) {\r\n        $.on(el, 'click', Embedding.cb.click);\r\n        if ($.hasClass(el, 'embedded')) { Embedding.cb.toggle.call(el); }\r\n      }\r\n    }\r\n    if (Conf['Cover Preview']) {\r\n      i = 0;\r\n      items = $$('.linkify', post.nodes.comment);\r\n      while ((el = items[i++])) {\r\n        var data;\r\n        if (data = Embedding.services(el)) {\r\n          Embedding.preview(data);\r\n        }\r\n      }\r\n      return;\r\n    }\r\n  },\r\n\r\n  process(link, post) {\r\n    let data;\r\n    if (!Conf['Embedding'] && !Conf['Link Title'] && !Conf['Cover Preview']) { return; }\r\n    if ($.x('ancestor::pre', link)) { return; }\r\n    if (data = Embedding.services(link)) {\r\n      data.post = post;\r\n      if (Conf['Embedding'] && (g.VIEW !== 'archive')) { Embedding.embed(data); }\r\n      if (Embedding.shouldFetchTitles()) Embedding.title(data);\r\n      if (Conf['Cover Preview'] && (g.VIEW !== 'archive')) { return Embedding.preview(data); }\r\n    }\r\n  },\r\n\r\n  services(link) {\r\n    const {href} = link;\r\n    for (var type of Embedding.ordered_types) {\r\n      var match;\r\n      if (match = type.regExp.exec(href)) {\r\n        return {key: type.key, uid: match[1], options: match[2], link};\r\n      }\r\n    }\r\n  },\r\n\r\n  embed(data) {\r\n    const {key, uid, options, link, post} = data;\r\n    const {href} = link;\r\n\r\n    $.addClass(link, key.toLowerCase());\r\n\r\n    const embed = $.el('a', {\r\n      className:   'embedder',\r\n      href:        'javascript:;'\r\n    }\r\n    ,\r\n      {innerHTML: '(<span>un</span>embed)'});\r\n\r\n    const object = {key, uid, options, href};\r\n    for (var name in object) { var value = object[name]; embed.dataset[name] = value; }\r\n\r\n    $.on(embed, 'click', Embedding.cb.click);\r\n    $.after(link, [$.tn(' '), embed]);\r\n    post.nodes.embedlinks.push(embed);\r\n\r\n    if (Conf['Auto-embed'] && !Conf['Floating Embeds'] && !post.isFetchedQuote) {\r\n      if ($.hasClass(doc, 'catalog-mode')) {\r\n        return $.addClass(embed, 'embed-removed');\r\n      } else {\r\n        return Embedding.cb.toggle.call(embed);\r\n      }\r\n    }\r\n  },\r\n\r\n  ready() {\r\n    if (!Main.isThisPageLegit()) { return; }\r\n    $.addClass(Embedding.dialog, 'empty');\r\n    $.on($('.close', Embedding.dialog), 'click',     Embedding.closeFloat);\r\n    $.on($('.move',  Embedding.dialog), 'mousedown', Embedding.dragEmbed);\r\n    $.on($('.jump',  Embedding.dialog), 'click', function() {\r\n      if (doc.contains(Embedding.lastEmbed)) { return Header.scrollTo(Embedding.lastEmbed); }\r\n    });\r\n    return $.add(d.body, Embedding.dialog);\r\n  },\r\n\r\n  closeFloat() {\r\n    delete Embedding.lastEmbed;\r\n    $.addClass(Embedding.dialog, 'empty');\r\n    return $.replace(Embedding.media.firstChild, $.el('div'));\r\n  },\r\n\r\n  dragEmbed() {\r\n    // only webkit can handle a blocking div\r\n    const {style} = Embedding.media;\r\n    if (Embedding.dragEmbed.mouseup) {\r\n      $.off(d, 'mouseup', Embedding.dragEmbed);\r\n      Embedding.dragEmbed.mouseup = false;\r\n      style.pointerEvents = '';\r\n      return;\r\n    }\r\n    $.on(d, 'mouseup', Embedding.dragEmbed);\r\n    Embedding.dragEmbed.mouseup = true;\r\n    return style.pointerEvents = 'none';\r\n  },\r\n\r\n  title(data) {\r\n    let service;\r\n    const {key, uid, options, link, post} = data;\r\n    if (!(service = Embedding.types[key].title)) { return; }\r\n    $.addClass(link, key.toLowerCase());\r\n    if (service.batchSize) {\r\n      (service.queue || (service.queue = [])).push(data);\r\n      if (service.queue.length >= service.batchSize) {\r\n        return Embedding.flushTitles(service);\r\n      }\r\n    } else {\r\n      return CrossOrigin.cache(service.api(uid), (function() { return Embedding.cb.title(this, data); }));\r\n    }\r\n  },\r\n\r\n  flushTitles(service) {\r\n    let data;\r\n    const {queue} = service;\r\n    if (!queue?.length) { return; }\r\n    service.queue = [];\r\n    const cb = function() {\r\n      for (data of queue) { Embedding.cb.title(this, data); }\r\n    };\r\n    return CrossOrigin.cache(service.api((() => {\r\n      const result = [];\r\n      for (data of queue) {         result.push(data.uid);\r\n      }\r\n      return result;\r\n    })()), cb);\r\n  },\r\n\r\n  preview(data) {\r\n    let service;\r\n    const {key, uid, link} = data;\r\n    if (!(service = Embedding.types[key].preview)) { return; }\r\n    return $.on(link, 'mouseover', function(e) {\r\n      const src = service.url(uid);\r\n      const {height} = service;\r\n      const el = $.el('img', {\r\n        src,\r\n        id: 'ihover'\r\n      }\r\n      );\r\n      $.add(Header.hover, el);\r\n      return UI.hover({\r\n        root: link,\r\n        el,\r\n        latestEvent: e,\r\n        endEvents: 'mouseout click',\r\n        height\r\n      });\r\n    });\r\n  },\r\n\r\n  cb: {\r\n    click(e) {\r\n      e.preventDefault();\r\n      if (!$.hasClass(this, 'embedded') && (Conf['Floating Embeds'] || $.hasClass(doc, 'catalog-mode'))) {\r\n        let div;\r\n        if (!(div = Embedding.media.firstChild)) { return; }\r\n        $.replace(div, Embedding.cb.embed(this));\r\n        Embedding.lastEmbed = Get.postFromNode(this).nodes.root;\r\n        return $.rmClass(Embedding.dialog, 'empty');\r\n      } else {\r\n        return Embedding.cb.toggle.call(this);\r\n      }\r\n    },\r\n\r\n    toggle() {\r\n      if ($.hasClass(this, \"embedded\")) {\r\n        $.rm(this.nextElementSibling);\r\n      } else {\r\n        $.after(this, Embedding.cb.embed(this));\r\n      }\r\n      return $.toggleClass(this, 'embedded');\r\n    },\r\n\r\n    embed(a) {\r\n      // We create an element to embed\r\n      let el, type;\r\n      const container = $.el('div', {className: 'media-embed'});\r\n      $.add(container, (el = (type = Embedding.types[a.dataset.key]).el(a)));\r\n\r\n      // Set style values.\r\n      el.style.cssText = (type.style != null) ?\r\n        type.style\r\n      :\r\n        'border: none; width: 640px; height: 360px;';\r\n\r\n      return container;\r\n    },\r\n\r\n    catalogRemove() {\r\n      const isCatalog = $.hasClass(doc, 'catalog-mode');\r\n      if ((isCatalog && $.hasClass(this, 'embedded')) || (!isCatalog && $.hasClass(this, 'embed-removed'))) {\r\n        Embedding.cb.toggle.call(this);\r\n        return $.toggleClass(this, 'embed-removed');\r\n      }\r\n    },\r\n\r\n    title(req, data) {\r\n      let text;\r\n      const {key, uid, options, link, post} = data;\r\n      const service = Embedding.types[key].title;\r\n\r\n      let {status} = req;\r\n      if ([200, 304].includes(status) && service.status) {\r\n        status = service.status(req.response)[0];\r\n      }\r\n\r\n      if (!status) { return; }\r\n\r\n      text = `[${key}] ${(() => { switch (status) {\r\n        case 200: case 304:\r\n          text = service.text(req.response, uid);\r\n          if (typeof text === 'string') {\r\n            return text;\r\n          } else {\r\n            return text = link.textContent;\r\n          }\r\n        case 404:\r\n          return \"Not Found\";\r\n        case 403: case 401:\r\n          return \"Forbidden or Private\";\r\n        default:\r\n          return `${status}'d`;\r\n      } })()\r\n      }`;\r\n\r\n      link.dataset.original = link.textContent;\r\n      link.textContent = text;\r\n      for (var post2 of post.clones) {\r\n        for (var link2 of $$('a.linkify', post2.nodes.comment)) {\r\n          if (link2.href === link.href) {\r\n            if (link2.dataset.original == null) { link2.dataset.original = link2.textContent; }\r\n            link2.textContent = text;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  ordered_types: [{\r\n      key: 'audio',\r\n      regExp: /^[^?#]+\\.(?:mp3|m4a|oga|wav|flac)(?:[?#]|$)/i,\r\n      style: '',\r\n      el(a) {\r\n        return $.el('audio', {\r\n          controls:    true,\r\n          preload:     'auto',\r\n          src:         a.dataset.href\r\n        }\r\n        );\r\n      }\r\n    }\r\n    , {\r\n      key: 'image',\r\n      regExp: /^[^?#]+\\.(?:gif|png|jpg|jpeg|bmp|webp)(?::\\w+)?(?:[?#]|$)/i,\r\n      style: '',\r\n      el(a) {\r\n        const hrefEsc = E(a.dataset.href);\r\n        return $.el('div', { innerHTML: `<a target=\"_blank\" href=\"${hrefEsc}\"><img src=\"${hrefEsc}\" style=\"max-width: 80vw; max-height: 80vh;\"></a>`});\r\n      }\r\n    }\r\n    , {\r\n      key: 'video',\r\n      regExp: /^[^?#]+\\.(?:og[gv]|webm|mp4)(?:[?#]|$)/i,\r\n      style: 'max-width: 80vw; max-height: 80vh;',\r\n      el(a) {\r\n        const el = $.el('video', {\r\n          hidden:   true,\r\n          controls: true,\r\n          preload:  'auto',\r\n          src:      a.dataset.href,\r\n          loop:     ImageHost.test(a.dataset.href.split('/')[2])\r\n        });\r\n        $.on(el, 'loadedmetadata', function() {\r\n          if ((el.videoHeight === 0) && el.parentNode) {\r\n            return $.replace(el, Embedding.types.audio.el(a));\r\n          } else {\r\n            return el.hidden = false;\r\n          }\r\n        });\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'PeerTube',\r\n      regExp: /^(\\w+:\\/\\/[^\\/]+\\/videos\\/watch\\/\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12})(.*)/,\r\n      el(a) {\r\n        let start;\r\n        const options = (start = a.dataset.options.match(/[?&](start=\\w+)/)) ? `?${start[1]}` : '';\r\n        const el = $.el('iframe',\r\n          {src: a.dataset.uid.replace('/videos/watch/', '/videos/embed/') + options});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'BitChute',\r\n      regExp:  /^\\w+:\\/\\/(?:www\\.)?bitchute\\.com\\/video\\/([\\w\\-]+)/,\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `https://www.bitchute.com/embed/${a.dataset.uid}/`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Clyp',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?clyp\\.it\\/(\\w{8})/,\r\n      style: 'border: 0; width: 640px; height: 160px;',\r\n      el(a) {\r\n        return $.el('iframe',\r\n          {src: `https://clyp.it/${a.dataset.uid}/widget`});\r\n      },\r\n      title: {\r\n        api(uid) { return `https://api.clyp.it/oembed?url=https://clyp.it/${uid}`; },\r\n        text(_) { return _.title; }\r\n      }\r\n    }\r\n    , {\r\n      key: 'Dailymotion',\r\n      regExp:  /^\\w+:\\/\\/(?:(?:www\\.)?dailymotion\\.com\\/(?:embed\\/)?video|dai\\.ly)\\/([A-Za-z0-9]+)[^?]*(.*)/,\r\n      el(a) {\r\n        let start;\r\n        const options = (start = a.dataset.options.match(/[?&](start=\\d+)/)) ? `?${start[1]}` : '';\r\n        const el = $.el('iframe',\r\n          {src: `//www.dailymotion.com/embed/video/${a.dataset.uid}${options}`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      },\r\n      title: {\r\n        api(uid) { return `https://api.dailymotion.com/video/${uid}`; },\r\n        text(_) { return _.title; }\r\n      },\r\n      preview: {\r\n        url(uid) { return `https://www.dailymotion.com/thumbnail/video/${uid}`; },\r\n        height: 240\r\n      }\r\n    }\r\n    , {\r\n      key: 'Gfycat',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?gfycat\\.com\\/(?:iframe\\/)?(\\w+)/,\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `//gfycat.com/ifr/${a.dataset.uid}`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Gist',\r\n      regExp: /^\\w+:\\/\\/gist\\.github\\.com\\/[\\w\\-]+\\/(\\w+)/,\r\n      style: '',\r\n      el: (function() {\r\n        let counter = 0;\r\n        return function(a) {\r\n          const el = $.el('pre', {\r\n            hidden: true,\r\n            id: `gist-embed-${counter++}`\r\n          }\r\n          );\r\n          CrossOrigin.cache(`https://api.github.com/gists/${a.dataset.uid}`, function() {\r\n            el.textContent = Object.values(this.response.files)[0].content;\r\n            el.className = 'prettyprint';\r\n            $.global(() => window.prettyPrint?.((function() {}), document.getElementById(document.currentScript.dataset.id).parentNode)\r\n            , {id: el.id});\r\n            return el.hidden = false;\r\n          });\r\n          return el;\r\n        };\r\n      })(),\r\n      title: {\r\n        api(uid) { return `https://api.github.com/gists/${uid}`; },\r\n        text({files}) {\r\n          for (var file in files) { if (files.hasOwnProperty(file)) { return file; } }\r\n        }\r\n      }\r\n    }\r\n    , {\r\n      key: 'InstallGentoo',\r\n      regExp: /^\\w+:\\/\\/paste\\.installgentoo\\.com\\/view\\/(?:raw\\/|download\\/|embed\\/)?(\\w+)/,\r\n      el(a) {\r\n        return $.el('iframe',\r\n          {src: `https://paste.installgentoo.com/view/embed/${a.dataset.uid}`});\r\n      }\r\n    }\r\n    , {\r\n      key: 'LiveLeak',\r\n      regExp: /^\\w+:\\/\\/(?:\\w+\\.)?liveleak\\.com\\/.*\\?.*[tif]=(\\w+)/,\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `https://www.liveleak.com/e/${a.dataset.uid}`,});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Loopvid',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?loopvid.appspot.com\\/#?((?:pf|kd|lv|gd|gh|db|dx|nn|cp|wu|ig|ky|mf|m2|pc|1c|pi|ni|wl|ko|mm|ic|gc)\\/[\\w\\-\\/]+(?:,[\\w\\-\\/]+)*|fc\\/\\w+\\/\\d+|https?:\\/\\/.+)/,\r\n      style: 'max-width: 80vw; max-height: 80vh;',\r\n      el(a) {\r\n        const el = $.el('video', {\r\n          controls: true,\r\n          preload:  'auto',\r\n          loop:     true\r\n        }\r\n        );\r\n        if (/^http/.test(a.dataset.uid)) {\r\n          $.add(el, $.el('source', {src: a.dataset.uid}));\r\n          return el;\r\n        }\r\n        const [_, host, names] = a.dataset.uid.match(/(\\w+)\\/(.*)/);\r\n        const types = (() => { switch (host) {\r\n          case 'gd': case 'wu': case 'fc': return [''];\r\n          case 'gc': return ['giant', 'fat', 'zippy'];\r\n          default: return ['.webm', '.mp4'];\r\n        } })();\r\n        for (var name of names.split(',')) {\r\n          for (var type of types) {\r\n            var base = `${name}${type}`;\r\n            var urls = (() => { switch (host) {\r\n              // list from src/common.py at http://loopvid.appspot.com/source.html\r\n              case 'pf': return [`https://kastden.org/_loopvid_media/pf/${base}`, `https://web.archive.org/web/2/http://a.pomf.se/${base}`];\r\n              case 'kd': return [`https://kastden.org/loopvid/${base}`];\r\n              case 'lv': return [`https://lv.kastden.org/${base}`];\r\n              case 'gd': return [`https://docs.google.com/uc?export=download&id=${base}`];\r\n              case 'gh': return [`https://googledrive.com/host/${base}`];\r\n              case 'db': return [`https://dl.dropboxusercontent.com/u/${base}`];\r\n              case 'dx': return [`https://dl.dropboxusercontent.com/${base}`];\r\n              case 'nn': return [`https://kastden.org/_loopvid_media/nn/${base}`];\r\n              case 'cp': return [`https://copy.com/${base}`];\r\n              case 'wu': return [`http://webmup.com/${base}/vid.webm`];\r\n              case 'ig': return [`https://i.imgur.com/${base}`];\r\n              case 'ky': return [`https://kastden.org/_loopvid_media/ky/${base}`];\r\n              case 'mf': return [`https://kastden.org/_loopvid_media/mf/${base}`, `https://web.archive.org/web/2/https://d.maxfile.ro/${base}`];\r\n              case 'm2': return [`https://kastden.org/_loopvid_media/m2/${base}`];\r\n              case 'pc': return [`https://kastden.org/_loopvid_media/pc/${base}`, `https://web.archive.org/web/2/http://a.pomf.cat/${base}`];\r\n              case '1c': return [`http://b.1339.cf/${base}`];\r\n              case 'pi': return [`https://kastden.org/_loopvid_media/pi/${base}`, `https://web.archive.org/web/2/https://u.pomf.is/${base}`];\r\n              case 'ni': return [`https://kastden.org/_loopvid_media/ni/${base}`, `https://web.archive.org/web/2/https://u.nya.is/${base}`];\r\n              case 'wl': return [`http://webm.land/media/${base}`];\r\n              case 'ko': return [`https://kordy.kastden.org/loopvid/${base}`];\r\n              case 'mm': return [`https://kastden.org/_loopvid_media/mm/${base}`, `https://web.archive.org/web/2/https://my.mixtape.moe/${base}`];\r\n              case 'ic': return [`https://media.8ch.net/file_store/${base}`];\r\n              case 'fc': return [`//${ImageHost.host()}/${base}.webm`];\r\n              case 'gc': return [`https://${type}.gfycat.com/${name}.webm`];\r\n            } })();\r\n\r\n            for (var url of urls) {\r\n              $.add(el, $.el('source', {src: url}));\r\n            }\r\n          }\r\n        }\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Openings.moe',\r\n      regExp: /^\\w+:\\/\\/openings.moe\\/\\?video=([^.&=]+)/,\r\n      style: 'width: 1280px; height: 720px; max-width: 80vw; max-height: 80vh;',\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `https://openings.moe/?video=${a.dataset.uid}`,});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Pastebin',\r\n      regExp: /^\\w+:\\/\\/(?:\\w+\\.)?pastebin\\.com\\/(?!u\\/)(?:[\\w.]+(?:\\/|\\?i\\=))?(\\w+)/,\r\n      el(a) {\r\n        let div;\r\n        return div = $.el('iframe',\r\n          {src: `//pastebin.com/embed_iframe.php?i=${a.dataset.uid}`});\r\n      }\r\n    }\r\n    , {\r\n      key: 'SoundCloud',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?(?:soundcloud\\.com\\/|snd\\.sc\\/)([\\w\\-\\/]+)/,\r\n      style: 'border: 0; width: 500px; height: 400px;',\r\n      el(a) {\r\n        return $.el('iframe',\r\n          {src: `https://w.soundcloud.com/player/?visual=true&show_comments=false&url=https%3A%2F%2Fsoundcloud.com%2F${encodeURIComponent(a.dataset.uid)}`});\r\n      },\r\n      title: {\r\n        api(uid) { return `${location.protocol}//soundcloud.com/oembed?format=json&url=https%3A%2F%2Fsoundcloud.com%2F${encodeURIComponent(uid)}`; },\r\n        text(_) { return _.title; }\r\n      }\r\n    }\r\n    , {\r\n      key: 'StrawPoll',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?strawpoll\\.me\\/(?:embed_\\d+\\/)?(\\d+(?:\\/r)?)/,\r\n      style: 'border: 0; width: 600px; height: 406px;',\r\n      el(a) {\r\n        return $.el('iframe',\r\n          {src: `https://www.strawpoll.me/embed_1/${a.dataset.uid}`});\r\n      }\r\n    }\r\n    , {\r\n      key: 'Streamable',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?streamable\\.com\\/(\\w+)/,\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `https://streamable.com/o/${a.dataset.uid}`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      },\r\n      title: {\r\n        api(uid) { return `https://api.streamable.com/oembed?url=https://streamable.com/${uid}`; },\r\n        text(_) { return _.title; }\r\n      }\r\n    }\r\n    , {\r\n      key: 'TwitchTV',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.|secure\\.|clips\\.|m\\.)?twitch\\.tv\\/(\\w[^#\\&\\?]*)/,\r\n      el(a) {\r\n        let url;\r\n        let m = a.dataset.href.match(/^\\w+:\\/\\/(?:(clips\\.)|\\w+\\.)?twitch\\.tv\\/(?:\\w+\\/)?(clip\\/)?(\\w[^#\\&\\?]*)/);\r\n        if (m[1] || m[2]) {\r\n          url = `//clips.twitch.tv/embed?clip=${m[3]}&parent=${location.hostname}`;\r\n        } else {\r\n          let time;\r\n          m = a.dataset.uid.match(/(\\w+)(?:\\/(?:v\\/)?(\\d+))?/);\r\n          url = `//player.twitch.tv/?${m[2] ? `video=v${m[2]}` : `channel=${m[1]}`}&autoplay=false&parent=${location.hostname}`;\r\n          if (time = a.dataset.href.match(/\\bt=(\\w+)/)) {\r\n            url += `&time=${time[1]}`;\r\n          }\r\n        }\r\n        const el = $.el('iframe',\r\n          {src: url});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Twitter',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.|mobile\\.)?(?:twitter|x)\\.com\\/(\\w+\\/status\\/\\d+)/,\r\n      style: 'border: none; width: 550px; height: 250px; overflow: hidden; resize: both;',\r\n      el(a) {\r\n        const el = $.el('iframe');\r\n        $.on(el, 'load', function() {\r\n          return this.contentWindow.postMessage({element: 't', query: 'height'}, 'https://twitframe.com');\r\n        });\r\n        var onMessage = function(e) {\r\n          if ((e.source === el.contentWindow) && (e.origin === 'https://twitframe.com')) {\r\n            $.off(window, 'message', onMessage);\r\n            return (cont || el).style.height = `${+$.minmax(e.data.height, 250, 0.8 * doc.clientHeight)}px`;\r\n          }\r\n        };\r\n        $.on(window, 'message', onMessage);\r\n        el.src = `https://twitframe.com/show?url=https://twitter.com/${a.dataset.uid}`;\r\n        if ($.engine === 'gecko') {\r\n          // XXX https://bugzilla.mozilla.org/show_bug.cgi?id=680823\r\n          el.style.cssText = 'border: none; width: 100%; height: 100%;';\r\n          var cont = $.el('div');\r\n          $.add(cont, el);\r\n          return cont;\r\n        } else {\r\n          return el;\r\n        }\r\n      }\r\n    }\r\n    , {\r\n      key: 'VidLii',\r\n      regExp:  /^\\w+:\\/\\/(?:www\\.)?vidlii\\.com\\/watch\\?v=(\\w{11})/,\r\n      style: 'border: none; width: 640px; height: 392px;',\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `https://www.vidlii.com/embed?v=${a.dataset.uid}&a=0`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Vimeo',\r\n      regExp:  /^\\w+:\\/\\/(?:www\\.)?vimeo\\.com\\/(\\d+)/,\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `//player.vimeo.com/video/${a.dataset.uid}?wmode=opaque`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      },\r\n      title: {\r\n        api(uid) { return `https://vimeo.com/api/oembed.json?url=https://vimeo.com/${uid}`; },\r\n        text(_) { return _.title; }\r\n      }\r\n    }\r\n    , {\r\n      key: 'Vine',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?vine\\.co\\/v\\/(\\w+)/,\r\n      style: 'border: none; width: 500px; height: 500px;',\r\n      el(a) {\r\n        return $.el('iframe',\r\n          {src: `https://vine.co/v/${a.dataset.uid}/card`});\r\n      }\r\n    }\r\n    , {\r\n      key: 'Vocaroo',\r\n      regExp: /^\\w+:\\/\\/(?:(?:www\\.|old\\.)?vocaroo\\.com|voca\\.ro)\\/((?:i\\/)?\\w+)/,\r\n      style: '',\r\n      el(a) {\r\n        const el = $.el('iframe');\r\n        el.width = 300;\r\n        el.height = 60;\r\n        el.setAttribute('frameborder', 0);\r\n        el.src = `https://vocaroo.com/embed/${a.dataset.uid.replace(/^i\\//, '')}?autoplay=0`;\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'YouTube',\r\n      regExp: /^\\w+:\\/\\/(?:youtu.be\\/|[\\w.]*youtube[\\w.]*\\/.*(?:v=|\\bembed\\/|\\bv\\/|live\\/))([\\w\\-]{11})(.*)/,\r\n      el(a) {\r\n        let start = a.dataset.options.match(/\\b(?:star)?t\\=(\\w+)/);\r\n        if (start) { start = start[1]; }\r\n        if (start && !/^\\d+$/.test(start)) {\r\n          start += ' 0h0m0s';\r\n          start = (3600 * start.match(/(\\d+)h/)[1]) + (60 * start.match(/(\\d+)m/)[1]) + (1 * start.match(/(\\d+)s/)[1]);\r\n        }\r\n        const el = $.el('iframe',\r\n          {src: `//www.youtube.com/embed/${a.dataset.uid}?rel=0&wmode=opaque${start ? '&start=' + start : ''}`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      },\r\n      title: {\r\n        api(uid) { return `https://www.youtube.com/oembed?url=https%3A//www.youtube.com/watch%3Fv%3D${uid}&format=json`; },\r\n        text(_) { return _.title; },\r\n        status(_) {\r\n          if (_.error) {\r\n            const m = _.error.match(/^(\\d*)\\s*(.*)/);\r\n            return [+m[1], m[2]];\r\n          } else {\r\n            return [200, 'OK'];\r\n          }\r\n        }\r\n      },\r\n      preview: {\r\n        url(uid) { return `https://img.youtube.com/vi/${uid}/0.jpg`; },\r\n        height: 360\r\n      }\r\n    }\r\n  ],\r\n\r\n  shouldFetchTitles() {\r\n    if(!Conf['Link Title']) return false;\r\n    if (Conf['Link Title in the catalog']) return true;\r\n    return g.VIEW !== 'catalog' && !(g.VIEW === 'index' && Conf['Index Mode'] === 'catalog');\r\n  },\r\n};\r\nexport default Embedding;\r\n","import Notice from \"../classes/Notice\";\r\nimport Config from \"../config/Config\";\r\nimport Filter from \"../Filtering/Filter\";\r\nimport ThreadHiding from \"../Filtering/ThreadHiding\";\r\nimport BoardConfig from \"../General/BoardConfig\";\r\nimport Get from \"../General/Get\";\r\nimport Header from \"../General/Header\";\r\nimport Index from \"../General/Index\";\r\nimport Settings from \"../General/Settings\";\r\nimport { Conf, d, g } from \"../globals/globals\";\r\nimport FappeTyme from \"../Images/FappeTyme\";\r\nimport Gallery from \"../Images/Gallery\";\r\nimport ImageExpand from \"../Images/ImageExpand\";\r\nimport Embedding from \"../Linkification/Embedding\";\r\nimport ThreadUpdater from \"../Monitoring/ThreadUpdater\";\r\nimport ThreadWatcher from \"../Monitoring/ThreadWatcher\";\r\nimport UnreadIndex from \"../Monitoring/UnreadIndex\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport QR from \"../Posting/QR\";\r\nimport QuoteThreading from \"../Quotelinks/QuoteThreading\";\r\nimport QuoteYou from \"../Quotelinks/QuoteYou\";\r\nimport CatalogLinks from \"./CatalogLinks\";\r\nimport ExpandThread from \"./ExpandThread\";\r\nimport Nav from \"./Nav\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Keybinds = {\r\n  init() {\r\n    if (!Conf['Keybinds']) { return; }\r\n\r\n    for (var hotkey in Config.hotkeys) {\r\n      $.sync(hotkey, Keybinds.sync);\r\n    }\r\n\r\n    var init = function() {\r\n      $.off(d, '4chanXInitFinished', init);\r\n      $.on(d, 'keydown', Keybinds.keydown);\r\n      for (var node of $$('[accesskey]')) {\r\n        node.removeAttribute('accesskey');\r\n      }\r\n    };\r\n    return $.on(d, '4chanXInitFinished', init);\r\n  },\r\n\r\n  sync(key, hotkey) {\r\n    return Conf[hotkey] = key;\r\n  },\r\n\r\n  keydown(e) {\r\n    let key, thread, threadRoot;\r\n    let catalog, notifications;\r\n    if (!(key = Keybinds.keyCode(e))) { return; }\r\n    const {target} = e;\r\n    if (['INPUT', 'TEXTAREA'].includes(target.nodeName)) {\r\n      if (!/(Esc|Alt|Ctrl|Meta|Shift\\+\\w{2,})/.test(key) || !!/^Alt\\+(\\d|Up|Down|Left|Right)$/.test(key)) { return; }\r\n    }\r\n    if (['index', 'thread'].includes(g.VIEW)) {\r\n      threadRoot = Nav.getThread();\r\n      thread = Get.threadFromRoot(threadRoot);\r\n    }\r\n    switch (key) {\r\n      // QR & Options\r\n      case Conf['Toggle board list']:\r\n        if (!Conf['Custom Board Navigation']) { return; }\r\n        Header.toggleBoardList();\r\n        break;\r\n      case Conf['Toggle header']:\r\n        Header.toggleBarVisibility();\r\n        break;\r\n      case Conf['Open empty QR']:\r\n        if (!QR.postingIsEnabled) { return; }\r\n        Keybinds.qr();\r\n        break;\r\n      case Conf['Open QR']:\r\n        if (!QR.postingIsEnabled || !threadRoot) { return; }\r\n        Keybinds.qr(threadRoot);\r\n        break;\r\n      case Conf['Open settings']:\r\n        Settings.open();\r\n        break;\r\n      case Conf['Close']:\r\n        if (Settings.dialog) {\r\n          Settings.close();\r\n        } else if ((notifications = $$('.notification')).length) {\r\n          for (var notification of notifications) {\r\n            $('.close', notification).click();\r\n          }\r\n        } else if (QR.nodes && !(QR.nodes.el.hidden || (window.getComputedStyle(QR.nodes.form).display === 'none'))) {\r\n          if (Conf['Persistent QR']) {\r\n            QR.hide();\r\n          } else {\r\n            QR.close();\r\n          }\r\n        } else if (Embedding.lastEmbed) {\r\n          Embedding.closeFloat();\r\n        } else {\r\n          return;\r\n        }\r\n        break;\r\n      case Conf['Spoiler tags']:\r\n        if (target.nodeName !== 'TEXTAREA') { return; }\r\n        Keybinds.tags('spoiler', target);\r\n        break;\r\n      case Conf['Code tags']:\r\n        if (target.nodeName !== 'TEXTAREA') { return; }\r\n        Keybinds.tags('code', target);\r\n        break;\r\n      case Conf['Eqn tags']:\r\n        if (target.nodeName !== 'TEXTAREA') { return; }\r\n        Keybinds.tags('eqn', target);\r\n        break;\r\n      case Conf['Math tags']:\r\n        if (target.nodeName !== 'TEXTAREA') { return; }\r\n        Keybinds.tags('math', target);\r\n        break;\r\n      case Conf['SJIS tags']:\r\n        if (target.nodeName !== 'TEXTAREA') { return; }\r\n        Keybinds.tags('sjis', target);\r\n        break;\r\n      case Conf['Toggle sage']:\r\n        if (!QR.nodes || !!QR.nodes.el.hidden) { return; }\r\n        Keybinds.sage();\r\n        break;\r\n      case Conf['Toggle Cooldown']:\r\n        if (!QR.nodes || !!QR.nodes.el.hidden || !$.hasClass(QR.nodes.fileSubmit, 'custom-cooldown')) { return; }\r\n        QR.toggleCustomCooldown();\r\n        break;\r\n      case Conf['Post from URL']:\r\n        if (!QR.postingIsEnabled) { return; }\r\n        QR.handleUrl('');\r\n        break;\r\n      case Conf['Add new post']:\r\n        if (!QR.postingIsEnabled) { return; }\r\n        QR.addPost();\r\n        break;\r\n      case Conf['Submit QR']:\r\n        if (!QR.nodes || !!QR.nodes.el.hidden) { return; }\r\n        if (!QR.status()) { QR.submit(); }\r\n        break;\r\n      // Index/Thread related\r\n      case Conf['Update']:\r\n        switch (g.VIEW) {\r\n          case 'thread':\r\n            if (!ThreadUpdater.enabled) { return; }\r\n            ThreadUpdater.update();\r\n            break;\r\n          case 'index':\r\n            if (!Index.enabled) { return; }\r\n            Index.update();\r\n            break;\r\n          default:\r\n            return;\r\n        }\r\n        break;\r\n      case Conf['Watch']:\r\n        if (!ThreadWatcher.enabled || !thread) { return; }\r\n        ThreadWatcher.toggle(thread);\r\n        break;\r\n      case Conf['Update thread watcher']:\r\n        if (!ThreadWatcher.enabled) { return; }\r\n        ThreadWatcher.buttonFetchAll();\r\n        break;\r\n      case Conf['Toggle thread watcher']:\r\n        if (!ThreadWatcher.enabled) { return; }\r\n        ThreadWatcher.toggleWatcher();\r\n        break;\r\n      case Conf['Toggle threading']:\r\n        if (!QuoteThreading.ready) { return; }\r\n        QuoteThreading.toggleThreading();\r\n        break;\r\n      case Conf['Mark thread read']:\r\n        if ((g.VIEW !== 'index') || !thread || !UnreadIndex.enabled) { return; }\r\n        UnreadIndex.markRead.call(threadRoot);\r\n        break;\r\n      // Images\r\n      case Conf['Expand image']:\r\n        if (!ImageExpand.enabled || !threadRoot) { return; }\r\n        var post = Get.postFromNode(Keybinds.post(threadRoot));\r\n        if (post.file) { ImageExpand.toggle(post); }\r\n        break;\r\n      case Conf['Expand images']:\r\n        if (!ImageExpand.enabled) { return; }\r\n        ImageExpand.cb.toggleAll();\r\n        break;\r\n      case Conf['Open Gallery']:\r\n        if (!Gallery.enabled) { return; }\r\n        Gallery.cb.toggle();\r\n        break;\r\n      case Conf['fappeTyme']:\r\n        if (!FappeTyme.nodes?.fappe) { return; }\r\n        FappeTyme.toggle('fappe');\r\n        break;\r\n      case Conf['werkTyme']:\r\n        if (!FappeTyme.nodes?.werk) { return; }\r\n        FappeTyme.toggle('werk');\r\n        break;\r\n      // Board Navigation\r\n      case Conf['Front page']:\r\n        if (Index.enabled) {\r\n          Index.userPageNav(1);\r\n        } else {\r\n          location.href = `/${g.BOARD}/`;\r\n        }\r\n        break;\r\n      case Conf['Open front page']:\r\n        $.open(`${location.origin}/${g.BOARD}/`);\r\n        break;\r\n      case Conf['Next page']:\r\n        if ((g.VIEW !== 'index') || !!g.SITE.isOnePage?.(g.BOARD)) { return; }\r\n        if (Index.enabled) {\r\n          if (!['paged', 'infinite'].includes(Conf['Index Mode'])) { return; }\r\n          $('.next button', Index.pagelist).click();\r\n        } else {\r\n          $(g.SITE.selectors.nav.next)?.click();\r\n        }\r\n        break;\r\n      case Conf['Previous page']:\r\n        if ((g.VIEW !== 'index') || !!g.SITE.isOnePage?.(g.BOARD)) { return; }\r\n        if (Index.enabled) {\r\n          if (!['paged', 'infinite'].includes(Conf['Index Mode'])) { return; }\r\n          $('.prev button', Index.pagelist).click();\r\n        } else {\r\n          $(g.SITE.selectors.nav.prev)?.click();\r\n        }\r\n        break;\r\n      case Conf['Search form']:\r\n        if (g.VIEW !== 'index') { return; }\r\n        var searchInput = Index.enabled ?\r\n          Index.searchInput\r\n        : g.SITE.selectors.searchBox ?\r\n          $(g.SITE.selectors.searchBox)\r\n        :\r\n          undefined;\r\n        if (!searchInput) { return; }\r\n        Header.scrollToIfNeeded(searchInput);\r\n        searchInput.focus();\r\n        break;\r\n      case Conf['Paged mode']:\r\n        if (!Index.enabledOn(g.BOARD)) { return; }\r\n        location.href = g.VIEW === 'index' ? '#paged' : `/${g.BOARD}/#paged`;\r\n        break;\r\n      case Conf['Infinite scrolling mode']:\r\n        if (!Index.enabledOn(g.BOARD)) { return; }\r\n        location.href = g.VIEW === 'index' ? '#infinite' : `/${g.BOARD}/#infinite`;\r\n        break;\r\n      case Conf['All pages mode']:\r\n        if (!Index.enabledOn(g.BOARD)) { return; }\r\n        location.href = g.VIEW === 'index' ? '#all-pages' : `/${g.BOARD}/#all-pages`;\r\n        break;\r\n      case Conf['Open catalog']:\r\n        if (!(catalog = CatalogLinks.catalog())) { return; }\r\n        location.href = catalog;\r\n        break;\r\n      case Conf['Cycle sort type']:\r\n        if (!Index.enabled) { return; }\r\n        Index.cycleSortType();\r\n        break;\r\n      // Thread Navigation\r\n      case Conf['Next thread']:\r\n        if ((g.VIEW !== 'index') || !threadRoot) { return; }\r\n        Nav.scroll(+1);\r\n        break;\r\n      case Conf['Previous thread']:\r\n        if ((g.VIEW !== 'index') || !threadRoot) { return; }\r\n        Nav.scroll(-1);\r\n        break;\r\n      case Conf['Expand thread']:\r\n        if ((g.VIEW !== 'index') || !threadRoot) { return; }\r\n        ExpandThread.toggle(thread);\r\n        // Keep thread from moving off screen when contracted.\r\n        Header.scrollTo(threadRoot);\r\n        break;\r\n      case Conf['Open thread']:\r\n        if ((g.VIEW !== 'index') || !threadRoot) { return; }\r\n        Keybinds.open(thread);\r\n        break;\r\n      case Conf['Open thread tab']:\r\n        if ((g.VIEW !== 'index') || !threadRoot) { return; }\r\n        Keybinds.open(thread, true);\r\n        break;\r\n      // Reply Navigation\r\n      case Conf['Next reply']:\r\n        if (!threadRoot) { return; }\r\n        Keybinds.hl(+1, threadRoot);\r\n        break;\r\n      case Conf['Previous reply']:\r\n        if (!threadRoot) { return; }\r\n        Keybinds.hl(-1, threadRoot);\r\n        break;\r\n      case Conf['Deselect reply']:\r\n        if (!threadRoot) { return; }\r\n        Keybinds.hl(0, threadRoot);\r\n        break;\r\n      case Conf['Hide']:\r\n        if (!thread || !ThreadHiding.db) { return; }\r\n        Header.scrollTo(threadRoot);\r\n        ThreadHiding.toggle(thread);\r\n        break;\r\n      case Conf['Quick Filter MD5']:\r\n        if (!threadRoot) { return; }\r\n        post = Keybinds.post(threadRoot);\r\n        Keybinds.hl(+1, threadRoot);\r\n        Filter.quickFilterMD5.call(post, e);\r\n        break;\r\n      case Conf['Previous Post Quoting You']:\r\n        if (!threadRoot || !QuoteYou.db) { return; }\r\n        QuoteYou.cb.seek('preceding');\r\n        break;\r\n      case Conf['Next Post Quoting You']:\r\n        if (!threadRoot || !QuoteYou.db) { return; }\r\n        QuoteYou.cb.seek('following');\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n    e.preventDefault();\r\n    return e.stopPropagation();\r\n  },\r\n\r\n  keyCode(e) {\r\n    let key = (() => { let kc;\r\n    switch ((kc = e.keyCode)) {\r\n      case 8: // return\r\n        return '';\r\n      case 13:\r\n        return 'Enter';\r\n      case 27:\r\n        return 'Esc';\r\n      case 32:\r\n        return 'Space';\r\n      case 37:\r\n        return 'Left';\r\n      case 38:\r\n        return 'Up';\r\n      case 39:\r\n        return 'Right';\r\n      case 40:\r\n        return 'Down';\r\n      case 188:\r\n        return 'Comma';\r\n      case 190:\r\n        return 'Period';\r\n      case 191:\r\n        return 'Slash';\r\n      case 59: case 186:\r\n        return 'Semicolon';\r\n      default:\r\n        if ((48 <= kc && kc <= 57) || (65 <= kc && kc <= 90)) { // 0-9, A-Z\r\n          return String.fromCharCode(kc).toLowerCase();\r\n        } else if (96 <= kc && kc <= 105) { // numpad 0-9\r\n          return String.fromCharCode(kc - 48).toLowerCase();\r\n        } else {\r\n          return null;\r\n        }\r\n    } })();\r\n    if (key) {\r\n      if (e.altKey) {   key = 'Alt+'   + key; }\r\n      if (e.ctrlKey) {  key = 'Ctrl+'  + key; }\r\n      if (e.metaKey) {  key = 'Meta+'  + key; }\r\n      if (e.shiftKey) { key = 'Shift+' + key; }\r\n    }\r\n    return key;\r\n  },\r\n\r\n  post(thread) {\r\n    const s = g.SITE.selectors;\r\n    return (\r\n      $(`${s.postContainer}${s.highlightable.reply}.${g.SITE.classes.highlight}`, thread) ||\r\n      $(`${g.SITE.isOPContainerThread ? s.thread : s.postContainer}${s.highlightable.op}`, thread)\r\n    );\r\n  },\r\n\r\n  qr(thread) {\r\n    QR.open();\r\n    if (thread != null) {\r\n      QR.quote.call(Keybinds.post(thread));\r\n    }\r\n    return QR.nodes.com.focus();\r\n  },\r\n\r\n  tags(tag, ta) {\r\n    BoardConfig.ready(function() {\r\n      const {config} = g.BOARD;\r\n      const supported = (() => { switch (tag) {\r\n        case 'spoiler':     return !!config.spoilers;\r\n        case 'code':        return !!config.code_tags;\r\n        case 'math': case 'eqn': return !!config.math_tags;\r\n        case 'sjis':        return !!config.sjis_tags;\r\n      } })();\r\n      if (!supported) { return new Notice('warning', `[${tag}] tags are not supported on /${g.BOARD}/.`, 20); }\r\n    });\r\n\r\n    const {\r\n      value\r\n    } = ta;\r\n    const selStart = ta.selectionStart;\r\n    const selEnd   = ta.selectionEnd;\r\n\r\n    ta.value =\r\n      value.slice(0, selStart) +\r\n      `[${tag}]` + value.slice(selStart, selEnd) + `[/${tag}]` +\r\n      value.slice(selEnd);\r\n\r\n    // Move the caret to the end of the selection.\r\n    const range = (`[${tag}]`).length + selEnd;\r\n    ta.setSelectionRange(range, range);\r\n\r\n    // Fire the 'input' event\r\n    return $.event('input', null, ta);\r\n  },\r\n\r\n  sage() {\r\n    const isSage  = /sage/i.test(QR.nodes.email.value);\r\n    return QR.nodes.email.value = isSage ?\r\n      \"\"\r\n    : \"sage\";\r\n  },\r\n\r\n  open(thread, tab) {\r\n    if (g.VIEW !== 'index') { return; }\r\n    const url = Get.url('thread', thread);\r\n    if (tab) {\r\n      return $.open(url);\r\n    } else {\r\n      return location.href = url;\r\n    }\r\n  },\r\n\r\n  hl(delta, thread) {\r\n    const replySelector = `${g.SITE.selectors.postContainer}${g.SITE.selectors.highlightable.reply}`;\r\n    const {highlight} = g.SITE.classes;\r\n\r\n    const postEl = $(`${replySelector}.${highlight}`, thread);\r\n\r\n    if (!delta) {\r\n      if (postEl) { $.rmClass(postEl, highlight); }\r\n      return;\r\n    }\r\n\r\n    if (postEl) {\r\n      const {height} = postEl.getBoundingClientRect();\r\n      if ((Header.getTopOf(postEl) >= -height) && (Header.getBottomOf(postEl) >= -height)) { // We're at least partially visible\r\n        let next;\r\n        const {root} = Get.postFromNode(postEl).nodes;\r\n        const axis = delta === +1 ?\r\n          'following'\r\n        :\r\n          'preceding';\r\n        if (!(next = $.x(`${axis}-sibling::${g.SITE.xpath.replyContainer}[not(@hidden) and not(child::div[@class='stub'])][1]`, root))) { return; }\r\n        if (!next.matches(replySelector)) { next = $(replySelector, next); }\r\n        Header.scrollToIfNeeded(next, delta === +1);\r\n        $.addClass(next, highlight);\r\n        $.rmClass(postEl, highlight);\r\n        return;\r\n      }\r\n      $.rmClass(postEl, highlight);\r\n    }\r\n\r\n    const replies = $$(replySelector, thread);\r\n    if (delta === -1) { replies.reverse(); }\r\n    for (var reply of replies) {\r\n      if (((delta === +1) && (Header.getTopOf(reply) > 0)) || ((delta === -1) && (Header.getBottomOf(reply) > 0))) {\r\n        $.addClass(reply, highlight);\r\n        return;\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default Keybinds;\r\n","import $ from \"../platform/$\";\r\nimport CaptchaReplace from \"./Captcha.replace\";\r\nimport CaptchaT from \"./Captcha.t\";\r\nimport meta from '../../package.json';\r\nimport Main from \"../main/Main\";\r\nimport Keybinds from \"../Miscellaneous/Keybinds\";\r\nimport $$ from \"../platform/$$\";\r\nimport QR from \"./QR\";\r\nimport { Conf, d, doc } from \"../globals/globals\";\r\nimport { MINUTE, SECOND } from \"../platform/helpers\";\r\n\r\nconst Captcha = {\r\n  Cache: {\r\n    init() {\r\n      $.on(d, 'SaveCaptcha', e => {\r\n        return this.saveAPI(e.detail);\r\n      });\r\n      return $.on(d, 'NoCaptcha', e => {\r\n        return this.noCaptcha(e.detail);\r\n      });\r\n    },\r\n\r\n    captchas: [],\r\n\r\n    getCount() {\r\n      return this.captchas.length;\r\n    },\r\n\r\n    neededRaw() {\r\n      return !(\r\n        this.haveCookie() || this.captchas.length || QR.req || this.submitCB\r\n      ) && (\r\n          (QR.posts.length > 1) || Conf['Auto-load captcha'] || !QR.posts[0].isOnlyQuotes() || QR.posts[0].file\r\n        );\r\n    },\r\n\r\n    needed() {\r\n      return this.neededRaw() && $.event('LoadCaptcha');\r\n    },\r\n\r\n    prerequest() {\r\n      if (!Conf['Prerequest Captcha']) { return; }\r\n      // Post count temporarily off by 1 when called from QR.post.rm, QR.close, or QR.submit\r\n      return $.queueTask(() => {\r\n        if (\r\n          !this.prerequested &&\r\n          this.neededRaw() &&\r\n          !$.event('LoadCaptcha') &&\r\n          !QR.captcha.occupied() &&\r\n          (QR.cooldown.seconds <= 60) &&\r\n          (QR.selected === QR.posts[QR.posts.length - 1]) &&\r\n          !QR.selected.isOnlyQuotes()\r\n        ) {\r\n          const isReply = (QR.selected.thread !== 'new');\r\n          if (!$.event('RequestCaptcha', { isReply })) {\r\n            this.prerequested = true;\r\n            this.submitCB = captcha => {\r\n              if (captcha) { return this.save(captcha); }\r\n            };\r\n            return this.updateCount();\r\n          }\r\n        }\r\n      });\r\n    },\r\n\r\n    haveCookie() {\r\n      return /\\b_ct=/.test(d.cookie) && (QR.posts[0].thread !== 'new');\r\n    },\r\n\r\n    getOne() {\r\n      let captcha;\r\n      delete this.prerequested;\r\n      this.clear();\r\n      if (captcha = this.captchas.shift()) {\r\n        this.count();\r\n        return captcha;\r\n      } else {\r\n        return null;\r\n      }\r\n    },\r\n\r\n    request(isReply) {\r\n      if (!this.submitCB) {\r\n        if ($.event('RequestCaptcha', { isReply })) { return; }\r\n      }\r\n      return cb => {\r\n        this.submitCB = cb;\r\n        return this.updateCount();\r\n      };\r\n    },\r\n\r\n    abort() {\r\n      if (this.submitCB) {\r\n        delete this.submitCB;\r\n        $.event('AbortCaptcha');\r\n        return this.updateCount();\r\n      }\r\n    },\r\n\r\n    saveAPI(captcha) {\r\n      let cb;\r\n      if (cb = this.submitCB) {\r\n        delete this.submitCB;\r\n        cb(captcha);\r\n        return this.updateCount();\r\n      } else {\r\n        return this.save(captcha);\r\n      }\r\n    },\r\n\r\n    noCaptcha(detail) {\r\n      let cb;\r\n      if (cb = this.submitCB) {\r\n        if (!this.haveCookie() || detail?.error) {\r\n          QR.error(detail?.error || 'Failed to retrieve captcha.');\r\n          QR.captcha.setup(d.activeElement === QR.nodes.status);\r\n        }\r\n        delete this.submitCB;\r\n        cb();\r\n        return this.updateCount();\r\n      }\r\n    },\r\n\r\n    save(captcha) {\r\n      let cb;\r\n      if (cb = this.submitCB) {\r\n        this.abort();\r\n        cb(captcha);\r\n        return;\r\n      }\r\n      this.captchas.push(captcha);\r\n      this.captchas.sort((a, b) => a.timeout - b.timeout);\r\n      return this.count();\r\n    },\r\n\r\n    clear() {\r\n      if (this.captchas.length) {\r\n        let i;\r\n        const now = Date.now();\r\n        for (i = 0; i < this.captchas.length; i++) {\r\n          var captcha = this.captchas[i];\r\n          if (captcha.timeout > now) { break; }\r\n        }\r\n        if (i) {\r\n          this.captchas = this.captchas.slice(i);\r\n          return this.count();\r\n        }\r\n      }\r\n    },\r\n\r\n    count() {\r\n      clearTimeout(this.timer);\r\n      if (this.captchas.length) {\r\n        this.timer = setTimeout(this.clear.bind(this), this.captchas[0].timeout - Date.now());\r\n      }\r\n      return this.updateCount();\r\n    },\r\n\r\n    updateCount() {\r\n      return $.event('CaptchaCount', this.captchas.length);\r\n    }\r\n  }, Replace: CaptchaReplace, t: CaptchaT, v2: {\r\n    lifetime: 2 * MINUTE,\r\n\r\n    init() {\r\n      if (d.cookie.indexOf('pass_enabled=1') >= 0) { return; }\r\n      if (!(this.isEnabled = !!$('#g-recaptcha, #captcha-forced-noscript') || !$.id('postForm'))) { return; }\r\n\r\n      if (this.noscript = Conf['Force Noscript Captcha'] || !Main.jsEnabled) {\r\n        $.addClass(QR.nodes.el, 'noscript-captcha');\r\n      }\r\n\r\n      Captcha.cache.init();\r\n      $.on(d, 'CaptchaCount', this.count.bind(this));\r\n\r\n      const root = $.el('div', { className: 'captcha-root' });\r\n      $.extend(root, {\r\n        innerHTML:\r\n          '<div class=\"captcha-counter\"><a href=\"javascript:;\"></a></div>'\r\n      }\r\n      );\r\n      const counter = $('.captcha-counter > a', root);\r\n      this.nodes = { root, counter };\r\n      this.count();\r\n      $.addClass(QR.nodes.el, 'has-captcha', 'captcha-v2');\r\n      $.after(QR.nodes.com.parentNode, root);\r\n\r\n      $.on(counter, 'click', this.toggle.bind(this));\r\n      $.on(counter, 'keydown', e => {\r\n        if (Keybinds.keyCode(e) !== 'Space') { return; }\r\n        this.toggle();\r\n        e.preventDefault();\r\n        return e.stopPropagation();\r\n      });\r\n      return $.on(window, 'captcha:success', () => {\r\n        // XXX Greasemonkey 1.x workaround to gain access to GM_* functions.\r\n        return $.queueTask(() => this.save(false));\r\n      });\r\n    },\r\n\r\n    timeouts: {},\r\n    prevNeeded: 0,\r\n\r\n    noscriptURL() {\r\n      let lang;\r\n      let url = `https://www.google.com/recaptcha/api/fallback?k=${meta.recaptchaKey}`;\r\n      if (lang = Conf['captchaLanguage'].trim()) {\r\n        url += `&hl=${encodeURIComponent(lang)}`;\r\n      }\r\n      return url;\r\n    },\r\n\r\n    moreNeeded() {\r\n      // Post count temporarily off by 1 when called from QR.post.rm, QR.close, or QR.submit\r\n      return $.queueTask(() => {\r\n        const needed = Captcha.cache.needed();\r\n        if (needed && !this.prevNeeded) {\r\n          this.setup(QR.cooldown.auto && (d.activeElement === QR.nodes.status));\r\n        }\r\n        return this.prevNeeded = needed;\r\n      });\r\n    },\r\n\r\n    toggle() {\r\n      if (this.nodes.container && !this.timeouts.destroy) {\r\n        return this.destroy();\r\n      } else {\r\n        return this.setup(true, true);\r\n      }\r\n    },\r\n\r\n    setup(focus, force) {\r\n      if (!this.isEnabled || (!Captcha.cache.needed() && !force)) { return; }\r\n\r\n      if (focus) {\r\n        $.addClass(QR.nodes.el, 'focus');\r\n        this.nodes.counter.focus();\r\n      }\r\n\r\n      if (this.timeouts.destroy) {\r\n        clearTimeout(this.timeouts.destroy);\r\n        delete this.timeouts.destroy;\r\n        return this.reload();\r\n      }\r\n\r\n      if (this.nodes.container) {\r\n        // XXX https://bugzilla.mozilla.org/show_bug.cgi?id=1226835\r\n        $.queueTask(() => {\r\n          let iframe;\r\n          if (this.nodes.container && (d.activeElement === this.nodes.counter) && (iframe = $('iframe[src^=\"https://www.google.com/recaptcha/\"]', this.nodes.container))) {\r\n            iframe.focus();\r\n            return QR.focus();\r\n          }\r\n        }); // Event handler not fired in Firefox\r\n        return;\r\n      }\r\n\r\n      this.nodes.container = $.el('div', { className: 'captcha-container' });\r\n      $.prepend(this.nodes.root, this.nodes.container);\r\n      new MutationObserver(this.afterSetup.bind(this)).observe(this.nodes.container, {\r\n        childList: true,\r\n        subtree: true\r\n      }\r\n      );\r\n\r\n      if (this.noscript) {\r\n        return this.setupNoscript();\r\n      } else {\r\n        return this.setupJS();\r\n      }\r\n    },\r\n\r\n    setupNoscript() {\r\n      const iframe = $.el('iframe', {\r\n        id: 'qr-captcha-iframe',\r\n        scrolling: 'no',\r\n        src: this.noscriptURL()\r\n      }\r\n      );\r\n      const div = $.el('div');\r\n      const textarea = $.el('textarea');\r\n      $.add(div, textarea);\r\n      return $.add(this.nodes.container, [iframe, div]);\r\n    },\r\n\r\n    setupJS() {\r\n      return $.global(function () {\r\n        const render = function () {\r\n          const { classList } = document.documentElement;\r\n          const container = document.querySelector('#qr .captcha-container');\r\n          return container.dataset.widgetID = window.grecaptcha.render(container, {\r\n            sitekey: meta.recaptchaKey,\r\n            theme: classList.contains('tomorrow') || classList.contains('spooky') || classList.contains('dark-captcha') ? 'dark' : 'light',\r\n            callback(response) {\r\n              return window.dispatchEvent(new CustomEvent('captcha:success', { detail: response }));\r\n            }\r\n          }\r\n          );\r\n        };\r\n        if (window.grecaptcha) {\r\n          return render();\r\n        } else {\r\n          const cbNative = window.onRecaptchaLoaded;\r\n          window.onRecaptchaLoaded = function () {\r\n            render();\r\n            return cbNative();\r\n          };\r\n          if (!document.head.querySelector('script[src^=\"https://www.google.com/recaptcha/api.js\"]')) {\r\n            const script = document.createElement('script');\r\n            script.src = 'https://www.google.com/recaptcha/api.js?onload=onRecaptchaLoaded&render=explicit';\r\n            return document.head.appendChild(script);\r\n          }\r\n        }\r\n      });\r\n    },\r\n\r\n    afterSetup(mutations) {\r\n      for (var mutation of mutations) {\r\n        for (var node of mutation.addedNodes) {\r\n          var iframe, textarea;\r\n          if (iframe = $.x('./descendant-or-self::iframe[starts-with(@src, \"https://www.google.com/recaptcha/\")]', node)) { this.setupIFrame(iframe); }\r\n          if (textarea = $.x('./descendant-or-self::textarea', node)) { this.setupTextArea(textarea); }\r\n        }\r\n      }\r\n    },\r\n\r\n    setupIFrame(iframe) {\r\n      let needle;\r\n      if (!doc.contains(iframe)) { return; }\r\n      Captcha.replace.iframe(iframe);\r\n      $.addClass(QR.nodes.el, 'captcha-open');\r\n      this.fixQRPosition();\r\n      $.on(iframe, 'load', this.fixQRPosition);\r\n      if (d.activeElement === this.nodes.counter) { iframe.focus(); }\r\n      // XXX Make sure scroll on space prevention (see src/css/style.css) doesn't cause scrolling of div\r\n      if (['blink', 'edge'].includes($.engine) && (needle = iframe.parentNode, $$('#qr .captcha-container > div > div:first-of-type').includes(needle))) {\r\n        return $.on(iframe.parentNode, 'scroll', function () { return this.scrollTop = 0; });\r\n      }\r\n    },\r\n\r\n    fixQRPosition() {\r\n      if (QR.nodes.el.getBoundingClientRect().bottom > doc.clientHeight) {\r\n        QR.nodes.el.style.top = '';\r\n        return QR.nodes.el.style.bottom = '0px';\r\n      }\r\n    },\r\n\r\n    setupTextArea(textarea) {\r\n      return $.one(textarea, 'input', () => this.save(true));\r\n    },\r\n\r\n    destroy() {\r\n      if (!this.isEnabled) { return; }\r\n      delete this.timeouts.destroy;\r\n      $.rmClass(QR.nodes.el, 'captcha-open');\r\n      if (this.nodes.container) {\r\n        $.global(function () {\r\n          const container = document.querySelector('#qr .captcha-container');\r\n          return window.grecaptcha.reset(container.dataset.widgetID);\r\n        });\r\n        $.rm(this.nodes.container);\r\n        return delete this.nodes.container;\r\n      }\r\n    },\r\n\r\n    getOne(isReply) {\r\n      return Captcha.cache.getOne(isReply);\r\n    },\r\n\r\n    save(pasted, token) {\r\n      Captcha.cache.save({\r\n        response: token || $('textarea', this.nodes.container).value,\r\n        timeout: Date.now() + this.lifetime\r\n      });\r\n\r\n      const focus = (d.activeElement?.nodeName === 'IFRAME') && /https?:\\/\\/www\\.google\\.com\\/recaptcha\\//.test(d.activeElement.src);\r\n      if (Captcha.cache.needed()) {\r\n        if (focus) {\r\n          if (QR.cooldown.auto || Conf['Post on Captcha Completion']) {\r\n            this.nodes.counter.focus();\r\n          } else {\r\n            QR.nodes.status.focus();\r\n          }\r\n        }\r\n        this.reload();\r\n      } else {\r\n        if (pasted) {\r\n          this.destroy();\r\n        } else {\r\n          if (this.timeouts.destroy == null) { this.timeouts.destroy = setTimeout(this.destroy.bind(this), 3 * SECOND); }\r\n        }\r\n        if (focus) { QR.nodes.status.focus(); }\r\n      }\r\n\r\n      if (Conf['Post on Captcha Completion'] && !QR.cooldown.auto) { return QR.submit(); }\r\n    },\r\n\r\n    count() {\r\n      const count = Captcha.cache.getCount();\r\n      const loading = Captcha.cache.submitCB ? '...' : '';\r\n      this.nodes.counter.textContent = `Captchas: ${count}${loading}`;\r\n      return this.moreNeeded();\r\n    },\r\n\r\n    reload() {\r\n      if ($('iframe[src^=\"https://www.google.com/recaptcha/api/fallback?\"]', this.nodes.container)) {\r\n        this.destroy();\r\n        return this.setup(false, true);\r\n      } else {\r\n        return $.global(function () {\r\n          const container = document.querySelector('#qr .captcha-container');\r\n          return window.grecaptcha.reset(container.dataset.widgetID);\r\n        });\r\n      }\r\n    },\r\n\r\n    occupied() {\r\n      return !!this.nodes.container && !this.timeouts.destroy;\r\n    }\r\n  }\r\n};\r\nexport default Captcha;\r\n","import QuickReplyPage from './QR/QuickReply.html';\r\nimport $ from '../platform/$';\r\nimport Callbacks from '../classes/Callbacks';\r\nimport Notice from '../classes/Notice';\r\nimport Main from '../main/Main';\r\nimport Favicon from '../Monitoring/Favicon';\r\nimport $$ from '../platform/$$';\r\nimport CrossOrigin from '../platform/CrossOrigin';\r\nimport Captcha from './Captcha';\r\nimport meta from '../../package.json';\r\nimport Header from '../General/Header';\r\nimport { Conf, E, d, doc, g } from '../globals/globals';\r\nimport Menu from '../Menu/Menu';\r\nimport UI from '../General/UI';\r\nimport BoardConfig from '../General/BoardConfig';\r\nimport Get from '../General/Get';\r\nimport { DAY, dict, SECOND } from '../platform/helpers';\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS202: Simplify dynamic range loops\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n\r\nvar QR = {\r\n  mimeTypes: ['image/jpeg', 'image/png', 'image/gif', 'application/pdf', 'application/vnd.adobe.flash.movie', 'application/x-shockwave-flash', 'video/webm'],\r\n\r\n  validExtension: /\\.(jpe?g|png|gif|pdf|swf|webm)$/i,\r\n\r\n  typeFromExtension: {\r\n    'jpg':  'image/jpeg',\r\n    'jpeg': 'image/jpeg',\r\n    'png':  'image/png',\r\n    'gif':  'image/gif',\r\n    'pdf':  'application/pdf',\r\n    'swf':  'application/vnd.adobe.flash.movie',\r\n    'webm': 'video/webm'\r\n  },\r\n\r\n  extensionFromType: {\r\n    'image/jpeg': 'jpg',\r\n    'image/png': 'png',\r\n    'image/gif': 'gif',\r\n    'application/pdf': 'pdf',\r\n    'application/vnd.adobe.flash.movie': 'swf',\r\n    'application/x-shockwave-flash': 'swf',\r\n    'video/webm': 'webm'\r\n  },\r\n\r\n  init() {\r\n    let sc;\r\n    if (!Conf['Quick Reply']) { return; }\r\n\r\n    this.posts = [];\r\n\r\n    $.on(d, '4chanXInitFinished', () => BoardConfig.ready(QR.initReady));\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Quick Reply',\r\n      cb:   this.node\r\n    });\r\n\r\n    this.shortcut = (sc = $.el('a', {\r\n      className: 'disabled bolder-icon bigger-icon',\r\n      textContent: 'Quick Reply',\r\n      title: 'Quick Reply',\r\n      href: 'javascript:;',\r\n    }));\r\n    $.on(sc, 'click', function() {\r\n      if (!QR.postingIsEnabled) { return; }\r\n      if (Conf['Persistent QR'] || !QR.nodes || QR.nodes.el.hidden) {\r\n        QR.open();\r\n        return QR.nodes.com.focus();\r\n      } else {\r\n        return QR.close();\r\n      }\r\n    });\r\n\r\n    return Header.addShortcut('qr', sc, 540, '↩');\r\n  },\r\n\r\n  initReady() {\r\n    let origToggle;\r\n    const captchaVersion = $('#g-recaptcha, #captcha-forced-noscript') ? 'v2' : 't';\r\n    QR.captcha = Captcha[captchaVersion];\r\n    QR.postingIsEnabled = true;\r\n\r\n    const {config} = g.BOARD;\r\n    const prop = (key, def) => +(config[key] ?? def);\r\n\r\n    QR.min_width  = prop('min_image_width',  1);\r\n    QR.min_height = prop('min_image_height', 1);\r\n    QR.max_width  = (QR.max_height = 10000);\r\n\r\n    QR.max_size       = prop('max_filesize',      4194304);\r\n    QR.max_size_video = prop('max_webm_filesize', QR.max_size);\r\n    QR.max_comment    = prop('max_comment_chars', 2000);\r\n\r\n    QR.max_width_video = (QR.max_height_video = 2048);\r\n    QR.max_duration_video = prop('max_webm_duration', 120);\r\n\r\n    QR.forcedAnon = !!config.forced_anon;\r\n    QR.spoiler    = !!config.spoilers;\r\n\r\n    if (origToggle = $.id('togglePostFormLink')) {\r\n      const link = $.el('h1',\r\n        {className: \"qr-link-container\"});\r\n      $.extend(link, {\r\n        innerHTML:\r\n          `<a href=\"javascript:;\" class=\"qr-link\">${g.VIEW === \"thread\" ? \"Reply to Thread\" : \"Start a Thread\"}</a>`\r\n      });\r\n\r\n      QR.link = link.firstElementChild;\r\n      $.on(link.firstChild, 'click', function() {\r\n        QR.open();\r\n        return QR.nodes.com.focus();\r\n      });\r\n\r\n      $.before(origToggle, link);\r\n      origToggle.firstElementChild.textContent = 'Original Form';\r\n    }\r\n\r\n    if (g.VIEW === 'thread') {\r\n      let navLinksBot;\r\n      const linkBot = $.el('div',\r\n        {className: \"brackets-wrap qr-link-container-bottom\"});\r\n      $.extend(linkBot, {innerHTML: '<a href=\"javascript:;\" class=\"qr-link-bottom\">Reply to Thread</a>'});\r\n\r\n      $.on(linkBot.firstElementChild, 'click', function() {\r\n        QR.open();\r\n        return QR.nodes.com.focus();\r\n      });\r\n\r\n      if (navLinksBot = $('.navLinksBot')) { $.prepend(navLinksBot, linkBot); }\r\n    }\r\n\r\n    $.on(d, 'QRGetFile',          QR.getFile);\r\n    $.on(d, 'QRDrawFile',         QR.drawFile);\r\n    $.on(d, 'QRSetFile',          QR.setFile);\r\n\r\n    $.on(d, 'paste',              QR.paste);\r\n    $.on(d, 'dragover',           QR.dragOver);\r\n    $.on(d, 'drop',               QR.dropFile);\r\n    $.on(d, 'dragstart dragend',  QR.drag);\r\n\r\n    $.on(d, 'IndexRefreshInternal', QR.generatePostableThreadsList);\r\n    $.on(d, 'ThreadUpdate', QR.statusCheck);\r\n\r\n    if (!Conf['Persistent QR']) { return; }\r\n    QR.open();\r\n    if (Conf['Auto Hide QR']) { return QR.hide(); }\r\n  },\r\n\r\n  statusCheck() {\r\n    if (!QR.nodes) { return; }\r\n    const {thread} = QR.posts[0];\r\n    if ((thread !== 'new') && g.threads.get(`${g.BOARD}.${thread}`).isDead) {\r\n      return QR.abort();\r\n    } else {\r\n      return QR.status();\r\n    }\r\n  },\r\n\r\n  node() {\r\n    $.on(this.nodes.quote, 'click', QR.quote);\r\n    if (this.isFetchedQuote) { return QR.generatePostableThreadsList(); }\r\n  },\r\n\r\n  open() {\r\n    if (QR.nodes) {\r\n      if (QR.nodes.el.hidden) { QR.captcha.setup(); }\r\n      QR.nodes.el.hidden = false;\r\n      QR.unhide();\r\n    } else {\r\n      try {\r\n        QR.dialog();\r\n      } catch (err) {\r\n        delete QR.nodes;\r\n        Main.handleErrors({\r\n          message: 'Quick Reply dialog creation crashed.',\r\n          error: err\r\n        });\r\n        return;\r\n      }\r\n    }\r\n    return $.rmClass(QR.shortcut, 'disabled');\r\n  },\r\n\r\n  close() {\r\n    if (QR.req) {\r\n      QR.abort();\r\n      return;\r\n    }\r\n    QR.nodes.el.hidden = true;\r\n    QR.cleanNotifications();\r\n    QR.blur();\r\n    $.rmClass(QR.nodes.el, 'dump');\r\n    $.addClass(QR.shortcut, 'disabled');\r\n    new QR.post(true);\r\n    for (var post of QR.posts.splice(0, QR.posts.length - 1)) {\r\n      post.delete();\r\n    }\r\n    QR.cooldown.auto = false;\r\n    QR.status();\r\n    return QR.captcha.destroy();\r\n  },\r\n\r\n  focus() {\r\n    return $.queueTask(function() {\r\n      if (!QR.inBubble()) {\r\n        QR.hasFocus = d.activeElement && QR.nodes.el.contains(d.activeElement);\r\n        return QR.nodes.el.classList.toggle('focus', QR.hasFocus);\r\n      }\r\n    });\r\n  },\r\n\r\n  inBubble() {\r\n    const bubbles = $$('iframe[src^=\"https://www.google.com/recaptcha/api2/frame\"]');\r\n    return bubbles.includes(d.activeElement) || bubbles.some(el => (getComputedStyle(el).visibility !== 'hidden') && (el.getBoundingClientRect().bottom > 0));\r\n  },\r\n\r\n  hide() {\r\n    QR.blur();\r\n    $.addClass(QR.nodes.el, 'autohide');\r\n    return QR.nodes.autohide.checked = true;\r\n  },\r\n\r\n  unhide() {\r\n    $.rmClass(QR.nodes.el, 'autohide');\r\n    return QR.nodes.autohide.checked = false;\r\n  },\r\n\r\n  toggleHide() {\r\n    if (this.checked) {\r\n      return QR.hide();\r\n    } else {\r\n      return QR.unhide();\r\n    }\r\n  },\r\n\r\n  blur() {\r\n    if (QR.nodes.el.contains(d.activeElement)) { return d.activeElement.blur(); }\r\n  },\r\n\r\n  toggleSJIS(e) {\r\n    e.preventDefault();\r\n    Conf['sjisPreview'] = !Conf['sjisPreview'];\r\n    $.set('sjisPreview', Conf['sjisPreview']);\r\n    return QR.nodes.el.classList.toggle('sjis-preview', Conf['sjisPreview']);\r\n  },\r\n\r\n  texPreviewShow() {\r\n    if ($.hasClass(QR.nodes.el, 'tex-preview')) { return QR.texPreviewHide(); }\r\n    $.addClass(QR.nodes.el, 'tex-preview');\r\n    QR.nodes.texPreview.textContent = QR.nodes.com.value;\r\n    return $.event('mathjax', null, QR.nodes.texPreview);\r\n  },\r\n\r\n  texPreviewHide() {\r\n    return $.rmClass(QR.nodes.el, 'tex-preview');\r\n  },\r\n\r\n  addPost() {\r\n    const wasOpen = (QR.nodes && !QR.nodes.el.hidden);\r\n    QR.open();\r\n    if (wasOpen) {\r\n      $.addClass(QR.nodes.el, 'dump');\r\n      new QR.post(true);\r\n    }\r\n    return QR.nodes.com.focus();\r\n  },\r\n\r\n  setCustomCooldown(enabled) {\r\n    Conf['customCooldownEnabled'] = enabled;\r\n    QR.cooldown.customCooldown = enabled;\r\n    return QR.nodes.customCooldown.classList.toggle('disabled', !enabled);\r\n  },\r\n\r\n  toggleCustomCooldown() {\r\n    const enabled = $.hasClass(QR.nodes.customCooldown, 'disabled');\r\n    QR.setCustomCooldown(enabled);\r\n    return $.set('customCooldownEnabled', enabled);\r\n  },\r\n\r\n  error(err, focusOverride) {\r\n    let el;\r\n    QR.open();\r\n    if (typeof err === 'string') {\r\n      el = $.tn(err);\r\n    } else {\r\n      el = err;\r\n      el.removeAttribute('style');\r\n    }\r\n    const notice = new Notice('warning', el);\r\n    QR.notifications.push(notice);\r\n    if (!Header.areNotificationsEnabled) {\r\n      if (d.hidden && !QR.cooldown.auto) { return alert(el.textContent); }\r\n    } else if (d.hidden || !(focusOverride || d.hasFocus())) {\r\n      const notif = new Notification(el.textContent, {\r\n        body: el.textContent,\r\n        icon: Favicon.logo\r\n      }\r\n      );\r\n      notif.onclick = () => window.focus();\r\n      if ($.engine !== 'gecko') {\r\n        // Firefox automatically closes notifications\r\n        // so we can't control the onclose properly.\r\n        notif.onclose = () => notice.close();\r\n        return notif.onshow  = () => setTimeout(function() {\r\n          notif.onclose = null;\r\n          return notif.close();\r\n        }\r\n        , 7 * SECOND);\r\n      }\r\n    }\r\n  },\r\n\r\n  connectionError() {\r\n    return $.el('span',\r\n      { innerHTML:\r\n        'Connection error while posting. ' +\r\n        '[<a href=\"' + E(meta.upstreamFaq) + '#connection-errors\" target=\"_blank\">More info</a>]'\r\n      }\r\n    );\r\n  },\r\n\r\n  notifications: [],\r\n\r\n  cleanNotifications() {\r\n    for (var notification of QR.notifications) {\r\n      notification.close();\r\n    }\r\n    return QR.notifications = [];\r\n  },\r\n\r\n  status() {\r\n    let disabled, value;\r\n    if (!QR.nodes) { return; }\r\n    const {thread} = QR.posts[0];\r\n    if ((thread !== 'new') && g.threads.get(`${g.BOARD}.${thread}`).isDead) {\r\n      value    = 'Dead';\r\n      disabled = true;\r\n      QR.cooldown.auto = false;\r\n    }\r\n\r\n    value = QR.req ?\r\n      QR.req.progress\r\n    :\r\n      QR.cooldown.seconds || value;\r\n\r\n    const {status} = QR.nodes;\r\n    status.value = !value ?\r\n      'Submit'\r\n    : QR.cooldown.auto ?\r\n      `Auto ${value}`\r\n    :\r\n      value;\r\n    return status.disabled = disabled || false;\r\n  },\r\n\r\n  openPost() {\r\n    QR.open();\r\n    if (QR.selected.isLocked) {\r\n      const index = QR.posts.indexOf(QR.selected);\r\n      (QR.posts[index+1] || new QR.post()).select();\r\n      $.addClass(QR.nodes.el, 'dump');\r\n      return QR.cooldown.auto = true;\r\n    }\r\n  },\r\n\r\n  quote(e) {\r\n    let range;\r\n    e?.preventDefault();\r\n    if (!QR.postingIsEnabled) { return; }\r\n    const sel  = d.getSelection();\r\n    const post = Get.postFromNode(this);\r\n    const {root} = post.nodes;\r\n    const postRange = new Range();\r\n    postRange.selectNode(root);\r\n    let text = post.board.ID === g.BOARD.ID ? `>>${post}\\n` : `>>>/${post.board}/${post}\\n`;\r\n    for (let i = 0, end = sel.rangeCount, asc = 0 <= end; asc ? i < end : i > end; asc ? i++ : i--) {\r\n      try {\r\n        var insideCode, node;\r\n        range = sel.getRangeAt(i);\r\n        // Trim range to be fully inside post\r\n        if (range.compareBoundaryPoints(Range.START_TO_START, postRange) < 0) {\r\n          range.setStartBefore(root);\r\n        }\r\n        if (range.compareBoundaryPoints(Range.END_TO_END, postRange) > 0) {\r\n          range.setEndAfter(root);\r\n        }\r\n\r\n        if (!range.toString().trim()) { continue; }\r\n\r\n        var frag  = range.cloneContents();\r\n        var ancestor = range.commonAncestorContainer;\r\n        // Quoting the insides of a spoiler/code tag.\r\n        if ($.x('ancestor-or-self::*[self::s or contains(@class,\"removed-spoiler\")]', ancestor)) {\r\n          $.prepend(frag, $.tn('[spoiler]'));\r\n          $.add(frag, $.tn('[/spoiler]'));\r\n        }\r\n        if (insideCode = $.x('ancestor-or-self::pre[contains(@class,\"prettyprint\")]', ancestor)) {\r\n          $.prepend(frag, $.tn('[code]'));\r\n          $.add(frag, $.tn('[/code]'));\r\n        }\r\n        for (node of $$((insideCode ? 'br' : '.prettyprint br'), frag)) {\r\n          $.replace(node, $.tn('\\n'));\r\n        }\r\n        for (node of $$('br', frag)) {\r\n          if (node !== frag.lastChild) { $.replace(node, $.tn('\\n>')); }\r\n        }\r\n        g.SITE.insertTags?.(frag);\r\n        for (node of $$('.linkify[data-original]', frag)) {\r\n          $.replace(node, $.tn(node.dataset.original));\r\n        }\r\n        for (node of $$('.embedder', frag)) {\r\n          if (node.previousSibling?.nodeValue === ' ') { $.rm(node.previousSibling); }\r\n          $.rm(node);\r\n        }\r\n        text += `>${frag.textContent.trim()}\\n`;\r\n      } catch (error) { }\r\n    }\r\n\r\n    QR.openPost();\r\n    const {com, thread} = QR.nodes;\r\n    if (!com.value) { thread.value = Get.threadFromNode(this); }\r\n\r\n    const wasOnlyQuotes = QR.selected.isOnlyQuotes();\r\n\r\n    const caretPos = com.selectionStart;\r\n    // Replace selection for text.\r\n    com.value = com.value.slice(0, caretPos) + text + com.value.slice(com.selectionEnd);\r\n    // Move the caret to the end of the new quote.\r\n    range = caretPos + text.length;\r\n    com.setSelectionRange(range, range);\r\n    com.focus();\r\n\r\n    // This allows us to determine if any text other than quotes has been typed.\r\n    if (wasOnlyQuotes) { QR.selected.quotedText = com.value; }\r\n\r\n    QR.selected.save(com);\r\n    return QR.selected.save(thread);\r\n  },\r\n\r\n  characterCount() {\r\n    const counter = QR.nodes.charCount;\r\n    const count   = QR.nodes.com.value.replace(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g, '_').length;\r\n    counter.textContent = count;\r\n    counter.hidden      = count < (QR.max_comment/2);\r\n    return (count > QR.max_comment ? $.addClass : $.rmClass)(counter, 'warning');\r\n  },\r\n\r\n  getFile() {\r\n    return $.event('QRFile', QR.selected?.file);\r\n  },\r\n\r\n  drawFile(e) {\r\n    const file = QR.selected?.file;\r\n    if (!file || !/^(image|video)\\//.test(file.type)) { return; }\r\n    const isVideo = /^video\\//.test(file);\r\n    const el = $.el((isVideo ? 'video' : 'img'));\r\n    $.on(el, 'error', () => QR.openError());\r\n    $.on(el, (isVideo ? 'loadeddata' : 'load'), function() {\r\n      e.target.getContext('2d').drawImage(el, 0, 0);\r\n      URL.revokeObjectURL(el.src);\r\n      return $.event('QRImageDrawn', null, e.target);\r\n    });\r\n    return el.src = URL.createObjectURL(file);\r\n  },\r\n\r\n  openError() {\r\n    const div = $.el('div');\r\n    $.extend(div, {\r\n      innerHTML:\r\n        'Could not open file. [<a href=\"' + E(meta.upstreamFaq) + '#error-reading-metadata\" target=\"_blank\">More info</a>]'\r\n    });\r\n    return QR.error(div);\r\n  },\r\n\r\n  setFile(e) {\r\n    const {file, name, source} = e.detail;\r\n    if (name != null) { file.name   = name; }\r\n    if (source != null) { file.source = source; }\r\n    QR.open();\r\n    return QR.handleFiles([file]);\r\n  },\r\n\r\n  drag(e) {\r\n    // Let it drag anything from the page.\r\n    const toggle = e.type === 'dragstart' ? $.off : $.on;\r\n    toggle(d, 'dragover', QR.dragOver);\r\n    return toggle(d, 'drop',     QR.dropFile);\r\n  },\r\n\r\n  dragOver(e) {\r\n    e.preventDefault();\r\n    return e.dataTransfer.dropEffect = 'copy';\r\n  }, // cursor feedback\r\n\r\n  dropFile(e) {\r\n    // Let it only handle files from the desktop.\r\n    if (!e.dataTransfer.files.length) { return; }\r\n    e.preventDefault();\r\n    QR.open();\r\n    return QR.handleFiles(e.dataTransfer.files);\r\n  },\r\n\r\n  paste(e) {\r\n    if (!e.clipboardData.items) { return; }\r\n    let file = null;\r\n    let score = -1;\r\n    for (var item of e.clipboardData.items) {\r\n      var file2;\r\n      if ((item.kind === 'file') && (file2 = item.getAsFile())) {\r\n        var score2 = (2*(file2.size <= QR.max_size)) + (file2.type === 'image/png');\r\n        if (score2 > score) {\r\n          file = file2;\r\n          score = score2;\r\n        }\r\n      }\r\n    }\r\n    if (file) {\r\n      const {type} = file;\r\n      const blob = new Blob([file], {type});\r\n      blob.name = `${Conf['pastedname']}.${$.getOwn(QR.extensionFromType, type) || 'jpg'}`;\r\n      QR.open();\r\n      QR.handleFiles([blob]);\r\n      $.addClass(QR.nodes.el, 'dump');\r\n    }\r\n  },\r\n\r\n  pasteFF() {\r\n    const {pasteArea} = QR.nodes;\r\n    if (!pasteArea.childNodes.length) { return; }\r\n    const images = $$('img', pasteArea);\r\n    $.rmAll(pasteArea);\r\n    for (var img of images) {\r\n      var m;\r\n      var {src} = img;\r\n      if (m = src.match(/data:(image\\/(\\w+));base64,(.+)/)) {\r\n        var bstr = atob(m[3]);\r\n        var arr = new Uint8Array(bstr.length);\r\n        for (var i = 0, end = bstr.length, asc = 0 <= end; asc ? i < end : i > end; asc ? i++ : i--) {\r\n          arr[i] = bstr.charCodeAt(i);\r\n        }\r\n        var blob = new Blob([arr], {type: m[1]});\r\n        blob.name = `${Conf['pastedname']}.${m[2]}`;\r\n        QR.handleFiles([blob]);\r\n      } else if (/^https?:\\/\\//.test(src)) {\r\n        QR.handleUrl(src);\r\n      }\r\n    }\r\n  },\r\n\r\n  handleUrl(urlDefault) {\r\n    QR.open();\r\n    QR.selected.preventAutoPost();\r\n    return CrossOrigin.permission(function() {\r\n      const url = prompt('Enter a URL:', urlDefault);\r\n      if (url === null) { return; }\r\n      QR.nodes.fileButton.focus();\r\n      return CrossOrigin.file(url, function(blob) {\r\n        if (blob && !/^text\\//.test(blob.type)) {\r\n          return QR.handleFiles([blob]);\r\n        } else {\r\n          return QR.error(\"Can't load file.\");\r\n        }\r\n      });\r\n    });\r\n  },\r\n\r\n  handleFiles(files) {\r\n    if (this !== QR) { // file input\r\n      files  = [...this.files];\r\n      this.value = null;\r\n    }\r\n    if (!files.length) { return; }\r\n    QR.cleanNotifications();\r\n    for (var file of files) {\r\n      QR.handleFile(file, files.length);\r\n    }\r\n    if (files.length !== 1) { $.addClass(QR.nodes.el, 'dump'); }\r\n    if ((d.activeElement === QR.nodes.fileButton) && $.hasClass(QR.nodes.fileSubmit, 'has-file')) {\r\n      return QR.nodes.filename.focus();\r\n    }\r\n  },\r\n\r\n  handleFile(file, nfiles) {\r\n    let post;\r\n    const isText = /^text\\//.test(file.type);\r\n    if (nfiles === 1) {\r\n      post = QR.selected;\r\n    } else {\r\n      post = QR.posts[QR.posts.length - 1];\r\n      if (isText ? post.com || post.pasting : post.file) {\r\n        post = new QR.post();\r\n      }\r\n    }\r\n    return post[isText ? 'pasteText' : 'setFile'](file);\r\n  },\r\n\r\n  openFileInput() {\r\n    if (QR.nodes.fileButton.disabled) { return; }\r\n    QR.nodes.fileInput.click();\r\n    return QR.nodes.fileButton.focus();\r\n  },\r\n\r\n  generatePostableThreadsList() {\r\n    if (!QR.nodes) { return; }\r\n    const list    = QR.nodes.thread;\r\n    const options = [list.firstElementChild];\r\n    for (var thread of g.BOARD.threads.keys) {\r\n      options.push($.el('option', {\r\n        value: thread,\r\n        textContent: `Thread ${thread}`\r\n      }\r\n      )\r\n      );\r\n    }\r\n    const val = list.value;\r\n    $.rmAll(list);\r\n    $.add(list, options);\r\n    list.value = val;\r\n    if (list.value === val) { return; }\r\n    // Fix the value if the option disappeared.\r\n    list.value = g.VIEW === 'thread' ?\r\n      g.THREADID\r\n    :\r\n      'new';\r\n    return (g.VIEW === 'thread' ? $.addClass : $.rmClass)(QR.nodes.el, 'reply-to-thread');\r\n  },\r\n\r\n  dialog() {\r\n    let dialog, event, nodes;\r\n    let name;\r\n    QR.nodes = (nodes = {\r\n      el: (dialog = UI.dialog('qr',\r\n        { innerHTML: QuickReplyPage }))\r\n    });\r\n\r\n    const setNode = (name, query) => nodes[name] = $(query, dialog);\r\n\r\n    setNode('move',           '.move');\r\n    setNode('autohide',       '#autohide');\r\n    setNode('close',          '.close');\r\n    setNode('thread',         'select');\r\n    setNode('form',           'form');\r\n    setNode('sjisToggle',     '#sjis-toggle');\r\n    setNode('texButton',      '#tex-preview-button');\r\n    setNode('name',           '[data-name=name]');\r\n    setNode('email',          '[data-name=email]');\r\n    setNode('sub',            '[data-name=sub]');\r\n    setNode('com',            '[data-name=com]');\r\n    setNode('charCount',      '#char-count');\r\n    setNode('texPreview',     '#tex-preview');\r\n    setNode('dumpList',       '#dump-list');\r\n    setNode('addPost',        '#add-post');\r\n    setNode('oekaki',         '.oekaki');\r\n    setNode('drawButton',     '#qr-draw-button');\r\n    setNode('fileSubmit',     '#file-n-submit');\r\n    setNode('fileButton',     '#qr-file-button');\r\n    setNode('noFile',         '#qr-no-file');\r\n    setNode('filename',       '#qr-filename');\r\n    setNode('spoiler',        '#qr-file-spoiler');\r\n    setNode('oekakiButton',   '#qr-oekaki-button');\r\n    setNode('fileRM',         '#qr-filerm');\r\n    setNode('urlButton',      '#url-button');\r\n    setNode('pasteArea',      '#paste-area');\r\n    setNode('customCooldown', '#custom-cooldown-button');\r\n    setNode('dumpButton',     '#dump-button');\r\n    setNode('status',         '[type=submit]');\r\n    setNode('flashTag',       '[name=filetag]');\r\n    setNode('fileInput',      '[type=file]');\r\n\r\n    const {config} = g.BOARD;\r\n    const {classList} = QR.nodes.el;\r\n    classList.toggle('forced-anon',  QR.forcedAnon);\r\n    classList.toggle('has-spoiler',  QR.spoiler);\r\n    classList.toggle('has-sjis',     !!config.sjis_tags);\r\n    classList.toggle('has-math',     !!config.math_tags);\r\n    classList.toggle('sjis-preview', !!config.sjis_tags && Conf['sjisPreview']);\r\n    classList.toggle('show-new-thread-option', Conf['Show New Thread Option in Threads']);\r\n\r\n    if (parseInt(Conf['customCooldown'], 10) > 0) {\r\n      $.addClass(QR.nodes.fileSubmit, 'custom-cooldown');\r\n      $.get('customCooldownEnabled', Conf['customCooldownEnabled'], function({customCooldownEnabled}) {\r\n        QR.setCustomCooldown(customCooldownEnabled);\r\n        return $.sync('customCooldownEnabled', QR.setCustomCooldown);\r\n      });\r\n    }\r\n\r\n    QR.flagsInput();\r\n\r\n    $.on(nodes.autohide,       'change',    QR.toggleHide);\r\n    $.on(nodes.close,          'click',     QR.close);\r\n    $.on(nodes.status,         'click',     QR.submit);\r\n    $.on(nodes.form,           'submit',    QR.submit);\r\n    $.on(nodes.sjisToggle,     'click',     QR.toggleSJIS);\r\n    $.on(nodes.texButton,      'mousedown', QR.texPreviewShow);\r\n    $.on(nodes.texButton,      'mouseup',   QR.texPreviewHide);\r\n    $.on(nodes.addPost,        'click',     () => new QR.post(true));\r\n    $.on(nodes.drawButton,     'click',     QR.oekaki.draw);\r\n    $.on(nodes.fileButton,     'click',     QR.openFileInput);\r\n    $.on(nodes.noFile,         'click',     QR.openFileInput);\r\n    $.on(nodes.filename,       'focus',     function() { return $.addClass(this.parentNode, 'focus'); });\r\n    $.on(nodes.filename,       'blur',      function() { return $.rmClass(this.parentNode, 'focus'); });\r\n    $.on(nodes.spoiler,        'change',    () => QR.selected.nodes.spoiler.click());\r\n    $.on(nodes.oekakiButton,   'click',     QR.oekaki.button);\r\n    $.on(nodes.fileRM,         'click',     () => QR.selected.rmFile());\r\n    $.on(nodes.urlButton,      'click',     () => QR.handleUrl(''));\r\n    $.on(nodes.customCooldown, 'click',     QR.toggleCustomCooldown);\r\n    $.on(nodes.dumpButton,     'click',     () => nodes.el.classList.toggle('dump'));\r\n    $.on(nodes.fileInput,      'change',    QR.handleFiles);\r\n\r\n    window.addEventListener('focus', QR.focus, true);\r\n    window.addEventListener('blur',  QR.focus, true);\r\n    // We don't receive blur events from captcha iframe.\r\n    $.on(d, 'click', QR.focus);\r\n\r\n    // XXX Workaround for image pasting in Firefox, obsolete as of v50.\r\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=906420\r\n    if (($.engine === 'gecko') && !window.DataTransferItemList) {\r\n      nodes.pasteArea.hidden = false;\r\n    }\r\n    new MutationObserver(QR.pasteFF).observe(nodes.pasteArea, {childList: true});\r\n\r\n    // save selected post's data\r\n    const items = ['thread', 'name', 'email', 'sub', 'com', 'filename', 'flag'];\r\n    let i = 0;\r\n    const save = function() { return QR.selected.save(this); };\r\n    while ((name = items[i++])) {\r\n      var node;\r\n      if (!(node = nodes[name])) { continue; }\r\n      event = node.nodeName === 'SELECT' ? 'change' : 'input';\r\n      $.on(nodes[name], event, save);\r\n    }\r\n\r\n    // XXX Blink and WebKit treat width and height of <textarea>s as min-width and min-height\r\n    if (($.engine === 'gecko') && Conf['Remember QR Size']) {\r\n      $.get('QR Size', '', item => nodes.com.style.cssText = item['QR Size']);\r\n      $.on(nodes.com, 'mouseup', function(e) {\r\n        if (e.button !== 0) { return; }\r\n        return $.set('QR Size', this.style.cssText);\r\n      });\r\n    }\r\n\r\n    QR.generatePostableThreadsList();\r\n    QR.persona.load();\r\n    new QR.post(true);\r\n    QR.status();\r\n    QR.cooldown.setup();\r\n    QR.captcha.init();\r\n\r\n    $.add(d.body, dialog);\r\n    QR.captcha.setup();\r\n    QR.oekaki.setup();\r\n\r\n    // Create a custom event when the QR dialog is first initialized.\r\n    // Use it to extend the QR's functionalities, or for XTRM RICE.\r\n    return $.event('QRDialogCreation', null, dialog);\r\n  },\r\n\r\n  flags() {\r\n    const select = $.el('select', {\r\n      name:      'flag',\r\n      className: 'flagSelector'\r\n    }\r\n    );\r\n\r\n    const addFlag = (value, textContent) => $.add(select, $.el('option', {value, textContent}));\r\n\r\n    addFlag('0', (g.BOARD.config.country_flags ? 'Geographic Location' : 'None'));\r\n    for (var value in g.BOARD.config.board_flags) {\r\n      var textContent = g.BOARD.config.board_flags[value];\r\n      addFlag(value, textContent);\r\n    }\r\n\r\n    return select;\r\n  },\r\n\r\n  flagsInput() {\r\n    const {nodes} = QR;\r\n    if (!nodes) { return; }\r\n    if (nodes.flag) {\r\n      $.rm(nodes.flag);\r\n      delete nodes.flag;\r\n    }\r\n\r\n    if (g.BOARD.config.board_flags) {\r\n      const flag = QR.flags();\r\n      flag.dataset.name    = 'flag';\r\n      flag.dataset.default = '0';\r\n      nodes.flag = flag;\r\n      return $.add(nodes.form, flag);\r\n    }\r\n  },\r\n\r\n  submit(e) {\r\n    let captcha, err, filetag;\r\n    e?.preventDefault();\r\n    const force = e?.shiftKey;\r\n\r\n    if (QR.req) {\r\n      QR.abort();\r\n      return;\r\n    }\r\n\r\n    $.forceSync('cooldowns');\r\n    if (QR.cooldown.seconds) {\r\n      if (force) {\r\n        QR.cooldown.clear();\r\n      } else {\r\n        QR.cooldown.auto = !QR.cooldown.auto;\r\n        QR.status();\r\n        return;\r\n      }\r\n    }\r\n\r\n    const post = QR.posts[0];\r\n    delete post.quotedText;\r\n    post.forceSave();\r\n    let threadID = post.thread;\r\n    const thread = g.BOARD.threads.get(threadID);\r\n    if ((g.BOARD.ID === 'f') && (threadID === 'new')) {\r\n      filetag = QR.nodes.flashTag.value;\r\n    }\r\n\r\n    // prevent errors\r\n    if (threadID === 'new') {\r\n      threadID = null;\r\n      if (!!g.BOARD.config.require_subject && !post.sub) {\r\n        err = 'New threads require a subject.';\r\n      } else if (!!!g.BOARD.config.text_only && !post.file) {\r\n        err = 'No file selected.';\r\n      }\r\n    } else if (g.BOARD.threads.get(threadID).isClosed) {\r\n      err = 'You can\\'t reply to this thread anymore.';\r\n    } else if (!post.com && !post.file) {\r\n      err = 'No comment or file.';\r\n    } else if (post.file && thread.fileLimit) {\r\n      err = 'Max limit of image replies has been reached.';\r\n    }\r\n\r\n    if ((g.BOARD.ID === 'r9k') && !post.com?.match(/[a-z-]/i)) {\r\n      if (!err) { err = 'Original comment required.'; }\r\n    }\r\n\r\n    if (QR.captcha.isEnabled && !((QR.captcha === Captcha.v2) && /\\b_ct=/.test(d.cookie) && threadID) && !(err && !force)) {\r\n      captcha = QR.captcha.getOne(!!threadID);\r\n      if (QR.captcha === Captcha.v2) {\r\n        if (!captcha) { captcha = Captcha.cache.request(!!threadID); }\r\n      }\r\n      if (!captcha) {\r\n        err = 'No valid captcha.';\r\n        QR.captcha.setup(!QR.cooldown.auto || (d.activeElement === QR.nodes.status));\r\n      }\r\n    }\r\n\r\n    QR.cleanNotifications();\r\n    if (err && !force) {\r\n      // stop auto-posting\r\n      QR.cooldown.auto = false;\r\n      QR.status();\r\n      QR.error(err);\r\n      return;\r\n    }\r\n\r\n    // Enable auto-posting if we have stuff to post, disable it otherwise.\r\n    QR.cooldown.auto = QR.posts.length > 1;\r\n\r\n    post.lock();\r\n\r\n    const formData = {\r\n      MAX_FILE_SIZE: QR.max_size,\r\n      mode:     'regist',\r\n      pwd:      QR.persona.getPassword(),\r\n      resto:    threadID,\r\n      name:     (!QR.forcedAnon ? post.name : undefined),\r\n      email:    post.email,\r\n      sub:      (!QR.forcedAnon && !threadID ? post.sub : undefined),\r\n      com:      post.com,\r\n      upfile:   post.file,\r\n      filetag,\r\n      spoiler:  post.spoiler,\r\n      flag:     post.flag,\r\n    };\r\n\r\n    const options = {\r\n      responseType: 'document',\r\n      withCredentials: true,\r\n      onloadend: QR.response,\r\n      form: $.formData(formData)\r\n    };\r\n    if (Conf['Show Upload Progress']) {\r\n      options.onprogress = function(e) {\r\n        if (this !== QR.req?.upload) { return; } // aborted\r\n        if (e.loaded < e.total) {\r\n          // Uploading...\r\n          QR.req.progress = `${Math.round((e.loaded / e.total) * 100)}%`;\r\n        } else {\r\n          // Upload done, waiting for server response.\r\n          QR.req.isUploadFinished = true;\r\n          QR.req.progress = '...';\r\n        }\r\n        return QR.status();\r\n      };\r\n    }\r\n\r\n    let cb = function(response) {\r\n      if (response != null) {\r\n        QR.currentCaptcha = response;\r\n        if (QR.captcha === Captcha.v2) {\r\n          if (response.challenge != null) {\r\n            options.form.append('recaptcha_challenge_field', response.challenge);\r\n            options.form.append('recaptcha_response_field', response.response);\r\n          } else {\r\n            options.form.append('g-recaptcha-response', response.response);\r\n          }\r\n        } else {\r\n          for (var key in response) {\r\n            var val = response[key];\r\n            options.form.append(key, val);\r\n          }\r\n        }\r\n      }\r\n      QR.req = $.ajax(`https://sys.${location.hostname.split('.')[1]}.org/${g.BOARD}/post`, options);\r\n      return QR.req.progress = '...';\r\n    };\r\n\r\n    if (typeof captcha === 'function') {\r\n      // Wait for captcha to be verified before submitting post.\r\n      QR.req = {\r\n        progress: '...',\r\n        abort() {\r\n          if (QR.captcha === Captcha.v2) {\r\n            Captcha.cache.abort();\r\n          }\r\n          return cb = null;\r\n        }\r\n      };\r\n      captcha(function(response) {\r\n        if ((QR.captcha === Captcha.v2) && Captcha.cache.haveCookie()) {\r\n          cb?.();\r\n          if (response) { return Captcha.cache.save(response); }\r\n        } else if (response) {\r\n          return cb?.(response);\r\n        } else {\r\n          delete QR.req;\r\n          post.unlock();\r\n          QR.cooldown.auto = !!Captcha.cache.getCount();\r\n          return QR.status();\r\n        }\r\n      });\r\n    } else {\r\n      cb(captcha);\r\n    }\r\n\r\n    // Starting to upload might take some time.\r\n    // Provide some feedback that we're starting to submit.\r\n    return QR.status();\r\n  },\r\n\r\n  response() {\r\n    let connErr, err;\r\n    if (this !== QR.req) { return; } // aborted\r\n    delete QR.req;\r\n\r\n    const post = QR.posts[0];\r\n    post.unlock();\r\n\r\n    if (err = this.response?.getElementById('errmsg')) { // error!\r\n      const el = $('a', err);\r\n      if (el) el.target = '_blank'; // duplicate image link\r\n    } else if (connErr = (!this.response || (this.response.title !== 'Post successful!'))) {\r\n      err = QR.connectionError();\r\n      if ((QR.captcha === Captcha.v2) && QR.currentCaptcha) { Captcha.cache.save(QR.currentCaptcha); }\r\n    } else if (this.status !== 200) {\r\n      err = `Error ${this.statusText} (${this.status})`;\r\n    }\r\n\r\n    if (!connErr) { QR.captcha.setUsed?.(); }\r\n    delete QR.currentCaptcha;\r\n\r\n    if (err) {\r\n      let m;\r\n      QR.errorCount = (QR.errorCount || 0) + 1;\r\n      if (/captcha|verification/i.test(err.textContent)) {\r\n        // Remove the obnoxious 4chan Pass ad.\r\n        if (/mistyped/i.test(err.textContent)) {\r\n          err = 'You mistyped the CAPTCHA, or the CAPTCHA malfunctioned.';\r\n        } else if (/expired/i.test(err.textContent)) {\r\n          err = 'This CAPTCHA is no longer valid because it has expired.';\r\n        }\r\n        // Do not auto post with a wrong captcha.\r\n        QR.cooldown.auto = false;\r\n      } else if (connErr) {\r\n        if (QR.errorCount >= 5) {\r\n          // Too many posting errors can ban you. Stop autoposting after 5 errors.\r\n          QR.cooldown.auto = false;\r\n        } else {\r\n          // Something must've gone terribly wrong if you get captcha errors without captchas.\r\n          // Don't auto-post indefinitely in that case.\r\n          QR.cooldown.auto = QR.captcha.isEnabled || connErr;\r\n          // Too many frequent mistyped captchas will auto-ban you!\r\n          // On connection error, the post most likely didn't go through.\r\n          // If the post did go through, it should be stopped by the duplicate reply cooldown.\r\n          QR.cooldown.addDelay(post, 2);\r\n        }\r\n      } else if (err.textContent && (m = err.textContent.match(/\\d+\\s+(?:minute|second)/gi)) && !/duplicate|hour/i.test(err.textContent)) {\r\n        QR.cooldown.auto = !/have\\s+been\\s+muted/i.test(err.textContent);\r\n        let seconds = 0;\r\n        for (var mi of m) {\r\n          seconds += (/minute/i.test(mi) ? 60 : 1) * (+mi.match(/\\d+/)[0]);\r\n        }\r\n        if (/muted/i.test(err.textContent)) {\r\n          QR.cooldown.addMute(seconds);\r\n        } else {\r\n          QR.cooldown.addDelay(post, seconds);\r\n        }\r\n      } else { // stop auto-posting\r\n        QR.cooldown.auto = false;\r\n      }\r\n      QR.captcha.setup(QR.cooldown.auto && [QR.nodes.status, d.body].includes(d.activeElement));\r\n      QR.status();\r\n      QR.error(err);\r\n      return;\r\n    }\r\n\r\n    delete QR.errorCount;\r\n\r\n    const h1 = $('h1', this.response);\r\n\r\n    let [_, threadID, postID] = h1.nextSibling.textContent.match(/thread:(\\d+),no:(\\d+)/);\r\n    postID   = +postID;\r\n    threadID = +threadID || postID;\r\n    const isReply  = threadID !== postID;\r\n\r\n    // Post/upload confirmed as successful.\r\n    $.event('QRPostSuccessful', {\r\n      boardID: g.BOARD.ID,\r\n      threadID,\r\n      postID\r\n    });\r\n    // XXX deprecated\r\n    $.event('QRPostSuccessful_', {boardID: g.BOARD.ID, threadID, postID});\r\n\r\n    // Enable auto-posting if we have stuff left to post, disable it otherwise.\r\n    const postsCount = QR.posts.length - 1;\r\n    QR.cooldown.auto = postsCount && isReply;\r\n\r\n    const lastPostToThread = !((function() { for (var p of QR.posts.slice(1)) { if (p.thread === post.thread) { return true; } } })());\r\n\r\n    if (postsCount) {\r\n      post.rm();\r\n      QR.captcha.setup(d.activeElement === QR.nodes.status);\r\n    } else if (Conf['Persistent QR']) {\r\n      post.rm();\r\n      if (Conf['Auto Hide QR']) {\r\n        QR.hide();\r\n      } else {\r\n        QR.blur();\r\n      }\r\n    } else {\r\n      QR.close();\r\n    }\r\n\r\n    QR.cleanNotifications();\r\n    if (Conf['Posting Success Notifications']) {\r\n      QR.notifications.push(new Notice('success', h1.textContent, 5));\r\n    }\r\n\r\n    QR.cooldown.add(threadID, postID);\r\n\r\n    const URL = threadID === postID ? ( // new thread\r\n      `${window.location.origin}/${g.BOARD}/thread/${threadID}`\r\n    ) : (threadID !== g.THREADID) && lastPostToThread && Conf['Open Post in New Tab'] ? ( // replying from the index or a different thread\r\n      `${window.location.origin}/${g.BOARD}/thread/${threadID}#p${postID}`\r\n    ) : undefined;\r\n\r\n    if (URL) {\r\n      const open = Conf['Open Post in New Tab'] || postsCount ?\r\n        () => $.open(URL)\r\n      :\r\n        () => location.href = URL;\r\n\r\n      if (threadID === postID) {\r\n        // XXX 4chan sometimes responds before the thread exists.\r\n        QR.waitForThread(URL, open);\r\n      } else {\r\n        open();\r\n      }\r\n    }\r\n\r\n    return QR.status();\r\n  },\r\n\r\n  waitForThread(url, cb) {\r\n    let attempts = 0;\r\n    var check = function() {\r\n      return $.ajax(url, {\r\n        onloadend() {\r\n          attempts++;\r\n          if ((attempts >= 6) || (this.status === 200)) {\r\n            return cb();\r\n          } else {\r\n            return setTimeout(check, attempts * SECOND);\r\n          }\r\n        },\r\n        responseType: 'text',\r\n        type: 'HEAD'\r\n      }\r\n      );\r\n    };\r\n    return check();\r\n  },\r\n\r\n  abort() {\r\n    let oldReq;\r\n    if ((oldReq = QR.req) && !QR.req.isUploadFinished) {\r\n      delete QR.req;\r\n      oldReq.abort();\r\n      if ((QR.captcha === Captcha.v2) && QR.currentCaptcha) { Captcha.cache.save(QR.currentCaptcha); }\r\n      delete QR.currentCaptcha;\r\n      QR.posts[0].unlock();\r\n      QR.cooldown.auto = false;\r\n      QR.notifications.push(new Notice('info', 'QR upload aborted.', 5));\r\n    }\r\n    return QR.status();\r\n  },\r\n\r\n  cooldown: {\r\n    seconds: 0,\r\n    delays: {\r\n      deletion: 60\r\n    }, // cooldown for deleting posts/files\r\n\r\n    // Called from Main\r\n    init() {\r\n      if (!Conf['Quick Reply']) { return; }\r\n      this.data = Conf['cooldowns'];\r\n      this.changes = dict();\r\n      return $.sync('cooldowns', this.sync);\r\n    },\r\n\r\n    // Called from QR\r\n    setup() {\r\n      // Read cooldown times\r\n      $.extend(QR.cooldown.delays, g.BOARD.cooldowns());\r\n\r\n      // The longest reply cooldown, for use in pruning old reply data\r\n      QR.cooldown.maxDelay = 0;\r\n      for (var type in QR.cooldown.delays) {\r\n        var delay = QR.cooldown.delays[type];\r\n        if (!['thread', 'thread_global'].includes(type)) {\r\n          QR.cooldown.maxDelay = Math.max(QR.cooldown.maxDelay, delay);\r\n        }\r\n      }\r\n\r\n      QR.cooldown.isSetup = true;\r\n      return QR.cooldown.start();\r\n    },\r\n\r\n    start() {\r\n      const { data } = QR.cooldown;\r\n      if (\r\n        !Conf['Cooldown'] ||\r\n        !QR.cooldown.isSetup ||\r\n        !!QR.cooldown.isCounting ||\r\n        ((Object.keys(data[g.BOARD.ID] || {}).length + Object.keys(data.global || {}).length) <= 0)\r\n      ) { return; }\r\n      QR.cooldown.isCounting = true;\r\n      return QR.cooldown.count();\r\n    },\r\n\r\n    sync(data) {\r\n      QR.cooldown.data = data || dict();\r\n      return QR.cooldown.start();\r\n    },\r\n\r\n    add(threadID, postID) {\r\n      if (!Conf['Cooldown']) { return; }\r\n      const start = Date.now();\r\n      const boardID = g.BOARD.ID;\r\n      QR.cooldown.set(boardID, start, { threadID, postID });\r\n      if (threadID === postID) { QR.cooldown.set('global', start, { boardID, threadID, postID }); }\r\n      QR.cooldown.save();\r\n      return QR.cooldown.start();\r\n    },\r\n\r\n    addDelay(post, delay) {\r\n      if (!Conf['Cooldown']) { return; }\r\n      const cooldown = QR.cooldown.categorize(post);\r\n      cooldown.delay = delay;\r\n      QR.cooldown.set(g.BOARD.ID, Date.now(), cooldown);\r\n      QR.cooldown.save();\r\n      return QR.cooldown.start();\r\n    },\r\n\r\n    addMute(delay) {\r\n      if (!Conf['Cooldown']) { return; }\r\n      QR.cooldown.set(g.BOARD.ID, Date.now(), { type: 'mute', delay });\r\n      QR.cooldown.save();\r\n      return QR.cooldown.start();\r\n    },\r\n\r\n    delete(post) {\r\n      let cooldown;\r\n      if (!QR.cooldown.data) { return; }\r\n      const cooldowns = (QR.cooldown.data[post.board.ID] || (QR.cooldown.data[post.board.ID] = dict()));\r\n      for (var id in cooldowns) {\r\n        cooldown = cooldowns[id];\r\n        if ((cooldown.delay == null) && (cooldown.threadID === post.thread.ID) && (cooldown.postID === post.ID)) {\r\n          QR.cooldown.set(post.board.ID, id, null);\r\n        }\r\n      }\r\n      return QR.cooldown.save();\r\n    },\r\n\r\n    secondsDeletion(post) {\r\n      if (!QR.cooldown.data || !Conf['Cooldown']) { return 0; }\r\n      const cooldowns = QR.cooldown.data[post.board.ID] || dict();\r\n      for (var start in cooldowns) {\r\n        var cooldown = cooldowns[start];\r\n        if ((cooldown.delay == null) && (cooldown.threadID === post.thread.ID) && (cooldown.postID === post.ID)) {\r\n          var seconds = QR.cooldown.delays.deletion - Math.floor((Date.now() - start) / SECOND);\r\n          return Math.max(seconds, 0);\r\n        }\r\n      }\r\n      return 0;\r\n    },\r\n\r\n    categorize(post) {\r\n      if (post.thread === 'new') {\r\n        return { type: 'thread' };\r\n      } else {\r\n        return {\r\n          type: !!post.file ? 'image' : 'reply',\r\n          threadID: +post.thread\r\n        };\r\n      }\r\n    },\r\n\r\n    mergeChange(data, scope, id, value) {\r\n      if (value) {\r\n        return (data[scope] || (data[scope] = dict()))[id] = value;\r\n      } else if (scope in data) {\r\n        delete data[scope][id];\r\n        if (Object.keys(data[scope]).length === 0) { return delete data[scope]; }\r\n      }\r\n    },\r\n\r\n    set(scope, id, value) {\r\n      QR.cooldown.mergeChange(QR.cooldown.data, scope, id, value);\r\n      return (QR.cooldown.changes[scope] || (QR.cooldown.changes[scope] = dict()))[id] = value;\r\n    },\r\n\r\n    save() {\r\n      const { changes } = QR.cooldown;\r\n      if (!Object.keys(changes).length) { return; }\r\n      return $.get('cooldowns', dict(), function ({ cooldowns }) {\r\n        for (var scope in QR.cooldown.changes) {\r\n          for (var id in QR.cooldown.changes[scope]) {\r\n            var value = QR.cooldown.changes[scope][id];\r\n            QR.cooldown.mergeChange(cooldowns, scope, id, value);\r\n          }\r\n          QR.cooldown.data = cooldowns;\r\n        }\r\n        return $.set('cooldowns', cooldowns, () => QR.cooldown.changes = dict());\r\n      });\r\n    },\r\n\r\n    clear() {\r\n      QR.cooldown.data = dict();\r\n      QR.cooldown.changes = dict();\r\n      QR.cooldown.auto = false;\r\n      QR.cooldown.update();\r\n      return $.queueTask($.delete, 'cooldowns');\r\n    },\r\n\r\n    update() {\r\n      let cooldown;\r\n      if (!QR.cooldown.isCounting) { return; }\r\n\r\n      let save = false;\r\n      let nCooldowns = 0;\r\n      const now = Date.now();\r\n      const { type, threadID } = QR.cooldown.categorize(QR.posts[0]);\r\n      let seconds = 0;\r\n\r\n      if (Conf['Cooldown']) {\r\n        for (var scope of [g.BOARD.ID, 'global']) {\r\n          var cooldowns = (QR.cooldown.data[scope] || (QR.cooldown.data[scope] = dict()));\r\n\r\n          for (var start in cooldowns) {\r\n            cooldown = cooldowns[start];\r\n            start = +start;\r\n            var elapsed = Math.floor((now - start) / SECOND);\r\n            if (elapsed < 0) { // clock changed since then?\r\n              QR.cooldown.set(scope, start, null);\r\n              save = true;\r\n              continue;\r\n            }\r\n\r\n            // Explicit delays from error messages\r\n            if (cooldown.delay != null) {\r\n              if (cooldown.delay <= elapsed) {\r\n                QR.cooldown.set(scope, start, null);\r\n                save = true;\r\n              } else if (((cooldown.type === type) && (cooldown.threadID === threadID)) || (cooldown.type === 'mute')) {\r\n                // Delays only apply to the given post type and thread.\r\n                seconds = Math.max(seconds, cooldown.delay - elapsed);\r\n              }\r\n              continue;\r\n            }\r\n\r\n            // Clean up expired cooldowns\r\n            var maxDelay = cooldown.threadID !== cooldown.postID ?\r\n              QR.cooldown.maxDelay\r\n              :\r\n              QR.cooldown.delays[scope === 'global' ? 'thread_global' : 'thread'];\r\n            if (QR.cooldown.customCooldown) {\r\n              maxDelay = Math.max(maxDelay, parseInt(Conf['customCooldown'], 10));\r\n            }\r\n            if (maxDelay <= elapsed) {\r\n              QR.cooldown.set(scope, start, null);\r\n              save = true;\r\n              continue;\r\n            }\r\n\r\n            if (((type === 'thread') === (cooldown.threadID === cooldown.postID)) && (cooldown.boardID !== g.BOARD.ID)) {\r\n              // Only cooldowns relevant to this post can set the seconds variable:\r\n              //   reply cooldown with a reply, thread cooldown with a thread.\r\n              // Inter-board thread cooldowns only apply on boards other than the one they were posted on.\r\n              var suffix = scope === 'global' ?\r\n                '_global'\r\n                :\r\n                '';\r\n              seconds = Math.max(seconds, QR.cooldown.delays[type + suffix] - elapsed);\r\n\r\n              // If additional cooldown is enabled, add the configured seconds to the count.\r\n              if (QR.cooldown.customCooldown) {\r\n                seconds = Math.max(seconds, parseInt(Conf['customCooldown'], 10) - elapsed);\r\n              }\r\n            }\r\n          }\r\n\r\n          nCooldowns += Object.keys(cooldowns).length;\r\n        }\r\n      }\r\n\r\n      if (save) { QR.cooldown.save; }\r\n\r\n      if (nCooldowns) {\r\n        clearTimeout(QR.cooldown.timeout);\r\n        QR.cooldown.timeout = setTimeout(QR.cooldown.count, SECOND);\r\n      } else {\r\n        delete QR.cooldown.isCounting;\r\n      }\r\n\r\n      // Update the status when we change posting type.\r\n      // Don't get stuck at some random number.\r\n      // Don't interfere with progress status updates.\r\n      const update = seconds !== QR.cooldown.seconds;\r\n      QR.cooldown.seconds = seconds;\r\n      if (update) { return QR.status(); }\r\n    },\r\n\r\n    count() {\r\n      QR.cooldown.update();\r\n      if ((QR.cooldown.seconds === 0) && QR.cooldown.auto && !QR.req) { return QR.submit(); }\r\n    }\r\n  },\r\n\r\n  oekaki: {\r\n    menu: {\r\n      init() {\r\n        if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Edit Link'] || !Conf['Quick Reply']) { return; }\r\n\r\n        const a = $.el('a', {\r\n          className: 'edit-link',\r\n          href: 'javascript:;',\r\n          textContent: 'Edit image'\r\n        }\r\n        );\r\n        $.on(a, 'click', this.editFile);\r\n\r\n        return Menu.menu.addEntry({\r\n          el: a,\r\n          order: 90,\r\n          open(post) {\r\n            QR.oekaki.menu.post = post;\r\n            const { file } = post;\r\n            return QR.postingIsEnabled && !!file && (file.isImage || file.isVideo);\r\n          }\r\n        });\r\n      },\r\n\r\n      editFile() {\r\n        const { post } = QR.oekaki.menu;\r\n        QR.quote.call(post.nodes.post);\r\n        const { isVideo } = post.file;\r\n        const currentTime = post.file.fullImage?.currentTime || 0;\r\n        return CrossOrigin.file(post.file.url, function (blob) {\r\n          if (!blob) {\r\n            return QR.error(\"Can't load file.\");\r\n          } else if (isVideo) {\r\n            const video = $.el('video');\r\n            $.on(video, 'loadedmetadata', function () {\r\n              $.on(video, 'seeked', function () {\r\n                const canvas = $.el('canvas', {\r\n                  width: video.videoWidth,\r\n                  height: video.videoHeight\r\n                }\r\n                );\r\n                canvas.getContext('2d').drawImage(video, 0, 0);\r\n                return canvas.toBlob(function (snapshot) {\r\n                  snapshot.name = post.file.name.replace(/\\.\\w+$/, '') + '.png';\r\n                  QR.handleFiles([snapshot]);\r\n                  return QR.oekaki.edit();\r\n                });\r\n              });\r\n              return video.currentTime = currentTime;\r\n            });\r\n            $.on(video, 'error', () => QR.openError());\r\n            return video.src = URL.createObjectURL(blob);\r\n          } else {\r\n            blob.name = post.file.name;\r\n            QR.handleFiles([blob]);\r\n            return QR.oekaki.edit();\r\n          }\r\n        });\r\n      }\r\n    },\r\n\r\n    setup() {\r\n      return $.global(function () {\r\n        const { FCX } = window;\r\n        FCX.oekakiCB = () => window.Tegaki.flatten().toBlob(function (file) {\r\n          const source = `oekaki-${Date.now()}`;\r\n          FCX.oekakiLatest = source;\r\n          return document.dispatchEvent(new CustomEvent('QRSetFile', {\r\n            bubbles: true,\r\n            detail: { file, name: FCX.oekakiName, source }\r\n          }));\r\n        });\r\n        if (window.Tegaki) {\r\n          return document.querySelector('#qr .oekaki').hidden = false;\r\n        }\r\n      });\r\n    },\r\n\r\n    load(cb) {\r\n      if ($('script[src^=\"//s.4cdn.org/js/tegaki\"]', d.head)) {\r\n        return cb();\r\n      } else {\r\n        const style = $.el('link', {\r\n          rel: 'stylesheet',\r\n          href: `//s.4cdn.org/css/tegaki.${Date.now()}.css`\r\n        }\r\n        );\r\n        const script = $.el('script',\r\n          { src: `//s.4cdn.org/js/tegaki.min.${Date.now()}.js` });\r\n        let n = 0;\r\n        const onload = function () {\r\n          if (++n === 2) { return cb(); }\r\n        };\r\n        $.on(style, 'load', onload);\r\n        $.on(script, 'load', onload);\r\n        return $.add(d.head, [style, script]);\r\n      }\r\n    },\r\n\r\n    draw() {\r\n      return $.global(function () {\r\n        const { Tegaki, FCX } = window;\r\n        if (Tegaki.bg) { Tegaki.destroy(); }\r\n        FCX.oekakiName = 'tegaki.png';\r\n        return Tegaki.open({\r\n          onDone: FCX.oekakiCB,\r\n          onCancel() { return Tegaki.bgColor = '#ffffff'; },\r\n          width: +document.querySelector('#qr [name=oekaki-width]').value,\r\n          height: +document.querySelector('#qr [name=oekaki-height]').value,\r\n          bgColor:\r\n            document.querySelector('#qr [name=oekaki-bg]').checked ?\r\n              document.querySelector('#qr [name=oekaki-bgcolor]').value\r\n              :\r\n              'transparent'\r\n        });\r\n      });\r\n    },\r\n\r\n    button() {\r\n      if (QR.selected.file) {\r\n        return QR.oekaki.edit();\r\n      } else {\r\n        return QR.oekaki.toggle();\r\n      }\r\n    },\r\n\r\n    edit() {\r\n      return QR.oekaki.load(() => $.global(function () {\r\n        const { Tegaki, FCX } = window;\r\n        const name = document.getElementById('qr-filename').value.replace(/\\.\\w+$/, '') + '.png';\r\n        const { source } = document.getElementById('file-n-submit').dataset;\r\n        const error = content => document.dispatchEvent(new CustomEvent('CreateNotification', {\r\n          bubbles: true,\r\n          detail: { type: 'warning', content, lifetime: 20 }\r\n        }));\r\n        var cb = function (e) {\r\n          if (e) { this.removeEventListener('QRMetadata', cb, false); }\r\n          const selected = document.getElementById('selected');\r\n          if (!selected?.dataset.type) { return error('No file to edit.'); }\r\n          if (!/^(image|video)\\//.test(selected.dataset.type)) { return error('Not an image.'); }\r\n          if (!selected.dataset.height) { return error('Metadata not available.'); }\r\n          if (selected.dataset.height === 'loading') {\r\n            selected.addEventListener('QRMetadata', cb, false);\r\n            return;\r\n          }\r\n          if (Tegaki.bg) { Tegaki.destroy(); }\r\n          FCX.oekakiName = name;\r\n          Tegaki.open({\r\n            onDone: FCX.oekakiCB,\r\n            onCancel() { return Tegaki.bgColor = '#ffffff'; },\r\n            width: +selected.dataset.width,\r\n            height: +selected.dataset.height,\r\n            bgColor: 'transparent'\r\n          });\r\n          const canvas = document.createElement('canvas');\r\n          canvas.width = (canvas.naturalWidth = +selected.dataset.width);\r\n          canvas.height = (canvas.naturalHeight = +selected.dataset.height);\r\n          canvas.hidden = true;\r\n          document.body.appendChild(canvas);\r\n          canvas.addEventListener('QRImageDrawn', function () {\r\n            this.remove();\r\n            return Tegaki.onOpenImageLoaded.call(this);\r\n          }\r\n            , false);\r\n          return canvas.dispatchEvent(new CustomEvent('QRDrawFile', { bubbles: true }));\r\n        };\r\n        if (Tegaki.bg && (Tegaki.onDoneCb === FCX.oekakiCB) && (source === FCX.oekakiLatest)) {\r\n          FCX.oekakiName = name;\r\n          return Tegaki.resume();\r\n        } else {\r\n          return cb();\r\n        }\r\n      }));\r\n    },\r\n\r\n    toggle() {\r\n      return QR.oekaki.load(() => QR.nodes.oekaki.hidden = !QR.nodes.oekaki.hidden);\r\n    }\r\n  },\r\n\r\n  persona: {\r\n    always: {},\r\n    types: {\r\n      name: [],\r\n      email: [],\r\n      sub: []\r\n    },\r\n\r\n    init() {\r\n      if (!Conf['Quick Reply'] && (!Conf['Menu'] || !Conf['Delete Link'])) { return; }\r\n      for (var item of Conf['QR.personas'].split('\\n')) {\r\n        QR.persona.parseItem(item.trim());\r\n      }\r\n    },\r\n\r\n    parseItem(item) {\r\n      let match, needle, type, val;\r\n      if (item[0] === '#') { return; }\r\n      if (!(match = item.match(/(name|options|email|subject|password):\"(.*)\"/i))) { return; }\r\n      [match, type, val] = match;\r\n\r\n      // Don't mix up item settings with val.\r\n      item = item.replace(match, '');\r\n\r\n      const boards = item.match(/boards:([^;]+)/i)?.[1].toLowerCase() || 'global';\r\n      if ((boards !== 'global') && (needle = g.BOARD.ID, !boards.split(',').includes(needle))) { return; }\r\n\r\n\r\n      if (type === 'password') {\r\n        QR.persona.pwd = val;\r\n        return;\r\n      }\r\n\r\n      if (type === 'options') { type = 'email'; }\r\n      if (type === 'subject') { type = 'sub'; }\r\n\r\n      if (/always/i.test(item)) {\r\n        QR.persona.always[type] = val;\r\n      }\r\n\r\n      if (!QR.persona.types[type].includes(val)) {\r\n        return QR.persona.types[type].push(val);\r\n      }\r\n    },\r\n\r\n    load() {\r\n      for (var type in QR.persona.types) {\r\n        var arr = QR.persona.types[type];\r\n        var list = $(`#list-${type}`, QR.nodes.el);\r\n        for (var val of arr) {\r\n          if (val) {\r\n            $.add(list, $.el('option',\r\n              { textContent: val })\r\n            );\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    getPassword() {\r\n      let m;\r\n      if (QR.persona.pwd != null) {\r\n        return QR.persona.pwd;\r\n      } else if (m = d.cookie.match(/4chan_pass=([^;]+)/)) {\r\n        return decodeURIComponent(m[1]);\r\n      } else {\r\n        return '';\r\n      }\r\n    },\r\n\r\n    get(cb) {\r\n      return $.get('QR.persona', {}, ({ 'QR.persona': persona }) => cb(persona));\r\n    },\r\n\r\n    set(post) {\r\n      return $.get('QR.persona', {}, function ({ 'QR.persona': persona }) {\r\n        persona = {\r\n          name: post.name,\r\n          flag: post.flag\r\n        };\r\n        return $.set('QR.persona', persona);\r\n      });\r\n    }\r\n  },\r\n\r\n  post: class {\r\n    constructor(select) {\r\n      this.select = this.select.bind(this);\r\n      const el = $.el('a', {\r\n        className: 'qr-preview',\r\n        draggable: true,\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.extend(el, { innerHTML: '<a class=\"remove\" title=\"Remove\">✕</a><label class=\"qr-preview-spoiler\"><input type=\"checkbox\"> Spoiler</label><span></span>' });\r\n\r\n      this.nodes = {\r\n        el,\r\n        rm: el.firstChild,\r\n        spoiler: $('.qr-preview-spoiler input', el),\r\n        span: el.lastChild\r\n      };\r\n\r\n      $.on(el, 'click', this.select);\r\n      $.on(this.nodes.rm, 'click', e => { e.stopPropagation(); return this.rm(); });\r\n      $.on(this.nodes.spoiler, 'change', e => {\r\n        this.spoiler = e.target.checked;\r\n        if (this === QR.selected) { QR.nodes.spoiler.checked = this.spoiler; }\r\n        return this.preventAutoPost();\r\n      });\r\n      for (var label of $$('label', el)) {\r\n        $.on(label, 'click', e => e.stopPropagation());\r\n      }\r\n      $.add(QR.nodes.dumpList, el);\r\n\r\n      for (var event of ['dragStart', 'dragEnter', 'dragLeave', 'dragOver', 'dragEnd', 'drop']) {\r\n        $.on(el, event.toLowerCase(), this[event]);\r\n      }\r\n\r\n      this.thread = g.VIEW === 'thread' ?\r\n        g.THREADID\r\n        :\r\n        'new';\r\n\r\n      const prev = QR.posts[QR.posts.length - 1];\r\n      QR.posts.push(this);\r\n      this.nodes.spoiler.checked = (this.spoiler = prev && Conf['Remember Spoiler'] ?\r\n        prev.spoiler\r\n        :\r\n        false);\r\n      QR.persona.get(persona => {\r\n        this.name = 'name' in QR.persona.always ?\r\n          QR.persona.always.name\r\n          : prev ?\r\n            prev.name\r\n            :\r\n            persona.name;\r\n\r\n        this.email = 'email' in QR.persona.always ?\r\n          QR.persona.always.email\r\n          :\r\n          '';\r\n\r\n        this.sub = 'sub' in QR.persona.always ?\r\n          QR.persona.always.sub\r\n          :\r\n          '';\r\n\r\n        if (QR.nodes.flag) {\r\n          this.flag = (() => {\r\n            if (prev) {\r\n              return prev.flag;\r\n            } else if (persona.flag && persona.flag in g.BOARD.config.board_flags) {\r\n              return persona.flag;\r\n            }\r\n          })();\r\n        }\r\n        if (QR.selected === this) { return this.load(); }\r\n      }); // load persona\r\n      if (select) { this.select(); }\r\n      this.unlock();\r\n      QR.captcha.moreNeeded();\r\n    }\r\n\r\n    rm() {\r\n      this.delete();\r\n      const index = QR.posts.indexOf(this);\r\n      if (QR.posts.length === 1) {\r\n        new QR.post(true);\r\n        $.rmClass(QR.nodes.el, 'dump');\r\n      } else if (this === QR.selected) {\r\n        (QR.posts[index - 1] || QR.posts[index + 1]).select();\r\n      }\r\n      QR.posts.splice(index, 1);\r\n      QR.status();\r\n      return QR.captcha.updateThread?.();\r\n    }\r\n\r\n    delete() {\r\n      $.rm(this.nodes.el);\r\n      URL.revokeObjectURL(this.URL);\r\n      return this.dismissErrors();\r\n    }\r\n\r\n    lock(lock = true) {\r\n      this.isLocked = lock;\r\n      if (this !== QR.selected) { return; }\r\n      for (var name of ['thread', 'name', 'email', 'sub', 'com', 'fileButton', 'filename', 'spoiler', 'flag']) {\r\n        var node;\r\n        if ((node = QR.nodes[name])) {\r\n          node.disabled = lock;\r\n        }\r\n      }\r\n      this.nodes.rm.style.visibility = lock ? 'hidden' : '';\r\n      this.nodes.spoiler.disabled = lock;\r\n      return this.nodes.el.draggable = !lock;\r\n    }\r\n\r\n    unlock() {\r\n      return this.lock(false);\r\n    }\r\n\r\n    select() {\r\n      if (QR.selected) {\r\n        QR.selected.nodes.el.removeAttribute('id');\r\n        QR.selected.forceSave();\r\n      }\r\n      QR.selected = this;\r\n      this.lock(this.isLocked);\r\n      this.nodes.el.id = 'selected';\r\n      // Scroll the list to center the focused post.\r\n      const rectEl = this.nodes.el.getBoundingClientRect();\r\n      const rectList = this.nodes.el.parentNode.getBoundingClientRect();\r\n      this.nodes.el.parentNode.scrollLeft += (rectEl.left + (rectEl.width / 2)) - rectList.left - (rectList.width / 2);\r\n      return this.load();\r\n    }\r\n\r\n    load() {\r\n      // Load this post's values.\r\n\r\n      for (var name of ['thread', 'name', 'email', 'sub', 'com', 'filename', 'flag']) {\r\n        var node;\r\n        if (!(node = QR.nodes[name])) { continue; }\r\n        node.value = this[name] || node.dataset.default || '';\r\n      }\r\n\r\n      (this.thread !== 'new' ? $.addClass : $.rmClass)(QR.nodes.el, 'reply-to-thread');\r\n\r\n      this.showFileData();\r\n      return QR.characterCount();\r\n    }\r\n\r\n    save(input, forced) {\r\n      if (input.type === 'checkbox') {\r\n        this.spoiler = input.checked;\r\n        return;\r\n      }\r\n      const { name } = input.dataset;\r\n      if (!['thread', 'name', 'email', 'sub', 'com', 'filename', 'flag'].includes(name)) { return; }\r\n      const prev = this[name] || input.dataset.default || null;\r\n      this[name] = input.value || input.dataset.default || null;\r\n      switch (name) {\r\n        case 'thread':\r\n          (this.thread !== 'new' ? $.addClass : $.rmClass)(QR.nodes.el, 'reply-to-thread');\r\n          QR.status();\r\n          QR.captcha.updateThread?.();\r\n          break;\r\n        case 'com':\r\n          this.updateComment();\r\n          break;\r\n        case 'filename':\r\n          if (!this.file) { return; }\r\n          this.saveFilename();\r\n          this.updateFilename();\r\n          break;\r\n        case 'name': case 'flag':\r\n          if (this[name] !== prev) { // only save manual changes, not values filled in by persona settings\r\n            QR.persona.set(this);\r\n          }\r\n          break;\r\n      }\r\n      if (!forced) { return this.preventAutoPost(); }\r\n    }\r\n\r\n    forceSave() {\r\n      if (this !== QR.selected) { return; }\r\n      // Do this in case people use extensions\r\n      // that do not trigger the `input` event.\r\n      for (var name of ['thread', 'name', 'email', 'sub', 'com', 'filename', 'spoiler', 'flag']) {\r\n        var node;\r\n        if (!(node = QR.nodes[name])) { continue; }\r\n        this.save(node, true);\r\n      }\r\n    }\r\n\r\n    preventAutoPost() {\r\n      // Disable auto-posting if you're editing the first post\r\n      // during the last 5 seconds of the cooldown.\r\n      if (QR.cooldown.auto && (this === QR.posts[0])) {\r\n        QR.cooldown.update(); // adding/removing file can change cooldown\r\n        if (QR.cooldown.seconds <= 5) { return QR.cooldown.auto = false; }\r\n      }\r\n    }\r\n\r\n    setComment(com) {\r\n      this.com = com || null;\r\n      if (this === QR.selected) {\r\n        QR.nodes.com.value = this.com;\r\n      }\r\n      return this.updateComment();\r\n    }\r\n\r\n    updateComment() {\r\n      if (this === QR.selected) {\r\n        QR.characterCount();\r\n      }\r\n      this.nodes.span.textContent = this.com;\r\n      QR.captcha.moreNeeded();\r\n      if (QR.captcha === Captcha.v2) {\r\n        return Captcha.cache.prerequest();\r\n      }\r\n    }\r\n\r\n    isOnlyQuotes() {\r\n      return (this.com || '').trim() === (this.quotedText || '').trim();\r\n    }\r\n\r\n    static rmErrored(e) {\r\n      e.stopPropagation();\r\n      for (let i = QR.posts.length - 1; i >= 0; i--) {\r\n        var errors;\r\n        var post = QR.posts[i];\r\n        if ((errors = post.errors)) {\r\n          for (var error of errors) {\r\n            if (doc.contains(error)) {\r\n              post.rm();\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    error(className, message, link) {\r\n      const div = $.el('div', { className });\r\n      $.extend(div, {\r\n        innerHTML: message + (link ? ` [<a href=\"${E(link)}\" target=\"_blank\">More info</a>]` : '') +\r\n          `<br>[<a href=\"javascript:;\">delete post</a>] [<a href=\"javascript:;\">delete all</a>]`\r\n      });\r\n      (this.errors || (this.errors = [])).push(div);\r\n      const [rm, rmAll] = $$('a', div);\r\n      $.on(div, 'click', () => {\r\n        if (QR.posts.includes(this)) { return this.select(); }\r\n      });\r\n      $.on(rm, 'click', e => {\r\n        e.stopPropagation();\r\n        if (QR.posts.includes(this)) { return this.rm(); }\r\n      });\r\n      $.on(rmAll, 'click', QR.post.rmErrored);\r\n      return QR.error(div, true);\r\n    }\r\n\r\n    fileError(message, link) {\r\n      return this.error('file-error', `${this.filename}: ${message}`, link);\r\n    }\r\n\r\n    dismissErrors(test = () => true) {\r\n      if (this.errors) {\r\n        for (var error of this.errors) {\r\n          if (doc.contains(error) && test(error)) {\r\n            error.parentNode.previousElementSibling.click();\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    setFile(file) {\r\n      this.file = file;\r\n      if (Conf['Randomize Filename'] && (g.BOARD.ID !== 'f')) {\r\n        let ext;\r\n        this.filename = `${Date.now() * 1000 - Math.floor(Math.random() * 365 * DAY * 1000)}`;\r\n        if (ext = this.file.name.match(QR.validExtension)) { this.filename += ext[0]; }\r\n      } else {\r\n        this.filename = this.file.name;\r\n      }\r\n      this.filesize = $.bytesToString(this.file.size);\r\n      this.checkSize();\r\n      $.addClass(this.nodes.el, 'has-file');\r\n      QR.captcha.moreNeeded();\r\n      URL.revokeObjectURL(this.URL);\r\n      this.saveFilename();\r\n      if (this === QR.selected) {\r\n        this.showFileData();\r\n      } else {\r\n        this.updateFilename();\r\n      }\r\n      this.rmMetadata();\r\n      this.nodes.el.dataset.type = this.file.type;\r\n      this.nodes.el.style.backgroundImage = '';\r\n      if (!QR.mimeTypes.includes(this.file.type)) {\r\n        this.fileError('Unsupported file type.');\r\n      } else if (/^(image|video)\\//.test(this.file.type)) {\r\n        this.readFile();\r\n      }\r\n      return this.preventAutoPost();\r\n    }\r\n\r\n    checkSize() {\r\n      let max = QR.max_size;\r\n      if (/^video\\//.test(this.file.type)) { max = Math.min(max, QR.max_size_video); }\r\n      if (this.file.size > max) {\r\n        return this.fileError(`File too large (file: ${this.filesize}, max: ${$.bytesToString(max)}).`);\r\n      }\r\n    }\r\n\r\n    readFile() {\r\n      const isVideo = /^video\\//.test(this.file.type);\r\n      const el = $.el(isVideo ? 'video' : 'img');\r\n      if (isVideo && !el.canPlayType(this.file.type)) { return; }\r\n\r\n      const event = isVideo ? 'loadeddata' : 'load';\r\n      var onload = () => {\r\n        $.off(el, event, onload);\r\n        $.off(el, 'error', onerror);\r\n        this.checkDimensions(el);\r\n        this.setThumbnail(el);\r\n        return $.event('QRMetadata', null, this.nodes.el);\r\n      };\r\n      var onerror = () => {\r\n        $.off(el, event, onload);\r\n        $.off(el, 'error', onerror);\r\n        this.fileError(`Corrupt ${isVideo ? 'video' : 'image'} or error reading metadata.`, meta.upstreamFaq + '#error-reading-metadata');\r\n        URL.revokeObjectURL(el.src);\r\n        // XXX https://bugzilla.mozilla.org/show_bug.cgi?id=1021289\r\n        this.nodes.el.removeAttribute('data-height');\r\n        return $.event('QRMetadata', null, this.nodes.el);\r\n      };\r\n      this.nodes.el.dataset.height = 'loading';\r\n      $.on(el, event, onload);\r\n      $.on(el, 'error', onerror);\r\n      return el.src = URL.createObjectURL(this.file);\r\n    }\r\n\r\n    checkDimensions(el) {\r\n      let height, width;\r\n      if (el.tagName === 'IMG') {\r\n        ({ height, width } = el);\r\n        this.nodes.el.dataset.height = height;\r\n        this.nodes.el.dataset.width = width;\r\n        if ((height > QR.max_height) || (width > QR.max_width)) {\r\n          this.fileError(`Image too large (image: ${height}x${width}px, max: ${QR.max_height}x${QR.max_width}px)`);\r\n        }\r\n        if ((height < QR.min_height) || (width < QR.min_width)) {\r\n          return this.fileError(`Image too small (image: ${height}x${width}px, min: ${QR.min_height}x${QR.min_width}px)`);\r\n        }\r\n      } else {\r\n        const { videoHeight, videoWidth, duration } = el;\r\n        this.nodes.el.dataset.height = videoHeight;\r\n        this.nodes.el.dataset.width = videoWidth;\r\n        this.nodes.el.dataset.duration = duration;\r\n        const max_height = Math.min(QR.max_height, QR.max_height_video);\r\n        const max_width = Math.min(QR.max_width, QR.max_width_video);\r\n        if ((videoHeight > max_height) || (videoWidth > max_width)) {\r\n          this.fileError(`Video too large (video: ${videoHeight}x${videoWidth}px, max: ${max_height}x${max_width}px)`);\r\n        }\r\n        if ((videoHeight < QR.min_height) || (videoWidth < QR.min_width)) {\r\n          this.fileError(`Video too small (video: ${videoHeight}x${videoWidth}px, min: ${QR.min_height}x${QR.min_width}px)`);\r\n        }\r\n        if (!isFinite(duration)) {\r\n          this.fileError('Video lacks duration metadata (try remuxing)');\r\n        } else if (duration > QR.max_duration_video) {\r\n          this.fileError(`Video too long (video: ${duration}s, max: ${QR.max_duration_video}s)`);\r\n        }\r\n        if (BoardConfig.noAudio(g.BOARD.ID) && $.hasAudio(el)) {\r\n          return this.fileError('Audio not allowed');\r\n        }\r\n      }\r\n    }\r\n\r\n    setThumbnail(el) {\r\n      // Create a redimensioned thumbnail.\r\n      let height, width;\r\n      const isVideo = el.tagName === 'VIDEO';\r\n\r\n      // Generate thumbnails only if they're really big.\r\n      // Resized pictures through canvases look like ass,\r\n      // so we generate thumbnails `s` times bigger then expected\r\n      // to avoid crappy resized quality.\r\n      let s = 90 * 2 * window.devicePixelRatio;\r\n      if (this.file.type === 'image/gif') { s *= 3; } // let them animate\r\n      if (isVideo) {\r\n        height = el.videoHeight;\r\n        width = el.videoWidth;\r\n      } else {\r\n        ({ height, width } = el);\r\n        if ((height < s) || (width < s)) {\r\n          this.URL = el.src;\r\n          this.nodes.el.style.backgroundImage = `url(${this.URL})`;\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (height <= width) {\r\n        width = (s / height) * width;\r\n        height = s;\r\n      } else {\r\n        height = (s / width) * height;\r\n        width = s;\r\n      }\r\n      const cv = $.el('canvas');\r\n      cv.height = height;\r\n      cv.width = width;\r\n      cv.getContext('2d').drawImage(el, 0, 0, width, height);\r\n      URL.revokeObjectURL(el.src);\r\n      return cv.toBlob(blob => {\r\n        this.URL = URL.createObjectURL(blob);\r\n        return this.nodes.el.style.backgroundImage = `url(${this.URL})`;\r\n      });\r\n    }\r\n\r\n    rmFile() {\r\n      if (this.isLocked) { return; }\r\n      delete this.file;\r\n      delete this.filename;\r\n      delete this.filesize;\r\n      this.nodes.el.removeAttribute('title');\r\n      QR.nodes.filename.removeAttribute('title');\r\n      this.rmMetadata();\r\n      this.nodes.el.style.backgroundImage = '';\r\n      $.rmClass(this.nodes.el, 'has-file');\r\n      this.showFileData();\r\n      URL.revokeObjectURL(this.URL);\r\n      this.dismissErrors(error => $.hasClass(error, 'file-error'));\r\n      return this.preventAutoPost();\r\n    }\r\n\r\n    rmMetadata() {\r\n      for (var attr of ['type', 'height', 'width', 'duration']) {\r\n        // XXX https://bugzilla.mozilla.org/show_bug.cgi?id=1021289\r\n        this.nodes.el.removeAttribute(`data-${attr}`);\r\n      }\r\n    }\r\n\r\n    saveFilename() {\r\n      this.file.newName = (this.filename || '').replace(/[/\\\\]/g, '-');\r\n      if (!QR.validExtension.test(this.filename)) {\r\n        // 4chan will truncate the filename if it has no extension.\r\n        return this.file.newName += `.${$.getOwn(QR.extensionFromType, this.file.type) || 'jpg'}`;\r\n      }\r\n    }\r\n\r\n    updateFilename() {\r\n      const long = `${this.filename} (${this.filesize})`;\r\n      this.nodes.el.title = long;\r\n      if (this !== QR.selected) { return; }\r\n      return QR.nodes.filename.title = long;\r\n    }\r\n\r\n    showFileData() {\r\n      if (this.file) {\r\n        this.updateFilename();\r\n        QR.nodes.filename.value = this.filename;\r\n        $.addClass(QR.nodes.oekaki, 'has-file');\r\n        $.addClass(QR.nodes.fileSubmit, 'has-file');\r\n      } else {\r\n        $.rmClass(QR.nodes.oekaki, 'has-file');\r\n        $.rmClass(QR.nodes.fileSubmit, 'has-file');\r\n      }\r\n      if (this.file?.source != null) {\r\n        QR.nodes.fileSubmit.dataset.source = this.file.source;\r\n      } else {\r\n        QR.nodes.fileSubmit.removeAttribute('data-source');\r\n      }\r\n      return QR.nodes.spoiler.checked = this.spoiler;\r\n    }\r\n\r\n    pasteText(file) {\r\n      this.pasting = true;\r\n      this.preventAutoPost();\r\n      const reader = new FileReader();\r\n      reader.onload = e => {\r\n        const { result } = e.target;\r\n        this.setComment((this.com ? `${this.com}\\n${result}` : result));\r\n        return delete this.pasting;\r\n      };\r\n      return reader.readAsText(file);\r\n    }\r\n\r\n    dragStart(e) {\r\n      const { left, top } = this.getBoundingClientRect();\r\n      e.dataTransfer.setDragImage(this, e.clientX - left, e.clientY - top);\r\n      return $.addClass(this, 'drag');\r\n    }\r\n    dragEnd() { return $.rmClass(this, 'drag'); }\r\n    dragEnter() { return $.addClass(this, 'over'); }\r\n    dragLeave() { return $.rmClass(this, 'over'); }\r\n\r\n    dragOver(e) {\r\n      e.preventDefault();\r\n      return e.dataTransfer.dropEffect = 'move';\r\n    }\r\n\r\n    drop() {\r\n      $.rmClass(this, 'over');\r\n      if (!this.draggable) { return; }\r\n      const el = $('.drag', this.parentNode);\r\n      const index = el => {\r\n        for (let i = 0; i < el.parentNode.children.length; i++) {\r\n          if (el.parentNode.children[i] === el) return i;\r\n        }\r\n        return -1;\r\n      }\r\n      const oldIndex = index(el);\r\n      const newIndex = index(this);\r\n      if (QR.posts[oldIndex].isLocked || QR.posts[newIndex].isLocked) { return; }\r\n      (oldIndex < newIndex ? $.after : $.before)(this, el);\r\n      const post = QR.posts.splice(oldIndex, 1)[0];\r\n      QR.posts.splice(newIndex, 0, post);\r\n      QR.status();\r\n      return QR.captcha.updateThread?.();\r\n    }\r\n  }\r\n\r\n};\r\nexport default QR;\r\n","import QR from \"../Posting/QR\";\r\nimport $ from \"./$\";\r\nimport { dict, platform } from \"./helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * DS206: Consider reworking classes to avoid initClass\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nlet eventPageRequest;\r\nif (platform === 'crx') {\r\n  eventPageRequest = (function () {\r\n    const callbacks = [];\r\n    chrome.runtime.onMessage.addListener(function(response) {\r\n      callbacks[response.id](response.data);\r\n      return delete callbacks[response.id];});\r\n    return (params, cb) => chrome.runtime.sendMessage(params, id => callbacks[id] = cb);\r\n  })();\r\n}\r\nvar CrossOrigin = {\r\n  binary(url, cb, headers = dict()) {\r\n    // XXX https://forums.lanik.us/viewtopic.php?f=64&t=24173&p=78310\r\n    url = url.replace(/^((?:https?:)?\\/\\/(?:\\w+\\.)?(?:4chan|4channel|4cdn)\\.org)\\/adv\\//, '$1//adv/');\r\n    if (platform === 'crx') {\r\n    eventPageRequest({type: 'ajax', url, headers, responseType: 'arraybuffer'}, function({response, responseHeaderString}) {\r\n      if (response) { response = new Uint8Array(response); }\r\n      return cb(response, responseHeaderString);\r\n    });\r\n    } else {\r\n      const fallback = function() {\r\n        return $.ajax(url, {\r\n          headers,\r\n          responseType: 'arraybuffer',\r\n          onloadend() {\r\n            if (this.status && this.response) {\r\n              return cb(new Uint8Array(this.response), this.getAllResponseHeaders());\r\n            } else {\r\n              return cb(null);\r\n            }\r\n          }\r\n        });\r\n      };\r\n      if ((typeof window.GM_xmlhttpRequest === 'undefined' || window.GM_xmlhttpRequest === null)) {\r\n        fallback();\r\n        return;\r\n      }\r\n      const gmOptions = {\r\n        method: \"GET\",\r\n        url,\r\n        headers,\r\n        responseType: 'arraybuffer',\r\n        overrideMimeType: 'text/plain; charset=x-user-defined',\r\n        onload(xhr) {\r\n          let data;\r\n          if (xhr.response instanceof ArrayBuffer) {\r\n            data = new Uint8Array(xhr.response);\r\n          } else {\r\n            const r = xhr.responseText;\r\n            data = new Uint8Array(r.length);\r\n            let i = 0;\r\n            while (i < r.length) {\r\n              data[i] = r.charCodeAt(i);\r\n              i++;\r\n            }\r\n          }\r\n          return cb(data, xhr.responseHeaders);\r\n        },\r\n        onerror() {\r\n          return cb(null);\r\n        },\r\n        onabort() {\r\n          return cb(null);\r\n        }\r\n      };\r\n      try {\r\n        return (GM?.xmlHttpRequest || GM_xmlhttpRequest)(gmOptions);\r\n      } catch (error) {\r\n        return fallback();\r\n      }\r\n    }\r\n  },\r\n\r\n  file(url, cb) {\r\n    return CrossOrigin.binary(url, function(data, headers) {\r\n      if (data == null) { return cb(null); }\r\n      let name = url.match(/([^\\/?#]+)\\/*(?:$|[?#])/)?.[1];\r\n      const contentType        = headers.match(/Content-Type:\\s*(.*)/i)?.[1];\r\n      const contentDisposition = headers.match(/Content-Disposition:\\s*(.*)/i)?.[1];\r\n      let mime = contentType?.match(/[^;]*/)[0] || 'application/octet-stream';\r\n      const match =\r\n        contentDisposition?.match(/\\bfilename\\s*=\\s*\"((\\\\\"|[^\"])+)\"/i)?.[1] ||\r\n        contentType?.match(/\\bname\\s*=\\s*\"((\\\\\"|[^\"])+)\"/i)?.[1];\r\n      if (match) {\r\n        name = match.replace(/\\\\\"/g, '\"');\r\n      }\r\n      if (/^text\\/plain;\\s*charset=x-user-defined$/i.test(mime)) {\r\n        // In JS Blocker (Safari) content type comes back as 'text/plain; charset=x-user-defined'; guess from filename instead.\r\n        mime = $.getOwn(QR.typeFromExtension, name.match(/[^.]*$/)[0].toLowerCase()) || 'application/octet-stream';\r\n      }\r\n      const blob = new Blob([data], {type: mime});\r\n      blob.name = name;\r\n      return cb(blob);\r\n    });\r\n  },\r\n\r\n  Request: (function() {\r\n    const Request = class Request {\r\n      static initClass() {\r\n        this.prototype.status = 0;\r\n        this.prototype.statusText = '';\r\n        this.prototype.response = null;\r\n        this.prototype.responseHeaderString = null;\r\n      }\r\n      getResponseHeader(headerName) {\r\n        if ((this.responseHeaders == null) && (this.responseHeaderString != null)) {\r\n          this.responseHeaders = dict();\r\n          for (var header of this.responseHeaderString.split('\\r\\n')) {\r\n            var i;\r\n            if ((i = header.indexOf(':')) >= 0) {\r\n              var key = header.slice(0, i).trim().toLowerCase();\r\n              var val = header.slice(i+1).trim();\r\n              this.responseHeaders[key] = val;\r\n            }\r\n          }\r\n        }\r\n        return this.responseHeaders?.[headerName.toLowerCase()] ?? null;\r\n      }\r\n      abort() {}\r\n      onloadend() {}\r\n    };\r\n    Request.initClass();\r\n    return Request;\r\n  })(),\r\n\r\n  // Attempts to fetch `url` using cross-origin privileges, if available.\r\n  // Interface is a subset of that of $.ajax.\r\n  // Options:\r\n  //   `onloadend` - called with the returned object as `this` on success or error/abort/timeout.\r\n  //   `timeout` - time limit for request\r\n  //   `responseType` - expected response type, 'json' by default; 'json' and 'text' supported\r\n  //   `headers` - request headers\r\n  // Returned object properties:\r\n  //   `status` - HTTP status (0 if connection not successful)\r\n  //   `statusText` - HTTP status text\r\n  //   `response` - decoded response body\r\n  //   `abort` - function for aborting the request (silently fails on some platforms)\r\n  //   `getResponseHeader` - function for reading response headers\r\n  ajax(url, options={}) {\r\n    let gmReq;\r\n    let {onloadend, timeout, responseType, headers} = options;\r\n    if (responseType == null) { responseType = 'json'; }\r\n\r\n    if ((window.GM?.xmlHttpRequest == null) && (typeof window.GM_xmlhttpRequest === 'undefined' || window.GM_xmlhttpRequest === null)) {\r\n      return $.ajax(url, options);\r\n    }\r\n\r\n    const req = new CrossOrigin.Request();\r\n    req.onloadend = onloadend;\r\n\r\n    if (platform === 'userscript') {\r\n      const gmOptions = {\r\n        method: 'GET',\r\n        url,\r\n        headers,\r\n        timeout,\r\n        onload(xhr) {\r\n          try {\r\n            const response = (() => { switch (responseType) {\r\n              case 'json':\r\n                if (xhr.responseText) { return JSON.parse(xhr.responseText); } else { return null; }\r\n              default:\r\n                return xhr.responseText;\r\n            } })();\r\n            $.extend(req, {\r\n              response,\r\n              status: xhr.status,\r\n              statusText: xhr.statusText,\r\n              responseHeaderString: xhr.responseHeaders\r\n            });\r\n          } catch (error) {}\r\n          return req.onloadend();\r\n        },\r\n        onerror() { return req.onloadend(); },\r\n        onabort() { return req.onloadend(); },\r\n        ontimeout() { return req.onloadend(); }\r\n      };\r\n      try {\r\n        gmReq = (GM?.xmlHttpRequest || GM_xmlhttpRequest)(gmOptions);\r\n      } catch (error) {\r\n        return $.ajax(url, options);\r\n      }\r\n\r\n      if (gmReq && (typeof gmReq.abort === 'function')) {\r\n        req.abort = function() {\r\n          try {\r\n            return gmReq.abort();\r\n          } catch (error1) {}\r\n        };\r\n      }\r\n    } else {\r\n      eventPageRequest({type: 'ajax', url, responseType, headers, timeout}, function(result) {\r\n        if (result.status) {\r\n          $.extend(req, result);\r\n        }\r\n        return req.onloadend();\r\n      });\r\n    }\r\n\r\n    return req;\r\n  },\r\n\r\n  cache(url, cb) {\r\n    return $.cache(url, cb,\r\n      {ajax: CrossOrigin.ajax});\r\n  },\r\n\r\n  permission(cb, cbFail, origins) {\r\n    if (platform === 'crx') {\r\n      return eventPageRequest({type: 'permission', origins}, function(result) {\r\n        if (result) {\r\n          return cb();\r\n        } else {\r\n          return cbFail();\r\n        }\r\n      });\r\n    }\r\n    return cb();\r\n  },\r\n};\r\nexport default CrossOrigin;\r\n",null,"import { Conf, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Get = {\r\n  url(type, IDs, ...args) {\r\n    let f, site;\r\n    if ((site = g.sites[IDs.siteID]) && (f = $.getOwn(site.urls, type))) {\r\n      return f(IDs, ...args);\r\n    } else {\r\n      return undefined;\r\n    }\r\n  },\r\n  threadExcerpt(thread) {\r\n    const {OP} = thread;\r\n    const excerpt = (`/${decodeURIComponent(thread.board.ID)}/ - `) + (\r\n      OP.info.subject?.trim() ||\r\n      OP.commentDisplay().replace(/\\n+/g, ' // ') ||\r\n      OP.file?.name ||\r\n      `No.${OP}`);\r\n    if (excerpt.length > 73) { return `${excerpt.slice(0, 70)}...`; }\r\n    return excerpt;\r\n  },\r\n  threadFromRoot(root) {\r\n    if (root == null) { return null; }\r\n    const {board} = root.dataset;\r\n    return g.threads.get(`${board ? encodeURIComponent(board) : g.BOARD.ID}.${root.id.match(/\\d*$/)[0]}`);\r\n  },\r\n  threadFromNode(node) {\r\n    return Get.threadFromRoot($.x(`ancestor-or-self::${g.SITE.xpath.thread}`, node));\r\n  },\r\n  postFromRoot(root) {\r\n    if (root == null) { return null; }\r\n    const post  = g.posts.get(root.dataset.fullID);\r\n    const index = root.dataset.clone;\r\n    if (index) { return post.clones[+index]; } else { return post; }\r\n  },\r\n  postFromNode(root) {\r\n    return Get.postFromRoot($.x(`ancestor-or-self::${g.SITE.xpath.postContainer}[1]`, root));\r\n  },\r\n  postDataFromLink(link) {\r\n    let boardID, postID, threadID;\r\n    if (link.dataset.postID) { // resurrected quote\r\n      ({boardID, threadID, postID} = link.dataset);\r\n      if (!threadID) { threadID = 0; }\r\n    } else {\r\n      const match = link.href.match(g.SITE.regexp.quotelink);\r\n      [boardID, threadID, postID] = match.slice(1);\r\n      if (!postID) { postID = threadID; }\r\n    }\r\n    return {\r\n      boardID,\r\n      threadID: +threadID,\r\n      postID:   +postID\r\n    };\r\n  },\r\n  allQuotelinksLinkingTo(post) {\r\n    // Get quotelinks & backlinks linking to the given post.\r\n    const quotelinks = [];\r\n    const {posts} = g;\r\n    const {fullID} = post;\r\n    const handleQuotes = function(qPost, type) {\r\n      quotelinks.push(...(qPost.nodes[type] || []));\r\n      for (var clone of qPost.clones) { quotelinks.push(...(clone.nodes[type] || [])); }\r\n    };\r\n    // First:\r\n    //   In every posts,\r\n    //   if it did quote this post,\r\n    //   get all their backlinks.\r\n    posts.forEach(function(qPost) {\r\n      if (qPost.quotes.includes(fullID)) {\r\n        return handleQuotes(qPost, 'quotelinks');\r\n      }\r\n    });\r\n\r\n    // Second:\r\n    //   If we have quote backlinks:\r\n    //   in all posts this post quoted\r\n    //   and their clones,\r\n    //   get all of their backlinks.\r\n    if (Conf['Quote Backlinks']) {\r\n      for (var quote of post.quotes) { var qPost;\r\n      if ((qPost = posts.get(quote))) { handleQuotes(qPost, 'backlinks'); } }\r\n    }\r\n\r\n    // Third:\r\n    //   Filter out irrelevant quotelinks.\r\n    return quotelinks.filter(function(quotelink) {\r\n      const {boardID, postID} = Get.postDataFromLink(quotelink);\r\n      return (boardID === post.board.ID) && (postID === post.ID);\r\n    });\r\n  }\r\n};\r\nexport default Get;\r\n",null,"import { Conf, doc, g } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\nimport SW from \"./SW\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Site = {\r\n  defaultProperties: {\r\n    '4chan.org':    {software: 'yotsuba'},\r\n    '4channel.org': {canonical: '4chan.org'},\r\n    '4cdn.org':     {canonical: '4chan.org'},\r\n    'notso.smuglo.li': {canonical: 'smuglo.li'},\r\n    'smugloli.net':    {canonical: 'smuglo.li'},\r\n    'smug.nepu.moe':   {canonical: 'smuglo.li'}\r\n  },\r\n\r\n  init(cb) {\r\n    $.extend(Conf['siteProperties'], Site.defaultProperties);\r\n    let hostname = Site.resolve();\r\n    if (hostname && $.hasOwn(SW, Conf['siteProperties'][hostname].software)) {\r\n      this.set(hostname);\r\n      cb();\r\n    }\r\n    return $.onExists(doc, 'body', () => {\r\n      for (var software in SW) {\r\n        var changes;\r\n        if (changes = SW[software].detect?.()) {\r\n          changes.software = software;\r\n          hostname = location.hostname.replace(/^www\\./, '');\r\n          var properties = (Conf['siteProperties'][hostname] || (Conf['siteProperties'][hostname] = dict()));\r\n          var changed = 0;\r\n          for (var key in changes) {\r\n            if (properties[key] !== changes[key]) {\r\n              properties[key] = changes[key];\r\n              changed++;\r\n            }\r\n          }\r\n          if (changed) {\r\n            $.set('siteProperties', Conf['siteProperties']);\r\n          }\r\n          if (!g.SITE) {\r\n            this.set(hostname);\r\n            cb();\r\n          }\r\n          return;\r\n        }\r\n      }\r\n    });\r\n  },\r\n\r\n  resolve(url=location) {\r\n    let {hostname} = url;\r\n    while (hostname && !$.hasOwn(Conf['siteProperties'], hostname)) {\r\n      hostname = hostname.replace(/^[^.]*\\.?/, '');\r\n    }\r\n    if (hostname) {\r\n      let canonical;\r\n      if (canonical = Conf['siteProperties'][hostname].canonical) { hostname = canonical; }\r\n    }\r\n    return hostname;\r\n  },\r\n\r\n  parseURL(url) {\r\n    const siteID = Site.resolve(url);\r\n    return Main.parseURL(g.sites[siteID], url);\r\n  },\r\n\r\n  set(hostname) {\r\n    for (var ID in Conf['siteProperties']) {\r\n      var site;\r\n      var properties = Conf['siteProperties'][ID];\r\n      if (properties.canonical) { continue; }\r\n      var {\r\n        software\r\n      } = properties;\r\n      if (!software || !$.hasOwn(SW, software)) { continue; }\r\n      g.sites[ID] = (site = Object.create(SW[software]));\r\n      $.extend(site, {ID, siteID: ID, properties, software});\r\n    }\r\n    return g.SITE = g.sites[hostname];\r\n  }\r\n};\r\nexport default Site;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Filter from \"../Filtering/Filter\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport meta from '../../package.json';\r\nimport Index from \"../General/Index\";\r\nimport Site from \"../site/Site\";\r\nimport Header from \"../General/Header\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport UI from \"../General/UI\";\r\nimport Get from \"../General/Get\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar CatalogLinks = {\r\n  init() {\r\n    if ((g.SITE.software === 'yotsuba') && (Conf['External Catalog'] || Conf['JSON Index']) && !(Conf['JSON Index'] && (g.VIEW === 'index'))) {\r\n      const selector = (() => { switch (g.VIEW) {\r\n        case 'thread': case 'archive': return '.navLinks.desktop > a';\r\n        case 'catalog':           return '.navLinks > :first-child > a';\r\n        case 'index':             return '#ctrl-top > a, .cataloglink > a';\r\n      } })();\r\n      $.ready(function() {\r\n        for (var link of $$(selector)) {\r\n          var catalogURL;\r\n          switch (link.pathname.replace(/\\/+/g, '/')) {\r\n            case `/${g.BOARD}/`:\r\n              if (Conf['JSON Index']) { link.textContent = 'Index'; }\r\n              link.href = CatalogLinks.index();\r\n              break;\r\n            case `/${g.BOARD}/catalog`:\r\n              link.href = CatalogLinks.catalog();\r\n              break;\r\n          }\r\n          if ((g.VIEW === 'catalog') && ((catalogURL = CatalogLinks.catalog()) !== g.SITE.urls.catalog?.(g.BOARD))) {\r\n            var catalogLink = link.parentNode.cloneNode(true);\r\n            var link2 = catalogLink.firstElementChild;\r\n            link2.href = catalogURL;\r\n            link2.textContent = link2.hostname === location.hostname ? `${meta.name} Catalog` : 'External Catalog';\r\n            $.after(link.parentNode, [$.tn(' '), catalogLink]);\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    if ((g.SITE.software === 'yotsuba') && Conf['JSON Index'] && Conf[`Use ${meta.name} Catalog`]) {\r\n      Callbacks.Post.push({\r\n        name: 'Catalog Link Rewrite',\r\n        cb:   this.node\r\n      });\r\n    }\r\n\r\n    if (this.enabled = Conf['Catalog Links']) {\r\n      let el;\r\n      CatalogLinks.el = (el = UI.checkbox('Header catalog links', 'Catalog Links'));\r\n      el.id = 'toggleCatalog';\r\n      const input = $('input', el);\r\n      $.on(input, 'change', this.toggle);\r\n      $.sync('Header catalog links', CatalogLinks.set);\r\n      return Header.menu.addEntry({\r\n        el,\r\n        order: 95\r\n      });\r\n    }\r\n  },\r\n\r\n  node() {\r\n    for (var a of $$('a', this.nodes.comment)) {\r\n      var m;\r\n      if (m = a.href.match(/^https?:\\/\\/(boards\\.4chan(?:nel)?\\.org\\/[^\\/]+)\\/catalog(#s=.*)?/)) {\r\n        a.href = `//${m[1]}/${m[2] || '#catalog'}`;\r\n      }\r\n    }\r\n  },\r\n\r\n  toggle() {\r\n    $.event('CloseMenu');\r\n    $.set('Header catalog links', this.checked);\r\n    return CatalogLinks.set(this.checked);\r\n  },\r\n\r\n  set(useCatalog) {\r\n    Conf['Header catalog links'] = useCatalog;\r\n    CatalogLinks.setLinks(Header.boardList);\r\n    CatalogLinks.setLinks(Header.bottomBoardList);\r\n    CatalogLinks.el.title = `Turn catalog links ${useCatalog ? 'off' : 'on'}.`;\r\n    return $('input', CatalogLinks.el).checked = useCatalog;\r\n  },\r\n\r\n  // Also called by Header when board lists are loaded / generated.\r\n  setLinks(list) {\r\n    if ((!(CatalogLinks.enabled ?? Conf['Catalog Links'])) || !list) { return; }\r\n\r\n    // do not transform links unless they differ from the expected value at most by this tail\r\n    const tail = /(?:index)?(?:\\.\\w+)?$/;\r\n\r\n    for (var a of $$('a:not([data-only])', list)) {\r\n      var {siteID, boardID} = a.dataset;\r\n      if (!siteID || !boardID) {\r\n        var VIEW;\r\n        ({siteID, boardID, VIEW} = Site.parseURL(a));\r\n        if (\r\n          !siteID || !boardID ||\r\n          !['index', 'catalog'].includes(VIEW) ||\r\n          (!a.dataset.indexOptions && (a.href.replace(tail, '') !== (Get.url(VIEW, {siteID, boardID}) || '').replace(tail, '')))\r\n        ) { continue; }\r\n        $.extend(a.dataset, {siteID, boardID});\r\n      }\r\n\r\n      var board = {siteID, boardID};\r\n      var url = Conf['Header catalog links'] ? CatalogLinks.catalog(board) : Get.url('index', board);\r\n      if (url) {\r\n        a.href = url;\r\n        if (a.dataset.indexOptions && (url.split('#')[0] === Get.url('index', board))) {\r\n          a.href += (a.hash ? '/' : '#') + a.dataset.indexOptions;\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  externalParse() {\r\n    CatalogLinks.externalList = dict();\r\n    for (var line of Conf['externalCatalogURLs'].split('\\n')) {\r\n      if (line[0] === '#') { continue; }\r\n      var url = line.split(';')[0];\r\n      var boards   = Filter.parseBoards(line.match(/;boards:([^;]+)/)?.[1] || '*');\r\n      var excludes = Filter.parseBoards(line.match(/;exclude:([^;]+)/)?.[1]) || dict();\r\n      for (var board in boards) {\r\n        if (!excludes[board] && !excludes[board.split('/')[0] + '/*']) {\r\n          CatalogLinks.externalList[board] = url;\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  external({siteID, boardID}) {\r\n    if (!CatalogLinks.externalList) { CatalogLinks.externalParse(); }\r\n    const external = (CatalogLinks.externalList[`${siteID}/${boardID}`] || CatalogLinks.externalList[`${siteID}/*`]);\r\n    if (external) { return external.replace(/%board/g, boardID); } else { return undefined; }\r\n  },\r\n\r\n  jsonIndex(board, hash) {\r\n    if ((g.SITE.ID === board.siteID) && (g.BOARD.ID === board.boardID) && (g.VIEW === 'index')) {\r\n      return hash;\r\n    } else {\r\n      return Get.url('index', board) + hash;\r\n    }\r\n  },\r\n\r\n  catalog(board=g.BOARD) {\r\n    let external, nativeCatalog;\r\n    if (Conf['External Catalog'] && (external = CatalogLinks.external(board))) {\r\n      return external;\r\n    } else if (Index.enabledOn(board) && Conf[`Use ${meta.name} Catalog`]) {\r\n      return CatalogLinks.jsonIndex(board, '#catalog');\r\n    } else if (nativeCatalog = Get.url('catalog', board)) {\r\n      return nativeCatalog;\r\n    } else {\r\n      return CatalogLinks.external(board);\r\n    }\r\n  },\r\n\r\n  index(board=g.BOARD) {\r\n    if (Index.enabledOn(board)) {\r\n      return CatalogLinks.jsonIndex(board, '#index');\r\n    } else {\r\n      return Get.url('index', board);\r\n    }\r\n  }\r\n};\r\nexport default CatalogLinks;\r\n",null,"import Header from \"../General/Header\";\r\nimport { d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { SECOND } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nexport default class Notice {\r\n  constructor(type, content, timeout, onclose) {\r\n    this.add = this.add.bind(this);\r\n    this.close = this.close.bind(this);\r\n    this.timeout = timeout;\r\n    this.onclose = onclose;\r\n    this.el = $.el('div',\r\n      {innerHTML: \"<a href=\\\"javascript:;\\\" class=\\\"close\\\" title=\\\"Close\\\">✕</a><div class=\\\"message\\\"></div>\"});\r\n    this.el.style.opacity = 0;\r\n    this.setType(type);\r\n    $.on(this.el.firstElementChild, 'click', this.close);\r\n    if (typeof content === 'string') {\r\n      content = $.tn(content);\r\n    }\r\n    $.add(this.el.lastElementChild, content);\r\n\r\n    $.ready(this.add);\r\n  }\r\n\r\n  setType(type) {\r\n    return this.el.className = `notification ${type}`;\r\n  }\r\n\r\n  add() {\r\n    if (this.closed) { return; }\r\n    if (d.hidden) {\r\n      $.on(d, 'visibilitychange', this.add);\r\n      return;\r\n    }\r\n    $.off(d, 'visibilitychange', this.add);\r\n    $.add(Header.noticesRoot, this.el);\r\n    this.el.clientHeight; // force reflow\r\n    this.el.style.opacity = 1;\r\n    if (this.timeout) { return setTimeout(this.close, this.timeout * SECOND); }\r\n  }\r\n\r\n  close() {\r\n    this.closed = true;\r\n    $.off(d, 'visibilitychange', this.add);\r\n    $.rm(this.el);\r\n    return this.onclose?.();\r\n  }\r\n}\r\n",null,"import { g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport Board from \"./Board\";\r\nimport Thread from \"./Thread\";\r\n\r\nexport default class CatalogThreadNative {\r\n  toString() { return this.ID; }\r\n\r\n  constructor(root) {\r\n    this.nodes = {\r\n      root,\r\n      thumb: $(g.SITE.selectors.catalog.thumb, root)\r\n    };\r\n    this.siteID  = g.SITE.ID;\r\n    this.boardID = this.nodes.thumb.parentNode.pathname.split(/\\/+/)[1];\r\n    this.board = g.boards[this.boardID] || new Board(this.boardID);\r\n    this.ID = (this.threadID = +(root.dataset.id || root.id).match(/\\d*$/)[0]);\r\n    this.thread = this.board.threads.get(this.ID) || new Thread(this.ID, this.board);\r\n  }\r\n}\r\n","import { Conf, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst Anonymize = {\r\n  init() {\r\n    if (!Conf['Anonymize']) { return; }\r\n    return $.addClass(doc, 'anonymize');\r\n  }\r\n};\r\nexport default Anonymize;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Header from \"../General/Header\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { SECOND } from \"../platform/helpers\";\r\nimport ImageCommon from \"./ImageCommon\";\r\nimport Volume from \"./Volume\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ImageHover = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW)) { return; }\r\n    if (Conf['Image Hover']) {\r\n      Callbacks.Post.push({\r\n        name: 'Image Hover',\r\n        cb:   this.node\r\n      });\r\n    }\r\n    if (Conf['Image Hover in Catalog']) {\r\n      return Callbacks.CatalogThread.push({\r\n        name: 'Image Hover',\r\n        cb:   this.catalogNode\r\n      });\r\n    }\r\n  },\r\n\r\n  node() {\r\n    return this.files.filter((file) => (file.isImage || file.isVideo) && file.thumb).map((file) =>\r\n      $.on(file.thumb, 'mouseover', ImageHover.mouseover(this, file)));\r\n  },\r\n\r\n  catalogNode() {\r\n    const file = this.thread.OP.files[0];\r\n    if (!file || (!file.isImage && !file.isVideo)) { return; }\r\n    return $.on(this.nodes.thumb, 'mouseover', ImageHover.mouseover(this.thread.OP, file));\r\n  },\r\n\r\n  mouseover(post, file) { return function(e) {\r\n    let el, height, width;\r\n    if (!doc.contains(this)) { return; }\r\n    const {isVideo} = file;\r\n    if (file.isExpanding || file.isExpanded || g.SITE.isThumbExpanded?.(file)) { return; }\r\n    const error = ImageHover.error(post, file);\r\n    if (ImageCommon.cache?.dataset.fileID === `${post.fullID}.${file.index}`) {\r\n      el = ImageCommon.popCache();\r\n      $.on(el, 'error', error);\r\n    } else {\r\n      el = $.el((isVideo ? 'video' : 'img'));\r\n      el.dataset.fileID = `${post.fullID}.${file.index}`;\r\n      $.on(el, 'error', error);\r\n      el.src = file.url;\r\n    }\r\n\r\n    if (Conf['Restart when Opened']) {\r\n      ImageCommon.rewind(el);\r\n      ImageCommon.rewind(this);\r\n    }\r\n    el.id = 'ihover';\r\n    $.add(Header.hover, el);\r\n    if (isVideo) {\r\n      el.loop     = true;\r\n      el.controls = false;\r\n      Volume.setup(el);\r\n      if (Conf['Autoplay']) {\r\n        el.play();\r\n        if (this.nodeName === 'VIDEO') { this.currentTime = el.currentTime; }\r\n      }\r\n    }\r\n    if (file.dimensions) {\r\n      [width, height] = file.dimensions.split('x').map((x) => +x);\r\n      const maxWidth = doc.clientWidth;\r\n      const maxHeight = doc.clientHeight - UI.hover.padding;\r\n      const scale = Math.min(1, maxWidth / width, maxHeight / height);\r\n      width *= scale;\r\n      height *= scale;\r\n      el.style.maxWidth  = `${width}px`;\r\n      el.style.maxHeight = `${height}px`;\r\n    }\r\n    return UI.hover({\r\n      root: this,\r\n      el,\r\n      latestEvent: e,\r\n      endEvents: 'mouseout click',\r\n      height,\r\n      width,\r\n      noRemove: true,\r\n      cb() {\r\n        $.off(el, 'error', error);\r\n        ImageCommon.pushCache(el);\r\n        ImageCommon.pause(el);\r\n        $.rm(el);\r\n        return el.removeAttribute('style');\r\n      }\r\n    });\r\n  }; },\r\n\r\n  error(post, file) { return function() {\r\n    if (ImageCommon.decodeError(this, file)) { return; }\r\n    return ImageCommon.error(this, post, file, 3 * SECOND, URL => {\r\n      if (URL) {\r\n        return this.src = URL + (this.src === URL ? '?' + Date.now() : '');\r\n      } else {\r\n        return $.rm(this);\r\n      }\r\n    });\r\n  }; }\r\n};\r\nexport default ImageHover;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Header from \"../General/Header\";\r\nimport { g, Conf, d, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ImageLoader = {\r\n  init() {\r\n    if (!['index', 'thread', 'archive'].includes(g.VIEW)) { return; }\r\n    const replace = Conf['Replace JPG'] || Conf['Replace PNG'] || Conf['Replace GIF'] || Conf['Replace WEBM'];\r\n    if (!Conf['Image Prefetching'] && !replace) { return; }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Image Replace',\r\n      cb:   this.node\r\n    });\r\n\r\n    $.on(d, 'PostsInserted', function() {\r\n      if (ImageLoader.prefetchEnabled || replace) {\r\n        return g.posts.forEach(ImageLoader.prefetchAll);\r\n      }\r\n    });\r\n\r\n    if (Conf['Replace WEBM']) {\r\n      $.on(d, 'scroll visibilitychange 4chanXInitFinished PostsInserted', this.playVideos);\r\n    }\r\n\r\n    if (!Conf['Image Prefetching'] || !['index', 'thread'].includes(g.VIEW)) { return; }\r\n\r\n    const el = $.el('a', {\r\n      href: 'javascript:;',\r\n      title: 'Prefetch Images',\r\n      innerHTML: 'Prefetch',\r\n    });\r\n\r\n    $.on(el, 'click', this.toggle);\r\n\r\n    return Header.addShortcut('prefetch', el, 525, '🗲︎');\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) { return; }\r\n    for (var file of this.files) {\r\n      if (Conf['Replace WEBM'] && file.isVideo) { ImageLoader.replaceVideo(this, file); }\r\n      ImageLoader.prefetch(this, file);\r\n    }\r\n  },\r\n\r\n  replaceVideo(post, file) {\r\n    const {thumb} = file;\r\n    const video = $.el('video', {\r\n      preload:     'none',\r\n      loop:        true,\r\n      muted:       true,\r\n      poster:      thumb.src || thumb.dataset.src,\r\n      textContent: thumb.alt,\r\n      className:   thumb.className\r\n    }\r\n    );\r\n    video.setAttribute('muted', 'muted');\r\n    video.dataset.md5 = thumb.dataset.md5;\r\n    for (var attr of ['height', 'width', 'maxHeight', 'maxWidth']) { video.style[attr] = thumb.style[attr]; }\r\n    video.src         = file.url;\r\n    $.replace(thumb, video);\r\n    file.thumb      = video;\r\n    return file.videoThumb = true;\r\n  },\r\n\r\n  prefetch(post, file) {\r\n    let clone, type;\r\n    const {isImage, isVideo, thumb, url} = file;\r\n    if (file.isPrefetched || !(isImage || isVideo) || post.isHidden || post.thread.isHidden) { return; }\r\n    if (isVideo) {\r\n      type = 'WEBM';\r\n    } else {\r\n      type = url.match(/\\.([^.]+)$/)?.[1].toUpperCase();\r\n      if (type === 'JPEG') { type = 'JPG'; }\r\n    }\r\n    const replace = Conf[`Replace ${type}`] && !/spoiler/.test(thumb.src || thumb.dataset.src);\r\n    if (!replace && !ImageLoader.prefetchEnabled) { return; }\r\n    if ($.hasClass(doc, 'catalog-mode')) { return; }\r\n    if (![post, ...post.clones].some(clone => doc.contains(clone.nodes.root))) { return; }\r\n    file.isPrefetched = true;\r\n    if (file.videoThumb) {\r\n      for (clone of post.clones) { clone.file.thumb.preload = 'auto'; }\r\n      thumb.preload = 'auto';\r\n      // XXX Cloned video elements with poster in Firefox cause momentary display of image loading icon.\r\n      if ($.engine === 'gecko') {\r\n        $.on(thumb, 'loadeddata', function() { return this.removeAttribute('poster'); });\r\n      }\r\n      return;\r\n    }\r\n\r\n    const el = $.el(isImage ? 'img' : 'video');\r\n    if (isVideo) { el.preload = 'auto'; }\r\n    if (replace && isImage) {\r\n      $.on(el, 'load', function() {\r\n        for (clone of post.clones) { clone.file.thumb.src = url; }\r\n        return thumb.src = url;\r\n      });\r\n    }\r\n    return el.src = url;\r\n  },\r\n\r\n  prefetchAll(post) {\r\n    for (var file of post.files) {\r\n      ImageLoader.prefetch(post, file);\r\n    }\r\n  },\r\n\r\n  toggle() {\r\n    ImageLoader.prefetchEnabled = !ImageLoader.prefetchEnabled;\r\n    this.classList.toggle('disabled', !ImageLoader.prefetchEnabled);\r\n    if (ImageLoader.prefetchEnabled) {\r\n      g.posts.forEach(ImageLoader.prefetchAll);\r\n    }\r\n  },\r\n\r\n  playVideos() {\r\n    // Special case: Quote previews are off screen when inserted into document, but quickly moved on screen.\r\n    const qpClone = $.id('qp')?.firstElementChild;\r\n    return g.posts.forEach(function(post) {\r\n      for (post of [post, ...post.clones]) {\r\n        for (var file of post.files) {\r\n          if (file.videoThumb) {\r\n            var {thumb} = file;\r\n            if (Header.isNodeVisible(thumb) || (post.nodes.root === qpClone)) { thumb.play(); } else { thumb.pause(); }\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n};\r\nexport default ImageLoader;\r\n","import $ from \"../platform/$\";\r\nimport Callbacks from \"../classes/Callbacks\";\r\nimport CrossOrigin from \"../platform/CrossOrigin\";\r\nimport { Conf, d, g } from \"../globals/globals\";\r\nimport Get from \"../General/Get\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Metadata = {\r\n  init() {\r\n    if (!Conf['WEBM Metadata'] || !['index', 'thread'].includes(g.VIEW)) { return; }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'WEBM Metadata',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    for (let i = 0; i < this.files.length; i++) {\r\n      var file = this.files[i];\r\n      if (/webm$/i.test(file.url)) {var el;\r\n      \r\n        if (this.isClone) {\r\n          el = $('.webm-title', file.text);\r\n        } else {\r\n          el = $.el('span',\r\n            {className: 'webm-title'});\r\n          el.dataset.index = i;\r\n          $.extend(el,\r\n            {innerHTML: \"<a href=\\\"javascript:;\\\"></a>\"});\r\n          $.add(file.text, [$.tn(' '), el]);\r\n        }\r\n        if (el.children.length === 1) { $.one(el.lastElementChild, 'mouseover focus', Metadata.load); }\r\n      }\r\n    }\r\n  },\r\n\r\n  load() {\r\n    $.rmClass(this.parentNode, 'error');\r\n    $.addClass(this.parentNode, 'loading');\r\n    const {index} = this.parentNode.dataset;\r\n    return CrossOrigin.binary(Get.postFromNode(this).files[+index].url, data => {\r\n      $.rmClass(this.parentNode, 'loading');\r\n      if (data != null) {\r\n        const title = Metadata.parse(data);\r\n        const output = $.el('span',\r\n          {textContent: title || ''});\r\n        if (title == null) { $.addClass(this.parentNode, 'not-found'); }\r\n        $.before(this, output);\r\n        this.parentNode.tabIndex = 0;\r\n        if (d.activeElement === this) { this.parentNode.focus(); }\r\n        return this.tabIndex = -1;\r\n      } else {\r\n        $.addClass(this.parentNode, 'error');\r\n        return $.one(this, 'click', Metadata.load);\r\n      }\r\n    }\r\n    ,\r\n      {Range: 'bytes=0-9999'});\r\n  },\r\n\r\n  parse(data) {\r\n    const readInt = function() {\r\n      let n = data[i++];\r\n      let len = 0;\r\n      while (n < (0x80 >> len)) { len++; }\r\n      n ^= (0x80 >> len);\r\n      while (len-- && (i < data.length)) {\r\n        n = (n << 8) ^ data[i++];\r\n      }\r\n      return n;\r\n    };\r\n\r\n    var i = 0;\r\n    while (i < data.length) {\r\n      var element = readInt();\r\n      var size    = readInt();\r\n      if (element === 0x3BA9) { // Title\r\n        var title = '';\r\n        while (size-- && (i < data.length)) {\r\n          title += String.fromCharCode(data[i++]);\r\n        }\r\n        return decodeURIComponent(escape(title)); // UTF-8 decoding\r\n      } else if (![0x8538067, 0x549A966].includes(element)) { // Segment, Info\r\n        i += size;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n};\r\nexport default Metadata;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g, Conf } from \"../globals/globals\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst RevealSpoilers = {\r\n  init() {\r\n    if (!['index', 'thread', 'archive'].includes(g.VIEW) || !Conf['Reveal Spoiler Thumbnails']) { return; }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Reveal Spoiler Thumbnails',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) { return; }\r\n    for (var file of this.files) {\r\n      if (file.thumb && file.isSpoiler) {\r\n        var {thumb} = file;\r\n        // Remove old width and height.\r\n        thumb.removeAttribute('style');\r\n        // Enforce thumbnail size if thumbnail is replaced.\r\n        thumb.style.maxHeight = (thumb.style.maxWidth = this.isReply ? '125px' : '250px');\r\n        if (thumb.src) {\r\n          thumb.src = file.thumbURL;\r\n        } else {\r\n          thumb.dataset.src = file.thumbURL;\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default RevealSpoilers;\r\n","import Callbacks from \"../classes/Callbacks\";\r\n// import Test from \"../General/Test\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport ImageHost from \"../Images/ImageHost\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport Embedding from \"./Embedding\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Linkify = {\r\n  init() {\r\n    if (!['index', 'thread', 'archive'].includes(g.VIEW) || !Conf['Linkify']) { return; }\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Linkify',\r\n      cb:   this.node\r\n    });\r\n\r\n    return Embedding.init();\r\n  },\r\n\r\n  node() {\r\n    let link;\r\n    if (this.isClone) { return Embedding.events(this); }\r\n    if (!Linkify.regString.test(this.info.comment)) { return; }\r\n    for (link of $$('a', this.nodes.comment)) {\r\n      if (g.SITE.isLinkified?.(link)) {\r\n        $.addClass(link, 'linkify');\r\n        if (ImageHost.useFaster) { ImageHost.fixLinks([link]); }\r\n        Embedding.process(link, this);\r\n      }\r\n    }\r\n    const links = Linkify.process(this.nodes.comment);\r\n    if (ImageHost.useFaster) { ImageHost.fixLinks(links); }\r\n    for (link of links) { Embedding.process(link, this); }\r\n  },\r\n\r\n  process(node) {\r\n    let length;\r\n    const test     = /[^\\s\"]+/g;\r\n    const space    = /[\\s\"]/;\r\n    const snapshot = $.X('.//br|.//text()', node);\r\n    let i = 0;\r\n    const links = [];\r\n    while ((node = snapshot.snapshotItem(i++))) {\r\n      var result;\r\n      var {data} = node;\r\n      if (!data || (node.parentElement.nodeName === \"A\")) { continue; }\r\n\r\n      while ((result = test.exec(data))) {\r\n        var {index} = result;\r\n        var endNode = node;\r\n        var word    = result[0];\r\n        // End of node, not necessarily end of space-delimited string\r\n        if ((length = index + word.length) === data.length) {\r\n          var saved;\r\n          test.lastIndex = 0;\r\n\r\n          while (saved = snapshot.snapshotItem(i++)) {\r\n            var end;\r\n            if ((saved.nodeName === 'BR') || ((saved.parentElement.nodeName === 'P') && !saved.previousSibling)) {\r\n              var part1, part2;\r\n              if (\r\n                // link deliberately split\r\n                (part1 = word.match(/(https?:\\/\\/)?([a-z\\d-]+\\.)*[a-z\\d-]+$/i)) &&\r\n                (part2 = snapshot.snapshotItem(i)?.data?.match(/^(\\.[a-z\\d-]+)*\\//i)) &&\r\n                ((part1[0] + part2[0]).search(Linkify.regString) === 0)\r\n              ) {\r\n                continue;\r\n              } else {\r\n                break;\r\n              }\r\n            }\r\n\r\n            if ((saved.parentElement.nodeName === \"A\") && !Linkify.regString.test(word)) {\r\n              break;\r\n            }\r\n\r\n            endNode  = saved;\r\n            ({data}   = saved);\r\n\r\n            if (end = space.exec(data)) {\r\n              // Set our snapshot and regex to start on this node at this position when the loop resumes\r\n              word += data.slice(0, end.index);\r\n              test.lastIndex = (length = end.index);\r\n              i--;\r\n              break;\r\n            } else {\r\n              ({length} = data);\r\n              word    += data;\r\n            }\r\n          }\r\n        }\r\n\r\n        if (Linkify.regString.test(word)) {\r\n          links.push(Linkify.makeRange(node, endNode, index, length));\r\n\r\n          // <% if (readJSON('/.tests_enabled')) { %>\r\n          // if (links.length) {\r\n          // Test.assert(() => word === links[links.length - 1]?.toString());\r\n          // }\r\n          // <% } %>\r\n        }\r\n\r\n        if (!test.lastIndex || (node !== endNode)) { break; }\r\n      }\r\n    }\r\n\r\n    i = links.length;\r\n    while (i--) {\r\n      links[i] = Linkify.makeLink(links[i]);\r\n    }\r\n    return links;\r\n  },\r\n\r\n  regString: new RegExp(`(\\\r\n\\\r\n(https?|mailto|git|magnet|ftp|irc):(\\\r\n[a-z\\\\d%/?]\\\r\n)\\\r\n|\\\r\n([-a-z\\\\d]+[.])+(\\\r\naero|asia|biz|cat|com|coop|dance|info|int|jobs|mobi|moe|museum|name|net|org|post|pro|tel|travel|xxx|xyz|edu|gov|mil|[a-z]{2}\\\r\n)([:/]|(?![^\\\\s\"]))\\\r\n|\\\r\n[\\\\d]{1,3}\\\\.[\\\\d]{1,3}\\\\.[\\\\d]{1,3}\\\\.[\\\\d]{1,3}\\\r\n|\\\r\n[-\\\\w\\\\d.@]+@[a-z\\\\d.-]+\\\\.[a-z\\\\d]\\\r\n)`, 'i'),\r\n\r\n  makeRange(startNode, endNode, startOffset, endOffset) {\r\n    const range = document.createRange();\r\n    range.setStart(startNode, startOffset);\r\n    range.setEnd(endNode,   endOffset);\r\n    return range;\r\n  },\r\n\r\n  makeLink(range) {\r\n    let t;\r\n    let encodedDomain;\r\n    let text = range.toString();\r\n\r\n    // Clean start of range\r\n    let i = text.search(Linkify.regString);\r\n\r\n    if (i > 0) {\r\n      text = text.slice(i);\r\n      while ((range.startOffset + i) >= range.startContainer.data.length) { i--; }\r\n\r\n      if (i) { range.setStart(range.startContainer, range.startOffset + i); }\r\n    }\r\n\r\n    // Clean end of range\r\n    i = 0;\r\n    while (/[)\\]}>.,]/.test(t = text.charAt(text.length - (1 + i)))) {\r\n      if (!/[.,]/.test(t) && !((text.match(/[()\\[\\]{}<>]/g)).length % 2)) { break; }\r\n      i++;\r\n    }\r\n\r\n    if (i) {\r\n      text = text.slice(0, -i);\r\n      while ((range.endOffset - i) < 0) { i--; }\r\n\r\n      if (i) {\r\n        range.setEnd(range.endContainer, range.endOffset - i);\r\n      }\r\n    }\r\n\r\n    // Make our link 'valid' if it is formatted incorrectly.\r\n    if (!/((mailto|magnet):|.+:\\/\\/)/.test(text)) {\r\n      text = (\r\n        /@/.test(text) ?\r\n          'mailto:'\r\n        :\r\n          'http://'\r\n      ) + text;\r\n    }\r\n\r\n    // Decode percent-encoded characters in domain so that they behave consistently across browsers.\r\n    if (encodedDomain = text.match(/^(https?:\\/\\/[^/]*%[0-9a-f]{2})(.*)$/i)) {\r\n      text = encodedDomain[1].replace(/%([0-9a-f]{2})/ig, function(x, y) {\r\n        if (y === '25') { return x; } else { return String.fromCharCode(parseInt(y, 16)); }\r\n      }) + encodedDomain[2];\r\n    }\r\n\r\n    const a = $.el('a', {\r\n      className: 'linkify',\r\n      rel:       'noreferrer noopener',\r\n      target:    '_blank',\r\n      href:      text\r\n    }\r\n    );\r\n\r\n    // Insert the range into the anchor, the anchor into the range's DOM location, and destroy the range.\r\n    $.add(a, range.extractContents());\r\n    range.insertNode(a);\r\n\r\n    return a;\r\n  }\r\n};\r\nexport default Linkify;\r\n","import $ from \"../platform/$\";\r\nimport Redirect from \"../Archive/Redirect\";\r\nimport Filter from \"../Filtering/Filter\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport Menu from \"./Menu\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst ArchiveLink = {\r\n  init() {\r\n    if ((g.SITE.software !== 'yotsuba') || !['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Archive Link']) { return; }\r\n\r\n    const div = $.el('div',\r\n      {textContent: 'Archive'});\r\n\r\n    const entry = {\r\n      el: div,\r\n      order: 60,\r\n      open({ID, thread, board}) {\r\n        return !!Redirect.to('thread', {postID: ID, threadID: thread.ID, boardID: board.ID});\r\n      },\r\n      subEntries: []\r\n    };\r\n\r\n    for (var type of [\r\n      ['Post',      'post'],\r\n      ['Name',      'name'],\r\n      ['Tripcode',  'tripcode'],\r\n      ['Capcode',   'capcode'],\r\n      ['Subject',   'subject'],\r\n      ['Flag',      'country'],\r\n      ['Filename',  'filename'],\r\n      ['Image MD5', 'MD5']\r\n    ]) {\r\n      // Add a sub entry for each type.\r\n      entry.subEntries.push(this.createSubEntry(type[0], type[1]));\r\n    }\r\n\r\n    return Menu.menu.addEntry(entry);\r\n  },\r\n\r\n  createSubEntry(text, type) {\r\n    const el = $.el('a', {\r\n      textContent: text,\r\n      target: '_blank'\r\n    }\r\n    );\r\n\r\n    const open = type === 'post' ?\r\n      function({ID, thread, board}) {\r\n        el.href = Redirect.to('thread', {postID: ID, threadID: thread.ID, boardID: board.ID});\r\n        return true;\r\n      }\r\n    :\r\n      function(post) {\r\n        const typeParam = (type === 'country') && post.info.flagCodeTroll ?\r\n          'troll_country'\r\n        :\r\n          type;\r\n        const value = type === 'country' ?\r\n          post.info.flagCode || post.info.flagCodeTroll?.toLowerCase()\r\n        :\r\n          Filter.values(type, post)[0];\r\n        // We want to parse the exact same stuff as the filter does already.\r\n        if (!value) { return false; }\r\n        el.href = Redirect.to('search', {\r\n          boardID:  post.board.ID,\r\n          type:     typeParam,\r\n          value,\r\n          isSearch: true\r\n        }\r\n        );\r\n        return true;\r\n      };\r\n\r\n    return {\r\n      el,\r\n      open\r\n    };\r\n  }\r\n};\r\nexport default ArchiveLink;\r\n","import { g, Conf, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport Menu from \"./Menu\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar CopyTextLink = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Copy Text Link']) { return; }\r\n\r\n    const a = $.el('a', {\r\n      className: 'copy-text-link',\r\n      href: 'javascript:;',\r\n      textContent: 'Copy Text'\r\n    }\r\n    );\r\n    $.on(a, 'click', CopyTextLink.copy);\r\n\r\n    return Menu.menu.addEntry({\r\n      el: a,\r\n      order: 12,\r\n      open(post) {\r\n        CopyTextLink.text = (post.origin || post).commentOrig();\r\n        return true;\r\n      }\r\n    });\r\n  },\r\n\r\n  copy() {\r\n    const el = $.el('textarea', {\r\n      className: 'copy-text-element',\r\n      value: CopyTextLink.text\r\n    }\r\n    );\r\n    $.add(d.body, el);\r\n    el.select();\r\n    try {\r\n      d.execCommand('copy');\r\n    } catch (error) {}\r\n    return $.rm(el);\r\n  }\r\n};\r\nexport default CopyTextLink;\r\n","import Notice from \"../classes/Notice\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\nimport QR from \"../Posting/QR\";\r\nimport Menu from \"./Menu\";\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar DeleteLink = {\r\n  auto: [dict(), dict()],\r\n\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Delete Link']) { return; }\r\n\r\n    const div = $.el('div', {\r\n      className: 'delete-link',\r\n      textContent: 'Delete'\r\n    }\r\n    );\r\n    const postEl = $.el('a', {\r\n      className: 'delete-post',\r\n      href: 'javascript:;'\r\n    }\r\n    );\r\n    const fileEl = $.el('a', {\r\n      className: 'delete-file',\r\n      href: 'javascript:;'\r\n    }\r\n    );\r\n    this.nodes = {\r\n      menu:  div.firstChild,\r\n      links: [postEl, fileEl]\r\n    };\r\n\r\n    const postEntry = {\r\n      el: postEl,\r\n      open() {\r\n        postEl.textContent = DeleteLink.linkText(false);\r\n        $.on(postEl, 'click', DeleteLink.toggle);\r\n        return true;\r\n      }\r\n    };\r\n    const fileEntry = {\r\n      el: fileEl,\r\n      open({file}) {\r\n        if (!file || file.isDead) { return false; }\r\n        fileEl.textContent = DeleteLink.linkText(true);\r\n        $.on(fileEl, 'click', DeleteLink.toggle);\r\n        return true;\r\n      }\r\n    };\r\n\r\n    return Menu.menu.addEntry({\r\n      el: div,\r\n      order: 40,\r\n      open(post) {\r\n        if (post.isDead) { return false; }\r\n        DeleteLink.post = post;\r\n        DeleteLink.nodes.menu.textContent = DeleteLink.menuText();\r\n        DeleteLink.cooldown.start(post);\r\n        return true;\r\n      },\r\n      subEntries: [postEntry, fileEntry]});\r\n  },\r\n\r\n  menuText() {\r\n    let seconds;\r\n    if ((seconds = DeleteLink.cooldown.seconds[DeleteLink.post.fullID])) {\r\n      return `Delete (${seconds})`;\r\n    } else {\r\n      return 'Delete';\r\n    }\r\n  },\r\n\r\n  linkText(fileOnly) {\r\n    let text = fileOnly ? 'File' : 'Post';\r\n    if (DeleteLink.auto[+fileOnly][DeleteLink.post.fullID]) {\r\n      text = `Deleting ${text.toLowerCase()}...`;\r\n    }\r\n    return text;\r\n  },\r\n\r\n  toggle() {\r\n    const {post} = DeleteLink;\r\n    const fileOnly = $.hasClass(this, 'delete-file');\r\n    const auto = DeleteLink.auto[+fileOnly];\r\n\r\n    if (auto[post.fullID]) {\r\n      delete auto[post.fullID];\r\n    } else {\r\n      auto[post.fullID] = true;\r\n    }\r\n    this.textContent = DeleteLink.linkText(fileOnly);\r\n\r\n    if (!DeleteLink.cooldown.seconds[post.fullID]) {\r\n      return DeleteLink.delete(post, fileOnly);\r\n    }\r\n  },\r\n\r\n  delete(post, fileOnly) {\r\n    const link = DeleteLink.nodes.links[+fileOnly];\r\n    delete DeleteLink.auto[+fileOnly][post.fullID];\r\n    if (post.fullID === DeleteLink.post.fullID) { $.off(link, 'click', DeleteLink.toggle); }\r\n\r\n    const form = {\r\n      mode: 'usrdel',\r\n      onlyimgdel: fileOnly,\r\n      pwd: QR.persona.getPassword()\r\n    };\r\n    form[+post.ID] = 'delete';\r\n\r\n    return $.ajax($.id('delform').action.replace(`/${g.BOARD}/`, `/${post.board}/`), {\r\n      responseType: 'document',\r\n      withCredentials: true,\r\n      onloadend() { return DeleteLink.load(link, post, fileOnly, this.response); },\r\n      form: $.formData(form)\r\n    }\r\n    );\r\n  },\r\n\r\n  load(link, post, fileOnly, resDoc) {\r\n    let msg;\r\n    if (!resDoc) {\r\n      new Notice('warning', 'Connection error, please retry.', 20);\r\n      if (post.fullID === DeleteLink.post.fullID) { $.on(link, 'click', DeleteLink.toggle); }\r\n      return;\r\n    }\r\n\r\n    link.textContent = DeleteLink.linkText(fileOnly);\r\n    if (resDoc.title === '4chan - Banned') { // Ban/warn check\r\n      const el = $.el('span', {innerHTML: \"You can&#039;t delete posts because you are <a href=\\\"//www.4chan.org/banned\\\" target=\\\"_blank\\\">banned</a>.\"});\r\n      return new Notice('warning', el, 20);\r\n    } else if (msg = resDoc.getElementById('errmsg')) { // error!\r\n      new Notice('warning', msg.textContent, 20);\r\n      if (post.fullID === DeleteLink.post.fullID) { $.on(link, 'click', DeleteLink.toggle); }\r\n      if (QR.cooldown.data && Conf['Cooldown'] && /\\bwait\\b/i.test(msg.textContent)) {\r\n        DeleteLink.cooldown.start(post, 5);\r\n        DeleteLink.auto[+fileOnly][post.fullID] = true;\r\n        return DeleteLink.nodes.links[+fileOnly].textContent = DeleteLink.linkText(fileOnly);\r\n      }\r\n    } else {\r\n      if (!fileOnly) { QR.cooldown.delete(post); }\r\n      if (resDoc.title === 'Updating index...') {\r\n        // We're 100% sure.\r\n        (post.origin || post).kill(fileOnly);\r\n      }\r\n      if (post.fullID === DeleteLink.post.fullID) { return link.textContent = 'Deleted'; }\r\n    }\r\n  },\r\n\r\n  cooldown: {\r\n    seconds: dict(),\r\n\r\n    start(post, seconds) {\r\n      // Already counting.\r\n      if (DeleteLink.cooldown.seconds[post.fullID] != null) { return; }\r\n\r\n      if (seconds == null) { seconds = QR.cooldown.secondsDeletion(post); }\r\n      if (seconds > 0) {\r\n        DeleteLink.cooldown.seconds[post.fullID] = seconds;\r\n        return DeleteLink.cooldown.count(post);\r\n      }\r\n    },\r\n\r\n    count(post) {\r\n      if (post.fullID === DeleteLink.post.fullID) { DeleteLink.nodes.menu.textContent = DeleteLink.menuText(); }\r\n      if ((DeleteLink.cooldown.seconds[post.fullID] > 0) && Conf['Cooldown']) {\r\n        DeleteLink.cooldown.seconds[post.fullID]--;\r\n        setTimeout(DeleteLink.cooldown.count, 1000, post);\r\n      } else {\r\n        delete DeleteLink.cooldown.seconds[post.fullID];\r\n        for (var fileOnly of [false, true]) {\r\n          if (DeleteLink.auto[+fileOnly][post.fullID]) {\r\n            DeleteLink.delete(post, fileOnly);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default DeleteLink;\r\n","import { g, Conf } from \"../globals/globals\";\r\nimport ImageCommon from \"../Images/ImageCommon\";\r\nimport $ from \"../platform/$\";\r\nimport Menu from \"./Menu\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst DownloadLink = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Download Link']) { return; }\r\n\r\n    const a = $.el('a', {\r\n      className: 'download-link',\r\n      textContent: 'Download file'\r\n    }\r\n    );\r\n\r\n    // Specifying the filename with the download attribute only works for same-origin links.\r\n    $.on(a, 'click', ImageCommon.download);\r\n\r\n    return Menu.menu.addEntry({\r\n      el: a,\r\n      order: 100,\r\n      open({file}) {\r\n        if (!file) { return false; }\r\n        a.href     = file.url;\r\n        a.download = file.name;\r\n        return true;\r\n      }\r\n    });\r\n  }\r\n};\r\nexport default DownloadLink;\r\n","import { g, Conf, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport Menu from \"./Menu\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ReportLink = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Report Link']) { return; }\r\n\r\n    const a = $.el('a', {\r\n      className: 'report-link',\r\n      href: 'javascript:;',\r\n      textContent: 'Report'\r\n    }\r\n    );\r\n    $.on(a, 'click', ReportLink.report);\r\n\r\n    return Menu.menu.addEntry({\r\n      el: a,\r\n      order: 10,\r\n      open(post) {\r\n        ReportLink.url = `//sys.${location.hostname.split('.')[1]}.org/${post.board}/imgboard.php?mode=report&no=${post}`;\r\n        if (d.cookie.indexOf('pass_enabled=1') >= 0) {\r\n          ReportLink.dims = 'width=350,height=275';\r\n        } else {\r\n          ReportLink.dims = 'width=400,height=550';\r\n        }\r\n        return true;\r\n      }\r\n    });\r\n  },\r\n\r\n  report() {\r\n    const {url, dims} = ReportLink;\r\n    const id  = Date.now();\r\n    const set = `toolbar=0,scrollbars=1,location=0,status=1,menubar=0,resizable=1,${dims}`;\r\n    return window.open(url, id, set);\r\n  }\r\n};\r\nexport default ReportLink;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { Conf, d, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar AntiAutoplay = {\r\n  init() {\r\n    if (!Conf['Disable Autoplaying Sounds']) { return; }\r\n    $.addClass(doc, 'anti-autoplay');\r\n    for (var audio of $$('audio[autoplay]', doc)) { this.stop(audio); }\r\n    window.addEventListener('loadstart', (e => this.stop(e.target)), true);\r\n    Callbacks.Post.push({\r\n      name: 'Disable Autoplaying Sounds',\r\n      cb:   this.node\r\n    });\r\n    return $.ready(() => this.process(d.body));\r\n  },\r\n\r\n  stop(audio) {\r\n    if (!audio.autoplay) { return; }\r\n    audio.pause();\r\n    audio.autoplay = false;\r\n    if (audio.controls) { return; }\r\n    audio.controls = true;\r\n    return $.addClass(audio, 'controls-added');\r\n  },\r\n\r\n  node() {\r\n    return AntiAutoplay.process(this.nodes.comment);\r\n  },\r\n\r\n  process(root) {\r\n    for (var iframe of $$('iframe[src*=\"youtube\"][src*=\"autoplay=1\"]', root)) {\r\n      AntiAutoplay.processVideo(iframe, 'src');\r\n    }\r\n    for (var object of $$('object[data*=\"youtube\"][data*=\"autoplay=1\"]', root)) {\r\n      AntiAutoplay.processVideo(object, 'data');\r\n    }\r\n  },\r\n\r\n  processVideo(el, attr) {\r\n    el[attr] = el[attr].replace(/\\?autoplay=1&?/, '?').replace('&autoplay=1', '');\r\n    if (window.getComputedStyle(el).display === 'none') { el.style.display = 'block'; }\r\n    return $.addClass(el, 'autoplay-removed');\r\n  }\r\n};\r\nexport default AntiAutoplay;\r\n","import DataBoard from \"../classes/DataBoard\";\r\nimport { Conf, d, g } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport Unread from \"../Monitoring/Unread\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Banner = {\r\n  init() {\r\n    if (Conf['Custom Board Titles']) {\r\n      this.db = new DataBoard('customTitles', null, true);\r\n    }\r\n\r\n    $.asap((() => d.body), () => $.asap((() => $('hr')), Banner.ready));\r\n\r\n    // Let 4chan's JS load the banner if enabled; otherwise, load it ourselves.\r\n    if (g.BOARD.ID !== 'f') {\r\n      return Main.ready(() => $.queueTask(Banner.load));\r\n    }\r\n  },\r\n\r\n  ready() {\r\n    const banner = $(\".boardBanner\");\r\n    const {children} = banner;\r\n\r\n    if ((g.VIEW === 'thread') && Conf['Remove Thread Excerpt']) {\r\n      Banner.setTitle(children[1].textContent);\r\n    }\r\n\r\n    children[0].title = \"Click to change\";\r\n    $.on(children[0], 'click', Banner.cb.toggle);\r\n\r\n    if (Conf['Custom Board Titles']) {\r\n      Banner.custom(children[1]);\r\n      if (children[2]) { return Banner.custom(children[2]); }\r\n    }\r\n  },\r\n\r\n  load() {\r\n    const bannerCnt = $.id('bannerCnt');\r\n    if (!bannerCnt.firstChild) {\r\n      const img = $.el('img', {\r\n        alt: '4chan',\r\n        src: '//s.4cdn.org/image/title/' + bannerCnt.dataset.src\r\n      }\r\n      );\r\n      return $.add(bannerCnt, img);\r\n    }\r\n  },\r\n\r\n  setTitle(title) {\r\n    if (Unread.title != null) {\r\n      Unread.title = title;\r\n      return Unread.update();\r\n    } else {\r\n      return d.title = title;\r\n    }\r\n  },\r\n\r\n  cb: {\r\n    toggle() {\r\n      if (!Banner.choices?.length) {\r\n        Banner.choices = Conf['knownBanners'].split(',').slice();\r\n      }\r\n      const i = Math.floor(Banner.choices.length * Math.random());\r\n      const banner = Banner.choices.splice(i, 1);\r\n      return $('img', this.parentNode).src = `//s.4cdn.org/image/title/${banner}`;\r\n    },\r\n\r\n    click(e) {\r\n      if (!e.ctrlKey && !e.metaKey) { return; }\r\n      if (Banner.original[this.className] == null) { Banner.original[this.className] = this.cloneNode(true); }\r\n      this.contentEditable = true;\r\n      for (var br of $$('br', this)) { $.replace(br, $.tn('\\n')); }\r\n      return this.focus();\r\n    },\r\n\r\n    keydown(e) {\r\n      e.stopPropagation();\r\n      if (!e.shiftKey && (e.keyCode === 13)) { return this.blur(); }\r\n    },\r\n\r\n    blur() {\r\n      for (var br of $$('br', this)) { $.replace(br, $.tn('\\n')); }\r\n      if (this.textContent = this.textContent.replace(/\\n*$/, '')) {\r\n        this.contentEditable = false;\r\n        return Banner.db.set({\r\n          boardID:  g.BOARD.ID,\r\n          threadID: this.className,\r\n          val: {\r\n            title: this.textContent,\r\n            orig:  Banner.original[this.className].textContent\r\n          }\r\n        });\r\n      } else {\r\n        $.rmAll(this);\r\n        $.add(this, [...Banner.original[this.className].cloneNode(true).childNodes]);\r\n        return Banner.db.delete({\r\n          boardID:  g.BOARD.ID,\r\n          threadID: this.className\r\n        });\r\n      }\r\n    }\r\n  },\r\n\r\n  original: dict(),\r\n\r\n  custom(child) {\r\n    let data;\r\n    const {className} = child;\r\n    child.title = `Ctrl/\\u2318+click to edit board ${className.slice(5).toLowerCase()}`;\r\n    child.spellcheck = false;\r\n\r\n    for (var event of ['click', 'keydown', 'blur']) {\r\n      $.on(child, event, Banner.cb[event]);\r\n    }\r\n\r\n    if (data = Banner.db.get({boardID: g.BOARD.ID, threadID: className})) {\r\n      if (Conf['Persistent Custom Board Titles'] || (data.orig === child.textContent)) {\r\n        Banner.original[className] = child.cloneNode(true);\r\n        return child.textContent = data.title;\r\n      } else {\r\n        return Banner.db.delete({boardID: g.BOARD.ID, threadID: className});\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default Banner;\r\n","import { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Flash = {\r\n  init() {\r\n    if ((g.BOARD.ID === 'f') && Conf['Enable Native Flash Embedding']) {\r\n      return $.ready(Flash.initReady);\r\n    }\r\n  },\r\n\r\n  initReady() {\r\n    if ($.hasStorage) {\r\n      return $.global(function() { if (JSON.parse(localStorage['4chan-settings'] || '{}').disableAll) { return window.SWFEmbed.init(); } });\r\n    } else {\r\n      if (g.VIEW === 'thread') {\r\n        $.global(() => window.Main.tid = location.pathname.split(/\\/+/)[3]);\r\n      }\r\n      return $.global(() => window.SWFEmbed.init());\r\n    }\r\n  }\r\n};\r\nexport default Flash;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport BoardConfig from \"../General/BoardConfig\";\r\nimport { d, doc, g } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport ExpandComment from \"./ExpandComment\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Fourchan = {\r\n  init() {\r\n    if ((g.SITE.software !== 'yotsuba') || !['index', 'thread', 'archive'].includes(g.VIEW)) { return; }\r\n    BoardConfig.ready(this.initBoard);\r\n    return Main.ready(this.initReady);\r\n  },\r\n\r\n  initBoard() {\r\n    if (g.BOARD.config.code_tags) {\r\n      $.on(window, 'prettyprint:cb', function(e) {\r\n        let post, pre;\r\n        if (!(post = g.posts.get(e.detail.ID))) { return; }\r\n        if (!(pre  = $$('.prettyprint', post.nodes.comment)[+e.detail.i])) { return; }\r\n        if (!$.hasClass(pre, 'prettyprinted')) {\r\n          pre.innerHTML = e.detail.html;\r\n          return $.addClass(pre, 'prettyprinted');\r\n        }\r\n      });\r\n      $.global(() => window.addEventListener('prettyprint', e => window.dispatchEvent(new CustomEvent('prettyprint:cb', {\r\n        detail: {\r\n          ID:   e.detail.ID,\r\n          i:    e.detail.i,\r\n          html: window.prettyPrintOne(e.detail.html)\r\n        }\r\n      }))\r\n      , false));\r\n      Callbacks.Post.push({\r\n        name: 'Parse [code] tags',\r\n        cb:   Fourchan.code\r\n      });\r\n      g.posts.forEach(function(post) {\r\n        if (post.callbacksExecuted) {\r\n          return Callbacks.Post.execute(post, ['Parse [code] tags'], true);\r\n        }\r\n      });\r\n      ExpandComment.callbacks.push(Fourchan.code);\r\n    }\r\n\r\n    if (g.BOARD.config.math_tags) {\r\n      $.global(() => window.addEventListener('mathjax', function(e) {\r\n        if (window.MathJax) {\r\n          return window.MathJax.Hub.Queue(['Typeset', window.MathJax.Hub, e.target]);\r\n        } else {\r\n          if (!document.querySelector('script[src^=\"//cdn.mathjax.org/\"]')) { // don't load MathJax if already loading\r\n            window.loadMathJax();\r\n            window.loadMathJax = function() {};\r\n          }\r\n          // 4chan only handles post comments on MathJax load; anything else (e.g. the QR preview) must be queued explicitly.\r\n          if (!e.target.classList.contains('postMessage')) {\r\n            return document.querySelector('script[src^=\"//cdn.mathjax.org/\"]').addEventListener('load', () => window.MathJax.Hub.Queue(['Typeset', window.MathJax.Hub, e.target])\r\n            , false);\r\n          }\r\n        }\r\n      }\r\n      , false));\r\n      Callbacks.Post.push({\r\n        name: 'Parse [math] tags',\r\n        cb:   Fourchan.math\r\n      });\r\n      g.posts.forEach(function(post) {\r\n        if (post.callbacksExecuted) {\r\n          return Callbacks.Post.execute(post, ['Parse [math] tags'], true);\r\n        }\r\n      });\r\n      return ExpandComment.callbacks.push(Fourchan.math);\r\n    }\r\n  },\r\n\r\n  // Disable 4chan's ID highlighting (replaced by IDHighlight) and reported post hiding.\r\n  initReady() {\r\n    return $.global(function() {\r\n      window.clickable_ids = false;\r\n      for (var node of document.querySelectorAll('.posteruid, .capcode')) {\r\n        node.removeEventListener('click', window.idClick, false);\r\n      }\r\n    });\r\n  },\r\n\r\n  code() {\r\n    if (this.isClone) { return; }\r\n    return $.ready(() => {\r\n      const iterable = $$('.prettyprint', this.nodes.comment);\r\n      for (let i = 0; i < iterable.length; i++) {\r\n        var pre = iterable[i];\r\n        if (!$.hasClass(pre, 'prettyprinted')) {\r\n          $.event('prettyprint', {ID: this.fullID, i, html: pre.innerHTML}, window);\r\n        }\r\n      }\r\n    });\r\n  },\r\n\r\n  math() {\r\n    let wbrs;\r\n    if (!/\\[(math|eqn)\\]/.test(this.nodes.comment.textContent)) { return; }\r\n    // XXX <wbr> tags frequently break MathJax; remove them.\r\n    if ((wbrs = $$('wbr', this.nodes.comment)).length) {\r\n      for (var wbr of wbrs) { $.rm(wbr); }\r\n      this.nodes.comment.normalize();\r\n    }\r\n    var cb = () => {\r\n      if (!doc.contains(this.nodes.comment)) { return; }\r\n      $.off(d, 'PostsInserted', cb);\r\n      return $.event('mathjax', null, this.nodes.comment);\r\n    };\r\n    $.on(d, 'PostsInserted', cb);\r\n    return cb();\r\n  }\r\n};\r\nexport default Fourchan;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar IDColor = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Color User IDs']) { return; }\r\n    this.ids = dict();\r\n    this.ids['Heaven'] = [0, 0, 0, '#fff'];\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Color User IDs',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    let span, uid;\r\n    if (this.isClone || !((uid = this.info.uniqueID) && (span = this.nodes.uniqueID))) { return; }\r\n\r\n    const rgb = IDColor.ids[uid] || IDColor.compute(uid);\r\n\r\n    // Style the damn node.\r\n    const {style} = span;\r\n    style.color = rgb[3];\r\n    style.backgroundColor = `rgb(${rgb[0]},${rgb[1]},${rgb[2]})`;\r\n    return $.addClass(span, 'painted');\r\n  },\r\n\r\n  compute(uid) {\r\n    // Convert chars to integers, bitshift and math to create a larger integer\r\n    // Create a nice string of binary\r\n    const hash = g.SITE.uidColor ? g.SITE.uidColor(uid) : parseInt(uid, 16);\r\n\r\n    // Convert binary string to numerical values with bitshift and '&' truncation.\r\n    const rgb = [\r\n      (hash >> 16) & 0xFF,\r\n      (hash >> 8)  & 0xFF,\r\n      hash & 0xFF\r\n    ];\r\n\r\n    // Weight color luminance values, assign a font color that should be readable. \r\n    rgb.push($.luma(rgb) > 125 ?\r\n      '#000'\r\n    :\r\n      '#fff'\r\n    );\r\n\r\n    // Cache.\r\n    return this.ids[uid] = rgb;\r\n  }\r\n};\r\nexport default IDColor;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar IDHighlight = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW)) { return; }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Highlight by User ID',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  uniqueID: null,\r\n\r\n  node() {\r\n    if (this.nodes.uniqueIDRoot) { $.on(this.nodes.uniqueIDRoot, 'click', IDHighlight.click(this)); }\r\n    if (this.nodes.capcode) { $.on(this.nodes.capcode,      'click', IDHighlight.click(this)); }\r\n    if (!this.isClone) { return IDHighlight.set(this); }\r\n  },\r\n\r\n  set(post) {\r\n    const match = (post.info.uniqueID || post.info.capcode) === IDHighlight.uniqueID;\r\n    return $[match ? 'addClass' : 'rmClass'](post.nodes.post, 'highlight');\r\n  },\r\n\r\n  click(post) { return function() {\r\n    const uniqueID = post.info.uniqueID || post.info.capcode;\r\n    IDHighlight.uniqueID = IDHighlight.uniqueID === uniqueID ? null : uniqueID;\r\n    return g.posts.forEach(IDHighlight.set);\r\n  }; }\r\n};\r\nexport default IDHighlight;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Get from \"../General/Get\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar IDPostCount = {\r\n  init() {\r\n    if ((g.VIEW !== 'thread') || !Conf['Count Posts by ID']) { return; }\r\n    Callbacks.Thread.push({\r\n      name: 'Count Posts by ID',\r\n      cb() { return IDPostCount.thread = this; }\r\n    });\r\n    return Callbacks.Post.push({\r\n      name: 'Count Posts by ID',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.nodes.uniqueID && (this.thread === IDPostCount.thread)) {\r\n      return $.on(this.nodes.uniqueID, 'mouseover', IDPostCount.count);\r\n    }\r\n  },\r\n\r\n  count() {\r\n    const {uniqueID} = Get.postFromNode(this).info;\r\n    let n = 0;\r\n    IDPostCount.thread.posts.forEach(function(post) {\r\n      if (post.info.uniqueID === uniqueID) { return n++; }\r\n    });\r\n    return this.title = `${n} post${n === 1 ? '' : 's'} by this ID`;\r\n  }\r\n};\r\nexport default IDPostCount;\r\n","import $ from \"../platform/$\";\r\nimport Callbacks from \"../classes/Callbacks\";\r\nimport { g } from \"../globals/globals\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ModContact = {\r\n  init() {\r\n    if ((g.SITE.software !== 'yotsuba') || !['index', 'thread'].includes(g.VIEW)) { return; }\r\n    return Callbacks.Post.push({\r\n      name: 'Mod Contact Links',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    let moved;\r\n    if (this.isClone || !$.hasOwn(ModContact.specific, this.info.capcode)) { return; }\r\n    const links = $.el('span', {className: 'contact-links brackets-wrap'});\r\n    $.extend(links, ModContact.template(this.info.capcode));\r\n    $.after(this.nodes.capcode, links);\r\n    if ((moved = this.info.comment.match(/This thread was moved to >>>\\/(\\w+)\\//)) && $.hasOwn(ModContact.moveNote, moved[1])) {\r\n      const moveNote = $.el('div', {className: 'move-note'});\r\n      $.extend(moveNote, ModContact.moveNote[moved[1]]);\r\n      return $.add(this.nodes.post, moveNote);\r\n    }\r\n  },\r\n\r\n  template(capcode) {\r\n    return {innerHTML: \"<a href=\\\"https://www.4chan.org/feedback\\\" target=\\\"_blank\\\">feedback</a>\" + (ModContact.specific[capcode]()).innerHTML};\r\n  },\r\n\r\n  specific: {\r\n    Mod() { return {innerHTML: \" <a href=\\\"https://www.4chan-x.net/4chan-irc.html\\\" target=\\\"_blank\\\">IRC</a>\"}; },\r\n    Manager() { return ModContact.specific.Mod(); },\r\n    Developer() { return {innerHTML: \" <a href=\\\"https://github.com/4chan\\\" target=\\\"_blank\\\">github</a>\"}; },\r\n    Admin() { return {innerHTML: \" <a href=\\\"https://twitter.com/hiroyuki_ni\\\" target=\\\"_blank\\\">twitter</a>\"}; }\r\n  },\r\n\r\n  moveNote: {\r\n    qa: {innerHTML: \"Moving a thread to /qa/ does not imply mods will read it. If you wish to contact mods, use <a href=\\\"https://www.4chan.org/feedback\\\" target=\\\"_blank\\\">feedback</a><span class=\\\"invisible\\\"> (https://www.4chan.org/feedback)</span> or <a href=\\\"https://www.4chan-x.net/4chan-irc.html\\\" target=\\\"_blank\\\">IRC</a><span class=\\\"invisible\\\"> (https://www.4chan-x.net/4chan-irc.html)</span>.\"}\r\n  }\r\n};\r\nexport default ModContact;\r\n","import { Conf, g } from \"../globals/globals\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst NormalizeURL = {\r\n  init() {\r\n    if (!Conf['Normalize URL']) { return; }\r\n\r\n    let pathname = location.pathname.split(/\\/+/);\r\n    if (g.SITE.software === 'yotsuba') {\r\n      switch (g.VIEW) {\r\n        case 'thread':\r\n          pathname[2] = 'thread';\r\n          pathname = pathname.slice(0, 4);\r\n          break;\r\n        case 'index':\r\n          pathname = pathname.slice(0, 3);\r\n          break;\r\n      }\r\n    }\r\n    pathname = pathname.join('/');\r\n    if (location.pathname !== pathname) {\r\n      return history.replaceState(history.state, '', `${location.protocol}//${location.host}${pathname}${location.hash}`);\r\n    }\r\n  }\r\n};\r\nexport default NormalizeURL;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { Conf, g, E } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar PostJumper = { \r\n  init() {\r\n    if (!Conf['Unique ID and Capcode Navigation'] || !['index', 'thread'].includes(g.VIEW)) { return; }\r\n\r\n    this.buttons = this.makeButtons();\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Post Jumper',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) {\r\n      for (var buttons of $$('.postJumper', this.nodes.info)) {\r\n        PostJumper.addListeners(buttons);\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (this.nodes.uniqueIDRoot) {\r\n      PostJumper.addButtons(this,'uniqueID');\r\n    }\r\n\r\n    if (this.nodes.capcode) {\r\n      return PostJumper.addButtons(this,'capcode');\r\n    }\r\n  },\r\n\r\n  addButtons(post,type) {\r\n    const value = post.info[type];\r\n    const buttons = PostJumper.buttons.cloneNode(true);\r\n    $.extend(buttons.dataset, {type, value});\r\n    $.after(post.nodes[type+(type === 'capcode' ? '' : 'Root')], buttons);\r\n    return PostJumper.addListeners(buttons);\r\n  },\r\n\r\n  addListeners(buttons) {\r\n    $.on(buttons.firstChild, 'click', PostJumper.buttonClick);\r\n    return $.on(buttons.lastChild, 'click', PostJumper.buttonClick);\r\n  },\r\n\r\n  buttonClick() {\r\n    let toJumper;\r\n    const dir = $.hasClass(this, 'prev') ? -1 : 1;\r\n    if (toJumper = PostJumper.find(this.parentNode, dir)) {\r\n      return PostJumper.scroll(this.parentNode, toJumper);\r\n    }\r\n  },\r\n\r\n  find(jumper, dir) {\r\n    const {type, value} = jumper.dataset;\r\n    const xpath = `span[contains(@class,\\\"postJumper\\\") and @data-value=\\\"${value}\\\" and @data-type=\\\"${type}\\\"]`;\r\n    const axis = dir < 0 ? 'preceding' : 'following';\r\n    let jumper2 = jumper;\r\n    while (jumper2 = $.x(`${axis}::${xpath}`, jumper2)) {\r\n      if (jumper2.getBoundingClientRect().height) { return jumper2; }\r\n    }\r\n    if (jumper2 = $.x(`(//${xpath})[${dir < 0 ? 'last()' : '1'}]`)) {\r\n      if (jumper2.getBoundingClientRect().height) { return jumper2; }\r\n    }\r\n    while ((jumper2 = $.x(`${axis}::${xpath}`, jumper2)) && (jumper2 !== jumper)) {\r\n      if (jumper2.getBoundingClientRect().height) { return jumper2; }\r\n    }\r\n    return null;\r\n  },\r\n\r\n  makeButtons() {\r\n    const charPrev = '\\u23EB';\r\n    const charNext = '\\u23EC';\r\n    const classPrev = 'prev';\r\n    const classNext = 'next';\r\n    const span = $.el('span',\r\n      {className: 'postJumper'});\r\n    $.extend(span, {innerHTML: \"<a href=\\\"javascript:;\\\" class=\\\"\" + E(classPrev) + \"\\\">\" + E(charPrev) + \"</a><a href=\\\"javascript:;\\\" class=\\\"\" + E(classNext) + \"\\\">\" + E(charNext) + \"</a>\"});\r\n    return span;\r\n  },\r\n\r\n  scroll(fromJumper, toJumper) {\r\n    const prevPos = fromJumper.getBoundingClientRect().top;\r\n    const destPos = toJumper.getBoundingClientRect().top;\r\n    return window.scrollBy(0, destPos-prevPos);\r\n  }\r\n};\r\nexport default PostJumper;\r\n","import Notice from \"../classes/Notice\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst PSA = {\r\n  init() {\r\n    let el;\r\n    if ((g.SITE.software === 'yotsuba') && (g.BOARD.ID === 'qa')) {\r\n      const announcement = {innerHTML: \"Stay in touch with your <a href=\\\"https://www.4chan-x.net/qa_friends.html\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\">/qa/ friends</a>!\"};\r\n      el = $.el('div', {className: 'fcx-announcement'}, announcement);\r\n      $.onExists(doc, '.boardBanner', banner => $.after(banner, el));\r\n    }\r\n    if ('samachan.org' in Conf['siteProperties'] && !Conf['PSAseen'].includes('samachan')) {\r\n      el = $.el('span',\r\n        {innerHTML: \"<a href=\\\"https://sushigirl.us/yakuza/res/776.html\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\">Looking for a new home?<br>Some former Samachan users are regrouping on SushiChan.</a><br>(a message from 4chan X)\"});\r\n      return Main.ready(function() {\r\n        new Notice('info', el);\r\n        Conf['PSAseen'].push('samachan');\r\n        return $.set('PSAseen', Conf['PSAseen']);});\r\n    }\r\n  }\r\n};\r\nexport default PSA;\r\n","import Header from \"../General/Header\";\r\nimport { Conf, doc, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar PSAHiding = {\r\n  init() {\r\n    if (!Conf['Announcement Hiding'] || !g.SITE.selectors.psa) { return; }\r\n    $.addClass(doc, 'hide-announcement');\r\n    $.onExists(doc, g.SITE.selectors.psa, this.setup);\r\n    return $.ready(function() {\r\n      if (!$(g.SITE.selectors.psa)) { return $.rmClass(doc, 'hide-announcement'); }\r\n    });\r\n  },\r\n\r\n  setup(psa) {\r\n    let btn, hr;\r\n    PSAHiding.psa = psa;\r\n    PSAHiding.text = psa.dataset.utc ?? psa.innerHTML;\r\n    if (g.SITE.selectors.psaTop && (hr = $(g.SITE.selectors.psaTop)?.previousElementSibling) && (hr.nodeName === 'HR')) {\r\n      PSAHiding.hr = hr;\r\n    }\r\n    PSAHiding.content = $.el('div');\r\n\r\n    const entry = {\r\n      el: $.el('a', {\r\n        textContent: 'Show announcement',\r\n        className: 'show-announcement',\r\n        href: 'javascript:;'\r\n      }\r\n      ),\r\n      order: 50,\r\n      open() { return psa.hidden; }\r\n    };\r\n    Header.menu.addEntry(entry);\r\n    $.on(entry.el, 'click', PSAHiding.toggle);\r\n\r\n    PSAHiding.btn = (btn = $.el('a', {\r\n      title:       'Mark announcement as read and hide.',\r\n      className:   'hide-announcement-button',\r\n      href:        'javascript:;',\r\n      textContent: '➖︎',\r\n    }\r\n    ));\r\n    $.on(btn, 'click', PSAHiding.toggle);\r\n    if (psa.firstChild?.tagName === 'HR') {\r\n      $.after(psa.firstChild, btn);\r\n    } else {\r\n      $.prepend(psa, btn);\r\n    }\r\n\r\n    PSAHiding.sync(Conf['hiddenPSAList']);\r\n    $.rmClass(doc, 'hide-announcement');\r\n\r\n    return $.sync('hiddenPSAList', PSAHiding.sync);\r\n  },\r\n\r\n  toggle() {\r\n    const hide = $.hasClass(this, 'hide-announcement-button');\r\n    const set = function(hiddenPSAList) {\r\n      if (hide) {\r\n        return hiddenPSAList[g.SITE.ID] = PSAHiding.text;\r\n      } else {\r\n        return delete hiddenPSAList[g.SITE.ID];\r\n      }\r\n    };\r\n    set(Conf['hiddenPSAList']);\r\n    PSAHiding.sync(Conf['hiddenPSAList']);\r\n    return $.get('hiddenPSAList', Conf['hiddenPSAList'], function({hiddenPSAList}) {\r\n      set(hiddenPSAList);\r\n      return $.set('hiddenPSAList', hiddenPSAList);\r\n    });\r\n  },\r\n\r\n  sync(hiddenPSAList) {\r\n    const {psa, content} = PSAHiding;\r\n    psa.hidden = (hiddenPSAList[g.SITE.ID] === PSAHiding.text);\r\n    // Remove content to prevent autoplaying sounds from hidden announcements\r\n    if (psa.hidden) {\r\n      $.add(content, [...psa.childNodes]);\r\n    } else {\r\n      $.add(psa, [...content.childNodes]);\r\n    }\r\n    if (PSAHiding.hr) PSAHiding.hr.hidden = psa.hidden;\r\n  }\r\n};\r\nexport default PSAHiding;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { Conf, doc, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar RemoveSpoilers = {\r\n  init() {\r\n    if (Conf['Reveal Spoilers']) {\r\n      $.addClass(doc, 'reveal-spoilers');\r\n    }\r\n\r\n    if (!Conf['Remove Spoilers']) { return; }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Reveal Spoilers',\r\n      cb:   this.node\r\n    });\r\n\r\n    if (g.VIEW === 'archive') {\r\n      return $.ready(() => RemoveSpoilers.unspoiler($.id('arc-list')));\r\n    }\r\n  },\r\n\r\n  node() {\r\n    return RemoveSpoilers.unspoiler(this.nodes.comment);\r\n  },\r\n\r\n  unspoiler(el) {\r\n    const spoilers = $$(g.SITE.selectors.spoiler, el);\r\n    for (var spoiler of spoilers) {\r\n      var span = $.el('span', {className: 'removed-spoiler'});\r\n      $.replace(spoiler, span);\r\n      $.add(span, [...spoiler.childNodes]);\r\n    }\r\n  }\r\n};\r\nexport default RemoveSpoilers;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g, Conf } from \"../globals/globals\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ThreadLinks = {\r\n  init() {\r\n    if ((g.VIEW !== 'index') || !Conf['Open Threads in New Tab']) { return; }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Thread Links',\r\n      cb:   this.node\r\n    });\r\n    return Callbacks.CatalogThread.push({\r\n      name: 'Thread Links',\r\n      cb:   this.catalogNode\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isReply || this.isClone) { return; }\r\n    return ThreadLinks.process(this.nodes.reply);\r\n  },\r\n\r\n  catalogNode() {\r\n    return ThreadLinks.process(this.nodes.thumb.parentNode);\r\n  },\r\n\r\n  process(link) {\r\n    return link.target = '_blank';\r\n  }\r\n};\r\nexport default ThreadLinks;\r\n","import { g } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst Tinyboard = {\r\n  init() {\r\n    if (g.SITE.software !== 'tinyboard') { return; }\r\n    if (g.VIEW === 'thread') {\r\n      return Main.ready(() => $.global(function() {\r\n        let base;\r\n        let {boardID, threadID} = document.currentScript.dataset;\r\n        threadID = +threadID;\r\n        const form = document.querySelector('form[name=\"post\"]');\r\n        window.$(document).ajaxComplete(function(event, request, settings) {\r\n          let postID;\r\n          if (settings.url !== form.action) { return; }\r\n          if (!(postID = +request.responseJSON?.id)) { return; }\r\n          const detail = {boardID, threadID, postID};\r\n          try {\r\n            const {redirect, noko} = request.responseJSON;\r\n            if (redirect && (originalNoko != null) && !originalNoko && !noko) {\r\n              detail.redirect = redirect;\r\n            }\r\n          } catch (error) {}\r\n          event = new CustomEvent('QRPostSuccessful', {bubbles: true, detail});\r\n          return document.dispatchEvent(event);\r\n        });\r\n        var originalNoko = window.tb_settings?.ajax?.always_noko_replies;\r\n        return (((base = window.tb_settings || (window.tb_settings = {}))).ajax || (base.ajax = {})).always_noko_replies = true;\r\n      }\r\n      , {boardID: g.BOARD.ID, threadID: g.THREADID}));\r\n    }\r\n  }\r\n};\r\nexport default Tinyboard;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g, Conf, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar MarkNewIPs = {\r\n  init() {\r\n    if ((g.SITE.software !== 'yotsuba') || (g.VIEW !== 'thread') || !Conf['Mark New IPs']) { return; }\r\n    return Callbacks.Thread.push({\r\n      name: 'Mark New IPs',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    MarkNewIPs.ipCount = this.ipCount;\r\n    MarkNewIPs.postCount = this.posts.keys.length;\r\n    return $.on(d, 'ThreadUpdate', MarkNewIPs.onUpdate);\r\n  },\r\n\r\n  onUpdate(e) {\r\n    let fullID;\r\n    const {ipCount, postCount, newPosts, deletedPosts} = e.detail;\r\n    if (ipCount == null) { return; }\r\n\r\n    switch (ipCount - MarkNewIPs.ipCount) {\r\n      case (postCount - MarkNewIPs.postCount) + deletedPosts.length:\r\n        var i = MarkNewIPs.ipCount;\r\n        for (fullID of newPosts) {\r\n          MarkNewIPs.markNew(g.posts.get(fullID), ++i);\r\n        }\r\n        break;\r\n      case -deletedPosts.length:\r\n        for (fullID of newPosts) {\r\n          MarkNewIPs.markOld(g.posts.get(fullID));\r\n        }\r\n        break;\r\n    }\r\n    MarkNewIPs.ipCount = ipCount;\r\n    return MarkNewIPs.postCount = postCount;\r\n  },\r\n\r\n  markNew(post, ipCount) {\r\n    const suffix = ((Math.floor(ipCount / 10)) % 10) === 1 ?\r\n      'th'\r\n    :\r\n      ['st', 'nd', 'rd'][(ipCount % 10) - 1] || 'th'; // fuck switches\r\n    const counter = $.el('span', {\r\n      className: 'ip-counter',\r\n      textContent: `(${ipCount})`\r\n    }\r\n    );\r\n    post.nodes.nameBlock.title = `This is the ${ipCount}${suffix} IP in the thread.`;\r\n    $.add(post.nodes.nameBlock, [$.tn(' '), counter]);\r\n    return $.addClass(post.nodes.root, 'new-ip');\r\n  },\r\n\r\n  markOld(post) {\r\n    post.nodes.nameBlock.title = 'Not the first post from this IP.';\r\n    return $.addClass(post.nodes.root, 'old-ip');\r\n  }\r\n};\r\nexport default MarkNewIPs;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Header from \"../General/Header\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf, E, doc, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { MINUTE, SECOND } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ThreadStats = {\r\n  postCount: 0,\r\n  fileCount: 0,\r\n  postIndex: 0,\r\n\r\n  init() {\r\n    let sc;\r\n    if ((g.VIEW !== 'thread') || !Conf['Thread Stats']) { return; }\r\n\r\n    if (Conf['Page Count in Stats']) {\r\n      this[g.SITE.isPrunedByAge?.(g.BOARD) ? 'showPurgePos' : 'showPage'] = true;\r\n    }\r\n\r\n    const statsHTML = {innerHTML: \"<span id=\\\"post-count\\\">?</span> / <span id=\\\"file-count\\\">?</span>\" + ((Conf[\"IP Count in Stats\"] && g.SITE.hasIPCount) ? \" / <span id=\\\"ip-count\\\">?</span>\" : \"\") + ((Conf[\"Page Count in Stats\"]) ? \" / <span id=\\\"page-count\\\">?</span>\" : \"\")};\r\n    let statsTitle = 'Posts / Files';\r\n    if (Conf['IP Count in Stats'] && g.SITE.hasIPCount) { statsTitle += ' / IPs'; }\r\n    if (Conf['Page Count in Stats']) { statsTitle += (this.showPurgePos ? ' / Purge Position' : ' / Page'); }\r\n\r\n    if (Conf['Updater and Stats in Header']) {\r\n      this.dialog = (sc = $.el('span', {\r\n        id:    'thread-stats',\r\n        title: statsTitle\r\n      }\r\n      ));\r\n      $.extend(sc, statsHTML);\r\n      Header.addShortcut('stats', sc, 200);\r\n\r\n    } else {\r\n      this.dialog = (sc = UI.dialog('thread-stats',\r\n        {innerHTML: \"<div class=\\\"move\\\" title=\\\"\" + E(statsTitle) + \"\\\">\" + (statsHTML).innerHTML + \"</div>\"}));\r\n      $.addClass(doc, 'float');\r\n      $.ready(() => $.add(d.body, sc));\r\n    }\r\n\r\n    this.postCountEl = $('#post-count', sc);\r\n    this.fileCountEl = $('#file-count', sc);\r\n    this.ipCountEl   = $('#ip-count',   sc);\r\n    this.pageCountEl = $('#page-count', sc);\r\n\r\n    if (this.pageCountEl) { $.on(this.pageCountEl, 'click', ThreadStats.fetchPage); }\r\n\r\n    return Callbacks.Thread.push({\r\n      name: 'Thread Stats',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    ThreadStats.thread = this;\r\n    ThreadStats.count();\r\n    ThreadStats.update();\r\n    ThreadStats.fetchPage();\r\n    $.on(d, 'PostsInserted', () => $.queueTask(ThreadStats.onPostsInserted));\r\n    return $.on(d, 'ThreadUpdate', ThreadStats.onUpdate);\r\n  },\r\n\r\n  count() {\r\n    const {posts} = ThreadStats.thread;\r\n    const n = posts.keys.length;\r\n    for (let i = ThreadStats.postIndex, end = n; i < end; i++) {\r\n      var post = posts.get(posts.keys[i]);\r\n      if (!post.isFetchedQuote) {\r\n        ThreadStats.postCount++;\r\n        ThreadStats.fileCount += post.files.length;\r\n      }\r\n    }\r\n    return ThreadStats.postIndex = n;\r\n  },\r\n\r\n  onUpdate(e) {\r\n    if (e.detail[404]) { return; }\r\n    const {postCount, fileCount} = e.detail;\r\n    $.extend(ThreadStats, {postCount, fileCount});\r\n    ThreadStats.postIndex = ThreadStats.thread.posts.keys.length;\r\n    ThreadStats.update();\r\n    if (ThreadStats.showPage && (ThreadStats.pageCountEl.textContent !== '1')) {\r\n      return ThreadStats.fetchPage();\r\n    }\r\n  },\r\n\r\n  onPostsInserted() {\r\n    if (ThreadStats.thread.posts.keys.length <= ThreadStats.postIndex) { return; }\r\n    ThreadStats.count();\r\n    ThreadStats.update();\r\n    if (ThreadStats.showPage && (ThreadStats.pageCountEl.textContent !== '1')) {\r\n      return ThreadStats.fetchPage();\r\n    }\r\n  },\r\n\r\n  update() {\r\n    const {thread, postCountEl, fileCountEl, ipCountEl} = ThreadStats;\r\n    postCountEl.textContent = ThreadStats.postCount;\r\n    fileCountEl.textContent = ThreadStats.fileCount;\r\n    // TOTO check if ipCountEl exists\r\n    ipCountEl.textContent  = thread.ipCount ?? '?';\r\n    postCountEl.classList.toggle('warning', (thread.postLimit && !thread.isSticky));\r\n    return fileCountEl.classList.toggle('warning', (thread.fileLimit && !thread.isSticky));\r\n  },\r\n\r\n  fetchPage() {\r\n    if (!ThreadStats.pageCountEl) { return; }\r\n    clearTimeout(ThreadStats.timeout);\r\n    if (ThreadStats.thread.isDead) {\r\n      ThreadStats.pageCountEl.textContent = 'Dead';\r\n      $.addClass(ThreadStats.pageCountEl, 'warning');\r\n      return;\r\n    }\r\n    ThreadStats.timeout = setTimeout(ThreadStats.fetchPage, 2 * MINUTE);\r\n    return $.whenModified(\r\n      g.SITE.urls.threadsListJSON(ThreadStats.thread),\r\n      'ThreadStats',\r\n      ThreadStats.onThreadsLoad\r\n    );\r\n  },\r\n\r\n  onThreadsLoad() {\r\n    if (this.status === 200) {\r\n      let page, thread;\r\n      if (ThreadStats.showPurgePos) {\r\n        let purgePos = 1;\r\n        for (page of this.response) {\r\n          for (thread of page.threads) {\r\n            if (thread.no < ThreadStats.thread.ID) {\r\n              purgePos++;\r\n            }\r\n          }\r\n        }\r\n        ThreadStats.pageCountEl.textContent = purgePos;\r\n        return ThreadStats.pageCountEl.classList.toggle('warning', (purgePos === 1));\r\n      } else {\r\n        let nThreads;\r\n        let i = (nThreads = 0);\r\n        for (page of this.response) {\r\n          nThreads += page.threads.length;\r\n        }\r\n        for (let pageNum = 0; pageNum < this.response.length; pageNum++) {\r\n          page = this.response[pageNum];\r\n          for (thread of page.threads) {\r\n            if (thread.no === ThreadStats.thread.ID) {\r\n              ThreadStats.pageCountEl.textContent = pageNum + 1;\r\n              ThreadStats.pageCountEl.classList.toggle('warning', (i >= (nThreads - this.response[0].threads.length)));\r\n              ThreadStats.lastPageUpdate = new Date(thread.last_modified * SECOND);\r\n              ThreadStats.retry();\r\n              return;\r\n            }\r\n            i++;\r\n          }\r\n        }\r\n      }\r\n    } else if (this.status === 304) {\r\n      return ThreadStats.retry();\r\n    }\r\n  },\r\n\r\n  retry() {\r\n    // If thread data is stale (modification date given < time of last post), try again.\r\n    // Skip this on vichan sites due to sage posts not updating modification time in threads.json.\r\n    if (\r\n      !ThreadStats.showPage ||\r\n      (ThreadStats.pageCountEl.textContent === '1') ||\r\n      !!g.SITE.threadModTimeIgnoresSage ||\r\n      (ThreadStats.thread.posts.get(ThreadStats.thread.lastPost).info.date <= ThreadStats.lastPageUpdate)\r\n    ) { return; }\r\n    clearTimeout(ThreadStats.timeout);\r\n    return ThreadStats.timeout = setTimeout(ThreadStats.fetchPage, 5 * SECOND);\r\n  }\r\n};\r\nexport default ThreadStats;\r\n","import { g, Conf } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst PassLink = {\r\n  init() {\r\n    if ((g.SITE.software !== 'yotsuba') || !Conf['Pass Link']) { return; }\r\n    return Main.ready(this.ready);\r\n  },\r\n\r\n  ready() {\r\n    let styleSelector;\r\n    if (!(styleSelector = $.id('styleSelector'))) { return; }\r\n\r\n    const passLink = $.el('span',\r\n      {className: 'brackets-wrap pass-link-container'});\r\n    $.extend(passLink, {innerHTML: \"<a href=\\\"javascript:;\\\">4chan Pass</a>\"});\r\n    $.on(passLink.firstElementChild, 'click', () => window.open(`//sys.${location.hostname.split('.')[1]}.org/auth`,\r\n      Date.now(),\r\n      'width=500,height=280,toolbar=0'));\r\n    return $.before(styleSelector.previousSibling, [passLink, $.tn('\\u00A0\\u00A0')]);\r\n  }\r\n};\r\nexport default PassLink;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Fetcher from \"../classes/Fetcher\";\r\nimport Get from \"../General/Get\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport Unread from \"../Monitoring/Unread\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar QuoteInline = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Quote Inlining']) { return; }\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Quote Inlining',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    const {process} = QuoteInline;\r\n    const {isClone} = this;\r\n    for (var link of this.nodes.quotelinks.concat([...this.nodes.backlinks], this.nodes.archivelinks)) {\r\n      process(link, isClone);\r\n    }\r\n  },\r\n\r\n  process(link, clone) {\r\n    if (Conf['Quote Hash Navigation']) {\r\n      if (!clone) { $.after(link, QuoteInline.qiQuote(link, $.hasClass(link, 'filtered'))); }\r\n    }\r\n    return $.on(link, 'click', QuoteInline.toggle);\r\n  },\r\n\r\n  qiQuote(link, hidden) {\r\n    let name = \"hashlink\";\r\n    if (hidden) { name += \" filtered\"; }\r\n    return $.el('a', {\r\n      className: name,\r\n      textContent: '#',\r\n      href: link.href\r\n    }\r\n    );\r\n  },\r\n\r\n  toggle(e) {\r\n    if ($.modifiedClick(e)) { return; }\r\n\r\n    const {boardID, threadID, postID} = Get.postDataFromLink(this);\r\n    if (Conf['Inline Cross-thread Quotes Only'] && (g.VIEW === 'thread') && g.posts.get(`${boardID}.${postID}`)?.nodes.root.offsetParent) { return; } // exists and not hidden\r\n    if ($.hasClass(doc, 'catalog-mode')) { return; }\r\n\r\n    e.preventDefault();\r\n    const quoter = Get.postFromNode(this);\r\n    const {context} = quoter;\r\n    if ($.hasClass(this, 'inlined')) {\r\n      QuoteInline.rm(this, boardID, threadID, postID, context);\r\n    } else {\r\n      if ($.x(`ancestor::div[@data-full-i-d='${boardID}.${postID}']`, this)) { return; }\r\n      QuoteInline.add(this, boardID, threadID, postID, context, quoter);\r\n    }\r\n    return this.classList.toggle('inlined');\r\n  },\r\n\r\n  findRoot(quotelink, isBacklink) {\r\n    if (isBacklink) {\r\n      return $.x('ancestor::*[parent::*[contains(@class,\"post\")]][1]', quotelink);\r\n    } else {\r\n      return $.x('ancestor-or-self::*[parent::blockquote][1]', quotelink);\r\n    }\r\n  },\r\n\r\n  add(quotelink, boardID, threadID, postID, context, quoter) {\r\n    let post;\r\n    const isBacklink = $.hasClass(quotelink, 'backlink');\r\n    const inline = $.el('div',\r\n      {className: 'inline'});\r\n    inline.dataset.fullID = `${boardID}.${postID}`;\r\n    const root = QuoteInline.findRoot(quotelink, isBacklink);\r\n    $.after(root, inline);\r\n\r\n    const qroot = $.x('ancestor::*[contains(@class,\"postContainer\")][1]', root);\r\n\r\n    $.addClass(qroot, 'hasInline');\r\n    new Fetcher(boardID, threadID, postID, inline, quoter);\r\n\r\n    if (!(\r\n      (post = g.posts.get(`${boardID}.${postID}`)) &&\r\n      (context.thread === post.thread)\r\n    )) { return; }\r\n\r\n    // Hide forward post if it's a backlink of a post in this thread.\r\n    // Will only unhide if there's no inlined backlinks of it anymore.\r\n    if (isBacklink && Conf['Forward Hiding']) {\r\n      $.addClass(post.nodes.root, 'forwarded');\r\n      post.forwarded++ || (post.forwarded = 1);\r\n    }\r\n\r\n    // Decrease the unread count if this post\r\n    // is in the array of unread posts.\r\n    if (!Unread.posts) { return; }\r\n    return Unread.readSinglePost(post);\r\n  },\r\n\r\n  rm(quotelink, boardID, threadID, postID, context) {\r\n    let el;\r\n    let inlined;\r\n    const isBacklink = $.hasClass(quotelink, 'backlink');\r\n    // Select the corresponding inlined quote, and remove it.\r\n    let root = QuoteInline.findRoot(quotelink, isBacklink);\r\n    root = $.x(`following-sibling::div[@data-full-i-d='${boardID}.${postID}'][1]`, root);\r\n    const qroot = $.x('ancestor::*[contains(@class,\"postContainer\")][1]', root);\r\n    const {parentNode} = root;\r\n    $.rm(root);\r\n    $.event('PostsRemoved', null, parentNode);\r\n\r\n    if (!$('.inline', qroot)) {\r\n      $.rmClass(qroot, 'hasInline');\r\n    }\r\n\r\n    // Stop if it only contains text.\r\n    if (!(el = root.firstElementChild)) { return; }\r\n\r\n    // Dereference clone.\r\n    const post = g.posts.get(`${boardID}.${postID}`);\r\n    post.rmClone(el.dataset.clone);\r\n\r\n    // Decrease forward count and unhide.\r\n    if (Conf['Forward Hiding'] &&\r\n      isBacklink &&\r\n      (context.thread === g.threads.get(`${boardID}.${threadID}`)) &&\r\n      !--post.forwarded) {\r\n        delete post.forwarded;\r\n        $.rmClass(post.nodes.root, 'forwarded');\r\n      }\r\n\r\n    // Repeat.\r\n    while ((inlined = $('.inlined', el))) {\r\n      ({boardID, threadID, postID} = Get.postDataFromLink(inlined));\r\n      QuoteInline.rm(inlined, boardID, threadID, postID, context);\r\n      $.rmClass(inlined, 'inlined');\r\n    }\r\n  }\r\n};\r\nexport default QuoteInline;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\nimport QuoteInline from \"./QuoteInline\";\r\nimport QuotePreview from \"./QuotePreview\";\r\nimport QuoteYou from \"./QuoteYou\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar QuoteBacklink = {\r\n  // Backlinks appending need to work for:\r\n  //  - previous, same, and following posts.\r\n  //  - existing and yet-to-exist posts.\r\n  //  - newly fetched posts.\r\n  //  - in copies.\r\n  // XXX what about order for fetched posts?\r\n  //\r\n  // First callback creates backlinks and add them to relevant containers.\r\n  // Second callback adds relevant containers into posts.\r\n  // This is is so that fetched posts can get their backlinks,\r\n  // and that as much backlinks are appended in the background as possible.\r\n  containers: dict(),\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Quote Backlinks']) { return; }\r\n\r\n    // Add a class to differentiate when backlinks are at\r\n    // the top (default) or bottom of a post\r\n    if (this.bottomBacklinks = Conf['Bottom Backlinks']) {\r\n      $.addClass(doc, 'bottom-backlinks');\r\n    }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Quote Backlinking Part 1',\r\n      cb:   this.firstNode\r\n    });\r\n    return Callbacks.Post.push({\r\n      name: 'Quote Backlinking Part 2',\r\n      cb:   this.secondNode\r\n    });\r\n  },\r\n  firstNode() {\r\n    if (this.isClone || !this.quotes.length || this.isRebuilt) { return; }\r\n    const markYours = Conf['Mark Quotes of You'] && QuoteYou.isYou(this);\r\n    const a = $.el('a', {\r\n      href: g.SITE.Build.postURL(this.board.ID, this.thread.ID, this.ID),\r\n      className: this.isHidden ? 'filtered backlink' : 'backlink',\r\n      textContent: Conf['backlink'].replace(/%(?:id|%)/g, x => ({'%id': this.ID, '%%': '%'})[x])\r\n    }\r\n    );\r\n    if (markYours) { $.add(a, QuoteYou.mark.cloneNode(true)); }\r\n    for (var quote of this.quotes) {\r\n      var post;\r\n      var containers = [QuoteBacklink.getContainer(quote)];\r\n      if ((post = g.posts.get(quote)) && post.nodes.backlinkContainer) {\r\n        // Don't add OP clones when OP Backlinks is disabled,\r\n        // as the clones won't have the backlink containers.\r\n        for (var clone of post.clones) {\r\n          containers.push(clone.nodes.backlinkContainer);\r\n        }\r\n      }\r\n      for (var container of containers) {\r\n        var link = a.cloneNode(true);\r\n        var nodes = container.firstChild ? [$.tn(' '), link] : [link];\r\n        if (Conf['Quote Previewing']) {\r\n          $.on(link, 'mouseover', QuotePreview.mouseover);\r\n        }\r\n        if (Conf['Quote Inlining']) {\r\n          $.on(link, 'click', QuoteInline.toggle);\r\n          if (Conf['Quote Hash Navigation']) {\r\n            var hash = QuoteInline.qiQuote(link, $.hasClass(link, 'filtered'));\r\n            nodes.push(hash);\r\n          }\r\n        }\r\n        $.add(container, nodes);\r\n      }\r\n    }\r\n  },\r\n  secondNode() {\r\n    if (this.isClone && (this.origin.isReply || Conf['OP Backlinks'])) {\r\n      this.nodes.backlinkContainer = $('.container', this.nodes.post);\r\n      return;\r\n    }\r\n    // Don't backlink the OP.\r\n    if (!this.isReply && !Conf['OP Backlinks']) { return; }\r\n    const container = QuoteBacklink.getContainer(this.fullID);\r\n    this.nodes.backlinkContainer = container;\r\n    if (QuoteBacklink.bottomBacklinks) {\r\n      return $.add(this.nodes.post, container);\r\n    } else {\r\n      return $.add(this.nodes.info, container);\r\n    }\r\n  },\r\n  getContainer(id) {\r\n    return this.containers[id] ||\r\n      (this.containers[id] = $.el('span', {className: 'container'}));\r\n  }\r\n};\r\nexport default QuoteBacklink;\r\n","import $ from \"../platform/$\";\r\nimport Callbacks from \"../classes/Callbacks\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport Get from \"../General/Get\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar QuoteCT = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Mark Cross-thread Quotes']) { return; }\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    // \\u00A0 is nbsp\r\n    this.mark = $.el('span', {\r\n      textContent: '\\u00A0(Cross-thread)',\r\n      className:   'qmark-ct'\r\n    }\r\n    );\r\n    return Callbacks.Post.push({\r\n      name: 'Mark Cross-thread Quotes',\r\n      cb:   this.node\r\n    });\r\n  },\r\n  node() {\r\n    // Stop there if it's a clone of a post in the same thread.\r\n    if (this.isClone && (this.thread === this.context.thread)) { return; }\r\n\r\n    const {board, thread} = this.context;\r\n    for (var quotelink of this.nodes.quotelinks) {\r\n      var {boardID, threadID} = Get.postDataFromLink(quotelink);\r\n      if (!threadID) { continue; } // deadlink\r\n      if (this.isClone) {\r\n        $.rm($('.qmark-ct', quotelink));\r\n      }\r\n      if ((boardID === board.ID) && (threadID !== thread.ID)) {\r\n        $.add(quotelink, QuoteCT.mark.cloneNode(true));\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default QuoteCT;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Get from \"../General/Get\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar QuoteOP = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Mark OP Quotes']) { return; }\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    // \\u00A0 is nbsp\r\n    this.mark = $.el('span', {\r\n      textContent: '\\u00A0(OP)',\r\n      className:   'qmark-op'\r\n    }\r\n    );\r\n    return Callbacks.Post.push({\r\n      name: 'Mark OP Quotes',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    // Stop there if it's a clone of a post in the same thread.\r\n    let i, quotelink, quotes;\r\n    if (this.isClone && (this.thread === this.context.thread)) { return; }\r\n    // Stop there if there's no quotes in that post.\r\n    if (!(quotes = this.quotes).length) { return; }\r\n    const {quotelinks} = this.nodes;\r\n\r\n    // rm (OP) from cross-thread quotes.\r\n    if (this.isClone && quotes.includes(this.thread.fullID)) {\r\n      i = 0;\r\n      while ((quotelink = quotelinks[i++])) {\r\n        $.rm($('.qmark-op', quotelink));\r\n      }\r\n    }\r\n\r\n    const {fullID} = this.context.thread;\r\n    // add (OP) to quotes quoting this context's OP.\r\n\r\n    if (!quotes.includes(fullID)) { return; }\r\n    i = 0;\r\n    while ((quotelink = quotelinks[i++])) {\r\n      var {boardID, postID} = Get.postDataFromLink(quotelink);\r\n      if (`${boardID}.${postID}` === fullID) {\r\n        $.add(quotelink, QuoteOP.mark.cloneNode(true));\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default QuoteOP;\r\n","import Redirect from \"../Archive/Redirect\";\r\nimport Callbacks from \"../classes/Callbacks\";\r\nimport Post from \"../classes/Post\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Quotify = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Resurrect Quotes']) { return; }\r\n\r\n    $.addClass(doc, 'resurrect-quotes');\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Resurrect Quotes',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) {\r\n      this.nodes.archivelinks = $$('a.linkify.quotelink', this.nodes.comment);\r\n      return;\r\n    }\r\n    for (var link of $$('a.linkify', this.nodes.comment)) {\r\n      Quotify.parseArchivelink.call(this, link);\r\n    }\r\n    for (var deadlink of $$('.deadlink', this.nodes.comment)) {\r\n      Quotify.parseDeadlink.call(this, deadlink);\r\n    }\r\n  },\r\n\r\n  parseArchivelink(link) {\r\n    let m;\r\n    if (!(m = link.pathname.match(/^\\/([^/]+)\\/thread\\/S?(\\d+)\\/?$/))) { return; }\r\n    if (['boards.4chan.org', 'boards.4channel.org'].includes(link.hostname)) { return; }\r\n    const boardID  = m[1];\r\n    const threadID = m[2];\r\n    const postID   = link.hash.match(/^#[pq]?(\\d+)$|$/)[1] || threadID;\r\n    if (Redirect.to('post', {boardID, postID})) {\r\n      $.addClass(link, 'quotelink');\r\n      $.extend(link.dataset, {boardID, threadID, postID});\r\n      return this.nodes.archivelinks.push(link);\r\n    }\r\n  },\r\n\r\n  parseDeadlink(deadlink) {\r\n    let a, m, post, postID;\r\n    if ($.hasClass(deadlink.parentNode, 'prettyprint')) {\r\n      // Don't quotify deadlinks inside code tags,\r\n      // un-`span` them.\r\n      // This won't be necessary once 4chan\r\n      // stops quotifying inside code tags:\r\n      // https://github.com/4chan/4chan-JS/issues/77\r\n      Quotify.fixDeadlink(deadlink);\r\n      return;\r\n    }\r\n\r\n    const quote = deadlink.textContent;\r\n    if (!(postID = quote.match(/\\d+$/)?.[0])) { return; }\r\n    if (postID[0] === '0') {\r\n      // Fix quotelinks that start with a `0`.\r\n      Quotify.fixDeadlink(deadlink);\r\n      return;\r\n    }\r\n    const boardID = (m = quote.match(/^>>>\\/([a-z\\d]+)/)) ?\r\n      m[1]\r\n    :\r\n      this.board.ID;\r\n    const quoteID = `${boardID}.${postID}`;\r\n\r\n    if (post = g.posts.get(quoteID)) {\r\n      if (!post.isDead) {\r\n        // Don't (Dead) when quotifying in an archived post,\r\n        // and we know the post still exists.\r\n        a = $.el('a', {\r\n          href:        g.SITE.Build.postURL(boardID, post.thread.ID, postID),\r\n          className:   'quotelink',\r\n          textContent: quote\r\n        }\r\n        );\r\n      } else {\r\n        // Replace the .deadlink span if we can redirect.\r\n        a = $.el('a', {\r\n          href:        g.SITE.Build.postURL(boardID, post.thread.ID, postID),\r\n          className:   'quotelink deadlink',\r\n          textContent: quote\r\n        }\r\n        );\r\n        $.add(a, Post.deadMark.cloneNode(true));\r\n        $.extend(a.dataset, {boardID, threadID: post.thread.ID, postID});\r\n      }\r\n\r\n    } else {\r\n      const redirect = Redirect.to('thread', {boardID, threadID: 0, postID});\r\n      const fetchable = Redirect.to('post', {boardID, postID});\r\n      if (redirect || fetchable) {\r\n        // Replace the .deadlink span if we can redirect or fetch the post.\r\n        a = $.el('a', {\r\n          href:        redirect || 'javascript:;',\r\n          className:   'deadlink',\r\n          textContent: quote\r\n        }\r\n        );\r\n        $.add(a, Post.deadMark.cloneNode(true));\r\n        if (fetchable) {\r\n          // Make it function as a normal quote if we can fetch the post.\r\n          $.addClass(a, 'quotelink');\r\n          $.extend(a.dataset, {boardID, postID});\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!this.quotes.includes(quoteID)) { this.quotes.push(quoteID); }\r\n\r\n    if (!a) {\r\n      $.add(deadlink, Post.deadMark.cloneNode(true));\r\n      return;\r\n    }\r\n\r\n    $.replace(deadlink, a);\r\n    if ($.hasClass(a, 'quotelink')) {\r\n      return this.nodes.quotelinks.push(a);\r\n    }\r\n  },\r\n\r\n  fixDeadlink(deadlink) {\r\n    let el;\r\n    if (!(el = deadlink.previousSibling) || (el.nodeName === 'BR')) {\r\n      const green = $.el('span',\r\n        {className: 'quote'});\r\n      $.before(deadlink, green);\r\n      $.add(green, deadlink);\r\n    }\r\n    return $.replace(deadlink, [...deadlink.childNodes]);\r\n  }\r\n};\r\nexport default Quotify;\r\n","import $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst Polyfill = {\r\n  init() {\r\n    this.toBlob();\r\n    $.global(this.toBlob);\r\n    if (!Element.prototype.matches) { Element.prototype.matches = Element.prototype.mozMatchesSelector || Element.prototype.webkitMatchesSelector; }\r\n  },\r\n  // This function is converted to a string and then put in a script tag.\r\n  // Do NOT shorten to `toBlob() {`.\r\n  toBlob: function() {\r\n    if (HTMLCanvasElement.prototype.toBlob) { return; }\r\n    HTMLCanvasElement.prototype.toBlob = function(cb, type, encoderOptions) {\r\n      const url = this.toDataURL(type, encoderOptions);\r\n      const data = atob(url.slice(url.indexOf(',')+1));\r\n      // DataUrl to Binary code from Aeosynth's 4chan X repo\r\n      const l = data.length;\r\n      const ui8a = new Uint8Array(l);\r\n      for (let i = 0, end = l; i < end; i++) {\r\n        ui8a[i] = data.charCodeAt(i);\r\n      }\r\n      return cb(new Blob([ui8a], {type: type || 'image/png'}));\r\n    };\r\n  }\r\n};\r\nexport default Polyfill;\r\n",null,"import Redirect from \"../Archive/Redirect\";\r\nimport Board from \"../classes/Board\";\r\nimport Callbacks from \"../classes/Callbacks\";\r\nimport CatalogThreadNative from \"../classes/CatalogThreadNative\";\r\nimport DataBoard from \"../classes/DataBoard\";\r\nimport Notice from \"../classes/Notice\";\r\nimport Post from \"../classes/Post\";\r\nimport SimpleDict from \"../classes/SimpleDict\";\r\nimport Thread from \"../classes/Thread\";\r\nimport Config from \"../config/Config\";\r\nimport Anonymize from \"../Filtering/Anonymize\";\r\nimport Filter from \"../Filtering/Filter\";\r\nimport PostHiding from \"../Filtering/PostHiding\";\r\nimport Recursive from \"../Filtering/Recursive\";\r\nimport ThreadHiding from \"../Filtering/ThreadHiding\";\r\nimport Index from \"../General/Index\";\r\nimport Settings from \"../General/Settings\";\r\nimport FappeTyme from \"../Images/FappeTyme\";\r\nimport Gallery from \"../Images/Gallery\";\r\nimport ImageCommon from \"../Images/ImageCommon\";\r\nimport ImageExpand from \"../Images/ImageExpand\";\r\nimport ImageHost from \"../Images/ImageHost\";\r\nimport ImageHover from \"../Images/ImageHover\";\r\nimport ImageLoader from \"../Images/ImageLoader\";\r\nimport Metadata from \"../Images/Metadata\";\r\nimport RevealSpoilers from \"../Images/RevealSpoilers\";\r\nimport Sauce from \"../Images/Sauce\";\r\nimport Volume from \"../Images/Volume\";\r\nimport Linkify from \"../Linkification/Linkify\";\r\nimport ArchiveLink from \"../Menu/ArchiveLink\";\r\nimport CopyTextLink from \"../Menu/CopyTextLink\";\r\nimport DeleteLink from \"../Menu/DeleteLink\";\r\nimport DownloadLink from \"../Menu/DownloadLink\";\r\nimport ReportLink from \"../Menu/ReportLink\";\r\nimport AntiAutoplay from \"../Miscellaneous/AntiAutoplay\";\r\nimport Banner from \"../Miscellaneous/Banner\";\r\nimport CatalogLinks from \"../Miscellaneous/CatalogLinks\";\r\nimport CustomCSS from \"../Miscellaneous/CustomCSS\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport ExpandThread from \"../Miscellaneous/ExpandThread\";\r\nimport FileInfo from \"../Miscellaneous/FileInfo\";\r\nimport Flash from \"../Miscellaneous/Flash\";\r\nimport Fourchan from \"../Miscellaneous/Fourchan\";\r\nimport IDColor from \"../Miscellaneous/IDColor\";\r\nimport IDHighlight from \"../Miscellaneous/IDHighlight\";\r\nimport IDPostCount from \"../Miscellaneous/IDPostCount\";\r\nimport Keybinds from \"../Miscellaneous/Keybinds\";\r\nimport ModContact from \"../Miscellaneous/ModContact\";\r\nimport Nav from \"../Miscellaneous/Nav\";\r\nimport NormalizeURL from \"../Miscellaneous/NormalizeURL\";\r\nimport PostJumper from \"../Miscellaneous/PostJumper\";\r\nimport PSA from \"../Miscellaneous/PSA\";\r\nimport PSAHiding from \"../Miscellaneous/PSAHiding\";\r\nimport RelativeDates from \"../Miscellaneous/RelativeDates\";\r\nimport RemoveSpoilers from \"../Miscellaneous/RemoveSpoilers\";\r\nimport ThreadLinks from \"../Miscellaneous/ThreadLinks\";\r\nimport Time from \"../Miscellaneous/Time\";\r\nimport Tinyboard from \"../Miscellaneous/Tinyboard\";\r\nimport Favicon from \"../Monitoring/Favicon\";\r\nimport MarkNewIPs from \"../Monitoring/MarkNewIPs\";\r\nimport ReplyPruning from \"../Monitoring/ReplyPruning\";\r\nimport ThreadStats from \"../Monitoring/ThreadStats\";\r\nimport ThreadUpdater from \"../Monitoring/ThreadUpdater\";\r\nimport ThreadWatcher from \"../Monitoring/ThreadWatcher\";\r\nimport Unread from \"../Monitoring/Unread\";\r\nimport UnreadIndex from \"../Monitoring/UnreadIndex\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport PassLink from \"../Posting/PassLink\";\r\nimport PostRedirect from \"../Posting/PostRedirect\";\r\nimport QR from \"../Posting/QR\";\r\nimport QuoteBacklink from \"../Quotelinks/QuoteBacklink\";\r\nimport QuoteCT from \"../Quotelinks/QuoteCT\";\r\nimport QuoteInline from \"../Quotelinks/QuoteInline\";\r\nimport QuoteOP from \"../Quotelinks/QuoteOP\";\r\nimport QuotePreview from \"../Quotelinks/QuotePreview\";\r\nimport QuoteStrikeThrough from \"../Quotelinks/QuoteStrikeThrough\";\r\nimport QuoteThreading from \"../Quotelinks/QuoteThreading\";\r\nimport QuoteYou from \"../Quotelinks/QuoteYou\";\r\nimport Quotify from \"../Quotelinks/Quotify\";\r\nimport Site from \"../site/Site\";\r\nimport SW from \"../site/SW\";\r\nimport CSS from \"../css/CSS\";\r\nimport meta from '../../package.json';\r\nimport Header from \"../General/Header\";\r\nimport { c, Conf, d, doc, docSet, E, g } from \"../globals/globals\";\r\nimport Menu from \"../Menu/Menu\";\r\nimport BoardConfig from \"../General/BoardConfig\";\r\nimport CaptchaReplace from \"../Posting/Captcha.replace\";\r\nimport Get from \"../General/Get\";\r\nimport { dict, platform } from \"../platform/helpers\";\r\nimport Polyfill from \"../General/Polyfill\";\r\nimport RestoreDeletedFromArchive from \"../Archive/RestoreDeletedFromArchive\";\r\n// import Test from \"../General/Test\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Main = {\r\n  init() {\r\n    // XXX dwb userscripts extension reloads scripts run at document-start when replaceState/pushState is called.\r\n    // XXX Firefox reinjects WebExtension content scripts when extension is updated / reloaded.\r\n    let key;\r\n    try {\r\n      let w = window;\r\n      if (platform === 'crx') { w = (w.wrappedJSObject || w); }\r\n      if (`${meta.name} antidup` in w) { return; }\r\n      w[`${meta.name} antidup`] = true;\r\n    } catch (error) {}\r\n\r\n    // Don't run inside ad iframes.\r\n    try {\r\n      if (window.frameElement && ['', 'about:blank'].includes(window.frameElement.src)) { return; }\r\n    } catch (error1) {}\r\n\r\n    // Detect multiple copies of 4chan X\r\n    if (doc && $.hasClass(doc, 'fourchan-x')) { return; }\r\n    $.asap(docSet, function() {\r\n      $.addClass(doc, 'fourchan-xt', 'fourchan-x', 'seaweedchan');\r\n      if ($.engine) { return $.addClass(doc, `ua-${$.engine}`); }\r\n    });\r\n    try {\r\n      $.global(\r\n        function () {\r\n          const date = +this.buildDate;\r\n          Object.defineProperty(window, 'fourchanXT', {\r\n            value: Object.freeze({\r\n              version: this.version,\r\n              // Getter to prevent mutations.\r\n              get buildDate() { return new Date(date) },\r\n            }),\r\n            writable: false,\r\n          });\r\n        },\r\n        { version: g.VERSION, buildDate: g.VERSION_DATE.getTime().toString() },\r\n      );\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    $.on(d, '4chanXInitFinished', function() {\r\n      if (Main.expectInitFinished) {\r\n        return delete Main.expectInitFinished;\r\n      } else {\r\n        new Notice('error', 'Error: Multiple copies of 4chan X are enabled.');\r\n        return $.addClass(doc, 'tainted');\r\n      }\r\n    });\r\n\r\n    // Detect \"mounted\" event from Kissu\r\n    var mountedCB = function() {\r\n      d.removeEventListener('mounted', mountedCB, true);\r\n      Main.isMounted = true;\r\n      return Main.mountedCBs.map((cb) =>\r\n        (() => { try {\r\n          return cb();\r\n        } catch (error2) {} })());\r\n    };\r\n    d.addEventListener('mounted', mountedCB, true);\r\n\r\n    // Flatten default values from Config into Conf\r\n    var flatten = function(parent, obj) {\r\n      if (obj instanceof Array) {\r\n        Conf[parent] = dict.clone(obj[0]);\r\n      } else if (typeof obj === 'object') {\r\n        for (var key in obj) {\r\n          var val = obj[key];\r\n          flatten(key, val);\r\n        }\r\n      } else { // string or number\r\n        Conf[parent] = obj;\r\n      }\r\n    };\r\n\r\n    // XXX Remove document-breaking ad\r\n    if (['boards.4chan.org', 'boards.4channel.org'].includes(location.hostname)) {\r\n      $.global(function() {\r\n        const fromCharCode0 = String.fromCharCode;\r\n        return String.fromCharCode = function() {\r\n          if (document.body) {\r\n            String.fromCharCode = fromCharCode0;\r\n          } else if (document.currentScript && !document.currentScript.src) {\r\n            throw Error();\r\n          }\r\n          return fromCharCode0.apply(this, arguments);\r\n        };\r\n      });\r\n      $.asap(docSet, () => $.onExists(doc, 'iframe[srcdoc]', $.rm));\r\n    }\r\n\r\n    flatten(null, Config);\r\n\r\n    for (var db of DataBoard.keys) {\r\n      Conf[db] = dict();\r\n    }\r\n    Conf['customTitles'] = dict.clone({'4chan.org': {boards: {'qa': {'boardTitle': {orig: '/qa/ - Question & Answer', title: '/qa/ - 2D/Random'}}}}});\r\n    Conf['boardConfig'] = {boards: dict()};\r\n    Conf['archives'] = Redirect.archives;\r\n    Conf['selectedArchives'] = dict();\r\n    Conf['cooldowns'] = dict();\r\n    Conf['Index Sort'] = dict();\r\n    for (let i = 0; i < 2; i++) { Conf[`Last Long Reply Thresholds ${i}`] = dict(); }\r\n    Conf['siteProperties'] = dict();\r\n\r\n    // XXX old key names\r\n    Conf['Except Archives from Encryption'] = false;\r\n    Conf['JSON Navigation'] = true;\r\n    Conf['Oekaki Links'] = true;\r\n    Conf['Show Name and Subject'] = false;\r\n    Conf['QR Shortcut'] = true;\r\n    Conf['Bottom QR Link'] = true;\r\n    Conf['Toggleable Thread Watcher'] = true;\r\n    Conf['siteSoftware'] = '';\r\n    Conf['Use Faster Image Host'] = 'true';\r\n    Conf['Captcha Fixes'] = true;\r\n    Conf['captchaServiceDomain'] = '';\r\n    Conf['captchaServiceKey'] = dict();\r\n\r\n    // Enforce JS whitelist\r\n    if (\r\n      /\\.4chan(?:nel)?\\.org$/.test(location.hostname) &&\r\n      !SW.yotsuba.regexp.pass.test(location.href) &&\r\n      !SW.yotsuba.regexp.captcha.test(location.href) &&\r\n      !$$('script:not([src])', d).filter(s => /this\\[/.test(s.textContent)).length\r\n    ) {\r\n      ($.getSync || $.get)({'jsWhitelist': Conf['jsWhitelist']}, ({jsWhitelist}) => $.addCSP(`script-src ${jsWhitelist.replace(/^#.*$/mg, '').replace(/[\\s;]+/g, ' ').trim()}`));\r\n    }\r\n\r\n    // Get saved values as items\r\n    const items = dict();\r\n    for (key in Conf) { items[key] = undefined; }\r\n    items['previousversion'] = undefined;\r\n    return ($.getSync || $.get)(items, function(items) {\r\n      if (!$.perProtocolSettings && /\\.4chan(?:nel)?\\.org$/.test(location.hostname) && (items['Redirect to HTTPS'] ?? Conf['Redirect to HTTPS']) && (location.protocol !== 'https:')) {\r\n        location.replace('https://' + location.host + location.pathname + location.search + location.hash);\r\n        return;\r\n      }\r\n      return $.asap(docSet, function() {\r\n\r\n        // Don't hide the local storage warning behind a settings panel.\r\n        if ($.cantSet) {\r\n          // pass\r\n\r\n        // Fresh install\r\n        } else if ((items.previousversion == null)) {\r\n          Main.isFirstRun = true;\r\n          Main.ready(function() {\r\n            $.set('previousversion', g.VERSION);\r\n            return Settings.open();\r\n          });\r\n\r\n        // Migrate old settings\r\n        } else if (items.previousversion !== g.VERSION) {\r\n          Main.upgrade(items);\r\n        }\r\n\r\n        // Combine default values with saved values\r\n        for (key in Conf) {\r\n          var val = Conf[key];\r\n          Conf[key] = items[key] ?? val;\r\n        }\r\n\r\n        return Site.init(Main.initFeatures);\r\n      });\r\n    });\r\n  },\r\n\r\n  upgrade(items) {\r\n    const {previousversion} = items;\r\n    const changes = Settings.upgrade(items, previousversion);\r\n    items.previousversion = (changes.previousversion = g.VERSION);\r\n    return $.set(changes, function() {\r\n      if (items['Show Updated Notifications'] ?? true) {\r\n        const el = $.el('span',\r\n          { innerHTML: `${meta.name} has been updated to <a href=\"${meta.changelog}\" target=\"_blank\">version ${g.VERSION}</a>.` });\r\n        return new Notice('info', el, 15);\r\n      }\r\n    });\r\n  },\r\n\r\n  parseURL(site=g.SITE, url=location) {\r\n    const r = {};\r\n\r\n    if (!site) { return r; }\r\n    r.siteID = site.ID;\r\n\r\n    if (site.isBoardlessPage?.(url)) { return r; }\r\n    const pathname = url.pathname.split(/\\/+/);\r\n    r.boardID = pathname[1];\r\n\r\n    if (site.isFileURL(url)) {\r\n      r.VIEW = 'file';\r\n    } else if (site.isAuxiliaryPage?.(url)) {\r\n      // pass\r\n    } else if (['thread', 'res'].includes(pathname[2])) {\r\n      r.VIEW = 'thread';\r\n      r.threadID = (r.THREADID = +pathname[3].replace(/\\.\\w+$/, ''));\r\n    } else if ((pathname[2] === 'archive') && (pathname[3] === 'res')) {\r\n      r.VIEW = 'thread';\r\n      r.threadID = (r.THREADID = +pathname[4].replace(/\\.\\w+$/, ''));\r\n      r.threadArchived = true;\r\n    } else if (/^(?:catalog|archive)(?:\\.\\w+)?$/.test(pathname[2])) {\r\n      r.VIEW = pathname[2].replace(/\\.\\w+$/, '');\r\n    } else if (/^(?:index|\\d*)(?:\\.\\w+)?$/.test(pathname[2])) {\r\n      r.VIEW = 'index';\r\n    }\r\n    return r;\r\n  },\r\n\r\n  initFeatures() {\r\n    $.global(function() {\r\n      document.documentElement.classList.add('js-enabled');\r\n      return window.FCX = {};});\r\n    Main.jsEnabled = $.hasClass(doc, 'js-enabled');\r\n\r\n    // XXX https://bugs.chromium.org/p/chromium/issues/detail?id=920638\r\n    $.ajaxPageInit?.();\r\n\r\n    $.extend(g, Main.parseURL());\r\n    if (g.boardID) { g.BOARD = new Board(g.boardID); }\r\n\r\n    if (!g.VIEW) {\r\n      g.SITE.initAuxiliary?.();\r\n      return;\r\n    }\r\n\r\n    if (g.VIEW === 'file') {\r\n      $.asap((() => d.readyState !== 'loading'), function() {\r\n        let video;\r\n        if ((g.SITE.software === 'yotsuba') && Conf['404 Redirect'] && g.SITE.is404?.()) {\r\n          const pathname = location.pathname.split(/\\/+/);\r\n          return Redirect.navigate('file', {\r\n            boardID:  g.BOARD.ID,\r\n            filename: pathname[pathname.length - 1]\r\n          });\r\n        } else if (video = $('video')) {\r\n          if (Conf['Volume in New Tab']) {\r\n            Volume.setup(video);\r\n          }\r\n          if (Conf['Loop in New Tab']) {\r\n            video.loop = true;\r\n            video.controls = false;\r\n            video.play();\r\n            return ImageCommon.addControls(video);\r\n          }\r\n        }\r\n      });\r\n      return;\r\n    }\r\n\r\n    g.threads = new SimpleDict();\r\n    g.posts   = new SimpleDict();\r\n\r\n    // set up CSS when <head> is completely loaded\r\n    $.onExists(doc, 'body', Main.initStyle);\r\n\r\n    // c.time 'All initializations'\r\n    for (var [name, feature] of Main.features) {\r\n      if (g.SITE.disabledFeatures && g.SITE.disabledFeatures.includes(name)) { continue; }\r\n      // c.time \"#{name} initialization\"\r\n      try {\r\n        feature.init();\r\n      } catch (err) {\r\n        Main.handleErrors({\r\n          message: `\\\"${name}\\\" initialization crashed.`,\r\n          error: err\r\n        });\r\n      }\r\n    }\r\n      // finally\r\n      //   c.timeEnd \"#{name} initialization\"\r\n\r\n    // c.timeEnd 'All initializations'\r\n\r\n    return $.ready(Main.initReady);\r\n  },\r\n\r\n  initStyle() {\r\n    if (!Main.isThisPageLegit()) { return; }\r\n\r\n    // disable the mobile layout\r\n    const mobileLink = $('link[href*=mobile]', d.head);\r\n    if (mobileLink) mobileLink.disabled = true;\r\n    doc.dataset.host = location.host;\r\n    $.addClass(doc, `sw-${g.SITE.software}`);\r\n    $.addClass(doc, g.VIEW === 'thread' ? 'thread-view' : g.VIEW);\r\n    $.onExists(doc, '.ad-cnt, .adg-rects > .desktop', ad => $.onExists(ad, 'img, iframe', () => $.addClass(doc, 'ads-loaded')));\r\n    if (Conf['Autohiding Scrollbar']) { $.addClass(doc, 'autohiding-scrollbar'); }\r\n    $.ready(function() {\r\n      if ((d.body.clientHeight > doc.clientHeight) && ((window.innerWidth === doc.clientWidth) !== Conf['Autohiding Scrollbar'])) {\r\n        Conf['Autohiding Scrollbar'] = !Conf['Autohiding Scrollbar'];\r\n        $.set('Autohiding Scrollbar', Conf['Autohiding Scrollbar']);\r\n        return $.toggleClass(doc, 'autohiding-scrollbar');\r\n      }\r\n    });\r\n    $.addStyle(CSS.sub(CSS.boards), 'fourchanx-css');\r\n    Main.bgColorStyle = $.el('style', {id: 'fourchanx-bgcolor-css'});\r\n\r\n    let keyboard = false;\r\n    $.on(d, 'mousedown', () => keyboard = false);\r\n    $.on(d, 'keydown', function(e) { if (e.keyCode === 9) { return keyboard = true; } }); // tab\r\n    window.addEventListener('focus', (() => doc.classList.toggle('keyboard-focus', keyboard)), true);\r\n\r\n    return Main.setClass();\r\n  },\r\n\r\n  setClass() {\r\n    let mainStyleSheet, style, styleSheets;\r\n    const knownStyles = ['yotsuba', 'yotsuba-b', 'futaba', 'burichan', 'photon', 'tomorrow', 'spooky'];\r\n\r\n    if ((g.SITE.software === 'yotsuba') && (g.VIEW === 'catalog')) {\r\n      if (mainStyleSheet = $.id('base-css')) {\r\n        style = mainStyleSheet.href.match(/catalog_(\\w+)/)?.[1].replace('_new', '').replace(/_+/g, '-');\r\n        if (knownStyles.includes(style)) {\r\n          $.addClass(doc, style);\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n    style = (mainStyleSheet = (styleSheets = null));\r\n\r\n    const setStyle = function() {\r\n      // Use preconfigured CSS for 4chan's default themes.\r\n      if (g.SITE.software === 'yotsuba') {\r\n        $.rmClass(doc, style);\r\n        style = null;\r\n        for (var styleSheet of styleSheets) {\r\n          if (styleSheet.href === mainStyleSheet?.href) {\r\n            style = styleSheet.title.toLowerCase().replace('new', '').trim().replace(/\\s+/g, '-');\r\n            if (style === '_special') { style = styleSheet.href.match(/[a-z]*(?=[^/]*$)/)[0]; }\r\n            if (!knownStyles.includes(style)) { style = null; }\r\n            break;\r\n          }\r\n        }\r\n        if (style) {\r\n          $.addClass(doc, style);\r\n          $.rm(Main.bgColorStyle);\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Determine proper dialog background color for other themes.\r\n      const div = g.SITE.bgColoredEl();\r\n      div.style.position = 'absolute';\r\n      div.style.visibility = 'hidden';\r\n      $.add(d.body, div);\r\n      let bgColor = window.getComputedStyle(div).backgroundColor;\r\n      $.rm(div);\r\n      const rgb = bgColor.match(/[\\d.]+/g);\r\n      // Use body background if reply background is transparent\r\n      if (!/^rgb\\(/.test(bgColor)) {\r\n        const s = window.getComputedStyle(d.body);\r\n        bgColor = `${s.backgroundColor} ${s.backgroundImage} ${s.backgroundRepeat} ${s.backgroundPosition}`;\r\n      }\r\n      let css = `\\\r\n.dialog, .suboption-list > div:last-of-type, :root.catalog-hover-expand .catalog-container:hover > .post {\r\n  background: ${bgColor};\r\n}\r\n.unread-mark-read {\r\n  background-color: rgba(${rgb.slice(0, 3).join(', ')}, ${0.5*(rgb[3] || 1)});\r\n}\\\r\n`;\r\n      if ($.luma(rgb) < 100) {\r\n        css += `\\\r\n.watch-thread-link {\r\n  background-image: url(\"data:image/svg+xml,<svg viewBox='0 0 26 26' preserveAspectRatio='true' xmlns='http://www.w3.org/2000/svg'><path fill='rgb(200,200,200)' d='M24.132,7.971c-2.203-2.205-5.916-2.098-8.25,0.235L15.5,8.588l-0.382-0.382c-2.334-2.333-6.047-2.44-8.25-0.235c-2.204,2.203-2.098,5.916,0.235,8.249l8.396,8.396l8.396-8.396C26.229,13.887,26.336,10.174,24.132,7.971z'/></svg>\");\r\n}\\\r\n`;\r\n      }\r\n      Main.bgColorStyle.textContent = css;\r\n      return $.after($.id('fourchanx-css'), Main.bgColorStyle);\r\n    };\r\n\r\n    $.onExists(d.head, g.SITE.selectors.styleSheet, function(el) {\r\n      mainStyleSheet = el;\r\n      if (g.SITE.software === 'yotsuba') {\r\n        styleSheets = $$('link[rel=\"alternate stylesheet\"]', d.head);\r\n      }\r\n      new MutationObserver(setStyle).observe(mainStyleSheet, {\r\n        attributes: true,\r\n        attributeFilter: ['href']\r\n      });\r\n      $.on(mainStyleSheet, 'load', setStyle);\r\n      return setStyle();\r\n    });\r\n    if (!mainStyleSheet) {\r\n      for (var styleSheet of $$('link[rel=\"stylesheet\"]', d.head)) {\r\n        $.on(styleSheet, 'load', setStyle);\r\n      }\r\n      return setStyle();\r\n    }\r\n  },\r\n\r\n  initReady() {\r\n    if (g.SITE.is404?.()) {\r\n      if (g.VIEW === 'thread') {\r\n        ThreadWatcher.set404(g.BOARD.ID, g.THREADID, function() {\r\n          if (Conf['404 Redirect']) {\r\n            return Redirect.navigate('thread', {\r\n              boardID:  g.BOARD.ID,\r\n              threadID: g.THREADID,\r\n              postID:   +location.hash.match(/\\d+/)\r\n            } // post number or 0\r\n            , `/${g.BOARD}/`);\r\n          }\r\n        });\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    if (g.SITE.isIncomplete?.()) {\r\n      const msg = $.el('div',\r\n        {innerHTML: 'The page didn&#039;t load completely.<br>Some features may not work unless you <a href=\"javascript:;\">reload</a>.'});\r\n      $.on($('a', msg), 'click', () => location.reload());\r\n      new Notice('warning', msg);\r\n    }\r\n\r\n    // Parse HTML or skip it and start building from JSON.\r\n    if (g.VIEW === 'catalog') {\r\n      return Main.initCatalog();\r\n    } else if (!Index.enabled) {\r\n      if (g.SITE.awaitBoard) {\r\n        return g.SITE.awaitBoard(Main.initThread);\r\n      } else {\r\n        return Main.initThread();\r\n      }\r\n    } else {\r\n      Main.expectInitFinished = true;\r\n      return $.event('4chanXInitFinished');\r\n    }\r\n  },\r\n\r\n  initThread() {\r\n    let board;\r\n    const s = g.SITE.selectors;\r\n    if (board = $((s.boardFor?.[g.VIEW] || s.board))) {\r\n      const threads = [];\r\n      const posts   = [];\r\n      const errors  = [];\r\n\r\n      try {\r\n        g.SITE.preParsingFixes?.(board);\r\n      } catch (error) {}\r\n\r\n      Main.addThreadsObserver = new MutationObserver(Main.addThreads);\r\n      Main.addPostsObserver   = new MutationObserver(Main.addPosts);\r\n      Main.addThreadsObserver.observe(board, {childList: true});\r\n\r\n      Main.parseThreads($$(s.thread, board), threads, posts, errors);\r\n      if (errors.length) { Main.handleErrors(errors); }\r\n\r\n      if (g.VIEW === 'thread') {\r\n        if (g.threadArchived) {\r\n          threads[0].isArchived = true;\r\n          threads[0].kill();\r\n        }\r\n        g.SITE.parseThreadMetadata?.(threads[0]);\r\n      }\r\n\r\n      Main.callbackNodes('Thread', threads);\r\n      return Main.callbackNodesDB('Post', posts, function() {\r\n        for (var post of posts) { QuoteThreading.insert(post); }\r\n        Main.expectInitFinished = true;\r\n        return $.event('4chanXInitFinished');\r\n      });\r\n\r\n    } else {\r\n      Main.expectInitFinished = true;\r\n      return $.event('4chanXInitFinished');\r\n    }\r\n  },\r\n\r\n  parseThreads(threadRoots, threads, posts, errors) {\r\n    for (var threadRoot of threadRoots) {\r\n      var boardObj = (() => {\r\n        let boardID;\r\n        if (boardID = threadRoot.dataset.board) {\r\n        boardID = encodeURIComponent(boardID);\r\n        return g.boards[boardID] || new Board(boardID);\r\n      } else {\r\n        return g.BOARD;\r\n      }\r\n      })();\r\n      var threadID = +threadRoot.id.match(/\\d*$/)[0];\r\n      if (!threadID || boardObj.threads.get(threadID)?.nodes.root) { return; }\r\n      var thread = new Thread(threadID, boardObj);\r\n      thread.nodes.root = threadRoot;\r\n      threads.push(thread);\r\n      var postRoots = $$(g.SITE.selectors.postContainer, threadRoot);\r\n      if (g.SITE.isOPContainerThread) { postRoots.unshift(threadRoot); }\r\n      Main.parsePosts(postRoots, thread, posts, errors);\r\n      Main.addPostsObserver.observe(threadRoot, {childList: true});\r\n    }\r\n  },\r\n\r\n  parsePosts(postRoots, thread, posts, errors) {\r\n    for (var postRoot of postRoots) {\r\n      if (!(postRoot.dataset.fullID && g.posts.get(postRoot.dataset.fullID)) && $(g.SITE.selectors.comment, postRoot)) {\r\n        try {\r\n          posts.push(new Post(postRoot, thread, thread.board));\r\n        } catch (err) {\r\n          // Skip posts that we failed to parse.\r\n          errors.push({\r\n            message: `Parsing of Post No.${postRoot.id.match(/\\d+/)} failed. Post will be skipped.`,\r\n            error: err,\r\n            html: postRoot.outerHTML\r\n          });\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  addThreads(records) {\r\n    const threadRoots = [];\r\n    for (var record of records) {\r\n      for (var node of record.addedNodes) {\r\n        if ((node.nodeType === Node.ELEMENT_NODE) && node.matches(g.SITE.selectors.thread)) {\r\n          threadRoots.push(node);\r\n        }\r\n      }\r\n    }\r\n    if (!threadRoots.length) { return; }\r\n    const threads = [];\r\n    const posts   = [];\r\n    const errors  = [];\r\n    Main.parseThreads(threadRoots, threads, posts, errors);\r\n    if (errors.length) { Main.handleErrors(errors); }\r\n    Main.callbackNodes('Thread', threads);\r\n    return Main.callbackNodesDB('Post', posts, () => $.event('PostsInserted', null, records[0].target));\r\n  },\r\n\r\n  addPosts(records) {\r\n    let thread;\r\n    const threads   = [];\r\n    const threadsRM = [];\r\n    const posts     = [];\r\n    const errors    = [];\r\n    for (var record of records) {\r\n      thread = Get.threadFromRoot(record.target);\r\n      var postRoots = [];\r\n      for (var node of record.addedNodes) {\r\n        if (node.nodeType === Node.ELEMENT_NODE) {\r\n          if (node.matches(g.SITE.selectors.postContainer) || (node = $(g.SITE.selectors.postContainer, node))) {\r\n            postRoots.push(node);\r\n          }\r\n        }\r\n      }\r\n      var n = posts.length;\r\n      Main.parsePosts(postRoots, thread, posts, errors);\r\n      if ((posts.length > n) && !threads.includes(thread)) {\r\n        threads.push(thread);\r\n      }\r\n      var anyRemoved = false;\r\n      for (var el of record.removedNodes) {\r\n        if ((Get.postFromRoot(el)?.nodes.root === el) && !doc.contains(el)) {\r\n          anyRemoved = true;\r\n          break;\r\n        }\r\n      }\r\n      if (anyRemoved && !threadsRM.includes(thread)) {\r\n        threadsRM.push(thread);\r\n      }\r\n    }\r\n    if (errors.length) { Main.handleErrors(errors); }\r\n    return Main.callbackNodesDB('Post', posts, function() {\r\n      for (thread of threads) {\r\n        $.event('PostsInserted', null, thread.nodes.root);\r\n      }\r\n      for (thread of threadsRM) {\r\n        $.event('PostsRemoved', null, thread.nodes.root);\r\n      }\r\n    });\r\n  },\r\n\r\n  initCatalog() {\r\n    let board;\r\n    const s = g.SITE.selectors.catalog;\r\n    if (s && (board = $(s.board))) {\r\n      const threads = [];\r\n      const errors  = [];\r\n\r\n      Main.addCatalogThreadsObserver = new MutationObserver(Main.addCatalogThreads);\r\n      Main.addCatalogThreadsObserver.observe(board, {childList: true});\r\n\r\n      Main.parseCatalogThreads($$(s.thread, board), threads, errors);\r\n      if (errors.length) { Main.handleErrors(errors); }\r\n\r\n      Main.callbackNodes('CatalogThreadNative', threads);\r\n    }\r\n\r\n    Main.expectInitFinished = true;\r\n    return $.event('4chanXInitFinished');\r\n  },\r\n\r\n  parseCatalogThreads(threadRoots, threads, errors) {\r\n    for (var threadRoot of threadRoots) {\r\n      try {\r\n        var thread = new CatalogThreadNative(threadRoot);\r\n        if (thread.thread.catalogViewNative?.nodes.root !== threadRoot) {\r\n          thread.thread.catalogViewNative = thread;\r\n          threads.push(thread);\r\n        }\r\n      } catch (err) {\r\n        // Skip threads that we failed to parse.\r\n        errors.push({\r\n          message: `Parsing of Catalog Thread No.${(threadRoot.dataset.id || threadRoot.id).match(/\\d+/)} failed. Thread will be skipped.`,\r\n          error: err,\r\n          html: threadRoot.outerHTML\r\n        });\r\n      }\r\n    }\r\n  },\r\n\r\n  addCatalogThreads(records) {\r\n    const threadRoots = [];\r\n    for (var record of records) {\r\n      for (var node of record.addedNodes) {\r\n        if ((node.nodeType === Node.ELEMENT_NODE) && node.matches(g.SITE.selectors.catalog.thread)) {\r\n          threadRoots.push(node);\r\n        }\r\n      }\r\n    }\r\n    if (!threadRoots.length) { return; }\r\n    const threads = [];\r\n    const errors  = [];\r\n    Main.parseCatalogThreads(threadRoots, threads, errors);\r\n    if (errors.length) { Main.handleErrors(errors); }\r\n    return Main.callbackNodes('CatalogThreadNative', threads);\r\n  },\r\n\r\n  callbackNodes(klass, nodes) {\r\n    let node;\r\n    let i = 0;\r\n    const cb = Callbacks[klass];\r\n    while ((node = nodes[i++])) {\r\n      cb.execute(node);\r\n    }\r\n  },\r\n\r\n  callbackNodesDB(klass, nodes, cb) {\r\n    let i   = 0;\r\n    const cbs = Callbacks[klass];\r\n    const fn  = function() {\r\n      let node;\r\n      if (!(node = nodes[i])) { return false; }\r\n      cbs.execute(node);\r\n      return ++i % 250;\r\n    };\r\n\r\n    var softTask = function() {\r\n      while (fn()) {\r\n        continue;\r\n      }\r\n      if (!nodes[i]) {\r\n        if (cb) { cb(); }\r\n        return;\r\n      }\r\n      return setTimeout(softTask, 0);\r\n    };\r\n\r\n    return softTask();\r\n  },\r\n\r\n  handleErrors(errors) {\r\n    // Detect conflicts with 4chan X v2\r\n    let error;\r\n    if (d.body && $.hasClass(d.body, 'fourchan_x') && !$.hasClass(doc, 'tainted')) {\r\n      new Notice('error', 'Error: Multiple copies of 4chan X are enabled.');\r\n      $.addClass(doc, 'tainted');\r\n    }\r\n\r\n    // Detect conflicts with native extension\r\n    if (g.SITE.testNativeExtension && !$.hasClass(doc, 'tainted')) {\r\n      const {enabled} = g.SITE.testNativeExtension();\r\n      if (enabled) {\r\n        $.addClass(doc, 'tainted');\r\n        if (Conf['Disable Native Extension'] && !Main.isFirstRun) {\r\n          const msg = $.el('div',\r\n            { innerHTML: 'Failed to disable the native extension. You may need to <a href=\"' + E(meta.upstreamFaq) +\r\n              '#blocking-native-extension\" target=\"_blank\">block it</a>.' });\r\n          new Notice('error', msg);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!(errors instanceof Array)) {\r\n      error = errors;\r\n    } else if (errors.length === 1) {\r\n      error = errors[0];\r\n    }\r\n    if (error) {\r\n      new Notice('error', Main.parseError(error, Main.reportLink([error])), 15);\r\n      return;\r\n    }\r\n\r\n    const div = $.el('div', {\r\n      innerHTML:\r\n        `${errors.length} errors occurred.${Main.reportLink(errors).innerHTML} [<a href=\"javascript:;\">show</a>]`\r\n    });\r\n    $.on(div.lastElementChild, 'click', function () {\r\n      return [this.textContent, logs.hidden] = this.textContent === 'show' ? ['hide', false] : ['show', true];\r\n    });\r\n\r\n    var logs = $.el('div',\r\n      {hidden: true});\r\n    for (error of errors) {\r\n      $.add(logs, Main.parseError(error));\r\n    }\r\n\r\n    return new Notice('error', [div, logs], 30);\r\n  },\r\n\r\n  parseError(data, reportLink) {\r\n    c.error(data.message, data.error.stack);\r\n    const message = $.el('div',\r\n      { innerHTML: E(data.message) + ((reportLink) ? (reportLink).innerHTML : \"\") });\r\n    const error = $.el('div',\r\n      {textContent: `${data.error.name || 'Error'}: ${data.error.message || 'see console for details'}`});\r\n    const lines = data.error.stack?.match(/\\d+(?=:\\d+\\)?$)/mg)?.join().replace(/^/, ' at ') || '';\r\n    const context = $.el('div',\r\n      { textContent: `(${meta.name} ${meta.fork} v${g.VERSION} ${platform} on ${$.engine}${lines})` });\r\n    return [message, error, context];\r\n  },\r\n\r\n  reportLink(errors) {\r\n    let info;\r\n    const data = errors[0];\r\n    let title  = data.message;\r\n    if (errors.length > 1) { title += ` (+${errors.length - 1} other errors)`; }\r\n    let details = '';\r\n    const addDetails = function(text) {\r\n      if (encodeURIComponent(title + details + text + '\\n').length <= meta.newIssueMaxLength - meta.newIssue.replace(/%(title|details)/, '').length) {\r\n        return details += text + '\\n';\r\n      }\r\n    };\r\n    addDetails(`\\\r\n[Please describe the steps needed to reproduce this error.]\r\n\r\nScript: ${meta.name} ${meta.fork} v${g.VERSION} ${platform}\r\nURL: ${location.href}\r\nUser agent: ${navigator.userAgent}\\\r\n`\r\n    );\r\n    if ((platform === 'userscript') && (info = (() => {\r\n      if (typeof GM !== 'undefined' && GM !== null) { return GM.info; } else { if (typeof GM_info !== 'undefined' && GM_info !== null) { return GM_info; }\r\n  }\r\n    })())) {\r\n      addDetails(`Userscript manager: ${info.scriptHandler} ${info.version}`);\r\n    }\r\n    addDetails('\\n' + data.error);\r\n    if (data.error.stack) { addDetails(data.error.stack.replace(data.error.toString(), '').trim()); }\r\n    if (data.html) { addDetails('\\n`' + data.html + '`'); }\r\n    details = details.replace(/file:\\/{3}.+\\//g, ''); // Remove local file paths\r\n    const url = meta.newIssue.replace('%title', encodeURIComponent(title)).replace('%details', encodeURIComponent(details));\r\n    return { innerHTML: `<span class=\"report-error\"> [<a href=\"${url}\" target=\"_blank\">report</a>]</span>` };\r\n  },\r\n\r\n  isThisPageLegit() {\r\n    // not 404 error page or similar.\r\n    if (!('thisPageIsLegit' in Main)) {\r\n      Main.thisPageIsLegit = g.SITE.isThisPageLegit ?\r\n        g.SITE.isThisPageLegit()\r\n      :\r\n        !/^[45]\\d\\d\\b/.test(document.title) && !/\\.(?:json|rss)$/.test(location.pathname);\r\n    }\r\n    return Main.thisPageIsLegit;\r\n  },\r\n\r\n  ready(cb) {\r\n    return $.ready(function() {\r\n      if (Main.isThisPageLegit()) { return cb(); }\r\n    });\r\n  },\r\n\r\n  mounted(cb) {\r\n    if (Main.isMounted) {\r\n      return cb();\r\n    } else {\r\n      return Main.mountedCBs.push(cb);\r\n    }\r\n  },\r\n\r\n  mountedCBs: [],\r\n\r\n  features: [\r\n    ['Polyfill',                  Polyfill],\r\n    ['Board Configuration',       BoardConfig],\r\n    ['Normalize URL',             NormalizeURL],\r\n    ['Delay Redirect on Post',    PostRedirect],\r\n    ['Captcha Configuration',     CaptchaReplace],\r\n    ['Image Host Rewriting',      ImageHost],\r\n    ['Redirect',                  Redirect],\r\n    ['Header',                    Header],\r\n    ['Catalog Links',             CatalogLinks],\r\n    ['Settings',                  Settings],\r\n    ['Index Generator',           Index],\r\n    ['Disable Autoplay',          AntiAutoplay],\r\n    ['Announcement Hiding',       PSAHiding],\r\n    ['Fourchan thingies',         Fourchan],\r\n    ['Tinyboard Glue',            Tinyboard],\r\n    ['Color User IDs',            IDColor],\r\n    ['Highlight by User ID',      IDHighlight],\r\n    ['Count Posts by ID',         IDPostCount],\r\n    ['Custom CSS',                CustomCSS],\r\n    ['Thread Links',              ThreadLinks],\r\n    ['Linkify',                   Linkify],\r\n    ['Reveal Spoilers',           RemoveSpoilers],\r\n    ['Resurrect Quotes',          Quotify],\r\n    ['Filter',                    Filter],\r\n    ['Thread Hiding Buttons',     ThreadHiding],\r\n    ['Reply Hiding Buttons',      PostHiding],\r\n    ['Recursive',                 Recursive],\r\n    ['Strike-through Quotes',     QuoteStrikeThrough],\r\n    ['Quick Reply Personas',      QR.persona],\r\n    ['Quick Reply',               QR],\r\n    ['Cooldown',                  QR.cooldown],\r\n    ['Post Jumper',               PostJumper],\r\n    ['Pass Link',                 PassLink],\r\n    ['Menu',                      Menu],\r\n    ['Index Generator (Menu)',    Index.menu],\r\n    ['Report Link',               ReportLink],\r\n    ['Copy Text Link',            CopyTextLink],\r\n    ['Thread Hiding (Menu)',      ThreadHiding.menu],\r\n    ['Reply Hiding (Menu)',       PostHiding.menu],\r\n    ['Delete Link',               DeleteLink],\r\n    ['Filter (Menu)',             Filter.menu],\r\n    ['Edit Link',                 QR.oekaki.menu],\r\n    ['Download Link',             DownloadLink],\r\n    ['Archive Link',              ArchiveLink],\r\n    ['Quote Inlining',            QuoteInline],\r\n    ['Quote Previewing',          QuotePreview],\r\n    ['Quote Backlinks',           QuoteBacklink],\r\n    ['Mark Quotes of You',        QuoteYou],\r\n    ['Mark OP Quotes',            QuoteOP],\r\n    ['Mark Cross-thread Quotes',  QuoteCT],\r\n    ['Anonymize',                 Anonymize],\r\n    ['Time Formatting',           Time],\r\n    ['Relative Post Dates',       RelativeDates],\r\n    ['File Info Formatting',      FileInfo],\r\n    ['Fappe Tyme',                FappeTyme],\r\n    ['Gallery',                   Gallery],\r\n    ['Gallery (menu)',            Gallery.menu],\r\n    ['Sauce',                     Sauce],\r\n    ['Image Expansion',           ImageExpand],\r\n    ['Image Expansion (Menu)',    ImageExpand.menu],\r\n    ['Reveal Spoiler Thumbnails', RevealSpoilers],\r\n    ['Image Loading',             ImageLoader],\r\n    ['Image Hover',               ImageHover],\r\n    ['Volume Control',            Volume],\r\n    ['WEBM Metadata',             Metadata],\r\n    ['Comment Expansion',         ExpandComment],\r\n    ['Thread Expansion',          ExpandThread],\r\n    ['Favicon',                   Favicon],\r\n    ['Unread',                    Unread],\r\n    ['Unread Line in Index',      UnreadIndex],\r\n    ['Quote Threading',           QuoteThreading],\r\n    ['Thread Stats',              ThreadStats],\r\n    ['Thread Updater',            ThreadUpdater],\r\n    ['Thread Watcher',            ThreadWatcher],\r\n    ['Thread Watcher (Menu)',     ThreadWatcher.menu],\r\n    ['Mark New IPs',              MarkNewIPs],\r\n    ['Index Navigation',          Nav],\r\n    ['Keybinds',                  Keybinds],\r\n    ['Banner',                    Banner],\r\n    ['Announcements',             PSA],\r\n    ['Flash Features',            Flash],\r\n    ['Reply Pruning',             ReplyPruning],\r\n    ['Mod Contact Links',         ModContact],\r\n    ['Restore deleted posts from archive', RestoreDeletedFromArchive],\r\n  ]\r\n};\r\nexport default Main;\r\n$.ready(() => Main.init());\r\n\r\n// <% if (readJSON('/.tests_enabled')) { %>\r\n// Main.features.push(['Build Test', Test]);\r\n// <% } %>\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Get from \"../General/Get\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst QuoteStrikeThrough = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) ||\r\n      (!Conf['Reply Hiding Buttons'] && (!Conf['Menu'] || !Conf['Reply Hiding Link']) && !Conf['Filter'])) { return; }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Strike-through Quotes',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) { return; }\r\n    for (var quotelink of this.nodes.quotelinks) {\r\n      var {boardID, postID} = Get.postDataFromLink(quotelink);\r\n      if (g.posts.get(`${boardID}.${postID}`)?.isHidden) {\r\n        $.addClass(quotelink, 'filtered');\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default QuoteStrikeThrough;\r\n"],"names":["Conf","Object","create","g","VERSION","version","VERSION_DATE","Date","NAMESPACE","meta","name","sites","boards","E","str","regex","fn","x","output","text","toString","replace","cat","templates","html","i","length","innerHTML","d","document","doc","documentElement","c","console","docSet","Callbacks","static","this","Post","Thread","CatalogThread","CatalogThreadNative","constructor","type","keys","push","cb","execute","node","force","errors","callbacksExecuted","call","err","message","ID","board","join","error","nodes","root","outerHTML","Main","handleErrors","initClass","Config","main","Miscellaneous","Keybinds","Linkification","Linkify","Embedding","Filtering","Anonymize","Filter","Stubs","Gallery","Sauce","Autoplay","Menu","Monitoring","Cooldown","imageExpansion","gallery","threadWatcher","filter","general","postID","uniqueID","tripcode","capcode","pass","email","subject","comment","flag","filename","dimensions","filesize","MD5","sauces","FappeT","werk","Index","Header","archives","archiveLists","lastarchivecheck","archiveAutoUpdate","externalCatalogURLs","boardnav","faq","QR","sjisPreview","jsWhitelist","captchaLanguage","time","timeLocale","backlink","pastedname","fileInfo","favicon","usercss","hotkeys","Close","Watch","Update","Pause","Slideshow","fappeTyme","werkTyme","Hide","updater","checkbox","Beep","Interval","customCooldown","customCooldownEnabled","position","fourchanImageHost","hiddenPSAList","knownBanners","passMessageClosed","PSAseen","Favicon","init","$","asap","head","el","initAsap","set","status","href","add","isSFW","test","default","switch","items","ferongr","Mayhem","Original","Metro","getOwn","f","unreadDead","unreadDeadY","unreadSFW","unreadSFWY","unreadNSFW","unreadNSFWY","update","unread","unreadY","SFW","NSFW","dead","logo","$$","selector","body","Array","from","querySelectorAll","CaptchaReplace","SITE","software","cookie","indexOf","jsEnabled","ready","noscript","trim","includes","location","hostname","onExists","iframe","original","toggle","parentNode","span","id","rm","insert","textContent","on","lang","src","encodeURIComponent","CaptchaT","isEnabled","className","addClass","after","com","moreNeeded","getThread","threadID","boardID","BOARD","posts","thread","setup","focus","container","prepend","currentThread","global","querySelector","window","TCaptcha","setErrorCb","dispatchEvent","CustomEvent","detail","content","destroy","updateThread","newThread","getOne","response","key","value","setUsed","clearChallenge","occupied","debounce","wait","lastCall","timeout","that","args","exec","now","apply","arguments","clearTimeout","setTimeout","dict","clone","obj","arr","end","map","val","json","JSON","parse","SECOND","MINUTE","HOUR","DAY","platform","GM_xmlhttpRequest","DataBoard","sync","dontClean","changes","onSync","bind","initData","clean","off","data","lastChecked","save","change","get","needSync","forceSync","delete","siteID","deleteIfEmpty","setUnsafe","undefined","base","extend","oldVal","defaultValue","subVal","setLastChecked","middle","ajaxClean","threadsList","urls","threadsListJSON","cache","archiveList","archiveListJSON","ajaxCleanParse","response1","archivedBoardsKnown","response2","threads","page","no","SimpleDict","compare","lastKey","keyString","indexOfNext","findIndex","k","splice","insertAt","index","forEach","last","fullID","isDead","isHidden","isSticky","isClosed","isArchived","postLimit","fileLimit","lastPost","ipCount","OP","catalogView","setPage","pageNum","icon","info","reply","previousSibling","tn","title","pageCount","setCount","count","reachedLimit","rmClass","setStatus","setIcon","typeLC","toLowerCase","icons","Build","staticPath","gifIcon","alt","style","cssText","quote","cloneNode","kill","collect","n","post","clones","thumb","postCount","fileCount","replies","currentMenu","lastToggledButton","setPosition","close","keybinds","onFocus","addEntry","open","entries","makeMenu","menu","tabIndex","dataset","e","stopPropagation","button","preventDefault","previousButton","entry","sort","first","second","order","insertEntry","mRect","getBoundingClientRect","bRect","scrollY","top","scrollX","left","cHeight","clientHeight","cWidth","clientWidth","bottom","height","right","width","classList","parent","submenu","subEntries","subEntry","findNextEntry","direction","children","next","keyCode","click","firstElementChild","nextPrev","target","focused","sRect","eRect","parseEntry","dragstart","isTouching","changedTouches","rect","screenHeight","screenWidth","o","dx","clientX","dy","clientY","topBorder","bottomBorder","bar","identifier","move","touchmove","up","touchend","drag","dragend","touch","hoverstart","latestEvent","endEvents","noRemove","isImage","nodeName","hover","hoverend","MutationObserver","observe","childList","workaround","contains","padding","offsetHeight","offsetWidth","Math","max","min","threshold","marginX","UI","dialog","properties","child","tagName","checked","label","input","Nav","VIEW","prev","append","scrollTo","scroll","scrollHeight","THREADID","hasClass","threadRoot","selectors","Get","threadFromRoot","stub","getTopOf","delta","activeElement","blur","axis","xpath","extra","marginBottom","haveExtra","removeExtra","ImageHost","useFaster","suggestions","host","flashHost","thumbHost","isClone","file","url","split","link","thumbLink","fixLinks","links","pathname","Volume","inputs","unmute","volume","noAudio","catalogNode","unmuteEntry","volumeEntry","video","muted","files","isVideo","wheel","shiftKey","altKey","ctrlKey","metaKey","hasAudio","deltaY","minmax","ImageCommon","pause","rewind","readyState","HAVE_METADATA","currentTime","queueTask","pushCache","cacheError","popCache","decodeError","fileObj","code","MediaError","MEDIA_ERR_DECODE","isFromArchive","delay","timeoutID","Redirect","to","securityCheck","redirect","threadJSON","parseJSON","isArchiveURL","needle","postObj","archivedThreadJSON","ajax","onloadend","docIndex","filesDeleted","addControls","handler","t","getTime","engine","duration","controls","onControls","download","protocol","CrossOrigin","blob","a","URL","createObjectURL","hidden","Notice","Audio","setupSync","audio","addEventListener","play","playbackRate","once","setupAudioSlider","createElement","appendChild","createTextNode","control","step","valueAsNumber","downloadLink","ImageExpand","enabled","EAI","toggleAll","addShortcut","playVideos","videoControls","isExpanding","contract","expand","isExpanded","fullImage","setupVideoCB","setupVideo","origin","paused","wasPlaying","isFetchedQuote","isSpoiler","modifiedClick","postFromNode","func","event","setProperty","visible","isNodeVisible","setFitness","scrollIntoView","oldHeight","scrollBy","scrollToIfNeeded","eventName","videoCB","remove","audioSlider","fileID","removeAttribute","loop","completeExpand","naturalHeight","soundUrlMatch","match","decodeURIComponent","startsWith","audioEl","parentElement","autoplay","imageBottom","getBottomOf","playing","mousedown","mouseover","mouseup","mouseout","buttons","createSubEntry","conf","desc","flags","context","isReply","parseNodes","flagCode","toUpperCase","flagCodeTroll","date","parseDate","nameBlock","parseComment","parseQuotes","parseFiles","isRebuilt","s","infoRoot","isOPContainerThread","opBottom","quotelinks","archivelinks","embedlinks","backlinks","getElementsByClassName","uniqueIDRoot","bq","normalize","commentClean","cleanComment","nodesToText","commentDisplay","cleanSpoilers","cleanCommentDisplay","commentOrig","insertTags","X","snapshotItem","spoilers","spoiler","quotelink","quotes","parseQuote","regexp","fileRoots","fileRoot","parseFile","multifile","roots","size","unit","sizeInBytes","strong","allQuotelinksLinkingTo","deadMark","markAsFromArchive","resurrect","some","addClone","contractThumb","PostClone","rmClone","slice","setCatalogOP","isCatalogOP","super","cloneWithoutVideo","suffix","inline","inlined","originFile","videoThumb","md5","nodeType","Node","ELEMENT_NODE","childNodes","makeButton","Recursive","recursives","recursive","PostHiding","db","sa","thisPost","hide","makeStub","hideRecursively","sideArrows","firstChild","div","show","hideStubLink","hideStub","saveHiddenState","isHiding","showRecursively","RelativeDates","INTERVAL","flush","dateEl","relative","diff","abbrev","number","years","getFullYear","months","getMonth","days","getDate","rounded","round","stale","isPost","utc","singlePost","concat","setOwnTimeout","markStale","Element","BoardConfig","cbs","load","statusText","config","sfwBoards","sfw","result","object","ws_board","domain","is_archived","webm_audio","Board","cooldowns","c2","image","images","thread_global","ceil","PostRedirect","delays","ExpandComment","callbacks","longComment","shortComment","req","spoilerRange","custom_spoiler","getAttribute","callback","QuoteYou","mark","isYou","postDataFromLink","quoter","seek","highlighted","highlight","classes","lastRead","snapshotLength","postFromRoot","sel","postContainer","highlightable","matches","RandomAccessList","item","before","rmi","shift","Unread","hr","Set","postsQuotingYou","addPost","lastReadPost","readCount","one","onUpdate","resetLink","reset","setLine","read","positionPrev","hash","updatePosition","postIDs","addPostQuotingYou","openNotification","predicate","areNotificationsEnabled","notif","Notification","onclick","onshow","readSinglePost","has","saveLastReadPost","oldPosition","linePosition","nextSibling","countQuotingYou","titleQuotingYou","titleCount","titleDead","saveThreadWatcherCount","quotingYou","ThreadWatcher","ExpandThread","statuses","onIndexRefresh","setButton","summaryText","cursor","cbToggle","disconnect","refresh","oldReq","abort","threadFromNode","cbToggleBottom","numReplies","replyOriginal","postsCount","filesCount","postsRoot","postData","postFromObject","callbackNodes","a2","UnreadIndex","markReadLink","onPostsInserted","isCatalog","threadIDs","wasVisible","divider","repliesShown","repliesRead","firstUnread","summary","hasUnread","markRead","threadDivider","sc","shortcut","dbLM","list","lastElementChild","refreshButton","closeButton","unreaddb","unreadEnabled","toggleWatcher","buttonFetchAll","addHeaderMenuEntry","addDialog","onIndexUpdate","onThreadRefresh","initLastModified","fetchAuto","isWatched","isWatchedRaw","setToggler","toggler","excerpt","threadExcerpt","isThisPageLegit","build","toggleClass","openAll","openUnread","openDeads","pruneDeads","getAll","dismiss","addRaw","nKilled","fetchStatus","requests","fetched","fetch","lastModified","whenModified","finished","clearRequests","syncing","lm","interval","hasFocus","fetchAllStatus","dbs","dbi","middle1","deep","lastChecked2","fetchBoard","modified","site","urlF","threadModTimeIgnoresSage","parseBoard","lmDate","getResponseHeader","pageLength","nThreads","oldest","last_modified","lastPage","isPrunedByAge","newData","parseStatus","archived","youOP","quotesYou","quotelinkHTML","lastIndex","archiveURL","mayLackJSON","groupByBoard","all","cont","makeLine","prefixes","setPrefixes","len","prefix","conflicts","conflicts2","siteID2","rmAll","refreshIcon","deferred","line","newLine","set404","oldData","addMenuEntries","entryEl","addCheckbox","disabled","isEscaped","Symbol","voidElements","hFragment","h","tag","attributes","attribute","isVoid","TypeError","parseArchivePost","Fetcher","archiveTags","greentext","text2","j","num","thread_num","shortname","fileDeleted","trip","poster_hash","poster_country","troll_country_code","poster_country_name","troll_country_name","dateUTC","timestamp","dateText","fourchan_date","commentHTML","media","banned","media_filename","thumb_link","media_link","media_orig","media_h","media_w","media_hash","bytesToString","media_size","thumbURL","preview_orig","theight","preview_h","twidth","preview_w","exif","Tag","ReplyPruning","frag","setEnabled","hiddenFiles","total","totalFiles","other","QuoteThreading","active","showIfHidden","updateCount","newPosts","boardTop","hidden1","hidden2","oldPos","lastChild","threadNewLink","rethread","setThread","inserted","lastID","toggleThreading","setThreadingState","navLinksBot","retroactive","backLink","shouldReThread","parents","lastParent","ancestor","descendants","threadContainer","prev2","rethreadQueued","Promise","resolve","then","replyData","isCached","fetchedPost","archivedPost","flagCSS","cssVersion","rel","api","cleanCache","archive","encryptionOK","parseArchivedPost","postIdNr","newPostIndex","insertAdjacentElement","QuotePreview","qp","pop","showHiddenThreads","changed","enabledOn","initFinished","postsInserted","search","history","state","searched","mode","currentSort","currentPage","getCurrentPage","processHash","popstate","resort","watchSettings","sortEntry","select","perBoardSort","navLinks","CatalogLinks","catalog","refreshFront","searchInput","setupSearch","onSearchInput","clearSearch","hideLabel","toggleHiddenThreads","selectRev","selectMode","selectSort","selectSize","lastLongOptions","lastLongInputs","lastLongThresholds","tRaw","hoverToggle","pagelist","pageNav","hat","addStyle","loaded","implementation","createDocument","topNavPos","previousElementSibling","timeEl","liveThreadData","innerHeight","pagesNum","endNotice","threadsOnPage","buildStructure","notify","toggleHide","threadPosition","floor","threadsNumPerPage","ThreadHiding","cycleSortType","types","options","option","selected","initFinishedFired","indexRefreshSeen","buildIndex","pushState","pageLoad","saveSort","saveLastLongThresholds","Number","isFinite","catalogReplies","hoverAdjust","setState","nCommands","userPageNav","buildCatalogReplies","scrollToIndex","hashCommands","paged","infinite","commands","leftover","command","pageBeforeSearch","oldpage","savePerBoard","buildPagelist","setupMode","setupSort","getPagesNum","sortedThreadIDs","getMaxPageNum","pagesRoot","maxPageNum","childElementCount","nextElementSibling","updateHideLabel","hiddenCount","liveThreadIDs","firstTime","notice","nTimeout","catalogJSON","reload","setType","stack","pages","parseThreadList","reduce","liveThreadDict","parsedThreads","results","filterResults","isOnTop","last_replies","isHiddenReply","buildThreads","withReplies","newThreads","opRoot","threadData","stringify","bumplimit","ext","imagelimit","sticky","closed","buildReplies","lastReplies","buildCatalogViews","catalogThreads","catalogThread","sizeCatalogViews","ratio","catalogReply","tmp_time","sortType","repliesAvailable","lastlong","iterable","r","omitted_posts","lastlongD","b","reverse","querySearch","sortOnTop","topThreads","bottomThreads","buildCatalog","nodesPerPage","offset","node0","buildCatalogPart","searching","query","keywords","RegExp","values","searchMatch","keyword","Index$1","catalogWatch","catalogSet","hasStorage","hiddenThreads","localStorage","setItem","getItem","catalogSave","subtree","attributeFilter","hiddenThreads2","hasOwn","separator","settingsHtml","class","changelog","issues","CSS","report","www","sub","css","variables","words","CustomCSS","rmStyle","SWTinyboard","disabledFeatures","detect","script","m","awaitBoard","boardFor","mounted","op","boardList","boardListBottom","styleSheet","psa","nav","replyContainer","extra_files","parseJSONFile","unescape","bgColoredEl","isFileURL","preParsingFixes","broken","splitText","isNaN","infoNode","nameNode","isThumbExpanded","expanded","isLinkified","catalogPin","passMessagePage","captchaFAQ","PassMessage","msg","PassMessagePage","hd","Report","Captcha","fit","getComputedStyle","visibility","resizeBy","form","fieldset","reason","submit","archiveSubmit","action","archiveResults","formData","success","PostSuccessful","_","SWYotsuba","hasIPCount","areMD5sDeferred","isOnePage","psaTop","searchBox","captcha","doctype","is404","isIncomplete","isBoardlessPage","isAuxiliaryPage","initAuxiliary","navigate","scriptData","parseThreadMetadata","abbr","br","hasCORS","uidColor","uid","charCodeAt","testNativeExtension","Parser","postMenuIcon","transformBoardList","spacer","chr","nodeValue","devicePixelRatio","shortFilename","spoilerThumb","random","sameThread","threadURL","postURL","resto","filedeleted","since4pass","country","board_flag","country_name","flag_name","capcodeHighlight","tim","w","fsize","tn_h","tn_w","hasDownscale","m_img","parseCommentDisplay","html2","capcodeDescription","capcodePlural","capcodeLC","capcodeLong","Admin","Mod","postInfo","postLink","quoteLink","nameHtml","nameBlockContent","postNumContent","generatePostInfoHtml","fileURL","fileThumb","fileBlock","fileContent","loading","generateFileHtml","postClass","wholePost","imgClass","generateCatalogThreadHtml","highlights","SW","tinyboard","yotsuba","FileInfo","quickFilterMD5","oldInfo","format","formatString","outputNode","formatters","T","l","L","N","fullname","p","B","K","M","Time","zeroPad","formatterCache","Map","formatter","Intl","DateTimeFormat","weekday","A","month","H","getHours","I","getMinutes","hour","hour12","formatToParts","find","P","S","getSeconds","y","Y","ThreadUpdater","beep","checkPostCount","timer","updateLink","scrollBG","setInterval","settings","intervalShortcut","outdateCount","fileIDs","checkpost","playBeep","seconds","parseInt","confirmed","limit","cur","Settings","klass","updateThreadStatus","ipCountEl","postObjects","unique_ips","postObject","deletedPosts","deletedFiles","unreadCount","unreadQYCount","firstPost","addSection","sauce","advanced","disableAll","defineProperty","openSection","sectionToOpen","SettingsPage","export","import","onImport","section","sections","hyphenatedTitle","scrollTop","warnings","cantSync","why","cantSet","ads","ad","addWarning","warning","addCheckboxes","containers","description","level","keyFS","fs","perProtocolSettings","hiddenPosts","hiddenNum","removeItem","Conf2","downloadExport","Blob","confirm","reader","FileReader","onload","loadSettings","readAsText","convertFrom","loadletter","prevKey","newKey","convertSettings","uniqueid","mod","openEmptyQR","openQR","openOptions","sageru","sjis","watch","unreadCountTo0","expandAllImages","expandImage","zero","nextPage","previousPage","nextThread","previousThread","expandThread","openThreadTab","openThread","nextReply","previousReply","Scrolling","Verbose","WatchedThreads","upgrade","corrupted","setD","addSauces","addCSS","compareString","padStart","val2","error1","uids","Moe","warosu","fgts","not4plebs","DesuStorage","record","rice","siteProperties","clear","selectFilter","ta","spellcheck","feature","listImageHost","customCSS","applyCSS","togglecss","itemsArchive","selectArchives","addArchiveTable","boardSelect","table","updateArchives","toLocaleString","tbody","archBoards","rows","boardOptions","row","addArchiveCell","td","setAttribute","saveSelectedArchive","selectedArchives","boardid","generateBoardList","img","tr","keybind","FappeTyme","fappe","lc","indicator","check","linkData","parseLink","parts","part","parseBoards","createSauceLink","missing","orig","parameter","skip","skipped","observer","node2","TURL","IMG","sMD5","hMD5","atob","semi","generateThumb","mozRequestFullScreen","webkitRequestFullScreen","ALLOW_KEYBOARD_INPUT","slideshow","frame","thumbs","current","menuButton","blank","start","stop","createSubEntries","postThumb","keydown","setHeight","candidate","overflow","thumbImg","errorCB","elType","webm","mp4","ogv","pdf","oldID","newID","offsetTop","setupTimer","cleanupTimer","startTimer","checkTimer","complete","advance","toggleSlideshow","rotateLeft","rotateRight","rotate","dataRotate","transform","mozCancelFullScreen","webkitExitFullscreen","dim","margin","minHeight","containerWidth","containerHeight","minWidth","maxWidth","maxHeight","setDelay","delayLabel","delayInput","ordered_types","embed","catalogRemove","shouldFetchTitles","service","batchSize","flushTitles","events","services","preview","process","regExp","closeFloat","dragEmbed","lastEmbed","pointerEvents","queue","post2","link2","preload","hrefEsc","videoHeight","counter","prettyPrint","getElementById","currentScript","hasOwnProperty","names","contentWindow","postMessage","element","onMessage","source","hotkey","notifications","toggleBoardList","toggleBarVisibility","postingIsEnabled","qr","notification","display","tags","sage","fileSubmit","toggleCustomCooldown","handleUrl","hl","kc","String","fromCharCode","code_tags","math_tags","sjis_tags","selStart","selectionStart","selEnd","selectionEnd","range","setSelectionRange","isSage","tab","replySelector","postEl","Cache","saveAPI","noCaptcha","captchas","getCount","neededRaw","haveCookie","submitCB","isOnlyQuotes","needed","prerequest","prerequested","cooldown","request","Replace","v2","lifetime","timeouts","prevNeeded","noscriptURL","recaptchaKey","auto","afterSetup","setupNoscript","setupJS","scrolling","textarea","render","widgetID","grecaptcha","sitekey","theme","cbNative","onRecaptchaLoaded","mutations","mutation","addedNodes","setupIFrame","setupTextArea","fixQRPosition","pasted","token","mimeTypes","validExtension","typeFromExtension","jpg","jpeg","png","gif","swf","extensionFromType","initReady","origToggle","captchaVersion","prop","def","min_width","min_height","max_width","max_height","max_size","max_size_video","max_comment","max_width_video","max_height_video","max_duration_video","forcedAnon","forced_anon","linkBot","getFile","drawFile","setFile","paste","dragOver","dropFile","generatePostableThreadsList","statusCheck","unhide","cleanNotifications","inBubble","bubbles","autohide","toggleSJIS","texPreviewShow","texPreviewHide","texPreview","wasOpen","setCustomCooldown","focusOverride","onclose","alert","connectionError","upstreamFaq","progress","openPost","isLocked","getSelection","postRange","Range","selectNode","rangeCount","asc","insideCode","getRangeAt","compareBoundaryPoints","START_TO_START","setStartBefore","END_TO_END","setEndAfter","cloneContents","commonAncestorContainer","wasOnlyQuotes","caretPos","quotedText","characterCount","charCount","openError","getContext","drawImage","revokeObjectURL","handleFiles","dataTransfer","dropEffect","clipboardData","score","file2","kind","getAsFile","score2","pasteFF","pasteArea","bstr","Uint8Array","urlDefault","preventAutoPost","permission","prompt","fileButton","handleFile","nfiles","isText","pasting","openFileInput","fileInput","setNode","flagsInput","sjisToggle","texButton","drawButton","oekaki","draw","noFile","oekakiButton","fileRM","rmFile","urlButton","dumpButton","DataTransferItemList","persona","addFlag","country_flags","board_flags","filetag","forceSave","flashTag","require_subject","text_only","lock","MAX_FILE_SIZE","pwd","getPassword","upfile","responseType","withCredentials","onprogress","upload","isUploadFinished","currentCaptcha","challenge","unlock","connErr","errorCount","addDelay","mi","addMute","h1","lastPostToThread","waitForThread","attempts","deletion","maxDelay","isSetup","isCounting","categorize","secondsDeletion","mergeChange","scope","nCooldowns","elapsed","editFile","canvas","videoWidth","toBlob","snapshot","edit","FCX","oekakiCB","Tegaki","flatten","oekakiLatest","oekakiName","bg","onDone","onCancel","bgColor","removeEventListener","naturalWidth","onOpenImageLoaded","onDoneCb","resume","always","parseItem","draggable","dumpList","dismissErrors","rectEl","rectList","scrollLeft","showFileData","forced","updateComment","saveFilename","updateFilename","setComment","rmErrored","fileError","checkSize","rmMetadata","backgroundImage","readFile","canPlayType","onerror","checkDimensions","setThumbnail","cv","attr","newName","long","pasteText","dragStart","setDragImage","dragEnd","dragEnter","dragLeave","drop","oldIndex","newIndex","eventPageRequest","chrome","runtime","addListener","params","sendMessage","binary","headers","responseHeaderString","fallback","getAllResponseHeaders","gmOptions","method","overrideMimeType","xhr","ArrayBuffer","responseText","responseHeaders","onabort","GM","xmlHttpRequest","contentType","contentDisposition","mime","Request","prototype","headerName","header","gmReq","ontimeout","cbFail","origins","CrossOrigin$1","fc","HTMLFormElement","FormData","fd","pageXHR","wrappedJSObject","XMLHttpRequest","XPCNativeWrapper","testCORB","ajaxPage","setRequestHeader","warn","send","requestID","ajaxPageInit","DOMParser","parseFromString","bucket","url0","reqs","testf","addCSP","policy","httpEquiv","path","evaluate","singleNodeValue","classNames","createDocumentFragment","insertBefore","replaceChild","properties2","globalThis","extension","cloneInto","defaultView","cancelable","navigator","userAgent","GM_info","unsafeConstructors","unsafeWindow","obj2","openInTab","GM_openInTab","taskQueue","execTask","mozHasAudio","webkitAudioDecodedByteCount","luma","rgb","oneItemSugar","oldValue","local","storage","onChanged","area","newValue","crxWorking","getManifest","crxWarningShown","lastError","result2","exceedsQuota","QUOTA_BYTES_PER_ITEM","setArea","setSync","done","deleteValue","BroadcastChannel","GM_addValueChangeListener","GM_deleteValue","getValue","GM_getValue","listValues","GM_listValues","setValue","GM_setValue","key2","remote","onChange","getSync","syncChannel","catch","$$1","IDs","handleQuotes","qPost","Get$1","filters","isstring","excludes","mask","only","noti","filterObj","filtersForType","boardsRaw","parseBoardsMemo","siteFilter","boardID2","hideable","filtersOrMap","isArray","catalogData","catalogParse","catalogViewNative","valueF","v","addFilter","re","removeFilters","res","flat","escape","showFilters","tl","textLength","quickFilterCB","undo","makeFilter","Site","defaultProperties","canonical","parseURL","catalogURL","catalogLink","useCatalog","setLinks","bottomBoardList","tail","indexOptions","externalParse","externalList","external","jsonIndex","nativeCatalog","noticesRoot","setBarPosition","box","barFixedToggler","headerToggler","scrollHeaderToggler","barPositionToggler","linkJustifyToggler","customNavToggler","footerToggler","shortcutToggler","editCustomNav","menuToggle","toggleBarFixed","toggleBarPosition","toggleHideBarOnScroll","toggleLinkJustify","toggleFooterVisibility","toggleShortcutIcons","toggleCustomNav","setBarFixed","setHideBarOnScroll","setBarVisibility","setLinkJustify","setShortcutIcons","setFooterVisibility","createNotification","setBoardList","generateFullBoardList","footer","absbot","cloneTopNav","cs","enableDesktopNotifications","shortcuts","btn","setCustomNav","fullBoardList","mapCustomNavigation","m0","m1","m2","urlV","urlIC","custom","full","showBoardList","centered","fixed","hideBarOnScroll","offsetY","pageYOffset","previousOffset","cust","down","offsetParent","headRect","rmShortcut","authorize","disable","requestPermission","Header$1","opacity","responses","nloaded","fail","archiveUIDs","dest","Developer","Verified","https","reports","alternative","Redirect$1","ImageHover","scale","ImageLoader","prefetchEnabled","prefetchAll","replaceVideo","prefetch","poster","isPrefetched","qpClone","Metadata","readInt","RevealSpoilers","regString","space","saved","endNode","word","part1","part2","makeRange","makeLink","startNode","startOffset","endOffset","createRange","setStart","setEnd","encodedDomain","startContainer","charAt","endContainer","extractContents","insertNode","ArchiveLink","typeParam","isSearch","CopyTextLink","copy","execCommand","DeleteLink","fileEl","postEntry","linkText","fileEntry","menuText","fileOnly","onlyimgdel","resDoc","DownloadLink","ReportLink","dims","AntiAutoplay","processVideo","Banner","banner","setTitle","bannerCnt","choices","contentEditable","Flash","SWFEmbed","tid","Fourchan","initBoard","pre","prettyPrintOne","MathJax","Hub","Queue","loadMathJax","math","clickable_ids","idClick","wbrs","wbr","IDColor","ids","compute","color","backgroundColor","IDHighlight","IDPostCount","ModContact","moved","specific","template","moveNote","Manager","qa","NormalizeURL","replaceState","PostJumper","makeButtons","addListeners","addButtons","buttonClick","toJumper","dir","jumper","jumper2","fromJumper","prevPos","destPos","PSA","announcement","PSAHiding","RemoveSpoilers","unspoiler","ThreadLinks","Tinyboard","ajaxComplete","responseJSON","noko","originalNoko","tb_settings","always_noko_replies","MarkNewIPs","markNew","markOld","ThreadStats","postIndex","statsHTML","statsTitle","showPurgePos","postCountEl","fileCountEl","pageCountEl","fetchPage","showPage","onThreadsLoad","purgePos","lastPageUpdate","retry","PassLink","styleSelector","passLink","QuoteInline","qiQuote","findRoot","isBacklink","qroot","forwarded","QuoteBacklink","bottomBacklinks","firstNode","secondNode","markYours","getContainer","backlinkContainer","QuoteCT","QuoteOP","Quotify","parseArchivelink","deadlink","parseDeadlink","fixDeadlink","quoteID","fetchable","green","Polyfill","mozMatchesSelector","webkitMatchesSelector","HTMLCanvasElement","encoderOptions","toDataURL","ui8a","RestoreDeletedFromArchive","restore","nrRestored","archivePosts","raw","newPost","menuEntry","frameElement","buildDate","freeze","writable","expectInitFinished","mountedCB","isMounted","mountedCBs","error2","fromCharCode0","Error","boardTitle","previousversion","isFirstRun","initFeatures","threadArchived","initStyle","features","mobileLink","innerWidth","bgColorStyle","keyboard","setClass","mainStyleSheet","styleSheets","knownStyles","setStyle","backgroundRepeat","backgroundPosition","initCatalog","initThread","addThreadsObserver","addThreads","addPostsObserver","addPosts","parseThreads","callbackNodesDB","threadRoots","boardObj","postRoots","unshift","parsePosts","postRoot","records","threadsRM","anyRemoved","removedNodes","addCatalogThreadsObserver","addCatalogThreads","parseCatalogThreads","softTask","parseError","reportLink","logs","lines","fork","details","addDetails","newIssueMaxLength","newIssue","scriptHandler","thisPageIsLegit","Main$1"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;yRAwCO,MAAMA,EAAOC,OAAOC,OAAO,MAErBC,EAcT,CACFC,QAAWC,EACXC,aAAc,IAAIC,KAAKF,GACvBG,UAAWC,EAAKC,KAChBC,MAAWV,OAAOC,OAAO,MACzBU,OAAWX,OAAOC,OAAO,OAGdW,EAAI,WACf,MAAMC,EAAM,CACV,IAAK,QACL,IAAK,SACL,IAAK,SACL,IAAK,OACL,IAAK,QAEDC,EAAQ,WACRC,EAAK,SAAUC,GACnB,OAAOH,EAAIG,EACb,EACMC,EAAS,SAAUC,GACvB,OAAOA,EAAKC,WAAWC,QAAQN,EAAOC,EACxC,EAQA,OAPAE,EAAOI,IAAM,SAAUC,GACrB,IAAIC,EAAO,GACX,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAUG,OAAQD,IACpCD,GAAQD,EAAUE,GAAGE,UAEvB,OAAOH,CACT,EACON,CACR,CAvBgB,GAyBJU,EAAIC,SACJC,EAAMF,EAAEG,gBAERC,EAAIC,QAEJC,EAAS,WAEpB,OAAOJ,CACT,ECzFe,MAAMK,EACnBC,mBACEC,KAAKC,KAAgB,IAAIH,EAAU,QACnCE,KAAKE,OAAgB,IAAIJ,EAAU,UACnCE,KAAKG,cAAgB,IAAIL,EAAU,kBACnCE,KAAKI,oBAAsB,IAAIN,EAAU,iBAC1C,CAEDO,YAAYC,GACVN,KAAKM,KAAOA,EACZN,KAAKO,KAAO,EACb,CAEDC,MAAKnC,KAACA,EAAIoC,GAAEA;AAEV,OADKT,KAAK3B,IAAS2B,KAAKO,KAAKC,KAAKnC,GAC3B2B,KAAK3B,GAAQoC,CACrB,CAEDC,QAAQC,EAAMJ,EAAKP,KAAKO,KAAMK,GAAM,GAClC,IAAIC,EACJ,IAAIF,EAAKG,mBAAsBF,EAA/B,CAEA,IAAK,IAAIvC,KADTsC,EAAKG,mBAAoB,EACRP,GACf,IACEP,KAAK3B,IAAO0C,KAAKJ,EAClB,CAAC,MAAOK,GACFH,IAAUA,EAAS,IACxBA,EAAOL,KAAK,CACVS,QAAS,CAAC,IAAK5C,EAAM,qBAAsB2B,KAAKM,KAAM,OAAQK,EAAKO,GAAI,KAAMP,EAAKQ,MAAO,MAAMC,KAAK,IACpGC,MAAOL,EACP7B,KAAMwB,EAAKW,OAAOC,MAAMC,WAE3B,CAGH,OAAIX,EAAiBY,GAAKC,aAAab,QAAvC,CAfiD,CAgBlD,EAEHf,EAAU6B,YC1CV,MAAMC,EAAS,CACbC,KAAM,CACJC,cAAiB,CACf,oBAAqB,EACnB,EACA,2CAEF,aAAc,EACZ,EACA,oHAEF,CAAC,OAAO1D,EAAKC,gBAAiB,EAC5B,EACA,WAAWD,EAAKC,kDAChB,GAEF,8BAA+B,EAC7B,EACA,oEACA,GAEF,gBAAiB,EACf,EACA,6DAEF,0BAA2B,EACzB,EACA,wCAAwCD,EAAKC;AAE/C,mBAAoB,EAClB,EACA,yDAEF,gBAAiB,EACf,EACA,+FAEF,sBAAuB,EACrB,EACA,2CAEF,wBAAyB,EACvB,EACA,gDAAgDD,EAAKC,kBAEvD,eAAgB,EACd,EACA,qDAEF,iBAAkB,EAChB,EACA,iDAEF,kCAAmC,EACjC,EACA,mGAEF0D,SAAY,EACV,EACA,uCAEF,kBAAmB,EACjB,EACA,mCAEF,sBAAuB,EACrB,EACA,oEAEF,sBAAuB,EACrB,EACA,yDACA;AAEF,oBAAqB,EACnB,EACA,8FAEF,uBAAwB,EACtB,EACA,kCAEF,mBAAoB,EAClB,EACA,kCAEF,mBAAoB,EAClB,EACA,4CAEF,mBAAoB,EAClB,EACA,sDAEF,mCAAoC,EAClC,EACA,0EAEF,sBAAuB,EACrB,EACA,0EAEF,iCAAkC,EAChC,EACA,oFACA,GAEF,6BAA8B,EAC5B,EACA,2BAA2B3D,EAAKC,iCAElC,iBAAkB,EAChB,EACA,4DAEF,oBAAqB,EACnB,EACA;AAEF,kBAAmB,EACjB,EACA,gCAEF,kBAAmB,EACjB,EACA,mHAEF,gBAAiB,EACf,EACA,2GAEF,uBAAwB,EACtB,EACA,2DAEF,6BAA8B,EAC5B,EACA,gDAEF,2BAA4B,EAC1B,EACA,GAAGD,EAAKC,2DAEV,gCAAiC,EAC/B,EACA,yFAIJ2D,cAAiB,CACfC,QAAW,EACT,EACA,6CAEF,aAAc,EACZ,EACA,8DACA;AAEF,4BAA6B,EAC3B,EACA,4RAGA,GAEF,gBAAiB,EACf,EACA,4CACA,GAEFC,UAAa,EACX,EACA,qEACA,GAEF,aAAc,EACZ,EACA,6BACA,GAEF,kBAAmB,EACjB,EACA,4EACA,IAIJC,UAAa,CACXC,UAAa,EACX,EACA,4BAEFC,OAAU,EACR,EACA,4BAEF,qBAAsB,EACpB,EACA,kHACA,GAEF,2BAA4B,EAC1B,EACA,2CACA;AAEF,iCAAkC,EAChC,EACA,2EACA,GAEF,mBAAoB,EAClB,EACA,8CAEF,wBAAyB,EACvB,EACA,uCAEF,uBAAwB,EACtB,EACA,uCAEFC,MAAS,EACP,EACA,4CAIJ,oBAAqB,CACnB,kBAAmB,EACjB,EACA,2BAEF,cAAe,EACb,EACA,yCAEF,yBAA0B,EACxB,EACA,2CAA2ClE,EAAKC,iBAElDkE,QAAW,EACT,EACA,+EAEF,qBAAsB,EACpB,EACA,mCACA,GAEF,iBAAkB,EAChB,EACA,6BACA,GAEFC,MAAS,EACP,EACA,8BAEF,gBAAiB,EACf,EACA,sDAEF,4BAA6B,EAC3B,EACA;AAEF,cAAe,EACb,EACA,iDAEF,cAAe,EACb,EACA,iDAEF,cAAe,EACb,EACA,iDAEF,eAAgB,EACd,EACA,6GAEF,oBAAqB,EACnB,EACA,kEAEF,aAAc,EACZ,EACA,6EAEF,YAAa,EACX,EACA,0DAEFC,SAAY,EACV,EACA,iDAEF,sBAAuB,EACrB,EACA,8DAEF,gBAAiB,EACf,EACA,4CAEF,oBAAqB,EACnB,EACA,yHACA;AAEF,cAAe,EACb,EACA,uCAEF,qBAAsB,EACpB,EACA,qFAEF,kBAAmB,EACjB,EACA,yCAEF,oBAAqB,EACnB,EACA,SAASrE,EAAKC,qEAEhB,qBAAsB,EACpB,EACA,6FAIJqE,KAAQ,CACNA,KAAQ,EACN,EACA,kCAEF,cAAe,EACb,EACA,iCACA,GAEF,iBAAkB,EAChB,EACA,sCACA,GAEF,qBAAsB,EACpB,EACA,qCACA,GAEF,oBAAqB,EACnB,EACA,qCACA,GAEF,cAAe,EACb,EACA,iDACA,GAEF,eAAgB,EACd,EACA,mCACA,GAEF,YAAa,EACX,EACA,wFACA;AAEF,gBAAiB,EACf,EACA,0DACA,IAIJC,WAAc,CACZ,iBAAkB,EAChB,EACA,6FAEF,eAAgB,EACd,EACA,iDAEF,eAAgB,EACd,EACA,uDACA,GAEF,2BAA4B,EAC1B,EACA,kEACA,GAEF,iBAAkB,EAChB,EACA,yDAEF,cAAe,EACb,EACA,2DAEF,0BAA2B,EACzB,EACA,4DAEF,2BAA4B,EAC1B,EACA,6DACA,GAEF,uBAAwB,EACtB,EACA,qEACA,GAEF,wBAAyB,EACvB,EACA;AAEF,eAAgB,EACd,EACA,kCAEF,oBAAqB,EACnB,EACA,mDACA,GAEF,sBAAuB,EACrB,EACA,8CACA,GAEF,8BAA+B,EAC7B,EACA,sFAEF,iBAAkB,EAChB,EACA,kEAEF,uBAAwB,EACtB,EACA,iDACA,GAEF,4BAA6B,EAC3B,EACA,8DACA,GAEF,eAAgB,EACd,EACA,qEAEF,gBAAiB,EACf,EACA,oGAEF,oBAAqB,EACnB,EACA,oDACA,IAIJ,uBAAwB,CACtB,cAAe,EACb,EACA;AAEF,gBAAiB,EACf,EACA,iDACA,GAEF,eAAgB,EACd,EACA,mDACA,GAEF,uBAAwB,EACtB,EACA,oGACA,GAEF,mBAAoB,EAClB,EACA,wCACA,GAEF,mBAAoB,EAClB,EACA,kEACA,GAEF,qBAAsB,EACpB,EACA,gFACA,GAEF,oCAAqC,EACnC,EACA,yEACA,GAEF,uBAAwB,EACtB,EACA,iEACA,GAEFC,SAAY,EACV,EACA,oDACA,GAEF,gCAAiC,EAC/B,EACA,oEACA;AAEF,oBAAqB,EACnB,EACA,uEACA,GAEF,6BAA8B,EAC5B,EACA,6DACA,GAEF,yBAA0B,EACxB,EACA,0EAEF,YAAa,EACX,EACA,2DAIJ,cAAe,CACb,kBAAmB,EACjB,EACA,wBAEF,eAAgB,EACd,EACA,2BACA,GAEF,mBAAoB,EAClB,EACA,0CACA,GAEF,i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"}