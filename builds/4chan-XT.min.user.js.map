{"version":3,"file":"4chan-XT.min.user.js","sources":["../../../../src/globals/globals.ts","../src/classes/Callbacks.js","../src/config/Config.js","../src/Monitoring/Favicon.js","../src/platform/$$.js","../src/Posting/Captcha.replace.js","../src/Posting/Captcha.t.js","../../../../src/platform/helpers.ts","../src/classes/DataBoard.js","../../../../src/classes/SimpleDict.ts","../../../../src/classes/Thread.ts","../src/classes/CatalogThread.js","../src/General/UI.js","../src/Miscellaneous/Nav.js","../src/Images/ImageHost.js","../src/Images/Volume.js","../src/Images/ImageCommon.js","../../../../src/Images/Audio.ts","../../../../src/Images/ImageExpand.ts","../../../../src/classes/Post.ts","../src/Menu/Menu.js","../src/Filtering/Recursive.js","../src/Filtering/PostHiding.js","../src/Miscellaneous/RelativeDates.js","../src/General/BoardConfig.js","../../../../src/classes/Board.ts","../src/Posting/PostRedirect.js","../src/Miscellaneous/ExpandComment.js","../src/Quotelinks/QuoteYou.js","../src/classes/RandomAccessList.js","../src/Monitoring/Unread.js","../src/Miscellaneous/ExpandThread.js","../src/Monitoring/UnreadIndex.js","../src/Monitoring/ThreadWatcher.js","../../../../src/globals/jsx.ts","../../../../src/Archive/Parse.ts","../../../../src/classes/Fetcher.ts","../src/Quotelinks/QuotePreview.js","../src/General/Index.js","../src/Filtering/ThreadHiding.js","../../../../src/General/Settings/SettingsHtml.tsx","../../../../src/css/style.ts","../../../../src/css/CSS.ts","../src/Miscellaneous/CustomCSS.js","../src/site/SW.tinyboard.js","../../../../src/Miscellaneous/PassMessage/PassMessageHtml.tsx","../src/Miscellaneous/PassMessage.js","../src/Miscellaneous/Report.js","../src/Posting/PostSuccessful.js","../../../../src/site/SW.yotsuba.tsx","../../../../src/site/SW.yotsuba.Build/PostInfoHtml.tsx","../../../../src/site/SW.yotsuba.Build/FileHtml.tsx","../../../../src/site/SW.yotsuba.Build/CatalogThreadHtml.tsx","../src/site/SW.js","../../../../src/Miscellaneous/FileInfo.tsx","../../../../src/Miscellaneous/Time.ts","../src/Monitoring/ReplyPruning.js","../src/Quotelinks/QuoteThreading.js","../../../../src/Monitoring/ThreadUpdater.ts","../../../../src/General/Settings.tsx","../src/Images/FappeTyme.js","../src/Images/Sauce.js","../src/Images/Gallery.js","../src/Linkification/Embedding.js","../src/Miscellaneous/Keybinds.js","../src/Posting/Captcha.js","../src/Posting/QR.js","../src/platform/CrossOrigin.js","../../../../src/platform/$.ts","../src/General/Get.js","../../../../src/Filtering/Filter.ts","../src/site/Site.js","../src/Miscellaneous/CatalogLinks.js","../../../../src/General/Header.ts","../src/classes/Notice.js","../../../../src/Archive/Redirect.ts","../src/classes/CatalogThreadNative.js","../src/Filtering/Anonymize.js","../src/Images/ImageHover.js","../src/Images/ImageLoader.js","../src/Images/Metadata.js","../src/Images/RevealSpoilers.js","../src/Linkification/Linkify.js","../src/Menu/ArchiveLink.js","../src/Menu/CopyTextLink.js","../src/Menu/DeleteLink.js","../src/Menu/DownloadLink.js","../src/Menu/ReportLink.js","../src/Miscellaneous/AntiAutoplay.js","../src/Miscellaneous/Banner.js","../src/Miscellaneous/Flash.js","../src/Miscellaneous/Fourchan.js","../src/Miscellaneous/IDColor.js","../src/Miscellaneous/IDHighlight.js","../src/Miscellaneous/IDPostCount.js","../src/Miscellaneous/ModContact.js","../src/Miscellaneous/NormalizeURL.js","../src/Miscellaneous/PostJumper.js","../src/Miscellaneous/PSA.js","../src/Miscellaneous/PSAHiding.js","../src/Miscellaneous/RemoveSpoilers.js","../src/Miscellaneous/ThreadLinks.js","../src/Miscellaneous/Tinyboard.js","../src/Monitoring/MarkNewIPs.js","../src/Monitoring/ThreadStats.js","../src/Posting/PassLink.js","../src/Quotelinks/QuoteInline.js","../src/Quotelinks/QuoteBacklink.js","../src/Quotelinks/QuoteCT.js","../src/Quotelinks/QuoteOP.js","../src/Quotelinks/Quotify.js","../src/General/Polyfill.js","../../../../src/Archive/RestoreDeletedFromArchive.ts","../src/main/Main.js","../src/Quotelinks/QuoteStrikeThrough.js"],"sourcesContent":[null,"import Main from \"../main/Main\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS206: Consider reworking classes to avoid initClass\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nexport default class Callbacks {\r\n  static initClass() {\r\n    this.Post          = new Callbacks('Post');\r\n    this.Thread        = new Callbacks('Thread');\r\n    this.CatalogThread = new Callbacks('Catalog Thread');\r\n    this.CatalogThreadNative = new Callbacks('Catalog Thread');\r\n  }\r\n\r\n  constructor(type) {\r\n    this.type = type;\r\n    this.keys = [];\r\n  }\r\n\r\n  push({name, cb}) {\r\n    if (!this[name]) { this.keys.push(name); }\r\n    return this[name] = cb;\r\n  }\r\n\r\n  execute(node, keys=this.keys, force=false) {\r\n    let errors;\r\n    if (node.callbacksExecuted && !force) { return; }\r\n    node.callbacksExecuted = true;\r\n    for (var name of keys) {\r\n      try {\r\n        this[name]?.call(node);\r\n      } catch (err) {\r\n        if (!errors) { errors = []; }\r\n        errors.push({\r\n          message: ['\"', name, '\" crashed on node ', this.type, ' No.', node.ID, ' (', node.board, ').'].join(''),\r\n          error: err,\r\n          html: node.nodes?.root?.outerHTML\r\n        });\r\n      }\r\n    }\r\n\r\n    if (errors) { return Main.handleErrors(errors); }\r\n  }\r\n}\r\nCallbacks.initClass();\r\n","import userCss from './user.css';\r\nimport banners from './banners.json';\r\nimport meta from '../../package.json';\r\n\r\nconst Config = {\r\n  main: {\r\n    'Miscellaneous': {\r\n      'Redirect to HTTPS': [\r\n        true,\r\n        'Redirect to the HTTPS version of 4chan.'\r\n      ],\r\n      'JSON Index': [\r\n        true,\r\n        'Replace the original board index with one supporting searching, sorting, infinite scrolling, and a catalog mode.'\r\n      ],\r\n      [`Use ${meta.name} Catalog`]: [\r\n        true,\r\n        `Link to ${meta.name}'s catalog instead of the native 4chan one.`,\r\n        1\r\n      ],\r\n      'Index Refresh Notifications': [\r\n        false,\r\n        'Show a notice at the top of the page when the index is refreshed.',\r\n        1\r\n      ],\r\n      'Follow Cursor': [\r\n        true,\r\n        'Image Hover and Quote Preview move with the mouse cursor.'\r\n      ],\r\n      'Open Threads in New Tab': [\r\n        false,\r\n        `Make links to threads in the index / ${meta.name} catalog open in a new tab.`\r\n      ],\r\n      'External Catalog': [\r\n        false,\r\n        'Link to external catalog instead of the internal one.'\r\n      ],\r\n      'Catalog Links': [\r\n        false,\r\n        'Add toggle link in header menu to turn Navigation links into links to each board\\'s catalog.'\r\n      ],\r\n      'Announcement Hiding': [\r\n        true,\r\n        'Add button to hide 4chan announcements.'\r\n      ],\r\n      'Desktop Notifications': [\r\n        true,\r\n        `Enables desktop notifications across various ${meta.name} features.`\r\n      ],\r\n      '404 Redirect': [\r\n        true,\r\n        'Redirect dead threads and images to the archives.'\r\n      ],\r\n      'Archive Report': [\r\n        true,\r\n        'Enable reporting posts to supported archives.'\r\n      ],\r\n      'Exempt Archives from Encryption': [\r\n        false,\r\n        'Permit loading content from, and warningless redirects to, HTTP-only archives from HTTPS pages.'\r\n      ],\r\n      'Keybinds': [\r\n        true,\r\n        'Bind actions to keyboard shortcuts.'\r\n      ],\r\n      'Time Formatting': [\r\n        true,\r\n        'Localize and format timestamps.'\r\n      ],\r\n      'Relative Post Dates': [\r\n        true,\r\n        'Display dates like \"3 minutes ago\". Tooltip shows the timestamp.'\r\n      ],\r\n      'Relative Date Title': [\r\n        true,\r\n        'Show Relative Post Date only when hovering over dates.',\r\n        1\r\n      ],\r\n      'Comment Expansion': [\r\n        true,\r\n        'Expand comments that are too long to display on the index. Not applicable with JSON Index.'\r\n      ],\r\n      'File Info Formatting': [\r\n        true,\r\n        'Reformat the file information.'\r\n      ],\r\n      'Thread Expansion': [\r\n        true,\r\n        'Add buttons to expand threads.'\r\n      ],\r\n      'Index Navigation': [\r\n        false,\r\n        'Add buttons to navigate between threads.'\r\n      ],\r\n      'Reply Navigation': [\r\n        false,\r\n        'Add buttons to navigate to top / bottom of thread.'\r\n      ],\r\n      'Unique ID and Capcode Navigation': [\r\n        false,\r\n        'Add buttons to navigate to posts having the same unique ID or capcode.'\r\n      ],\r\n      'Custom Board Titles': [\r\n        true,\r\n        'Allow editing of the board title and subtitle by ctrl/\\u2318+clicking them.'\r\n      ],\r\n      'Persistent Custom Board Titles': [\r\n        false,\r\n        'Force custom board titles to be persistent, even if the board titles are updated.',\r\n        1\r\n      ],\r\n      'Show Updated Notifications': [\r\n        true,\r\n        `Show notifications when ${meta.name} is successfully updated.`\r\n      ],\r\n      'Color User IDs': [\r\n        true,\r\n        'Assign unique colors to user IDs on boards that use them'\r\n      ],\r\n      'Count Posts by ID': [\r\n        true,\r\n        'Display number of posts in the thread when hovering over an ID.'\r\n      ],\r\n      'Remove Spoilers': [\r\n        false,\r\n        'Remove all spoilers in text.'\r\n      ],\r\n      'Reveal Spoilers': [\r\n        false,\r\n        'Indicate spoilers if Remove Spoilers is enabled, or make the text appear hovered if Remove Spoiler is disabled.'\r\n      ],\r\n      'Normalize URL': [\r\n        true,\r\n        'Rewrite the URL of the current page, removing slugs and excess slashes, and changing /res/ to /thread/.'\r\n      ],\r\n      'Work around CORB Bug': [\r\n        true,\r\n        'Leave this checked until your garbage browser is fixed.'\r\n      ],\r\n      'Disable Autoplaying Sounds': [\r\n        false,\r\n        'Prevent sounds on the page from autoplaying.'\r\n      ],\r\n      'Disable Native Extension': [\r\n        true,\r\n        `${meta.name} is NOT designed to work with the native extension.`\r\n      ],\r\n      'Enable Native Flash Embedding': [\r\n        true,\r\n        'Activate the native extension\\'s Flash embedding if the native extension is disabled.'\r\n      ]\r\n    },\r\n\r\n    'Linkification': {\r\n      'Linkify': [\r\n        true,\r\n        'Convert text into links where applicable.'\r\n      ],\r\n      'Link Title': [\r\n        true,\r\n        'Replace the link of a supported site with its actual title.',\r\n        1\r\n      ],\r\n      'Cover Preview': [\r\n        true,\r\n        'Show preview of supported links on hover.',\r\n        1\r\n      ],\r\n      'Embedding': [\r\n        true,\r\n        'Embed supported services. Note: Some services don\\'t work on HTTPS.',\r\n        1\r\n      ],\r\n      'Auto-embed': [\r\n        false,\r\n        'Auto-embed Linkify Embeds.',\r\n        2\r\n      ],\r\n      'Floating Embeds': [\r\n        false,\r\n        'Embed content in a frame that remains in place when the page is scrolled.',\r\n        2\r\n      ]\r\n    },\r\n\r\n    'Filtering': {\r\n      'Anonymize': [\r\n        false,\r\n        'Make everyone Anonymous.'\r\n      ],\r\n      'Filter': [\r\n        true,\r\n        'Self-moderation placebo.'\r\n      ],\r\n      'Filtered Backlinks': [\r\n        false,\r\n        'When enabled, shows backlinks to filtered posts with a line-through decoration. Otherwise, hides the backlinks.',\r\n        1\r\n      ],\r\n      'Filter in Native Catalog': [\r\n        true,\r\n        'Apply 4chan X filters in native catalog.',\r\n        1\r\n      ],\r\n      'MD5 Quick Filter Notifications': [\r\n        true,\r\n        'Show notification when quick filtering MD5s using the button or keybind.',\r\n        1\r\n      ],\r\n      'Recursive Hiding': [\r\n        true,\r\n        'Hide replies of hidden posts, recursively.'\r\n      ],\r\n      'Thread Hiding Buttons': [\r\n        true,\r\n        'Add buttons to hide entire threads.'\r\n      ],\r\n      'Reply Hiding Buttons': [\r\n        true,\r\n        'Add buttons to hide single replies.'\r\n      ],\r\n      'Stubs': [\r\n        true,\r\n        'Show stubs of hidden threads / replies.'\r\n      ]\r\n    },\r\n\r\n    'Images and Videos': {\r\n      'Image Expansion': [\r\n        true,\r\n        'Expand images / videos.'\r\n      ],\r\n      'Image Hover': [\r\n        true,\r\n        'Show full image / video on mouseover.'\r\n      ],\r\n      'Image Hover in Catalog': [\r\n        true,\r\n        `Show full image / video on mouseover in ${meta.name} catalog.`\r\n      ],\r\n      'Gallery': [\r\n        true,\r\n        'Adds a simple and cute image gallery. Has more options in the gallery menu.'\r\n      ],\r\n      'Fullscreen Gallery': [\r\n        false,\r\n        'Open gallery in fullscreen mode.',\r\n        1\r\n      ],\r\n      'PDF in Gallery': [\r\n        false,\r\n        'Show PDF files in gallery.',\r\n        1\r\n      ],\r\n      'Sauce': [\r\n        true,\r\n        'Add sauce links to images.'\r\n      ],\r\n      'WEBM Metadata': [\r\n        true,\r\n        'Add link to fetch title metadata from webm videos.'\r\n      ],\r\n      'Reveal Spoiler Thumbnails': [\r\n        false,\r\n        'Replace spoiler thumbnails with the original image.'\r\n      ],\r\n      'Replace GIF': [\r\n        false,\r\n        'Replace gif thumbnails with the actual image.'\r\n      ],\r\n      'Replace JPG': [\r\n        false,\r\n        'Replace jpg thumbnails with the actual image.'\r\n      ],\r\n      'Replace PNG': [\r\n        false,\r\n        'Replace png thumbnails with the actual image.'\r\n      ],\r\n      'Replace WEBM': [\r\n        false,\r\n        'Replace webm, mp4, and ogv thumbnails with the actual video. Probably will degrade browser performance ;)'\r\n      ],\r\n      'Image Prefetching': [\r\n        true,\r\n        'Add a shortcut icon to the header to turn on image preloading.'\r\n      ],\r\n      'Fappe Tyme': [\r\n        true,\r\n        'Hide posts without images when header menu item is checked. *hint* *hint*'\r\n      ],\r\n      'Werk Tyme': [\r\n        true,\r\n        'Hide all post images when header menu item is checked.'\r\n      ],\r\n      'Autoplay': [\r\n        true,\r\n        'Videos begin playing immediately when opened.'\r\n      ],\r\n      'Restart when Opened': [\r\n        false,\r\n        'Restart GIFs and WebMs when you hover over or expand them.'\r\n      ],\r\n      'Show Controls': [\r\n        true,\r\n        'Show controls on videos expanded inline.'\r\n      ],\r\n      'Click Passthrough': [\r\n        false,\r\n        'Clicks on videos trigger your browser\\'s default behavior. Videos can be contracted with button / dragging to the left.',\r\n        1\r\n      ],\r\n      'Allow Sound': [\r\n        true,\r\n        'Open videos with the sound unmuted.'\r\n      ],\r\n      'Mouse Wheel Volume': [\r\n        true,\r\n        'Adjust volume of videos with the mouse wheel over the thumbnail/filename/gallery.'\r\n      ],\r\n      'Loop in New Tab': [\r\n        true,\r\n        'Loop videos opened in their own tabs.'\r\n      ],\r\n      'Volume in New Tab': [\r\n        true,\r\n        `Apply ${meta.name} mute and volume settings to videos opened in their own tabs.`\r\n      ],\r\n      'Enable sound posts': [\r\n        true,\r\n        'Enable loading audio from [sound=] file names. This audio is fetched from third parties.'\r\n      ],\r\n    },\r\n\r\n    'Menu': {\r\n      'Menu': [\r\n        true,\r\n        'Add a drop-down menu to posts.'\r\n      ],\r\n      'Report Link': [\r\n        true,\r\n        'Add a report link to the menu.',\r\n        1\r\n      ],\r\n      'Copy Text Link': [\r\n        true,\r\n        'Add a link to copy the post\\'s text.',\r\n        1\r\n      ],\r\n      'Thread Hiding Link': [\r\n        true,\r\n        'Add a link to hide entire threads.',\r\n        1\r\n      ],\r\n      'Reply Hiding Link': [\r\n        true,\r\n        'Add a link to hide single replies.',\r\n        1\r\n      ],\r\n      'Delete Link': [\r\n        true,\r\n        'Add post and image deletion links to the menu.',\r\n        1\r\n      ],\r\n      'Archive Link': [\r\n        true,\r\n        'Add an archive link to the menu.',\r\n        1\r\n      ],\r\n      'Edit Link': [\r\n        true,\r\n        'Add a link to edit the image in Tegaki, /i/\\'s painting program. Requires Quick Reply.',\r\n        1\r\n      ],\r\n      'Download Link': [\r\n        false,\r\n        'Add a download with original filename link to the menu.',\r\n        1\r\n      ]\r\n    },\r\n\r\n    'Monitoring': {\r\n      'Thread Updater': [\r\n        true,\r\n        'Fetch and insert new replies. Has more options in the header menu and the \"Advanced\" tab.'\r\n      ],\r\n      'Unread Count': [\r\n        true,\r\n        'Show the unread posts count in the tab title.'\r\n      ],\r\n      'Quoted Title': [\r\n        false,\r\n        'Change the page title to reflect you\\'ve been quoted.',\r\n        1\r\n      ],\r\n      'Hide Unread Count at (0)': [\r\n        false,\r\n        'Hide the unread posts count in the tab title when it reaches 0.',\r\n        1\r\n      ],\r\n      'Unread Favicon': [\r\n        true,\r\n        'Show a different favicon when there are unread posts.'\r\n      ],\r\n      'Unread Line': [\r\n        true,\r\n        'Show a line to distinguish read posts from unread ones.'\r\n      ],\r\n      'Remember Last Read Post': [\r\n        true,\r\n        'Remember how far you\\'ve read after you close the thread.'\r\n      ],\r\n      'Scroll to Last Read Post': [\r\n        true,\r\n        'Scroll back to the last read post when reopening a thread.',\r\n        1\r\n      ],\r\n      'Unread Line in Index': [\r\n        false,\r\n        'Show a line between read and unread posts in threads in the index.',\r\n        1\r\n      ],\r\n      'Remove Thread Excerpt': [\r\n        false,\r\n        'Replace the excerpt of the thread in the tab title with the board title.'\r\n      ],\r\n      'Thread Stats': [\r\n        true,\r\n        'Display reply and image count.'\r\n      ],\r\n      'IP Count in Stats': [\r\n        true,\r\n        'Display the unique IP count in the thread stats.',\r\n        1\r\n      ],\r\n      'Page Count in Stats': [\r\n        true,\r\n        'Display the page count in the thread stats.',\r\n        1\r\n      ],\r\n      'Updater and Stats in Header': [\r\n        true,\r\n        'Places the thread updater and thread stats in the header instead of floating them.'\r\n      ],\r\n      'Thread Watcher': [\r\n        true,\r\n        'Bookmark threads. Has more options in the thread watcher menu.'\r\n      ],\r\n      'Fixed Thread Watcher': [\r\n        true,\r\n        'Makes the thread watcher scroll with the page.',\r\n        1\r\n      ],\r\n      'Persistent Thread Watcher': [\r\n        false,\r\n        'The thread watcher will be visible when the page is loaded.',\r\n        1\r\n      ],\r\n      'Mark New IPs': [\r\n        false,\r\n        'Label each post from a new IP with the thread\\'s current IP count.'\r\n      ],\r\n      'Reply Pruning': [\r\n        true,\r\n        'Add option in header menu to hide old replies in long threads. Activated by default in stickies.'\r\n      ],\r\n      'Prune All Threads': [\r\n        false,\r\n        'Activate Reply Pruning by default in all threads.',\r\n        1\r\n      ]\r\n    },\r\n\r\n    'Posting and Captchas': {\r\n      'Quick Reply': [\r\n        true,\r\n        'All-in-one form to reply, create threads, automate dumping and more.'\r\n      ],\r\n      'Persistent QR': [\r\n        false,\r\n        'The Quick reply won\\'t disappear after posting.',\r\n        1\r\n      ],\r\n      'Auto Hide QR': [\r\n        true,\r\n        'Automatically hide the quick reply when posting.',\r\n        2\r\n      ],\r\n      'Open Post in New Tab': [\r\n        true,\r\n        'Open new threads in a new tab, and open replies in a new tab if you\\'re not already in the thread.',\r\n        1\r\n      ],\r\n      'Remember QR Size': [\r\n        false,\r\n        'Remember the size of the Quick reply.',\r\n        1\r\n      ],\r\n      'Remember Spoiler': [\r\n        false,\r\n        'Remember the spoiler state, instead of resetting after posting.',\r\n        1\r\n      ],\r\n      'Randomize Filename': [\r\n        false,\r\n        'Set the filename to a random timestamp within the past year. Disabled on /f/.',\r\n        1\r\n      ],\r\n      'Show New Thread Option in Threads': [\r\n        true,\r\n        'Show the option to post a new / different thread from inside a thread.',\r\n        1\r\n      ],\r\n      'Show Upload Progress': [\r\n        true,\r\n        'Track progress of file uploads as percentage in submit button.',\r\n        1\r\n      ],\r\n      'Cooldown': [\r\n        true,\r\n        'Indicate the remaining time before posting again.',\r\n        1\r\n      ],\r\n      'Posting Success Notifications': [\r\n        true,\r\n        'Show notifications on successful post creation or file uploading.',\r\n        1\r\n      ],\r\n      'Auto-load captcha': [\r\n        false,\r\n        'Automatically load the captcha in the QR even if your post is empty.',\r\n        1\r\n      ],\r\n      'Post on Captcha Completion': [\r\n        false,\r\n        'Submit the post immediately when the captcha is completed.',\r\n        1\r\n      ],\r\n      'Force Noscript Captcha': [\r\n        false,\r\n        'Use the non-Javascript fallback captcha even if Javascript is enabled.'\r\n      ],\r\n      'Pass Link': [\r\n        false,\r\n        'Add a 4chan Pass login link to the bottom of the page.'\r\n      ]\r\n    },\r\n\r\n    'Quote Links': {\r\n      'Quote Backlinks': [\r\n        true,\r\n        'Add quote backlinks.'\r\n      ],\r\n      'OP Backlinks': [\r\n        true,\r\n        'Add backlinks to the OP.',\r\n        1\r\n      ],\r\n      'Bottom Backlinks': [\r\n        false,\r\n        'Place backlinks at the bottom of posts.',\r\n        1\r\n      ],\r\n      'Quote Inlining': [\r\n        true,\r\n        'Inline quoted post on click.'\r\n      ],\r\n      'Inline Cross-thread Quotes Only': [\r\n        false,\r\n        'Don\\'t inline quote links when the posts are visible in the thread.',\r\n        1\r\n      ],\r\n      'Quote Hash Navigation': [\r\n        false,\r\n        'Include an extra link after quotes for autoscrolling to quoted posts.',\r\n        1\r\n      ],\r\n      'Forward Hiding': [\r\n        true,\r\n        'Hide original posts of inlined backlinks.',\r\n        1\r\n      ],\r\n      'Quote Previewing': [\r\n        true,\r\n        'Show quoted post on hover.'\r\n      ],\r\n      'Quote Highlighting': [\r\n        true,\r\n        'Highlight the previewed post.',\r\n        1\r\n      ],\r\n      'Resurrect Quotes': [\r\n        true,\r\n        'Link dead quotes to the archives, and support inlining/previewing of archive links like quote links.'\r\n      ],\r\n      'Remember Your Posts': [\r\n        true,\r\n        'Remember your posting history.'\r\n      ],\r\n      'Mark Quotes of You': [\r\n        true,\r\n        'Add \\'(You)\\' to quotes linking to your posts.',\r\n        1\r\n      ],\r\n      'Highlight Posts Quoting You': [\r\n        true,\r\n        'Highlights any posts that contain a quote to your post.',\r\n        1\r\n      ],\r\n      'Highlight Own Posts': [\r\n        true,\r\n        'Highlights own posts.',\r\n        1\r\n      ],\r\n      'Mark OP Quotes': [\r\n        true,\r\n        'Add \\'(OP)\\' to OP quotes.'\r\n      ],\r\n      'Mark Cross-thread Quotes': [\r\n        true,\r\n        'Add \\'(Cross-thread)\\' to cross-threads quotes.'\r\n      ],\r\n      'Quote Threading': [\r\n        true,\r\n        'Add option in header menu to thread conversations.'\r\n      ]\r\n    }\r\n  },\r\n\r\n  imageExpansion: {\r\n    'Fit width': [\r\n      true,\r\n      ''\r\n    ],\r\n    'Fit height': [\r\n      false,\r\n      ''\r\n    ],\r\n    'Scroll into view': [\r\n      true,\r\n      'Scroll down when expanding images to bring the full image into view.'\r\n    ],\r\n    'Expand spoilers': [\r\n      true,\r\n      'Expand all images along with spoilers.'\r\n    ],\r\n    'Expand videos': [\r\n      true,\r\n      'Expand all images also expands videos.'\r\n    ],\r\n    'Expand from here': [\r\n      false,\r\n      'Expand all images only from current position to thread end.'\r\n    ],\r\n    'Expand thread only': [\r\n      false,\r\n      'In index, expand all images only within the current thread.'\r\n    ],\r\n    'Advance on contract': [\r\n      false,\r\n      'Advance to next post when contracting an expanded image.'\r\n    ]\r\n  },\r\n\r\n  gallery: {\r\n    'Hide Thumbnails': [\r\n      false\r\n    ],\r\n    'Fit Width': [ // 'Fit width' (lowercase W) belongs to Image Expansion. Engine limitations, heh.\r\n      true\r\n    ],\r\n    'Fit Height': [\r\n      true\r\n    ],\r\n    'Stretch to Fit': [\r\n      false\r\n    ],\r\n    'Scroll to Post': [\r\n      true\r\n    ],\r\n    'Slide Delay': [\r\n      6.0\r\n    ]\r\n  },\r\n\r\n  'Default Volume': 1.0,\r\n\r\n  threadWatcher: {\r\n    'Current Board': [\r\n      false,\r\n      'Only show watched threads from the current board.'\r\n    ],\r\n    'Auto Update Thread Watcher': [\r\n      true,\r\n      'Periodically check status of watched threads.'\r\n    ],\r\n    'Auto Watch': [\r\n      true,\r\n      'Automatically watch threads you start.'\r\n    ],\r\n    'Auto Watch Reply': [\r\n      true,\r\n      'Automatically watch threads you reply to.'\r\n    ],\r\n    'Auto Prune': [\r\n      false,\r\n      'Automatically remove dead threads.'\r\n    ],\r\n    'Show Page': [\r\n      true,\r\n      'Show what page watched threads are on.'\r\n    ],\r\n    'Show Unread Count': [\r\n      true,\r\n      'Show number of unread posts in watched threads.'\r\n    ],\r\n    'Show Site Prefix': [\r\n      true,\r\n      'When multiple sites are shown in the thread watcher, add a prefix to board names to distinguish them.'\r\n    ],\r\n    'Require OP Quote Link': [\r\n      false,\r\n      'For purposes of thread watcher highlighting, only consider posts with a quote link to the OP as replies to the OP.'\r\n    ]\r\n  },\r\n\r\n  filter: {\r\n    general: '',\r\n\r\n    postID: `\\\r\n# Highlight dubs on [s4s]:\r\n#/(\\\\d)\\\\1$/;highlight;top:no;boards:s4s\\\r\n`,\r\n\r\n    name: `\\\r\n# Filter any namefags:\r\n#/^(?!Anonymous$)/\\\r\n`,\r\n\r\n    uniqueID: `\\\r\n# Filter a specific ID:\r\n#/Txhvk1Tl/\\\r\n`,\r\n\r\n    tripcode: `\\\r\n# Filter any tripfag\r\n#/^!/\\\r\n`,\r\n\r\n    capcode: `\\\r\n# Set a custom class for mods:\r\n#/Mod$/;highlight:mod;op:yes\r\n# Set a custom class for admins:\r\n#/Admin$/;highlight:admin;op:yes\\\r\n`,\r\n\r\n    pass: `\\\r\n# Filter anyone using since4pass:\r\n#/./\\\r\n`,\r\n\r\n    email: '',\r\n\r\n    subject: `\\\r\n# Filter Generals on /v/:\r\n#/general/i;boards:v;op:only\\\r\n`,\r\n\r\n    comment: `\\\r\n# Filter Stallman copypasta on /g/:\r\n#/what you\\'re refer+ing to as linux/i;boards:g\r\n# Filter posts with 20 or more quote links:\r\n#/(?:>>\\\\d(?:(?!>>\\\\d)[^])*){20}/\r\n# Filter posts like T H I S / H / I / S:\r\n#/^>?\\\\s?\\\\w\\\\s?(\\\\w)\\\\s?(\\\\w)\\\\s?(\\\\w).*$[\\\\s>]+\\\\1[\\\\s>]+\\\\2[\\\\s>]+\\\\3/im\\\r\n`,\r\n\r\n    flag: '',\r\n    filename: '',\r\n    dimensions: `\\\r\n# Highlight potential wallpapers:\r\n#/1920x1080/;op:yes;highlight;top:no;boards:w,wg\\\r\n`,\r\n\r\n    filesize: '',\r\n\r\n    MD5: ''\r\n  },\r\n\r\n  sauces: `\\\r\n# Known filename formats:\r\nhttps://www.pixiv.net/member_illust.php?mode=medium&illust_id=%$1;regexp:/^(\\\\d+)_p\\\\d+/\r\njavascript:void(open(\"https://www.deviantart.com/\"+%$1.replace(/_/g,\"-\")+\"/art/\"+parseInt(%$2,36)));regexp:/^\\\\w+_by_(\\\\w+)[_-]d([\\\\da-z]{6})\\\\b/\r\nhttps://imgur.com/%$1;regexp:/^(?![a-zA-Z][a-z]{6})(?![A-Z]{7})(?!\\\\d{7})([\\\\da-zA-Z]{7})(?: \\\\(\\\\d+\\\\))?\\\\.\\\\w+$/\r\nhttps://flickr.com/photo.gne?id=%$1;regexp:/^(\\\\d+)_[\\\\da-f]{10}(?:_\\\\w)*\\\\b/\r\nhttps://www.facebook.com/photo.php?fbid=%$1;regexp:/^\\\\d+_(\\\\d+)_\\\\d+_[no]\\\\b/\r\n\r\n# Reverse image search:\r\nhttps://www.google.com/searchbyimage?sbisrc=4chanx&image_url=%IMG&safe=off\r\nhttps://yandex.com/images/search?rpt=imageview&url=%IMG\r\n#//tineye.com/search?url=%IMG\r\n#//www.bing.com/images/search?q=imgurl:%IMG&view=detailv2&iss=sbi#enterInsights\r\n#https://lens.google.com/uploadbyurl?url=%IMG;text:lens\r\n\r\n# Specialized reverse image search:\r\n//iqdb.org/?url=%IMG\r\nhttps://trace.moe/?auto&url=%IMG;text:wait\r\n#//3d.iqdb.org/?url=%IMG\r\n#//saucenao.com/search.php?url=%IMG\r\n\r\n# \"View Same\" in archives:\r\nhttp://eye.swfchan.com/search/?q=%name;types:swf\r\n#https://desuarchive.org/_/search/image/%sMD5/\r\n#https://archive.4plebs.org/_/search/image/%sMD5/\r\n#https://boards.fireden.net/_/search/image/%sMD5/\r\n#https://foolz.fireden.net/_/search/image/%sMD5/\r\n\r\n# Other tools:\r\n#http://exif.regex.info/exif.cgi?imgurl=%URL\r\n#//imgops.com/start?url=%URL;types:gif,jpg,png\r\n#//www.gif-explode.com/%URL;types:gif\\\r\n`,\r\n\r\n  FappeT: {\r\n    werk:  false\r\n  },\r\n\r\n  'Custom CSS': true,\r\n\r\n  Index: {\r\n    'Index Mode': 'paged',\r\n    'Previous Index Mode': 'paged',\r\n    'Index Size': 'small',\r\n    'Show Replies':          [true,  'Show replies in the index, and also in the catalog if \"Catalog hover expand\" is checked.'],\r\n    'Catalog Hover Expand':  [false, 'Expand the comment and show more details when you hover over a thread in the catalog.'],\r\n    'Catalog Hover Toggle':  [true,  'Turn \"Catalog hover expand\" on and off by clicking in the catalog.'],\r\n    'Pin Watched Threads':   [false, 'Move watched threads to the start of the index.'],\r\n    'Anchor Hidden Threads': [true,  'Move hidden threads to the end of the index.'],\r\n    'Refreshed Navigation':  [false, 'Refresh index when navigating through pages.']\r\n  },\r\n\r\n  Header: {\r\n    'Fixed Header':               true,\r\n    'Header auto-hide':           false,\r\n    'Header auto-hide on scroll': false,\r\n    'Bottom Header':              false,\r\n    'Centered links':             false,\r\n    'Header catalog links':       false,\r\n    'Bottom Board List':          true,\r\n    'Shortcut Icons':             true,\r\n    'Custom Board Navigation':    true\r\n  },\r\n\r\n  archives: {\r\n    archiveLists:      'https://4chenz.github.io/archives.json/archives.json',\r\n    lastarchivecheck:  0,\r\n    archiveAutoUpdate: true\r\n  },\r\n\r\n  externalCatalogURLs: `\\\r\n//catalog.neet.tv/%board/;boards:4chan.org:3,a,adv,an,asp,biz,c,cgl,ck,cm,co,diy,f,fa,fit,g,gd,his,i,int,jp,k,lgbt,lit,m,mlp,mu,n,news,o,out,p,po,pol,s4s,sci,sp,tg,toy,trv,tv,v,vg,vip,vp,vr,w,wg,wsg,wsr,x\\\r\n`,\r\n\r\n  boardnav: `\\\r\n[ toggle-all ]\r\n[current-index-text:\"Index\"\r\ncurrent-catalog-text:\"Catalog\"\r\ncurrent-expired-text:\"Expired\"\r\ncurrent-archive-text:\"Archive\"]\r\n[external-text:\"FAQ\",\"${meta.name}\"]\\\r\n`,\r\n\r\n  QR: {\r\n    'QR.personas': `\\\r\n#options:\"sage\";boards:jp;always\\\r\n`,\r\n    sjisPreview: false\r\n  },\r\n\r\n  jsWhitelist: `\\\r\nhttp://s.4cdn.org\r\nhttps://s.4cdn.org\r\nhttp://www.google.com\r\nhttps://www.google.com\r\nhttps://www.gstatic.com\r\nhttp://cdn.mathjax.org\r\nhttps://cdn.mathjax.org\r\nhttps://cdnjs.cloudflare.com\r\nhttps://hcaptcha.com\r\nhttps://*.hcaptcha.com\r\n'self'\r\n'unsafe-inline'\r\n'unsafe-eval'\\\r\n`,\r\n\r\n  captchaLanguage: '',\r\n\r\n  time: '%m/%d/%y(%a)%H:%M:%S',\r\n  timeLocale: '',\r\n\r\n  backlink: '>>%id',\r\n\r\n  pastedname: 'file',\r\n\r\n  fileInfo: '%l %d (%p%s, %r%g)',\r\n\r\n  favicon: 'ferongr',\r\n\r\n  usercss: userCss,\r\n\r\n  hotkeys: {\r\n    // QR & Options\r\n    'Toggle board list': [\r\n      'Ctrl+b',\r\n      'Toggle the full board list.'\r\n    ],\r\n    'Toggle header': [\r\n      'Shift+h',\r\n      'Toggle the auto-hide option of the header.'\r\n    ],\r\n    'Open empty QR': [\r\n      'q',\r\n      'Open QR without post number inserted.'\r\n    ],\r\n    'Open QR': [\r\n      'Shift+q',\r\n      'Open QR with post number inserted.'\r\n    ],\r\n    'Open settings': [\r\n      'Alt+o',\r\n      'Open Settings.'\r\n    ],\r\n    'Close': [\r\n      'Esc',\r\n      'Close dialogs or notifications.'\r\n    ],\r\n    'Spoiler tags': [\r\n      'Ctrl+s',\r\n      'Insert spoiler tags.'\r\n    ],\r\n    'Code tags': [\r\n      'Alt+c',\r\n      'Insert code tags.'\r\n    ],\r\n    'Eqn tags':  [\r\n      'Alt+e',\r\n      'Insert eqn tags.'\r\n    ],\r\n    'Math tags': [\r\n      'Alt+m',\r\n      'Insert math tags.'\r\n    ],\r\n    'SJIS tags': [\r\n      'Alt+a',\r\n      'Insert SJIS tags.'\r\n    ],\r\n    'Toggle sage': [\r\n      'Alt+s',\r\n      'Toggle sage in options field.'\r\n    ],\r\n    'Toggle Cooldown': [\r\n      'Alt+Comma',\r\n      'Toggle custom cooldown timer.'\r\n    ],\r\n    'Post from URL': [\r\n      'Alt+l',\r\n      'Post from URL.'\r\n    ],\r\n    'Add new post': [\r\n      'Alt+n',\r\n      'Add new post to the QR dump list.'\r\n    ],\r\n    'Submit QR': [\r\n      'Ctrl+Enter',\r\n      'Submit post.'\r\n    ],\r\n    // Thread related\r\n    'Watch': [\r\n      'w',\r\n      'Watch thread.'\r\n    ],\r\n    'Update': [\r\n      'r',\r\n      'Update the thread / refresh the index.'\r\n    ],\r\n    'Update thread watcher': [\r\n      'Shift+r',\r\n      'Manually refresh thread watcher.'\r\n    ],\r\n    'Toggle thread watcher': [\r\n      't',\r\n      'Toggle visibility of thread watcher.'\r\n    ],\r\n    'Toggle threading': [\r\n      'Shift+t',\r\n      'Toggle threading.'\r\n    ],\r\n    'Mark thread read': [\r\n      'Ctrl+0',\r\n      'Mark thread read from index (requires \"Unread Line in Index\").'\r\n    ],\r\n    // Images\r\n    'Expand image': [\r\n      'Shift+e',\r\n      'Expand selected image.'\r\n    ],\r\n    'Expand images': [\r\n      'e',\r\n      'Expand all images.'\r\n    ],\r\n    'Open Gallery': [\r\n      'g',\r\n      'Opens the gallery.'\r\n    ],\r\n    'Next Gallery Image': [\r\n      'Right',\r\n      'Go to the next image in gallery mode.'\r\n    ],\r\n    'Previous Gallery Image': [\r\n      'Left',\r\n      'Go to the previous image in gallery mode.'\r\n    ],\r\n    'Advance Gallery': [\r\n      'Enter',\r\n      'Go to next image or, if Autoplay is off, play video.'\r\n    ],\r\n    'Pause': [\r\n      'p',\r\n      'Pause/play videos in the gallery.'\r\n    ],\r\n    'Slideshow': [\r\n      'Ctrl+Right',\r\n      'Toggle the gallery slideshow mode.'\r\n    ],\r\n    'Rotate image clockwise': [\r\n      'Shift+Right',\r\n      'Rotate image clockwise in gallery.'\r\n    ],\r\n    'Rotate image anticlockwise': [\r\n      'Shift+Left',\r\n      'Rotate image anticlockwise in gallery.'\r\n    ],\r\n    'Download Gallery Image': [\r\n      'Shift+j',\r\n      'Download current image in gallery.'\r\n    ],\r\n    'fappeTyme': [\r\n      'f',\r\n      'Toggle Fappe Tyme.'\r\n    ],\r\n    'werkTyme': [\r\n      'Shift+w',\r\n      'Toggle Werk Tyme.'\r\n    ],\r\n    // Board Navigation\r\n    'Front page': [\r\n      '1',\r\n      'Jump to front page.'\r\n    ],\r\n    'Open front page': [\r\n      'Shift+1',\r\n      'Open front page in a new tab.'\r\n    ],\r\n    'Next page': [\r\n      'Ctrl+Right',\r\n      'Jump to the next page.'\r\n    ],\r\n    'Previous page': [\r\n      'Ctrl+Left',\r\n      'Jump to the previous page.'\r\n    ],\r\n    'Paged mode': [\r\n      'Alt+1',\r\n      'Open the index in paged mode.'\r\n    ],\r\n    'Infinite scrolling mode': [\r\n      'Alt+2',\r\n      'Open the index in infinite scrolling mode.'\r\n    ],\r\n    'All pages mode': [\r\n      'Alt+3',\r\n      'Open the index in all threads mode.'\r\n    ],\r\n    'Open catalog': [\r\n      'Shift+c',\r\n      'Open the catalog of the current board.'\r\n    ],\r\n    'Search form': [\r\n      'Ctrl+Alt+s',\r\n      'Focus the search field on the board index.'\r\n    ],\r\n    'Cycle sort type': [\r\n      'Alt+x',\r\n      'Cycle through index sort types.'\r\n    ],\r\n    // Thread Navigation\r\n    'Next thread': [\r\n      'Ctrl+Down',\r\n      'See next thread.'\r\n    ],\r\n    'Previous thread': [\r\n      'Ctrl+Up',\r\n      'See previous thread.'\r\n    ],\r\n    'Expand thread': [\r\n      'Ctrl+e',\r\n      'Expand thread.'\r\n    ],\r\n    'Open thread': [\r\n      'o',\r\n      'Open thread in current tab.'\r\n    ],\r\n    'Open thread tab': [\r\n      'Shift+o',\r\n      'Open thread in new tab.'\r\n    ],\r\n    // Reply Navigation\r\n    'Next reply': [\r\n      'j',\r\n      'Select next reply.'\r\n    ],\r\n    'Previous reply': [\r\n      'k',\r\n      'Select previous reply.'\r\n    ],\r\n    'Deselect reply': [\r\n      'Shift+d',\r\n      'Deselect reply.'\r\n    ],\r\n    'Hide': [\r\n      'x',\r\n      'Hide thread.'\r\n    ],\r\n    'Quick Filter MD5': [\r\n      '5',\r\n      'Add the MD5 of the selected image to the filter list.'\r\n    ],\r\n    'Previous Post Quoting You': [\r\n      'Alt+Up',\r\n      'Scroll to the previous post that quotes you.'\r\n    ],\r\n    'Next Post Quoting You': [\r\n      'Alt+Down',\r\n      'Scroll to the next post that quotes you.'\r\n    ]\r\n  },\r\n\r\n  updater: {\r\n    checkbox: {\r\n      'Beep': [\r\n        false,\r\n        'Beep on new post to completely read thread.'\r\n      ],\r\n      'Beep Quoting You': [\r\n        false,\r\n        'Beep on new post quoting you.'\r\n      ],\r\n      'Auto Scroll': [\r\n        false,\r\n        'Scroll updated posts into view. Only enabled at bottom of page.'\r\n      ],\r\n      'Bottom Scroll': [\r\n        false,\r\n        'Always scroll to the bottom, not the first new post. Useful for event threads.'\r\n      ],\r\n      'Scroll BG': [\r\n        false,\r\n        'Auto-scroll background tabs.'\r\n      ],\r\n      'Auto Update': [\r\n        true,\r\n        'Automatically fetch new posts.'\r\n      ],\r\n      'Optional Increase': [\r\n        false,\r\n        'Increase the intervals between updates on threads without new posts.'\r\n      ]\r\n    },\r\n    'Interval': 5\r\n  },\r\n\r\n  customCooldown: 0,\r\n  customCooldownEnabled: true,\r\n\r\n  'Thread Quotes': false,\r\n\r\n  'Max Replies': 1000,\r\n\r\n  'Autohiding Scrollbar': false,\r\n\r\n  position: {\r\n    'embedding.position':      'top: 50px; right: 0px;',\r\n    'thread-stats.position':   'bottom: 0px; right: 0px;',\r\n    'updater.position':        'bottom: 0px; left: 0px;',\r\n    'thread-watcher.position': 'top: 50px; left: 0px;',\r\n    'qr.position':             'top: 50px; right: 0px;'\r\n  },\r\n\r\n  fourchanImageHost: 'i.4cdn.org',\r\n\r\n  hiddenPSAList: [{}],\r\n\r\n  knownBanners: banners.join(','),\r\n\r\n  passMessageClosed: false,\r\n\r\n  'Prerequest Captcha': false,\r\n\r\n  'PSAseen': [[]]\r\n};\r\nexport default Config;\r\n","import ferongr_unreadDead from './Favicon/ferongr.unreadDead.png';\r\nimport ferongr_unreadDeadY from './Favicon/ferongr.unreadDeadY.png';\r\nimport ferongr_unreadSFW from './Favicon/ferongr.unreadSFW.png';\r\nimport ferongr_unreadSFWY from './Favicon/ferongr.unreadSFWY.png';\r\nimport ferongr_unreadNSFW from './Favicon/ferongr.unreadNSFW.png';\r\nimport ferongr_unreadNSFWY from './Favicon/ferongr.unreadNSFWY.png';\r\nimport xat_unreadDead from './Favicon/xat-.unreadDead.png';\r\nimport xat_unreadDeadY from './Favicon/xat-.unreadDeadY.png';\r\nimport xat_unreadSFW from './Favicon/xat-.unreadSFW.png';\r\nimport xat_unreadSFWY from './Favicon/xat-.unreadSFWY.png';\r\nimport xat_unreadNSFW from './Favicon/xat-.unreadNSFW.png';\r\nimport xat_unreadNSFWY from './Favicon/xat-.unreadNSFWY.png';\r\nimport Mayhem_unreadDead from './Favicon/Mayhem.unreadDead.png';\r\nimport Mayhem_unreadDeadY from './Favicon/Mayhem.unreadDeadY.png';\r\nimport Mayhem_unreadSFW from './Favicon/Mayhem.unreadSFW.png';\r\nimport Mayhem_unreadSFWY from './Favicon/Mayhem.unreadSFWY.png';\r\nimport Mayhem_unreadNSFW from './Favicon/Mayhem.unreadNSFW.png';\r\nimport Mayhem_unreadNSFWY from './Favicon/Mayhem.unreadNSFWY.png';\r\nimport fourChanJS_unreadDead from './Favicon/4chanJS.unreadDead.png';\r\nimport fourChanJS_unreadDeadY from './Favicon/4chanJS.unreadDeadY.png';\r\nimport fourChanJS_unreadSFW from './Favicon/4chanJS.unreadSFW.png';\r\nimport fourChanJS_unreadSFWY from './Favicon/4chanJS.unreadSFWY.png';\r\nimport fourChanJS_unreadNSFW from './Favicon/4chanJS.unreadNSFW.png';\r\nimport fourChanJS_unreadNSFWY from './Favicon/4chanJS.unreadNSFWY.png';\r\nimport Original_unreadDead from './Favicon/Original.unreadDead.png';\r\nimport Original_unreadDeadY from './Favicon/Original.unreadDeadY.png';\r\nimport Original_unreadSFW from './Favicon/Original.unreadSFW.png';\r\nimport Original_unreadSFWY from './Favicon/Original.unreadSFWY.png';\r\nimport Original_unreadNSFW from './Favicon/Original.unreadNSFW.png';\r\nimport Original_unreadNSFWY from './Favicon/Original.unreadNSFWY.png';\r\nimport Metro_unreadDead from './Favicon/Metro.unreadDead.png';\r\nimport Metro_unreadDeadY from './Favicon/Metro.unreadDeadY.png';\r\nimport Metro_unreadSFW from './Favicon/Metro.unreadSFW.png';\r\nimport Metro_unreadSFWY from './Favicon/Metro.unreadSFWY.png';\r\nimport Metro_unreadNSFW from './Favicon/Metro.unreadNSFW.png';\r\nimport Metro_unreadNSFWY from './Favicon/Metro.unreadNSFWY.png';\r\nimport dead from './Favicon/dead.gif';\r\nimport empty from './Favicon/empty.gif';\r\nimport $ from '../platform/$';\r\nimport { Conf, d } from '../globals/globals';\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n\r\nvar Favicon = {\r\n  init() {\r\n    return $.asap((() => d.head && (Favicon.el = $('link[rel=\"shortcut icon\"]', d.head))), Favicon.initAsap);\r\n  },\r\n\r\n  set(status) {\r\n    Favicon.status = status;\r\n    if (Favicon.el) {\r\n      Favicon.el.href = Favicon[status];\r\n      // `favicon.href = href` doesn't work on Firefox.\r\n      return $.add(d.head, Favicon.el);\r\n    }\r\n  },\r\n\r\n  initAsap() {\r\n    Favicon.el.type = 'image/x-icon';\r\n    const {href}          = Favicon.el;\r\n    Favicon.isSFW   = /ws\\.ico$/.test(href);\r\n    Favicon.default = href;\r\n    Favicon.switch();\r\n    if (Favicon.status) {\r\n      return Favicon.set(Favicon.status);\r\n    }\r\n  },\r\n\r\n  switch() {\r\n    let items = {\r\n      ferongr: [\r\n        ferongr_unreadDead,\r\n        ferongr_unreadDeadY,\r\n        ferongr_unreadSFW,\r\n        ferongr_unreadSFWY,\r\n        ferongr_unreadNSFW,\r\n        ferongr_unreadNSFWY,\r\n      ],\r\n      'xat-': [\r\n        xat_unreadDead,\r\n        xat_unreadDeadY,\r\n        xat_unreadSFW,\r\n        xat_unreadSFWY,\r\n        xat_unreadNSFW,\r\n        xat_unreadNSFWY,\r\n      ],\r\n      Mayhem: [\r\n        Mayhem_unreadDead,\r\n        Mayhem_unreadDeadY,\r\n        Mayhem_unreadSFW,\r\n        Mayhem_unreadSFWY,\r\n        Mayhem_unreadNSFW,\r\n        Mayhem_unreadNSFWY,\r\n      ],\r\n      '4chanJS': [\r\n        fourChanJS_unreadDead,\r\n        fourChanJS_unreadDeadY,\r\n        fourChanJS_unreadSFW,\r\n        fourChanJS_unreadSFWY,\r\n        fourChanJS_unreadNSFW,\r\n        fourChanJS_unreadNSFWY,\r\n      ],\r\n      Original: [\r\n        Original_unreadDead,\r\n        Original_unreadDeadY,\r\n        Original_unreadSFW,\r\n        Original_unreadSFWY,\r\n        Original_unreadNSFW,\r\n        Original_unreadNSFWY,\r\n      ],\r\n      'Metro': [\r\n        Metro_unreadDead,\r\n        Metro_unreadDeadY,\r\n        Metro_unreadSFW,\r\n        Metro_unreadSFWY,\r\n        Metro_unreadNSFW,\r\n        Metro_unreadNSFWY,\r\n      ]\r\n    };\r\n    items = $.getOwn(items, Conf['favicon']);\r\n\r\n    const f = Favicon;\r\n    const t = 'data:image/png;base64,';\r\n    let i = 0;\r\n    while (items[i]) {\r\n      items[i] = t + items[i++];\r\n    }\r\n\r\n    [f.unreadDead, f.unreadDeadY, f.unreadSFW, f.unreadSFWY, f.unreadNSFW, f.unreadNSFWY] = items;\r\n    return f.update();\r\n  },\r\n\r\n  update() {\r\n    if (this.isSFW) {\r\n      this.unread  = this.unreadSFW;\r\n      return this.unreadY = this.unreadSFWY;\r\n    } else {\r\n      this.unread  = this.unreadNSFW;\r\n      return this.unreadY = this.unreadNSFWY;\r\n    }\r\n  },\r\n\r\n  SFW:   '//s.4cdn.org/image/favicon-ws.ico',\r\n  NSFW:  '//s.4cdn.org/image/favicon.ico',\r\n  dead: `data:image/gif;base64,${dead}`,\r\n  logo: `data:image/png;base64,${empty}`,\r\n};\r\nexport default Favicon;\r\n","import { d } from \"../globals/globals\";\r\n\r\nconst $$ = (selector, root = d.body) => Array.from(root.querySelectorAll(selector));\r\nexport default $$;\r\n","import { g, Conf, doc, d } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\n\r\nconst CaptchaReplace = {\r\n  init() {\r\n    if ((g.SITE.software !== 'yotsuba') || (d.cookie.indexOf('pass_enabled=1') >= 0)) { return; }\r\n\r\n    if (Conf['Force Noscript Captcha'] && Main.jsEnabled) {\r\n      $.ready(this.noscript);\r\n      return;\r\n    }\r\n\r\n    if (Conf['captchaLanguage'].trim()) {\r\n      if (['boards.4chan.org', 'boards.4channel.org'].includes(location.hostname)) {\r\n        $.onExists(doc, '#captchaFormPart', node => $.onExists(node, 'iframe[src^=\"https://www.google.com/recaptcha/\"]', this.iframe));\r\n      } else {\r\n        $.onExists(doc, 'iframe[src^=\"https://www.google.com/recaptcha/\"]', this.iframe);\r\n      }\r\n    }\r\n  },\r\n\r\n  noscript() {\r\n    let noscript, original, toggle;\r\n    if (!((original = $('#g-recaptcha')) && (noscript = $('noscript', original.parentNode)))) { return; }\r\n    const span = $.el('span',\r\n      {id: 'captcha-forced-noscript'});\r\n    $.replace(noscript, span);\r\n    $.rm(original);\r\n    const insert = function() {\r\n      span.innerHTML = noscript.textContent;\r\n      this.iframe($('iframe[src^=\"https://www.google.com/recaptcha/\"]', span));\r\n    };\r\n    if (toggle = $('#togglePostFormLink a, #form-link')) {\r\n      $.on(toggle, 'click', insert);\r\n    } else {\r\n      insert();\r\n    }\r\n  },\r\n\r\n  iframe(iframe) {\r\n    let lang;\r\n    if (lang = Conf['captchaLanguage'].trim()) {\r\n      const src = /[?&]hl=/.test(iframe.src) ?\r\n        iframe.src.replace(/([?&]hl=)[^&]*/, '$1' + encodeURIComponent(lang))\r\n      :\r\n        iframe.src + `&hl=${encodeURIComponent(lang)}`;\r\n      if (iframe.src !== src) { iframe.src = src; }\r\n    }\r\n  }\r\n};\r\nexport default CaptchaReplace;\r\n","import { d, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport QR from \"./QR\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst CaptchaT = {\r\n  init() {\r\n    if (d.cookie.indexOf('pass_enabled=1') >= 0) { return; }\r\n    if (!(this.isEnabled = !!$('#t-root') || !$.id('postForm'))) { return; }\r\n\r\n    const root = $.el('div', {className: 'captcha-root'});\r\n    this.nodes = {root};\r\n\r\n    $.addClass(QR.nodes.el, 'has-captcha', 'captcha-t');\r\n    return $.after(QR.nodes.com.parentNode, root);\r\n  },\r\n\r\n  moreNeeded() {\r\n  },\r\n\r\n  getThread() {\r\n    let threadID;\r\n    const boardID = g.BOARD.ID;\r\n    if (QR.posts[0].thread === 'new') {\r\n      threadID = '0';\r\n    } else {\r\n      threadID = '' + QR.posts[0].thread;\r\n    }\r\n    return {boardID, threadID};\r\n  },\r\n\r\n  setup(focus) {\r\n    if (!this.isEnabled) { return; }\r\n\r\n    if (!this.nodes.container) {\r\n      this.nodes.container = $.el('div', {className: 'captcha-container'});\r\n      $.prepend(this.nodes.root, this.nodes.container);\r\n      CaptchaT.currentThread = CaptchaT.getThread();\r\n      $.global(function() {\r\n        const el = document.querySelector('#qr .captcha-container');\r\n        window.TCaptcha.init(el, this.boardID, +this.threadID);\r\n        return window.TCaptcha.setErrorCb(err => window.dispatchEvent(new CustomEvent('CreateNotification', {detail: {\r\n          type: 'warning',\r\n          content: '' + err\r\n        }})\r\n        ));\r\n      }\r\n      , CaptchaT.currentThread);\r\n    }\r\n\r\n    if (focus) {\r\n      return $('#t-resp').focus();\r\n    }\r\n  },\r\n\r\n  destroy() {\r\n    if (!this.isEnabled || !this.nodes.container) { return; }\r\n    $.global(() => window.TCaptcha.destroy());\r\n    $.rm(this.nodes.container);\r\n    return delete this.nodes.container;\r\n  },\r\n\r\n  updateThread() {\r\n    if (!this.isEnabled) { return; }\r\n    const {boardID, threadID} = (CaptchaT.currentThread || {});\r\n    const newThread = CaptchaT.getThread();\r\n    if ((newThread.boardID !== boardID) || (newThread.threadID !== threadID)) {\r\n      CaptchaT.destroy();\r\n      return CaptchaT.setup();\r\n    }\r\n  },\r\n\r\n  getOne() {\r\n    let el;\r\n    let response = {};\r\n    if (this.nodes.container) {\r\n      for (var key of ['t-response', 't-challenge']) {\r\n        response[key] = $(`[name='${key}']`, this.nodes.container).value;\r\n      }\r\n    }\r\n    if (!response['t-response'] && !((el = $('#t-msg')) && /Verification not required/i.test(el.textContent))) {\r\n      response = null;\r\n    }\r\n    return response;\r\n  },\r\n\r\n  setUsed() {\r\n    if (!this.isEnabled) { return; }\r\n    if (this.nodes.container) {\r\n      return $.global(() => window.TCaptcha.clearChallenge());\r\n    }\r\n  },\r\n\r\n  occupied() {\r\n    return !!this.nodes.container;\r\n  }\r\n};\r\nexport default CaptchaT;\r\n",null,"import { Conf, d, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { dict, HOUR } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS206: Consider reworking classes to avoid initClass\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nexport default class DataBoard {\r\n  static initClass() {\r\n    this.keys = ['hiddenThreads', 'hiddenPosts', 'lastReadPosts', 'yourPosts', 'watchedThreads', 'watcherLastModified', 'customTitles'];\r\n  }\r\n\r\n  constructor(key, sync, dontClean) {\r\n    this.changes = [];\r\n    this.onSync = this.onSync.bind(this);\r\n    this.key = key;\r\n    this.initData(Conf[this.key]);\r\n    $.sync(this.key, this.onSync);\r\n    if (!dontClean) { this.clean(); }\r\n    if (!sync) { return; }\r\n    // Chrome also fires the onChanged callback on the current tab,\r\n    // so we only start syncing when we're ready.\r\n    var init = () => {\r\n      $.off(d, '4chanXInitFinished', init);\r\n      return this.sync = sync;\r\n    };\r\n    $.on(d, '4chanXInitFinished', init);\r\n  }\r\n\r\n  initData(data) {\r\n    let boards;\r\n    this.data = data;\r\n    if (this.data.boards) {\r\n      let lastChecked;\r\n      ({boards, lastChecked} = this.data);\r\n      this.data['4chan.org'] = {boards, lastChecked};\r\n      delete this.data.boards;\r\n      delete this.data.lastChecked;\r\n    }\r\n    return this.data[g.SITE.ID] || (this.data[g.SITE.ID] = { boards: dict() });\r\n  }\r\n\r\n  save(change, cb) {\r\n    change();\r\n    this.changes.push(change);\r\n    return $.get(this.key, { boards: dict() }, items => {\r\n      if (!this.changes.length) { return; }\r\n      const needSync = ((items[this.key].version || 0) > (this.data.version || 0));\r\n      if (needSync) {\r\n        this.initData(items[this.key]);\r\n        for (change of this.changes) { change(); }\r\n      }\r\n      this.changes = [];\r\n      this.data.version = (this.data.version || 0) + 1;\r\n      return $.set(this.key, this.data, () => {\r\n        if (needSync) { this.sync?.(); }\r\n        return cb?.();\r\n      });\r\n    });\r\n  }\r\n\r\n  forceSync(cb) {\r\n    return $.get(this.key, { boards: dict() }, items => {\r\n      if ((items[this.key].version || 0) > (this.data.version || 0)) {\r\n        this.initData(items[this.key]);\r\n        for (var change of this.changes) { change(); }\r\n        this.sync?.();\r\n      }\r\n      return cb?.();\r\n    });\r\n  }\r\n\r\n  delete({siteID, boardID, threadID, postID}, cb) {\r\n    if (!siteID) { siteID = g.SITE.ID; }\r\n    if (!this.data[siteID]) { return; }\r\n    return this.save(() => {\r\n      if (postID) {\r\n        if (!this.data[siteID].boards[boardID]?.[threadID]) { return; }\r\n        delete this.data[siteID].boards[boardID][threadID][postID];\r\n        return this.deleteIfEmpty({siteID, boardID, threadID});\r\n      } else if (threadID) {\r\n        if (!this.data[siteID].boards[boardID]) { return; }\r\n        delete this.data[siteID].boards[boardID][threadID];\r\n        return this.deleteIfEmpty({siteID, boardID});\r\n      } else {\r\n        return delete this.data[siteID].boards[boardID];\r\n      }\r\n    }\r\n    , cb);\r\n  }\r\n\r\n  deleteIfEmpty({siteID, boardID, threadID}) {\r\n    if (!this.data[siteID]) { return; }\r\n    if (threadID) {\r\n      if (!Object.keys(this.data[siteID].boards[boardID][threadID]).length) {\r\n        delete this.data[siteID].boards[boardID][threadID];\r\n        return this.deleteIfEmpty({siteID, boardID});\r\n      }\r\n    } else if (!Object.keys(this.data[siteID].boards[boardID]).length) {\r\n      return delete this.data[siteID].boards[boardID];\r\n    }\r\n  }\r\n\r\n  set(data, cb) {\r\n    return this.save(() => {\r\n      return this.setUnsafe(data);\r\n    }\r\n    , cb);\r\n  }\r\n\r\n  setUnsafe({siteID, boardID, threadID, postID, val}) {\r\n    if (!siteID) { siteID = g.SITE.ID; }\r\n    if (!this.data[siteID]) { this.data[siteID] = { boards: dict() }; }\r\n    if (postID !== undefined) {\r\n      let base;\r\n      return (((base = this.data[siteID].boards[boardID] || (this.data[siteID].boards[boardID] = dict())))[threadID] || (base[threadID] = dict()))[postID] = val;\r\n    } else if (threadID !== undefined) {\r\n      return (this.data[siteID].boards[boardID] || (this.data[siteID].boards[boardID] = dict()))[threadID] = val;\r\n    } else {\r\n      return this.data[siteID].boards[boardID] = val;\r\n    }\r\n  }\r\n\r\n  extend({siteID, boardID, threadID, postID, val}, cb) {\r\n    return this.save(() => {\r\n      const oldVal = this.get({ siteID, boardID, threadID, postID, defaultValue: dict() });\r\n      for (var key in val) {\r\n        var subVal = val[key];\r\n        if (typeof subVal === 'undefined') {\r\n          delete oldVal[key];\r\n        } else {\r\n          oldVal[key] = subVal;\r\n        }\r\n      }\r\n      return this.setUnsafe({siteID, boardID, threadID, postID, val: oldVal});\r\n    }\r\n    , cb);\r\n  }\r\n\r\n  setLastChecked(key='lastChecked') {\r\n    return this.save(() => {\r\n      return this.data[key] = Date.now();\r\n    });\r\n  }\r\n\r\n  get({siteID, boardID, threadID, postID, defaultValue}) {\r\n    let board, val;\r\n    if (!siteID) { siteID = g.SITE.ID; }\r\n    if (board = this.data[siteID]?.boards[boardID]) {\r\n      let thread;\r\n      if (threadID == null) {\r\n        if (postID != null) {\r\n          for (thread = 0; thread < board.length; thread++) {\r\n            var ID = board[thread];\r\n            if (postID in thread) {\r\n              val = thread[postID];\r\n              break;\r\n            }\r\n          }\r\n        } else {\r\n          val = board;\r\n        }\r\n      } else if (thread = board[threadID]) {\r\n        val = (postID != null) ?\r\n          thread[postID]\r\n        :\r\n          thread;\r\n      }\r\n    }\r\n    return val || defaultValue;\r\n  }\r\n\r\n  clean() {\r\n    let boardID, middle;\r\n    const siteID = g.SITE.ID;\r\n    for (boardID in this.data[siteID].boards) {\r\n      var val = this.data[siteID].boards[boardID];\r\n      this.deleteIfEmpty({siteID, boardID});\r\n    }\r\n    const now = Date.now();\r\n    if (now - (2 * HOUR) >= ((middle = this.data[siteID].lastChecked || 0)) || middle > now) {\r\n      this.data[siteID].lastChecked = now;\r\n      for (boardID in this.data[siteID].boards) {\r\n        this.ajaxClean(boardID);\r\n      }\r\n    }\r\n  }\r\n\r\n  ajaxClean(boardID) {\r\n    const that = this;\r\n    const siteID = g.SITE.ID;\r\n    const threadsList = g.SITE.urls.threadsListJSON?.({siteID, boardID});\r\n    if (!threadsList) { return; }\r\n    return $.cache(threadsList, function() {\r\n      if (this.status !== 200) { return; }\r\n      const archiveList = g.SITE.urls.archiveListJSON?.({siteID, boardID});\r\n      if (!archiveList) { return that.ajaxCleanParse(boardID, this.response); }\r\n      const response1 = this.response;\r\n      return $.cache(archiveList, function() {\r\n        if ((this.status !== 200) && (!!g.SITE.archivedBoardsKnown || (this.status !== 404))) { return; }\r\n        return that.ajaxCleanParse(boardID, response1, this.response);\r\n      });\r\n    });\r\n  }\r\n\r\n  ajaxCleanParse(boardID, response1, response2) {\r\n    let board, ID;\r\n    const siteID = g.SITE.ID;\r\n    if (!(board = this.data[siteID].boards[boardID])) { return; }\r\n    const threads = dict();\r\n    if (response1) {\r\n      for (var page of response1) {\r\n        for (var thread of page.threads) {\r\n          ID = thread.no;\r\n          if (ID in board) { threads[ID] = board[ID]; }\r\n        }\r\n      }\r\n    }\r\n    if (response2) {\r\n      for (ID of response2) {\r\n        if (ID in board) { threads[ID] = board[ID]; }\r\n      }\r\n    }\r\n    this.data[siteID].boards[boardID] = threads;\r\n    this.deleteIfEmpty({siteID, boardID});\r\n    return $.set(this.key, this.data);\r\n  }\r\n\r\n  onSync(data) {\r\n    if ((data.version || 0) <= (this.data.version || 0)) { return; }\r\n    this.initData(data);\r\n    return this.sync?.();\r\n  }\r\n}\r\nDataBoard.initClass();\r\n",null,null,"import $ from \"../platform/$\";\r\n\r\nexport default class CatalogThread {\r\n  toString() { return this.ID; }\r\n\r\n  constructor(root, thread) {\r\n    this.thread = thread;\r\n    this.ID    = this.thread.ID;\r\n    this.board = this.thread.board;\r\n    const {post} = this.thread.OP.nodes;\r\n    this.nodes = {\r\n      root,\r\n      thumb:     $('.catalog-thumb', post),\r\n      icons:     $('.catalog-icons', post),\r\n      postCount: $('.post-count',    post),\r\n      fileCount: $('.file-count',    post),\r\n      pageCount: $('.page-count',    post),\r\n      replies:   null\r\n    };\r\n    this.thread.catalogView = this;\r\n  }\r\n}\r\n","import { Conf, d, doc } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport Header from \"./Header\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS206: Consider reworking classes to avoid initClass\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst dialog = function(id, properties) {\r\n  const el = $.el('div', {\r\n    className: 'dialog',\r\n    id\r\n  }\r\n  );\r\n  $.extend(el, properties);\r\n  el.style.cssText = Conf[`${id}.position`];\r\n\r\n  const move = $('.move', el);\r\n  $.on(move, 'touchstart mousedown', dragstart);\r\n  for (var child of move.children) {\r\n    if (!child.tagName) { continue; }\r\n    $.on(child, 'touchstart mousedown', e => e.stopPropagation());\r\n  }\r\n\r\n  return el;\r\n};\r\n\r\nvar Menu = (function() {\r\n  let currentMenu = undefined;\r\n  let lastToggledButton = undefined;\r\n  Menu = class Menu {\r\n    static initClass() {\r\n      currentMenu       = null;\r\n      lastToggledButton = null;\r\n    }\r\n\r\n    constructor(type) {\r\n      // XXX AddMenuEntry event is deprecated\r\n      this.setPosition = this.setPosition.bind(this);\r\n      this.close = this.close.bind(this);\r\n      this.keybinds = this.keybinds.bind(this);\r\n      this.onFocus = this.onFocus.bind(this);\r\n      this.addEntry = this.addEntry.bind(this);\r\n      this.type = type;\r\n      $.on(d, 'AddMenuEntry', ({detail}) => {\r\n        if (detail.type !== this.type) { return; }\r\n        delete detail.open;\r\n        return this.addEntry(detail);\r\n      });\r\n      this.entries = [];\r\n    }\r\n\r\n    makeMenu() {\r\n      const menu = $.el('div', {\r\n        className: 'dialog',\r\n        id:        'menu',\r\n        tabIndex:  0\r\n      }\r\n      );\r\n      menu.dataset.type = this.type;\r\n      $.on(menu, 'click', e => e.stopPropagation());\r\n      $.on(menu, 'keydown', this.keybinds);\r\n      return menu;\r\n    }\r\n\r\n    toggle(e, button, data) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n\r\n      if (currentMenu) {\r\n        // Close if it's already opened.\r\n        // Reopen if we clicked on another button.\r\n        const previousButton = lastToggledButton;\r\n        currentMenu.close();\r\n        if (previousButton === button) { return; }\r\n      }\r\n\r\n      if (!this.entries.length) { return; }\r\n      return this.open(button, data);\r\n    }\r\n\r\n    open(button, data) {\r\n      let entry;\r\n      const menu = (this.menu = this.makeMenu());\r\n      currentMenu       = this;\r\n      lastToggledButton = button;\r\n\r\n      this.entries.sort((first, second) => first.order - second.order);\r\n\r\n      for (entry of this.entries) {\r\n        this.insertEntry(entry, menu, data);\r\n      }\r\n\r\n      $.addClass(lastToggledButton, 'active');\r\n\r\n      $.on(d, 'click CloseMenu', this.close);\r\n      $.on(d, 'scroll', this.setPosition);\r\n      $.on(window, 'resize', this.setPosition);\r\n      $.after(button, menu);\r\n\r\n      this.setPosition();\r\n\r\n      entry = $('.entry', menu);\r\n      // We've removed flexbox, so we don't use order anymore.\r\n      // while prevEntry = @findNextEntry entry, -1\r\n      //   entry = prevEntry\r\n      this.focus(entry);\r\n\r\n      return menu.focus();\r\n    }\r\n\r\n    setPosition() {\r\n      const mRect   = this.menu.getBoundingClientRect();\r\n      const bRect   = lastToggledButton.getBoundingClientRect();\r\n      const bTop    = window.scrollY + bRect.top;\r\n      const bLeft   = window.scrollX + bRect.left;\r\n      const cHeight = doc.clientHeight;\r\n      const cWidth  = doc.clientWidth;\r\n      const [top, bottom] = (bRect.top + bRect.height + mRect.height) < cHeight ?\r\n        [`${bRect.bottom}px`, '']\r\n      :\r\n        ['', `${cHeight - bRect.top}px`];\r\n      const [left, right] = (bRect.left + mRect.width) < cWidth ?\r\n        [`${bRect.left}px`, '']\r\n      :\r\n        ['', `${cWidth - bRect.right}px`];\r\n      $.extend(this.menu.style, {top, right, bottom, left});\r\n      return this.menu.classList.toggle('left', right);\r\n    }\r\n\r\n    insertEntry(entry, parent, data) {\r\n      let submenu;\r\n      if (typeof entry.open === 'function') {\r\n        try {\r\n          if (!entry.open(data)) { return; }\r\n        } catch (err) {\r\n          Main.handleErrors({\r\n            message: `Error in building the ${this.type} menu.`,\r\n            error: err\r\n          });\r\n          return;\r\n        }\r\n      }\r\n      $.add(parent, entry.el);\r\n\r\n      if (!entry.subEntries) { return; }\r\n      if (submenu = $('.submenu', entry.el)) {\r\n        // Reset sub menu, remove irrelevant entries.\r\n        $.rm(submenu);\r\n      }\r\n      submenu = $.el('div',\r\n        {className: 'dialog submenu'});\r\n      for (var subEntry of entry.subEntries) {\r\n        this.insertEntry(subEntry, submenu, data);\r\n      }\r\n      $.add(entry.el, submenu);\r\n    }\r\n\r\n    close() {\r\n      $.rm(this.menu);\r\n      delete this.menu;\r\n      $.rmClass(lastToggledButton, 'active');\r\n      currentMenu       = null;\r\n      lastToggledButton = null;\r\n      $.off(d, 'click scroll CloseMenu', this.close);\r\n      $.off(d, 'scroll', this.setPosition);\r\n      return $.off(window, 'resize', this.setPosition);\r\n    }\r\n\r\n    findNextEntry(entry, direction) {\r\n      const entries = [...entry.parentNode.children];\r\n      entries.sort((first, second) => first.style.order - second.style.order);\r\n      return entries[entries.indexOf(entry) + direction];\r\n    }\r\n\r\n    keybinds(e) {\r\n      let subEntry;\r\n      let next, submenu;\r\n      let entry = $('.focused', this.menu);\r\n      while ((subEntry = $('.focused', entry))) {\r\n        entry = subEntry;\r\n      }\r\n\r\n      switch (e.keyCode) {\r\n        case 27: // Esc\r\n          lastToggledButton.focus();\r\n          this.close();\r\n          break;\r\n        case 13: case 32: // Enter, Space\r\n          entry.click();\r\n          break;\r\n        case 38: // Up\r\n          if (next = this.findNextEntry(entry, -1)) {\r\n            this.focus(next);\r\n          }\r\n          break;\r\n        case 40: // Down\r\n          if (next = this.findNextEntry(entry, +1)) {\r\n            this.focus(next);\r\n          }\r\n          break;\r\n        case 39: // Right\r\n          if ((submenu = $('.submenu', entry)) && (next = submenu.firstElementChild)) {\r\n            let nextPrev;\r\n            while ((nextPrev = this.findNextEntry(next, -1))) {\r\n              next = nextPrev;\r\n            }\r\n            this.focus(next);\r\n          }\r\n          break;\r\n        case 37: // Left\r\n          if (next = $.x('parent::*[contains(@class,\"submenu\")]/parent::*', entry)) {\r\n            this.focus(next);\r\n          }\r\n          break;\r\n        default:\r\n          return;\r\n      }\r\n\r\n      e.preventDefault();\r\n      return e.stopPropagation();\r\n    }\r\n\r\n    onFocus(e) {\r\n      e.stopPropagation();\r\n      return this.focus(e.target);\r\n    }\r\n\r\n    focus(entry) {\r\n      let focused, submenu;\r\n      while ((focused = $.x('parent::*/child::*[contains(@class,\"focused\")]', entry))) {\r\n        $.rmClass(focused, 'focused');\r\n      }\r\n      for (focused of $$('.focused', entry)) {\r\n        $.rmClass(focused, 'focused');\r\n      }\r\n      $.addClass(entry, 'focused');\r\n\r\n      // Submenu positioning.\r\n      if (!(submenu = $('.submenu', entry))) { return; }\r\n      const sRect   = submenu.getBoundingClientRect();\r\n      const eRect   = entry.getBoundingClientRect();\r\n      const cHeight = doc.clientHeight;\r\n      const cWidth  = doc.clientWidth;\r\n      const [top, bottom] = (eRect.top + sRect.height) < cHeight ?\r\n        ['0px', 'auto']\r\n      :\r\n        ['auto', '0px'];\r\n      const [left, right] = (eRect.right + sRect.width) < (cWidth - 150) ?\r\n        ['100%', 'auto']\r\n      :\r\n        ['auto', '100%'];\r\n      const {style} = submenu;\r\n      style.top    = top;\r\n      style.bottom = bottom;\r\n      style.left   = left;\r\n      return style.right  = right;\r\n    }\r\n\r\n    addEntry(entry) {\r\n      this.parseEntry(entry);\r\n      return this.entries.push(entry);\r\n    }\r\n\r\n    parseEntry(entry) {\r\n      const {el, subEntries} = entry;\r\n      $.addClass(el, 'entry');\r\n      $.on(el, 'focus mouseover', this.onFocus);\r\n      el.style.order = entry.order || 100;\r\n      if (!subEntries) { return; }\r\n      $.addClass(el, 'has-submenu');\r\n      for (var subEntry of subEntries) {\r\n        this.parseEntry(subEntry);\r\n      }\r\n    }\r\n  };\r\n  Menu.initClass();\r\n  return Menu;\r\n})();\r\n\r\nexport var dragstart = function (e) {\r\n  let isTouching;\r\n  if ((e.type === 'mousedown') && (e.button !== 0)) { return; } // not LMB\r\n  // prevent text selection\r\n  e.preventDefault();\r\n  if (isTouching = e.type === 'touchstart') {\r\n    e = e.changedTouches[e.changedTouches.length - 1];\r\n  }\r\n  // distance from pointer to el edge is constant; calculate it here.\r\n  const el = $.x('ancestor::div[contains(@class,\"dialog\")][1]', this);\r\n  const rect = el.getBoundingClientRect();\r\n  const screenHeight = doc.clientHeight;\r\n  const screenWidth  = doc.clientWidth;\r\n  const o = {\r\n    id:     el.id,\r\n    style:  el.style,\r\n    dx:     e.clientX - rect.left,\r\n    dy:     e.clientY - rect.top,\r\n    height: screenHeight - rect.height,\r\n    width:  screenWidth  - rect.width,\r\n    screenHeight,\r\n    screenWidth,\r\n    isTouching\r\n  };\r\n\r\n  [o.topBorder, o.bottomBorder] = Conf['Header auto-hide'] || !Conf['Fixed Header'] ?\r\n    [0, 0]\r\n  : Conf['Bottom Header'] ?\r\n    [0, Header.bar.getBoundingClientRect().height]\r\n  :\r\n    [Header.bar.getBoundingClientRect().height, 0];\r\n\r\n  if (isTouching) {\r\n    o.identifier = e.identifier;\r\n    o.move = touchmove.bind(o);\r\n    o.up   = touchend.bind(o);\r\n    $.on(d, 'touchmove', o.move);\r\n    return $.on(d, 'touchend touchcancel', o.up);\r\n  } else { // mousedown\r\n    o.move = drag.bind(o);\r\n    o.up   = dragend.bind(o);\r\n    $.on(d, 'mousemove', o.move);\r\n    return $.on(d, 'mouseup',   o.up);\r\n  }\r\n};\r\n\r\nexport var touchmove = function (e) {\r\n  for (var touch of e.changedTouches) {\r\n    if (touch.identifier === this.identifier) {\r\n      drag.call(this, touch);\r\n      return;\r\n    }\r\n  }\r\n};\r\n\r\nexport var drag = function (e) {\r\n  const {clientX, clientY} = e;\r\n\r\n  let left = clientX - this.dx;\r\n  left = left < 10 ?\r\n    0\r\n  : (this.width - left) < 10 ?\r\n    ''\r\n  :\r\n    ((left / this.screenWidth) * 100) + '%';\r\n\r\n  let top = clientY - this.dy;\r\n  top = top < (10 + this.topBorder) ?\r\n    this.topBorder + 'px'\r\n  : (this.height - top) < (10 + this.bottomBorder) ?\r\n    ''\r\n  :\r\n    ((top / this.screenHeight) * 100) + '%';\r\n\r\n  const right = left === '' ?\r\n    0\r\n  :\r\n    '';\r\n\r\n  const bottom = top === '' ?\r\n    this.bottomBorder + 'px'\r\n  :\r\n    '';\r\n\r\n  const {style} = this;\r\n  style.left   = left;\r\n  style.right  = right;\r\n  style.top    = top;\r\n  return style.bottom = bottom;\r\n};\r\n\r\nexport var touchend = function (e) {\r\n  for (var touch of e.changedTouches) {\r\n    if (touch.identifier === this.identifier) {\r\n      dragend.call(this);\r\n      return;\r\n    }\r\n  }\r\n};\r\n\r\nexport var dragend = function () {\r\n  if (this.isTouching) {\r\n    $.off(d, 'touchmove', this.move);\r\n    $.off(d, 'touchend touchcancel', this.up);\r\n  } else { // mouseup\r\n    $.off(d, 'mousemove', this.move);\r\n    $.off(d, 'mouseup',   this.up);\r\n  }\r\n  return $.set(`${this.id}.position`, this.style.cssText);\r\n};\r\n\r\nconst hoverstart = function ({ root, el, latestEvent, endEvents, height, width, cb, noRemove }) {\r\n  const rect = root.getBoundingClientRect();\r\n  const o = {\r\n    root,\r\n    el,\r\n    style: el.style,\r\n    isImage: ['IMG', 'VIDEO'].includes(el.nodeName),\r\n    cb,\r\n    endEvents,\r\n    latestEvent,\r\n    clientHeight: doc.clientHeight,\r\n    clientWidth:  doc.clientWidth,\r\n    height,\r\n    width,\r\n    noRemove,\r\n    clientX: (rect.left + rect.right) / 2,\r\n    clientY: (rect.top + rect.bottom) / 2\r\n  };\r\n  o.hover    = hover.bind(o);\r\n  o.hoverend = hoverend.bind(o);\r\n\r\n  o.hover(o.latestEvent);\r\n  new MutationObserver(function() {\r\n    if (el.parentNode) { return o.hover(o.latestEvent); }\r\n  }).observe(el, {childList: true});\r\n\r\n  $.on(root, endEvents,   o.hoverend);\r\n  if ($.x('ancestor::div[contains(@class,\"inline\")][1]', root)) {\r\n    $.on(d,    'keydown',   o.hoverend);\r\n  }\r\n  $.on(root, 'mousemove', o.hover);\r\n\r\n  // Workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=674955\r\n  o.workaround = function(e) { if (!root.contains(e.target)) { return o.hoverend(e); } };\r\n  return $.on(doc,  'mousemove', o.workaround);\r\n};\r\n\r\nhoverstart.padding = 25;\r\n\r\nexport var hover = function (e) {\r\n  this.latestEvent = e;\r\n  const height = (this.height || this.el.offsetHeight) + hoverstart.padding;\r\n  const width  = (this.width  || this.el.offsetWidth);\r\n  const {clientX, clientY} = Conf['Follow Cursor'] ? e : this;\r\n\r\n  const top = this.isImage ?\r\n    Math.max(0, (clientY * (this.clientHeight - height)) / this.clientHeight)\r\n  :\r\n    Math.max(0, Math.min(this.clientHeight - height, clientY - 120));\r\n\r\n  let threshold = this.clientWidth / 2;\r\n  if (!this.isImage) { threshold = Math.max(threshold, this.clientWidth - 400); }\r\n  let marginX = (clientX <= threshold ? clientX : this.clientWidth - clientX) + 45;\r\n  if (this.isImage) { marginX = Math.min(marginX, this.clientWidth - width); }\r\n  marginX += 'px';\r\n  const [left, right] = clientX <= threshold ? [marginX, ''] : ['', marginX];\r\n\r\n  const {style} = this;\r\n  style.top   = top + 'px';\r\n  style.left  = left;\r\n  return style.right = right;\r\n};\r\n\r\nexport var hoverend = function (e) {\r\n  if (((e.type === 'keydown') && (e.keyCode !== 13)) || (e.target.nodeName === \"TEXTAREA\")) { return; }\r\n  if (!this.noRemove) { $.rm(this.el); }\r\n  $.off(this.root, this.endEvents,  this.hoverend);\r\n  $.off(d,     'keydown',   this.hoverend);\r\n  $.off(this.root, 'mousemove', this.hover);\r\n  // Workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=674955\r\n  $.off(doc,   'mousemove', this.workaround);\r\n  if (this.cb) { return this.cb.call(this); }\r\n};\r\n\r\nexport const checkbox = function (name, text, checked) {\r\n  if (checked == null) { checked = Conf[name]; }\r\n  const label = $.el('label');\r\n  const input = $.el('input', {type: 'checkbox', name, checked});\r\n  $.add(label, [input, $.tn(` ${text}`)]);\r\n  return label;\r\n};\r\n\r\nconst UI = {\r\n  dialog,\r\n  Menu,\r\n  hover:    hoverstart,\r\n  checkbox\r\n};\r\nexport default UI;\r\n","import Get from \"../General/Get\";\r\nimport Header from \"../General/Header\";\r\nimport { g, Conf, d, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Nav = {\r\n  init() {\r\n    switch (g.VIEW) {\r\n      case 'index':\r\n        if (!Conf['Index Navigation']) { return; }\r\n        break;\r\n      case 'thread':\r\n        if (!Conf['Reply Navigation']) { return; }\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n\r\n    const span = $.el('span',\r\n      {id: 'navlinks'});\r\n    const prev = $.el('a', {\r\n      textContent: '▲',\r\n      href: 'javascript:;'\r\n    }\r\n    );\r\n    const next = $.el('a', {\r\n      textContent: '▼',\r\n      href: 'javascript:;'\r\n    }\r\n    );\r\n\r\n    $.on(prev, 'click', this.prev);\r\n    $.on(next, 'click', this.next);\r\n\r\n    $.add(span, [prev, $.tn(' '), next]);\r\n    var append = function() {\r\n      $.off(d, '4chanXInitFinished', append);\r\n      return $.add(d.body, span);\r\n    };\r\n    return $.on(d, '4chanXInitFinished', append);\r\n  },\r\n\r\n  prev() {\r\n    if (g.VIEW === 'thread') {\r\n      return window.scrollTo(0, 0);\r\n    } else {\r\n      return Nav.scroll(-1);\r\n    }\r\n  },\r\n\r\n  next() {\r\n    if (g.VIEW === 'thread') {\r\n      return window.scrollTo(0, d.body.scrollHeight);\r\n    } else {\r\n      return Nav.scroll(+1);\r\n    }\r\n  },\r\n\r\n  getThread() {\r\n    if (g.VIEW === 'thread') { return g.threads.get(`${g.BOARD}.${g.THREADID}`).nodes.root; }\r\n    if ($.hasClass(doc, 'catalog-mode')) { return; }\r\n    for (var threadRoot of $$(g.SITE.selectors.thread)) {\r\n      var thread = Get.threadFromRoot(threadRoot);\r\n      if (thread.isHidden && !thread.stub) { continue; }\r\n      if (Header.getTopOf(threadRoot) >= -threadRoot.getBoundingClientRect().height) { // not scrolled past\r\n        return threadRoot;\r\n      }\r\n    }\r\n  },\r\n\r\n  scroll(delta) {\r\n    let next;\r\n    d.activeElement?.blur();\r\n    let thread = Nav.getThread();\r\n    if (!thread) { return; }\r\n    const axis = delta === +1 ?\r\n      'following'\r\n    :\r\n      'preceding';\r\n    if (next = $.x(`${axis}-sibling::${g.SITE.xpath.thread}[not(@hidden)][1]`, thread)) {\r\n      // Unless we're not at the beginning of the current thread,\r\n      // and thus wanting to move to beginning,\r\n      // or we're above the first thread and don't want to skip it.\r\n      const top = Header.getTopOf(thread);\r\n      if (((delta === +1) && (top < 5)) || ((delta === -1) && (top > -5))) { thread = next; }\r\n    }\r\n    // Add extra space to the end of the page if necessary so that all threads can be selected by keybinds.\r\n    const extra = (Header.getTopOf(thread) + doc.clientHeight) - d.body.getBoundingClientRect().bottom;\r\n    if (extra > 0) { d.body.style.marginBottom = `${extra}px`; }\r\n\r\n    Header.scrollTo(thread);\r\n\r\n    if ((extra > 0) && !Nav.haveExtra) {\r\n      Nav.haveExtra = true;\r\n      return $.on(d, 'scroll', Nav.removeExtra);\r\n    }\r\n  },\r\n\r\n  removeExtra() {\r\n    const extra = doc.clientHeight - d.body.getBoundingClientRect().bottom;\r\n    if (extra > 0) {\r\n      return d.body.style.marginBottom = `${extra}px`;\r\n    } else {\r\n      d.body.style.marginBottom = '';\r\n      delete Nav.haveExtra;\r\n      return $.off(d, 'scroll', Nav.removeExtra);\r\n    }\r\n  }\r\n};\r\nexport default Nav;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { Conf, g } from \"../globals/globals\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ImageHost = {\r\n  init() {\r\n    if ((!(this.useFaster = /\\S/.test(Conf['fourchanImageHost']))) || (g.SITE.software !== 'yotsuba') || !['index', 'thread'].includes(g.VIEW)) { return; }\r\n    return Callbacks.Post.push({\r\n      name: 'Image Host Rewriting',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  suggestions: ['i.4cdn.org', 'is2.4chan.org'],\r\n\r\n  host() {\r\n    return Conf['fourchanImageHost'].trim() || 'i.4cdn.org';\r\n  },\r\n  flashHost() {\r\n    return 'i.4cdn.org';\r\n  },\r\n  thumbHost() {\r\n    return 'i.4cdn.org';\r\n  },\r\n  test(hostname) {\r\n    return (hostname === 'i.4cdn.org') || ImageHost.regex.test(hostname);\r\n  },\r\n\r\n  regex: /^is\\d*\\.4chan(?:nel)?\\.org$/,\r\n\r\n  node() {\r\n    if (this.isClone) { return; }\r\n    const host = ImageHost.host();\r\n    if (this.file && ImageHost.test(this.file.url.split('/')[2]) && !/\\.swf$/.test(this.file.url)) {\r\n      this.file.link.hostname = host;\r\n      if (this.file.thumbLink) { this.file.thumbLink.hostname = host; }\r\n      this.file.url = this.file.link.href;\r\n    }\r\n    return ImageHost.fixLinks($$('a', this.nodes.comment));\r\n  },\r\n\r\n  fixLinks(links) {\r\n    for (var link of links) {\r\n      if (ImageHost.test(link.hostname) && !/\\.swf$/.test(link.pathname)) {\r\n        var host = ImageHost.host();\r\n        if (link.hostname !== host) { link.hostname = host; }\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default ImageHost;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Config from \"../config/Config\";\r\nimport Header from \"../General/Header\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf, E } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Volume = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) ||\r\n      (!Conf['Image Expansion'] && !Conf['Image Hover'] && !Conf['Image Hover in Catalog'] && !Conf['Gallery'])) { return; }\r\n\r\n    $.sync('Allow Sound', function(x) {\r\n      Conf['Allow Sound'] = x;\r\n      if (Volume.inputs) Volume.inputs.unmute.checked = x;\r\n    });\r\n\r\n    $.sync('Default Volume', function(x) {\r\n      Conf['Default Volume'] = x;\r\n      if (Volume.inputs) Volume.inputs.volume.value = x;\r\n    });\r\n\r\n    if (Conf['Mouse Wheel Volume']) {\r\n      Callbacks.Post.push({\r\n        name: 'Mouse Wheel Volume',\r\n        cb:   this.node\r\n      });\r\n    }\r\n\r\n    if (g.SITE.noAudio?.(g.BOARD)) { return; }\r\n\r\n    if (Conf['Mouse Wheel Volume']) {\r\n      Callbacks.CatalogThread.push({\r\n        name: 'Mouse Wheel Volume',\r\n        cb:   this.catalogNode\r\n      });\r\n    }\r\n\r\n    const unmuteEntry = UI.checkbox('Allow Sound', 'Allow Sound');\r\n    unmuteEntry.title = Config.main['Images and Videos']['Allow Sound'][1];\r\n\r\n    const volumeEntry = $.el('label',\r\n      {title: 'Default volume for videos.'});\r\n    $.extend(volumeEntry,\r\n      {innerHTML: \"<input name=\\\"Default Volume\\\" type=\\\"range\\\" min=\\\"0\\\" max=\\\"1\\\" step=\\\"0.01\\\" value=\\\"\" + E(Conf[\"Default Volume\"]) + \"\\\"> Volume\"});\r\n\r\n    this.inputs = {\r\n      unmute: unmuteEntry.firstElementChild,\r\n      volume: volumeEntry.firstElementChild\r\n    };\r\n\r\n    $.on(this.inputs.unmute, 'change', $.cb.checked);\r\n    $.on(this.inputs.volume, 'change', $.cb.value);\r\n\r\n    Header.menu.addEntry({el: unmuteEntry, order: 200});\r\n    return Header.menu.addEntry({el: volumeEntry, order: 201});\r\n  },\r\n\r\n  setup(video) {\r\n    video.muted  = !Conf['Allow Sound'];\r\n    video.volume = Conf['Default Volume'];\r\n    return $.on(video, 'volumechange', Volume.change);\r\n  },\r\n\r\n  change() {\r\n    const {muted, volume} = this;\r\n    const items = {\r\n      'Allow Sound': !muted,\r\n      'Default Volume': volume\r\n    };\r\n    for (var key in items) {\r\n      var val = items[key];\r\n      if (Conf[key] === val) {\r\n        delete items[key];\r\n      }\r\n    }\r\n    $.set(items);\r\n    $.extend(Conf, items);\r\n    if (Volume.inputs) {\r\n      Volume.inputs.unmute.checked = !muted;\r\n      return Volume.inputs.volume.value = volume;\r\n    }\r\n  },\r\n\r\n  node() {\r\n    if (g.SITE.noAudio?.(this.board)) { return; }\r\n    for (var file of this.files) {\r\n      if (file.isVideo) {\r\n        if (file.thumb) { $.on(file.thumb,                                'wheel', Volume.wheel.bind(Header.hover)); }\r\n        $.on(($('.file-info', file.text) || file.link), 'wheel', Volume.wheel.bind(file.thumbLink));\r\n      }\r\n    }\r\n  },\r\n\r\n  catalogNode() {\r\n    const file = this.thread.OP.files[0];\r\n    if (!file?.isVideo) { return; }\r\n    return $.on(this.nodes.thumb, 'wheel', Volume.wheel.bind(Header.hover));\r\n  },\r\n\r\n  wheel(e) {\r\n    let el;\r\n    if (e.shiftKey || e.altKey || e.ctrlKey || e.metaKey) { return; }\r\n    if (!(el = $('video:not([data-md5])', this))) { return; }\r\n    if (el.muted || !$.hasAudio(el)) { return; }\r\n    let volume = el.volume + 0.1;\r\n    if (e.deltaY < 0) { volume *= 1.1; }\r\n    if (e.deltaY > 0) { volume /= 1.1; }\r\n    el.volume = $.minmax(volume - 0.1, 0, 1);\r\n    return e.preventDefault();\r\n  }\r\n};\r\nexport default Volume;\r\n","import Redirect from \"../Archive/Redirect\";\r\nimport Notice from \"../classes/Notice\";\r\nimport { g, Conf, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport CrossOrigin from \"../platform/CrossOrigin\";\r\nimport ImageHost from \"./ImageHost\";\r\nimport Volume from \"./Volume\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS204: Change includes calls to have a more natural evaluation order\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ImageCommon = {\r\n  // Pause and mute video in preparation for removing the element from the document.\r\n  pause(video) {\r\n    if (video.nodeName !== 'VIDEO') { return; }\r\n    video.pause();\r\n    $.off(video, 'volumechange', Volume.change);\r\n    return video.muted = true;\r\n  },\r\n\r\n  rewind(el) {\r\n    if (el.nodeName === 'VIDEO') {\r\n      if (el.readyState >= el.HAVE_METADATA) { return el.currentTime = 0; }\r\n    } else if (/\\.gif$/.test(el.src)) {\r\n      return $.queueTask(() => el.src = el.src);\r\n    }\r\n  },\r\n\r\n  pushCache(el) {\r\n    ImageCommon.cache = el;\r\n    return $.on(el, 'error', ImageCommon.cacheError);\r\n  },\r\n\r\n  popCache() {\r\n    const el = ImageCommon.cache;\r\n    $.off(el, 'error', ImageCommon.cacheError);\r\n    delete ImageCommon.cache;\r\n    return el;\r\n  },\r\n\r\n  cacheError() {\r\n    if (ImageCommon.cache === this) { return delete ImageCommon.cache; }\r\n  },\r\n\r\n  decodeError(file, fileObj) {\r\n    let message;\r\n    if (file.error?.code !== MediaError.MEDIA_ERR_DECODE) { return false; }\r\n    if (!(message = $('.warning', fileObj.thumb.parentNode))) {\r\n      message = $.el('div', {className:   'warning'});\r\n      $.after(fileObj.thumb, message);\r\n    }\r\n    message.textContent = 'Error: Corrupt or unplayable video';\r\n    return true;\r\n  },\r\n\r\n  isFromArchive(file) {\r\n    return (g.SITE.software === 'yotsuba') && !ImageHost.test(file.src.split('/')[2]);\r\n  },\r\n\r\n  error(file, post, fileObj, delay, cb) {\r\n    let timeoutID;\r\n    const src = fileObj.url.split('/');\r\n    let url = null;\r\n    if ((g.SITE.software === 'yotsuba') && Conf['404 Redirect']) {\r\n      url = Redirect.to('file', {\r\n        boardID:  post.board.ID,\r\n        filename: src[src.length - 1]\r\n      });\r\n    }\r\n    if (!url || !Redirect.securityCheck(url)) { url = null; }\r\n\r\n    if ((post.isDead || fileObj.isDead) && !ImageCommon.isFromArchive(file)) { return cb(url); }\r\n\r\n    if (delay != null) { timeoutID = setTimeout((() => cb(url)), delay); }\r\n    if (post.isDead || fileObj.isDead) { return; }\r\n    const redirect = function() {\r\n      if (!ImageCommon.isFromArchive(file)) {\r\n        if (delay != null) { clearTimeout(timeoutID); }\r\n        return cb(url);\r\n      }\r\n    };\r\n\r\n    const threadJSON = g.SITE.urls.threadJSON?.(post);\r\n    if (!threadJSON) { return; }\r\n    var parseJSON = function(isArchiveURL) {\r\n      let needle, postObj;\r\n      if (this.status === 404) {\r\n        let archivedThreadJSON;\r\n        if (!isArchiveURL && (archivedThreadJSON = g.SITE.urls.archivedThreadJSON?.(post))) {\r\n          $.ajax(archivedThreadJSON, {onloadend() { return parseJSON.call(this, true); }});\r\n        } else {\r\n          post.kill(!post.isClone, fileObj.index);\r\n        }\r\n      }\r\n      if (this.status !== 200) { return redirect(); }\r\n      for (postObj of this.response.posts) {\r\n        if (postObj.no === post.ID) { break; }\r\n      }\r\n      if (postObj.no !== post.ID) {\r\n        post.kill();\r\n        return redirect();\r\n      } else if ((needle = fileObj.docIndex, g.SITE.Build.parseJSON(postObj, post.board).filesDeleted.includes(needle))) {\r\n        post.kill(true);\r\n        return redirect();\r\n      } else {\r\n        return url = fileObj.url;\r\n      }\r\n    };\r\n    return $.ajax(threadJSON, {onloadend() { return parseJSON.call(this); }});\r\n  },\r\n\r\n  // Add controls, but not until the mouse is moved over the video.\r\n  addControls(video) {\r\n    var handler = function() {\r\n      $.off(video, 'mouseover', handler);\r\n      // Hacky workaround for Firefox forever-loading bug for very short videos\r\n      const t = new Date().getTime();\r\n      return $.asap((() => ($.engine !== 'gecko') || ((video.readyState >= 3) && (video.currentTime <= Math.max(0.1, (video.duration - 0.5)))) || (new Date().getTime() >= (t + 1000))), () => video.controls = true);\r\n    };\r\n    return $.on(video, 'mouseover', handler);\r\n  },\r\n\r\n  // XXX Estimate whether clicks are on the video controls and should be ignored.\r\n  onControls(e) {\r\n    return (Conf['Show Controls'] && Conf['Click Passthrough'] && (e.target.nodeName === 'VIDEO')) ||\r\n      (e.target.controls && ((e.target.getBoundingClientRect().bottom - e.clientY) < 35));\r\n  },\r\n\r\n  download(e) {\r\n    if (this.protocol === 'blob:') { return true; }\r\n    e.preventDefault();\r\n    const {href, download} = this;\r\n    return CrossOrigin.file(href, function(blob) {\r\n      if (blob) {\r\n        const a = $.el('a', {\r\n          href: URL.createObjectURL(blob),\r\n          download,\r\n          hidden: true\r\n        }\r\n        );\r\n        $.add(d.body, a);\r\n        a.click();\r\n        return $.rm(a);\r\n      } else {\r\n        return new Notice('warning', `Could not download ${href}`, 20);\r\n      }\r\n    });\r\n  }\r\n};\r\nexport default ImageCommon;\r\n",null,null,null,"import Callbacks from \"../classes/Callbacks\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Menu = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu']) { return; }\r\n\r\n    this.button = $.el('a', {\r\n      className: 'menu-button',\r\n      href:      'javascript:;'\r\n    }\r\n    );\r\n\r\n    $.extend(this.button, {textContent: \"🞃\"});\r\n\r\n    this.menu = new UI.Menu('post');\r\n    Callbacks.Post.push({\r\n      name: 'Menu',\r\n      cb:   this.node\r\n    });\r\n\r\n    return Callbacks.CatalogThread.push({\r\n      name: 'Menu',\r\n      cb:   this.catalogNode\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) {\r\n      const button = $('.menu-button', this.nodes.info);\r\n      $.rmClass(button, 'active');\r\n      $.rm($('.dialog', this.nodes.info));\r\n      Menu.makeButton(this, button);\r\n      return;\r\n    }\r\n    return $.add(this.nodes.info, Menu.makeButton(this));\r\n  },\r\n\r\n  catalogNode() {\r\n    return $.after(this.nodes.icons, Menu.makeButton(this.thread.OP));\r\n  },\r\n\r\n  makeButton(post, button) {\r\n    if (!button) { button = Menu.button.cloneNode(true); }\r\n    $.on(button, 'click', function(e) {\r\n      return Menu.menu.toggle(e, this, post);\r\n    });\r\n    return button;\r\n  }\r\n};\r\nexport default Menu;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g } from \"../globals/globals\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Recursive = {\r\n  recursives: dict(),\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW)) { return; }\r\n    return Callbacks.Post.push({\r\n      name: 'Recursive',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone || this.isFetchedQuote) { return; }\r\n    for (var quote of this.quotes) {\r\n      var obj;\r\n      if ((obj = Recursive.recursives[quote])) {\r\n        for (var i = 0; i < obj.recursives.length; i++) {\r\n          var recursive = obj.recursives[i];\r\n          recursive(this, ...obj.args[i]);\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  add(recursive, post, ...args) {\r\n    const obj = Recursive.recursives[post.fullID] || (Recursive.recursives[post.fullID] = {\r\n      recursives: [],\r\n      args: []\r\n    });\r\n    obj.recursives.push(recursive);\r\n    return obj.args.push(args);\r\n  },\r\n\r\n  rm(recursive, post) {\r\n    let obj;\r\n    if (!(obj = Recursive.recursives[post.fullID])) { return; }\r\n    for (let i = 0; i < obj.recursives.length; i++) {\r\n      var rec = obj.recursives[i];\r\n      if (rec === recursive) {\r\n        obj.recursives.splice(i, 1);\r\n        obj.args.splice(i, 1);\r\n      }\r\n    }\r\n  },\r\n\r\n  apply(recursive, post, ...args) {\r\n    const {fullID} = post;\r\n    return g.posts.forEach(function(post) {\r\n      if (post.quotes.includes(fullID)) {\r\n        return recursive(post, ...args);\r\n      }\r\n    });\r\n  }\r\n};\r\nexport default Recursive;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport DataBoard from \"../classes/DataBoard\";\r\nimport Get from \"../General/Get\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport Menu from \"../Menu/Menu\";\r\nimport $ from \"../platform/$\";\r\nimport Recursive from \"./Recursive\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar PostHiding = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || (!Conf['Reply Hiding Buttons'] && !(Conf['Menu'] && Conf['Reply Hiding Link']))) { return; }\r\n\r\n    if (Conf['Reply Hiding Buttons']) {\r\n      $.addClass(doc, \"reply-hide\");\r\n    }\r\n\r\n    this.db = new DataBoard('hiddenPosts');\r\n    return Callbacks.Post.push({\r\n      name: 'Reply Hiding',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  isHidden(boardID, threadID, postID) {\r\n    return !!(PostHiding.db && PostHiding.db.get({boardID, threadID, postID}));\r\n  },\r\n\r\n  node() {\r\n    let data, sa;\r\n    if (!this.isReply || this.isClone || this.isFetchedQuote) { return; }\r\n\r\n    if (data = PostHiding.db.get({boardID: this.board.ID, threadID: this.thread.ID, postID: this.ID})) {\r\n      if (data.thisPost) {\r\n        PostHiding.hide(this, data.makeStub, data.hideRecursively);\r\n      } else {\r\n        Recursive.apply(PostHiding.hide, this, data.makeStub, true);\r\n        Recursive.add(PostHiding.hide, this, data.makeStub, true);\r\n      }\r\n    }\r\n\r\n    if (!Conf['Reply Hiding Buttons']) { return; }\r\n\r\n    const button = PostHiding.makeButton(this, 'hide');\r\n    if (sa = g.SITE.selectors.sideArrows) {\r\n      const sideArrows = $(sa, this.nodes.root);\r\n      $.replace(sideArrows.firstChild, button);\r\n      return sideArrows.className = 'replacedSideArrows';\r\n    } else {\r\n      return $.prepend(this.nodes.info, button);\r\n    }\r\n  },\r\n\r\n  menu: {\r\n    init() {\r\n      if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Reply Hiding Link']) { return; }\r\n\r\n      // Hide\r\n      let div = $.el('div', {\r\n        className: 'hide-reply-link',\r\n        textContent: 'Hide'\r\n      }\r\n      );\r\n\r\n      let apply = $.el('a', {\r\n        textContent: 'Apply',\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.on(apply, 'click', PostHiding.menu.hide);\r\n\r\n      let thisPost = UI.checkbox('thisPost', 'This post',    true);\r\n      let replies  = UI.checkbox('replies',  'Hide replies', Conf['Recursive Hiding']);\r\n      const makeStub = UI.checkbox('makeStub', 'Make stub',    Conf['Stubs']);\r\n\r\n      Menu.menu.addEntry({\r\n        el: div,\r\n        order: 20,\r\n        open(post) {\r\n          if (!post.isReply || post.isClone || post.isHidden) {\r\n            return false;\r\n          }\r\n          PostHiding.menu.post = post;\r\n          return true;\r\n        },\r\n        subEntries: [\r\n            {el: apply}\r\n          ,\r\n            {el: thisPost}\r\n          ,\r\n            {el: replies}\r\n          ,\r\n            {el: makeStub}\r\n        ]});\r\n\r\n      // Show\r\n      div = $.el('div', {\r\n        className: 'show-reply-link',\r\n        textContent: 'Show'\r\n      }\r\n      );\r\n\r\n      apply = $.el('a', {\r\n        textContent: 'Apply',\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.on(apply, 'click', PostHiding.menu.show);\r\n\r\n      thisPost = UI.checkbox('thisPost', 'This post',    false);\r\n      replies  = UI.checkbox('replies',  'Show replies', false);\r\n      const hideStubLink = $.el('a', {\r\n        textContent: 'Hide stub',\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.on(hideStubLink, 'click', PostHiding.menu.hideStub);\r\n\r\n      Menu.menu.addEntry({\r\n        el: div,\r\n        order: 20,\r\n        open(post) {\r\n          let data;\r\n          if (!post.isReply || post.isClone || !post.isHidden) {\r\n            return false;\r\n          }\r\n          if (!(data = PostHiding.db.get({boardID: post.board.ID, threadID: post.thread.ID, postID: post.ID}))) {\r\n            return false;\r\n          }\r\n          PostHiding.menu.post = post;\r\n          thisPost.firstChild.checked = post.isHidden;\r\n          replies.firstChild.checked  = (data?.hideRecursively != null) ? data.hideRecursively : Conf['Recursive Hiding'];\r\n          return true;\r\n        },\r\n        subEntries: [\r\n            {el: apply}\r\n          ,\r\n            {el: thisPost}\r\n          ,\r\n            {el: replies}\r\n        ]});\r\n\r\n      return Menu.menu.addEntry({\r\n        el: hideStubLink,\r\n        order: 15,\r\n        open(post) {\r\n          let data;\r\n          if (!post.isReply || post.isClone || !post.isHidden) {\r\n            return false;\r\n          }\r\n          if (!(data = PostHiding.db.get({boardID: post.board.ID, threadID: post.thread.ID, postID: post.ID}))) {\r\n            return false;\r\n          }\r\n          return PostHiding.menu.post = post;\r\n        }\r\n      });\r\n    },\r\n\r\n    hide() {\r\n      const parent   = this.parentNode;\r\n      const thisPost = $('input[name=thisPost]', parent).checked;\r\n      const replies  = $('input[name=replies]',  parent).checked;\r\n      const makeStub = $('input[name=makeStub]', parent).checked;\r\n      const {post}   = PostHiding.menu;\r\n      if (thisPost) {\r\n        PostHiding.hide(post, makeStub, replies);\r\n      } else if (replies) {\r\n        Recursive.apply(PostHiding.hide, post, makeStub, true);\r\n        Recursive.add(PostHiding.hide, post, makeStub, true);\r\n      } else {\r\n        return;\r\n      }\r\n      PostHiding.saveHiddenState(post, true, thisPost, makeStub, replies);\r\n      return $.event('CloseMenu');\r\n    },\r\n\r\n    show() {\r\n      let data;\r\n      const parent   = this.parentNode;\r\n      const thisPost = $('input[name=thisPost]', parent).checked;\r\n      const replies  = $('input[name=replies]',  parent).checked;\r\n      const {post}   = PostHiding.menu;\r\n      if (thisPost) {\r\n        PostHiding.show(post, replies);\r\n      } else if (replies) {\r\n        Recursive.apply(PostHiding.show, post, true);\r\n        Recursive.rm(PostHiding.hide, post, true);\r\n      } else {\r\n        return;\r\n      }\r\n      if (data = PostHiding.db.get({boardID: post.board.ID, threadID: post.thread.ID, postID: post.ID})) {\r\n        PostHiding.saveHiddenState(post, !(thisPost && replies), !thisPost, data.makeStub, !replies);\r\n      }\r\n      return $.event('CloseMenu');\r\n    },\r\n    hideStub() {\r\n      let data;\r\n      const {post} = PostHiding.menu;\r\n      if (data = PostHiding.db.get({boardID: post.board.ID, threadID: post.thread.ID, postID: post.ID})) {\r\n        PostHiding.show(post, data.hideRecursively);\r\n        PostHiding.hide(post, false, data.hideRecursively);\r\n        PostHiding.saveHiddenState(post, true, true, false, data.hideRecursively);\r\n      }\r\n      $.event('CloseMenu');\r\n    }\r\n  },\r\n\r\n  makeButton(post, type) {\r\n    const span = $.el('span', {\r\n      textContent: type === 'hide' ? '➖︎' : '➕︎',\r\n    });\r\n    const a = $.el('a', {\r\n      className: `${type}-reply-button`,\r\n      href:      'javascript:;'\r\n    }\r\n    );\r\n    $.add(a, span);\r\n    $.on(a, 'click', PostHiding.toggle);\r\n    return a;\r\n  },\r\n\r\n  saveHiddenState(post, isHiding, thisPost, makeStub, hideRecursively) {\r\n    const data = {\r\n      boardID:  post.board.ID,\r\n      threadID: post.thread.ID,\r\n      postID:   post.ID\r\n    };\r\n    if (isHiding) {\r\n      data.val = {\r\n        thisPost: thisPost !== false, // undefined -> true\r\n        makeStub,\r\n        hideRecursively\r\n      };\r\n      return PostHiding.db.set(data);\r\n    } else {\r\n      return PostHiding.db.delete(data);\r\n    }\r\n  },\r\n\r\n  toggle() {\r\n    const post = Get.postFromNode(this);\r\n    PostHiding[(post.isHidden ? 'show' : 'hide')](post);\r\n    return PostHiding.saveHiddenState(post, post.isHidden);\r\n  },\r\n\r\n  hide(post, makeStub=Conf['Stubs'], hideRecursively=Conf['Recursive Hiding']) {\r\n    if (post.isHidden) { return; }\r\n    post.isHidden = true;\r\n\r\n    if (hideRecursively) {\r\n      Recursive.apply(PostHiding.hide, post, makeStub, true);\r\n      Recursive.add(PostHiding.hide, post, makeStub, true);\r\n    }\r\n\r\n    for (var quotelink of Get.allQuotelinksLinkingTo(post)) {\r\n      $.addClass(quotelink, 'filtered');\r\n    }\r\n\r\n    if (!makeStub) {\r\n      post.nodes.root.hidden = true;\r\n      return;\r\n    }\r\n\r\n    const a = PostHiding.makeButton(post, 'show');\r\n    $.add(a, $.tn(` ${post.info.nameBlock}`));\r\n    post.nodes.stub = $.el('div',\r\n      {className: 'stub'});\r\n    $.add(post.nodes.stub, a);\r\n    if (Conf['Menu']) {\r\n      $.add(post.nodes.stub, Menu.makeButton(post));\r\n    }\r\n    return $.prepend(post.nodes.root, post.nodes.stub);\r\n  },\r\n\r\n  show(post, showRecursively=Conf['Recursive Hiding']) {\r\n    if (post.nodes.stub) {\r\n      $.rm(post.nodes.stub);\r\n      delete post.nodes.stub;\r\n    } else {\r\n      post.nodes.root.hidden = false;\r\n    }\r\n    post.isHidden = false;\r\n    if (showRecursively) {\r\n      Recursive.apply(PostHiding.show, post, true);\r\n      Recursive.rm(PostHiding.hide, post);\r\n    }\r\n    for (var quotelink of Get.allQuotelinksLinkingTo(post)) {\r\n      $.rmClass(quotelink, 'filtered');\r\n    }\r\n  }\r\n};\r\nexport default PostHiding;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Post from \"../classes/Post\";\r\nimport Index from \"../General/Index\";\r\nimport { g, Conf, d, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { DAY, HOUR, MINUTE, SECOND } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar RelativeDates = {\r\n  INTERVAL: 30000,\r\n\r\n  init() {\r\n    if (\r\n      (['index', 'thread', 'archive'].includes(g.VIEW) && Conf['Relative Post Dates'] && !Conf['Relative Date Title']) ||\r\n      Index.enabled\r\n    ) {\r\n      this.flush();\r\n      $.on(d, 'visibilitychange PostsInserted', this.flush);\r\n    }\r\n\r\n    if (Conf['Relative Post Dates']) {\r\n      return Callbacks.Post.push({\r\n        name: 'Relative Post Dates',\r\n        cb:   this.node\r\n      });\r\n    }\r\n  },\r\n\r\n  node() {\r\n    if (!this.info.date) { return; }\r\n    const dateEl = this.nodes.date;\r\n    if (Conf['Relative Date Title']) {\r\n      $.on(dateEl, 'mouseover', () => RelativeDates.hover(this));\r\n      return;\r\n    }\r\n    if (this.isClone) { return; }\r\n\r\n    // Show original absolute time as tooltip so users can still know exact times\r\n    // Since \"Time Formatting\" runs its `node` before us, the title tooltip will\r\n    // pick up the user-formatted time instead of 4chan time when enabled.\r\n    dateEl.title = dateEl.textContent;\r\n\r\n    return RelativeDates.update(this);\r\n  },\r\n\r\n  // diff is milliseconds from now.\r\n  relative(diff, now, date, abbrev) {\r\n    let number;\r\n    let unit = (() => {\r\n      if ((number = (diff / DAY)) >= 1) {\r\n      const years  = now.getFullYear()  - date.getFullYear();\r\n        let months = now.getMonth() - date.getMonth();\r\n      const days   = now.getDate()  - date.getDate();\r\n        if (years > 1) {\r\n          number = years - ((months < 0) || ((months === 0) && (days < 0)));\r\n          return 'year';\r\n        } else if ((years === 1) && ((months > 0) || ((months === 0) && (days >= 0)))) {\r\n          number = years;\r\n          return 'year';\r\n      } else if ((months = months + (12*years)) > 1) {\r\n          number = months - (days < 0);\r\n          return 'month';\r\n        } else if ((months === 1) && (days >= 0)) {\r\n          number = months;\r\n          return 'month';\r\n        } else {\r\n          return 'day';\r\n        }\r\n    } else if ((number = (diff / HOUR)) >= 1) {\r\n      return 'hour';\r\n    } else if ((number = (diff / MINUTE)) >= 1) {\r\n      return 'minute';\r\n    } else {\r\n      // prevent \"-1 seconds ago\"\r\n      number = Math.max(0, diff) / SECOND;\r\n      return 'second';\r\n    }\r\n    })();\r\n\r\n    const rounded = Math.round(number);\r\n\r\n    if (abbrev) {\r\n      unit = unit === 'month' ? 'mo' : unit[0];\r\n    } else {\r\n      if (rounded !== 1) { unit += 's'; } // pluralize\r\n    }\r\n\r\n    if (abbrev) { return `${rounded}${unit}`; } else { return `${rounded} ${unit} ago`; }\r\n  },\r\n\r\n  // Changing all relative dates as soon as possible incurs many annoying\r\n  // redraws and scroll stuttering. Thus, sacrifice accuracy for UX/CPU economy,\r\n  // and perform redraws when the DOM is otherwise being manipulated (and scroll\r\n  // stuttering won't be noticed), falling back to INTERVAL while the page\r\n  // is visible.\r\n  //\r\n  // Each individual dateTime element will add its update() function to the stale list\r\n  // when it is to be called.\r\n  stale: [],\r\n  flush() {\r\n    // No point in changing the dates until the user sees them.\r\n    if (d.hidden) { return; }\r\n\r\n    const now = new Date();\r\n    for (var data of RelativeDates.stale) { RelativeDates.update(data, now); }\r\n    RelativeDates.stale = [];\r\n\r\n    // Reset automatic flush.\r\n    clearTimeout(RelativeDates.timeout);\r\n    return RelativeDates.timeout = setTimeout(RelativeDates.flush, RelativeDates.INTERVAL);\r\n  },\r\n\r\n  hover(post) {\r\n    const {\r\n      date\r\n    } = post.info;\r\n    const now  = new Date();\r\n    const diff = now - date;\r\n    return post.nodes.date.title = RelativeDates.relative(diff, now, date);\r\n  },\r\n\r\n  // `update()`, when called from `flush()`, updates the elements,\r\n  // and re-calls `setOwnTimeout()` to re-add `data` to the stale list later.\r\n  update(data, now) {\r\n    let abbrev, date;\r\n    const isPost = data instanceof Post;\r\n    if (isPost) {\r\n      ({\r\n        date\r\n      } = data.info);\r\n      abbrev = false;\r\n    } else {\r\n      date = new Date(+data.dataset.utc);\r\n      abbrev = !!data.dataset.abbrev;\r\n    }\r\n    if (!now) { now = new Date(); }\r\n    const diff = now - date;\r\n    const relative = RelativeDates.relative(diff, now, date, abbrev);\r\n    if (isPost) {\r\n      for (var singlePost of [data].concat(data.clones)) {\r\n        singlePost.nodes.date.firstChild.textContent = relative;\r\n      }\r\n    } else {\r\n      data.firstChild.textContent = relative;\r\n    }\r\n    return RelativeDates.setOwnTimeout(diff, data);\r\n  },\r\n\r\n  setOwnTimeout(diff, data) {\r\n    const delay = diff < MINUTE ?\r\n      SECOND - ((diff + (SECOND / 2)) % SECOND)\r\n    : diff < HOUR ?\r\n      MINUTE - ((diff + (MINUTE / 2)) % MINUTE)\r\n    : diff < DAY ?\r\n      HOUR - ((diff + (HOUR / 2)) % HOUR)\r\n    :\r\n      DAY - ((diff + (DAY / 2)) % DAY);\r\n    return setTimeout(RelativeDates.markStale, delay, data);\r\n  },\r\n\r\n  markStale(data) {\r\n    if (RelativeDates.stale.includes(data)) { return; } // We can call RelativeDates.update() multiple times.\r\n    if (data instanceof Post && !g.posts.get(data.fullID)) { return; } // collected post.\r\n    if (data instanceof Element && !doc.contains(data)) { return; } // removed catalog reply.\r\n    return RelativeDates.stale.push(data);\r\n  }\r\n};\r\nexport default RelativeDates;\r\n","import Notice from \"../classes/Notice\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { dict, HOUR } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar BoardConfig = {\r\n  cbs: [],\r\n\r\n  init() {\r\n    let middle;\r\n    if (g.SITE.software !== 'yotsuba') { return; }\r\n    const now = Date.now();\r\n    if (now - (2 * HOUR) >= ((middle = Conf['boardConfig'].lastChecked || 0)) || middle > now) {\r\n      return $.ajax(`${location.protocol}//a.4cdn.org/boards.json`,\r\n        {onloadend: this.load});\r\n    } else {\r\n      const {boards} = Conf['boardConfig'];\r\n      return this.set(boards);\r\n    }\r\n  },\r\n\r\n  load() {\r\n    let boards;\r\n    if ((this.status === 200) && this.response && this.response.boards) {\r\n      boards = dict();\r\n      for (var board of this.response.boards) {\r\n        boards[board.board] = board;\r\n      }\r\n      $.set('boardConfig', {boards, lastChecked: Date.now()});\r\n    } else {\r\n      ({boards} = Conf['boardConfig']);\r\n      const err = (() => { switch (this.status) {\r\n        case 0:   return 'Connection Error';\r\n        case 200: return 'Invalid Data';\r\n        default:          return `Error ${this.statusText} (${this.status})`;\r\n      } })();\r\n      new Notice('warning', `Failed to load board configuration. ${err}`, 20);\r\n    }\r\n    return BoardConfig.set(boards);\r\n  },\r\n\r\n  set(boards) {\r\n    this.boards = boards;\r\n    for (var ID in g.boards) {\r\n      var board = g.boards[ID];\r\n      board.config = this.boards[ID] || {};\r\n    }\r\n    for (var cb of this.cbs) {\r\n      $.queueTask(cb);\r\n    }\r\n  },\r\n\r\n  ready(cb) {\r\n    if (this.boards) {\r\n      return cb();\r\n    } else {\r\n      return this.cbs.push(cb);\r\n    }\r\n  },\r\n\r\n  sfwBoards(sfw) {\r\n    return (() => {\r\n      const result = [];\r\n      const object = this.boards || Conf['boardConfig'].boards;\r\n      for (var board in object) {\r\n        var data = object[board];\r\n        if (!!data.ws_board === sfw) {\r\n          result.push(board);\r\n        }\r\n      }\r\n      return result;\r\n    })();\r\n  },\r\n\r\n  isSFW(board) {\r\n    return !!(this.boards || Conf['boardConfig'].boards)[board]?.ws_board;\r\n  },\r\n\r\n  domain(board) {\r\n    // return `boards.${BoardConfig.isSFW(board) ? '4channel' : '4chan'}.org`;\r\n    return 'boards.4chan.org';\r\n  },\r\n\r\n  isArchived(board) {\r\n    // assume archive exists if no data available to prevent cleaning of archived threads\r\n    const data = (this.boards || Conf['boardConfig'].boards)[board];\r\n    return !data || data.is_archived;\r\n  },\r\n\r\n  noAudio(boardID) {\r\n    if (g.SITE.software !== 'yotsuba') { return false; }\r\n    const boards = this.boards || Conf['boardConfig'].boards;\r\n    return boards && boards[boardID] && !boards[boardID].webm_audio;\r\n  },\r\n\r\n  title(boardID) {\r\n    return (this.boards || Conf['boardConfig'].boards)?.[boardID]?.title || '';\r\n  }\r\n};\r\nexport default BoardConfig;\r\n",null,"import { d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst PostRedirect = {\r\n  init() {\r\n    return $.on(d, 'QRPostSuccessful', e => {\r\n      if (!e.detail.redirect) { return; }\r\n      this.event = e;\r\n      this.delays = 0;\r\n      return $.queueTask(() => {\r\n        if ((e === this.event) && (this.delays === 0)) {\r\n          return location.href = e.detail.redirect;\r\n        }\r\n      });\r\n    });\r\n  },\r\n\r\n  delays: 0,\r\n\r\n  delay() {\r\n    if (!this.event) { return null; }\r\n    const e = this.event;\r\n    this.delays++;\r\n    return () => {\r\n      if (e !== this.event) { return; }\r\n      this.delays--;\r\n      if (this.delays === 0) {\r\n        return location.href = e.detail.redirect;\r\n      }\r\n    };\r\n  }\r\n};\r\nexport default PostRedirect;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Get from \"../General/Get\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ExpandComment = {\r\n  init() {\r\n    if ((g.VIEW !== 'index') || !Conf['Comment Expansion'] || Conf['JSON Index']) { return; }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Comment Expansion',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    let a;\r\n    if (a = $('.abbr > a:not([onclick])', this.nodes.comment)) {\r\n      return $.on(a, 'click', ExpandComment.cb);\r\n    }\r\n  },\r\n\r\n  callbacks: [],\r\n\r\n  cb(e) {\r\n    e.preventDefault();\r\n    return ExpandComment.expand(Get.postFromNode(this));\r\n  },\r\n\r\n  expand(post) {\r\n    let a;\r\n    if (post.nodes.longComment && !post.nodes.longComment.parentNode) {\r\n      $.replace(post.nodes.shortComment, post.nodes.longComment);\r\n      post.nodes.comment = post.nodes.longComment;\r\n      return;\r\n    }\r\n    if (!(a = $('.abbr > a', post.nodes.comment))) { return; }\r\n    a.textContent = `Post No.${post} Loading...`;\r\n    return $.cache(g.SITE.urls.threadJSON({boardID: post.boardID, threadID: post.threadID}), function() { return ExpandComment.parse(this, a, post); });\r\n  },\r\n\r\n  contract(post) {\r\n    if (!post.nodes.shortComment) { return; }\r\n    const a = $('.abbr > a', post.nodes.shortComment);\r\n    a.textContent = 'here';\r\n    $.replace(post.nodes.longComment, post.nodes.shortComment);\r\n    return post.nodes.comment = post.nodes.shortComment;\r\n  },\r\n\r\n  parse(req, a, post) {\r\n    let postObj, spoilerRange;\r\n    const {status} = req;\r\n    if (![200, 304].includes(status)) {\r\n      a.textContent = status ? `Error ${req.statusText} (${status})` : 'Connection Error';\r\n      return;\r\n    }\r\n\r\n    const {\r\n      posts\r\n    } = req.response;\r\n    if (spoilerRange = posts[0].custom_spoiler) {\r\n      g.SITE.Build.spoilerRange[g.BOARD] = spoilerRange;\r\n    }\r\n\r\n    for (postObj of posts) {\r\n      if (postObj.no === post.ID) { break; }\r\n    }\r\n    if (postObj.no !== post.ID) {\r\n      a.textContent = `Post No.${post} not found.`;\r\n      return;\r\n    }\r\n\r\n    const {comment} = post.nodes;\r\n    const clone = comment.cloneNode(false);\r\n    clone.innerHTML = postObj.com;\r\n    // Fix pathnames\r\n    for (var quote of $$('.quotelink', clone)) {\r\n      var href = quote.getAttribute('href');\r\n      if (href[0] === '/') { continue; } // Cross-board quote, or board link\r\n      if (href[0] === '#') {\r\n        quote.href = `${a.pathname.split(/\\/+/).splice(0,4).join('/')}${href}`;\r\n      } else {\r\n        quote.href = `${a.pathname.split(/\\/+/).splice(0,3).join('/')}/${href}`;\r\n      }\r\n    }\r\n    post.nodes.shortComment = comment;\r\n    $.replace(comment, clone);\r\n    post.nodes.comment = (post.nodes.longComment = clone);\r\n    post.parseComment();\r\n    post.parseQuotes();\r\n\r\n    for (var callback of ExpandComment.callbacks) {\r\n      callback.call(post);\r\n    }\r\n  }\r\n};\r\nexport default ExpandComment;;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport DataBoard from \"../classes/DataBoard\";\r\nimport Notice from \"../classes/Notice\";\r\nimport Get from \"../General/Get\";\r\nimport Header from \"../General/Header\";\r\nimport { Conf, d, doc, g } from \"../globals/globals\";\r\nimport Menu from \"../Menu/Menu\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport PostRedirect from \"../Posting/PostRedirect\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar QuoteYou = {\r\n  init() {\r\n    if (!Conf['Remember Your Posts']) { return; }\r\n\r\n    this.db = new DataBoard('yourPosts');\r\n    $.sync('Remember Your Posts', enabled => Conf['Remember Your Posts'] = enabled);\r\n    $.on(d, 'QRPostSuccessful', function(e) {\r\n      const cb = PostRedirect.delay();\r\n      return $.get('Remember Your Posts', Conf['Remember Your Posts'], function(items) {\r\n        if (!items['Remember Your Posts']) { return; }\r\n        const {boardID, threadID, postID} = e.detail;\r\n        return QuoteYou.db.set({boardID, threadID, postID, val: true}, cb);\r\n      });\r\n    });\r\n\r\n    if (!['index', 'thread', 'archive'].includes(g.VIEW)) { return; }\r\n\r\n    if (Conf['Highlight Own Posts']) {\r\n      $.addClass(doc, 'highlight-own');\r\n    }\r\n\r\n    if (Conf['Highlight Posts Quoting You']) {\r\n      $.addClass(doc, 'highlight-you');\r\n    }\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    // \\u00A0 is nbsp\r\n    this.mark = $.el('span', {\r\n      textContent: '\\u00A0(You)',\r\n      className:   'qmark-you'\r\n    }\r\n    );\r\n    Callbacks.Post.push({\r\n      name: 'Mark Quotes of You',\r\n      cb:   this.node\r\n    });\r\n\r\n    return QuoteYou.menu.init();\r\n  },\r\n\r\n  isYou(post) {\r\n    return !!QuoteYou.db?.get({\r\n      boardID:  post.boardID,\r\n      threadID: post.threadID,\r\n      postID:   post.ID\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) { return; }\r\n\r\n    if (QuoteYou.isYou(this)) {\r\n      $.addClass(this.nodes.root, 'yourPost');\r\n    }\r\n\r\n    // Stop there if there's no quotes in that post.\r\n    if (!this.quotes.length) { return; }\r\n\r\n    for (var quotelink of this.nodes.quotelinks) {\r\n      if (QuoteYou.db.get(Get.postDataFromLink(quotelink))) {\r\n        if (Conf['Mark Quotes of You']) { $.add(quotelink, QuoteYou.mark.cloneNode(true)); }\r\n        $.addClass(quotelink, 'you');\r\n        $.addClass(this.nodes.root, 'quotesYou');\r\n      }\r\n    }\r\n  },\r\n\r\n  menu: {\r\n    init() {\r\n      const label = $.el('label',\r\n        {className: 'toggle-you'}\r\n      ,\r\n        {innerHTML: '<input type=\"checkbox\"> You'});\r\n      const input = $('input', label);\r\n      $.on(input, 'change', QuoteYou.menu.toggle);\r\n      return Menu.menu?.addEntry({\r\n        el: label,\r\n        order: 80,\r\n        open(post) {\r\n          QuoteYou.menu.post = (post.origin || post);\r\n          input.checked = QuoteYou.isYou(post);\r\n          return true;\r\n        }\r\n      });\r\n    },\r\n\r\n    toggle() {\r\n      const {post} = QuoteYou.menu;\r\n      const data = {boardID: post.board.ID, threadID: post.thread.ID, postID: post.ID, val: true};\r\n      if (this.checked) {\r\n        QuoteYou.db.set(data);\r\n      } else {\r\n        QuoteYou.db.delete(data);\r\n      }\r\n      for (var clone of [post].concat(post.clones)) {\r\n        clone.nodes.root.classList.toggle('yourPost', this.checked);\r\n      }\r\n      for (var quotelink of Get.allQuotelinksLinkingTo(post)) {\r\n        if (this.checked) {\r\n          if (Conf['Mark Quotes of You']) { $.add(quotelink, QuoteYou.mark.cloneNode(true)); }\r\n        } else {\r\n          $.rm($('.qmark-you', quotelink));\r\n        }\r\n        quotelink.classList.toggle('you', this.checked);\r\n        if ($.hasClass(quotelink, 'quotelink')) {\r\n          var quoter = Get.postFromNode(quotelink).nodes.root;\r\n          quoter.classList.toggle('quotesYou', !!$('.quotelink.you', quoter));\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  cb: {\r\n    seek(type) {\r\n      let highlighted, post;\r\n      let result;\r\n      const {highlight} = g.SITE.classes;\r\n      if (highlighted = $(`.${highlight}`)) { $.rmClass(highlighted, highlight); }\r\n\r\n      if (!QuoteYou.lastRead || !doc.contains(QuoteYou.lastRead) || !$.hasClass(QuoteYou.lastRead, 'quotesYou')) {\r\n        if (!(post = (QuoteYou.lastRead = $('.quotesYou')))) {\r\n          new Notice('warning', 'No posts are currently quoting you, loser.', 20);\r\n          return;\r\n        }\r\n        if (QuoteYou.cb.scroll(post)) { return; }\r\n      } else {\r\n        post = QuoteYou.lastRead;\r\n      }\r\n\r\n      const str = `${type}::div[contains(@class,'quotesYou')]`;\r\n\r\n      while (post = (result = $.X(str, post)).snapshotItem(type === 'preceding' ? result.snapshotLength - 1 : 0)) {\r\n        if (QuoteYou.cb.scroll(post)) { return; }\r\n      }\r\n\r\n      const posts = $$('.quotesYou');\r\n      return QuoteYou.cb.scroll(posts[type === 'following' ? 0 : posts.length - 1]);\r\n    },\r\n\r\n    scroll(root) {\r\n      const post = Get.postFromRoot(root);\r\n      if (!post.nodes.post.getBoundingClientRect().height) {\r\n        return false;\r\n      } else {\r\n        QuoteYou.lastRead = root;\r\n        location.href = Get.url('post', post);\r\n        Header.scrollTo(post.nodes.post);\r\n        if (post.isReply) {\r\n          const sel = `${g.SITE.selectors.postContainer}${g.SITE.selectors.highlightable.reply}`;\r\n          let node = post.nodes.root;\r\n          if (!node.matches(sel)) { node = $(sel, node); }\r\n          $.addClass(node, g.SITE.classes.highlight);\r\n        }\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default QuoteYou;\r\n","/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nexport default class RandomAccessList {\r\n  constructor(items) {\r\n    this.length = 0;\r\n    if (items) { for (var item of items) { this.push(item); } }\r\n  }\r\n\r\n  push(data) {\r\n    let item;\r\n    let {ID} = data;\r\n    if (!ID) { ID = data.id; }\r\n    if (this[ID]) { return; }\r\n    const {last} = this;\r\n    this[ID] = (item = {\r\n      prev: last,\r\n      next: null,\r\n      data,\r\n      ID\r\n    });\r\n    item.prev = last;\r\n    this.last = last ?\r\n      (last.next = item)\r\n    :\r\n      (this.first = item);\r\n    return this.length++;\r\n  }\r\n\r\n  before(root, item) {\r\n    if ((item.next === root) || (item === root)) { return; }\r\n\r\n    this.rmi(item);\r\n\r\n    const {prev} = root;\r\n    root.prev = item;\r\n    item.next = root;\r\n    item.prev = prev;\r\n    if (prev) {\r\n      return prev.next = item;\r\n    } else {\r\n      return this.first = item;\r\n    }\r\n  }\r\n\r\n  after(root, item) {\r\n    if ((item.prev === root) || (item === root)) { return; }\r\n\r\n    this.rmi(item);\r\n\r\n    const {next} = root;\r\n    root.next = item;\r\n    item.prev = root;\r\n    item.next = next;\r\n    if (next) {\r\n      return next.prev = item;\r\n    } else {\r\n      return this.last = item;\r\n    }\r\n  }\r\n\r\n  prepend(item) {\r\n    const {first} = this;\r\n    if ((item === first) || !this[item.ID]) { return; }\r\n    this.rmi(item);\r\n    item.next  = first;\r\n    if (first) {\r\n      first.prev = item;\r\n    } else {\r\n      this.last = item;\r\n    }\r\n    this.first = item;\r\n    return delete item.prev;\r\n  }\r\n\r\n  shift() {\r\n    return this.rm(this.first.ID);\r\n  }\r\n\r\n  order() {\r\n    let item;\r\n    const order = [(item = this.first)];\r\n    while ((item = item.next)) { order.push(item); }\r\n    return order;\r\n  }\r\n\r\n  rm(ID) {\r\n    const item = this[ID];\r\n    if (!item) { return; }\r\n    delete this[ID];\r\n    this.length--;\r\n    this.rmi(item);\r\n    delete item.next;\r\n    return delete item.prev;\r\n  }\r\n\r\n  rmi(item) {\r\n    const {prev, next} = item;\r\n    if (prev) {\r\n      prev.next = next;\r\n    } else {\r\n      this.first = next;\r\n    }\r\n    if (next) {\r\n      return next.prev = prev;\r\n    } else {\r\n      return this.last = prev;\r\n    }\r\n  }\r\n}\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport DataBoard from \"../classes/DataBoard\";\r\nimport RandomAccessList from \"../classes/RandomAccessList\";\r\nimport Get from \"../General/Get\";\r\nimport Header from \"../General/Header\";\r\nimport { g, Conf, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { debounce, SECOND } from \"../platform/helpers\";\r\nimport QuoteYou from \"../Quotelinks/QuoteYou\";\r\nimport Favicon from \"./Favicon\";\r\nimport ThreadWatcher from \"./ThreadWatcher\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Unread = {\r\n  init() {\r\n    if ((g.VIEW !== 'thread') || (\r\n      !Conf['Unread Count'] &&\r\n      !Conf['Unread Favicon'] &&\r\n      !Conf['Unread Line'] &&\r\n      !Conf['Remember Last Read Post'] &&\r\n      !Conf['Desktop Notifications'] &&\r\n      !Conf['Quote Threading']\r\n    )) { return; }\r\n\r\n    if (Conf['Remember Last Read Post']) {\r\n      $.sync('Remember Last Read Post', enabled => Conf['Remember Last Read Post'] = enabled);\r\n      this.db = new DataBoard('lastReadPosts', this.sync);\r\n    }\r\n\r\n    this.hr = $.el('hr', {\r\n      id: 'unread-line',\r\n      className: 'unread-line'\r\n    }\r\n    );\r\n    this.posts = new Set();\r\n    this.postsQuotingYou = new Set();\r\n    this.order = new RandomAccessList();\r\n    this.position = null;\r\n\r\n    Callbacks.Thread.push({\r\n      name: 'Unread',\r\n      cb:   this.node\r\n    });\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Unread',\r\n      cb:   this.addPost\r\n    });\r\n  },\r\n\r\n  node() {\r\n    Unread.thread = this;\r\n    Unread.title  = d.title;\r\n    Unread.lastReadPost = Unread.db?.get({\r\n      boardID: this.board.ID,\r\n      threadID: this.ID\r\n    }) || 0;\r\n    Unread.readCount = 0;\r\n    for (var ID of this.posts.keys) { if (+ID <= Unread.lastReadPost) { Unread.readCount++; } }\r\n    $.one(d, '4chanXInitFinished', Unread.ready);\r\n    $.on(d, 'PostsInserted',      Unread.onUpdate);\r\n    $.on(d, 'ThreadUpdate',       function(e) { if (e.detail[404]) { return Unread.update(); } });\r\n    const resetLink = $.el('a', {\r\n      href: 'javascript:;',\r\n      className: 'unread-reset',\r\n      textContent: 'Mark all unread'\r\n    }\r\n    );\r\n    $.on(resetLink, 'click', Unread.reset);\r\n    return Header.menu.addEntry({\r\n      el: resetLink,\r\n      order: 70\r\n    });\r\n  },\r\n\r\n  ready() {\r\n    if (Conf['Remember Last Read Post'] && Conf['Scroll to Last Read Post']) { Unread.scroll(); }\r\n    Unread.setLine(true);\r\n    Unread.read();\r\n    Unread.update();\r\n    $.on(d, 'scroll visibilitychange', Unread.read);\r\n    if (Conf['Unread Line']) { return $.on(d, 'visibilitychange',        Unread.setLine); }\r\n  },\r\n\r\n  positionPrev() {\r\n    if (Unread.position) { return Unread.position.prev; } else { return Unread.order.last; }\r\n  },\r\n\r\n  scroll() {\r\n    // Let the header's onload callback handle it.\r\n    let hash;\r\n    if ((hash = location.hash.match(/\\d+/)) && hash[0] in Unread.thread.posts) { return; }\r\n\r\n    let position = Unread.positionPrev();\r\n    while (position) {\r\n      var {bottom} = position.data.nodes;\r\n      if (!bottom.getBoundingClientRect().height) {\r\n        // Don't try to scroll to posts with display: none\r\n        position = position.prev;\r\n      } else {\r\n        Header.scrollToIfNeeded(bottom, true);\r\n        break;\r\n      }\r\n    }\r\n  },\r\n\r\n  reset() {\r\n    if (Unread.lastReadPost == null) { return; }\r\n\r\n    Unread.posts = new Set();\r\n    Unread.postsQuotingYou = new Set();\r\n    Unread.order = new RandomAccessList();\r\n    Unread.position = null;\r\n    Unread.lastReadPost = 0;\r\n    Unread.readCount = 0;\r\n    Unread.thread.posts.forEach(post => Unread.addPost.call(post));\r\n\r\n    $.forceSync('Remember Last Read Post');\r\n    if (Conf['Remember Last Read Post'] && (!Unread.thread.isDead || Unread.thread.isArchived)) {\r\n      Unread.db.set({\r\n        boardID:  Unread.thread.board.ID,\r\n        threadID: Unread.thread.ID,\r\n        val:      0\r\n      });\r\n    }\r\n\r\n    Unread.updatePosition();\r\n    Unread.setLine();\r\n    return Unread.update();\r\n  },\r\n\r\n  sync() {\r\n    if (Unread.lastReadPost == null) { return; }\r\n    const lastReadPost = Unread.db.get({\r\n      boardID: Unread.thread.board.ID,\r\n      threadID: Unread.thread.ID,\r\n      defaultValue: 0\r\n    });\r\n    if (Unread.lastReadPost >= lastReadPost) { return; }\r\n    Unread.lastReadPost = lastReadPost;\r\n\r\n    const postIDs = Unread.thread.posts.keys;\r\n    for (let i = Unread.readCount, end = postIDs.length; i < end; i++) {\r\n      var ID = +postIDs[i];\r\n      if (!Unread.thread.posts.get(ID).isFetchedQuote) {\r\n        if (ID > Unread.lastReadPost) { break; }\r\n        Unread.posts.delete(ID);\r\n        Unread.postsQuotingYou.delete(ID);\r\n      }\r\n      Unread.readCount++;\r\n    }\r\n\r\n    Unread.updatePosition();\r\n    Unread.setLine();\r\n    return Unread.update();\r\n  },\r\n\r\n  addPost() {\r\n    if (this.isFetchedQuote || this.isClone) return;\r\n    Unread.order.push(this);\r\n    if ((this.ID <= Unread.lastReadPost) || this.isHidden || QuoteYou.isYou(this)) return;\r\n    Unread.posts.add((Unread.posts.last = this.ID));\r\n    Unread.addPostQuotingYou(this);\r\n    return Unread.position != null ? Unread.position : (Unread.position = Unread.order[this.ID]);\r\n  },\r\n\r\n  addPostQuotingYou(post) {\r\n    for (var quotelink of post.nodes.quotelinks) {\r\n      if (QuoteYou.db?.get(Get.postDataFromLink(quotelink))) {\r\n        Unread.postsQuotingYou.add((Unread.postsQuotingYou.last = post.ID));\r\n        Unread.openNotification(post);\r\n        return;\r\n      }\r\n    }\r\n  },\r\n\r\n  openNotification(post, predicate=' replied to you') {\r\n    if (!Header.areNotificationsEnabled) { return; }\r\n    const notif = new Notification(`${post.info.nameBlock}${predicate}`, {\r\n      body: post.commentDisplay(),\r\n      icon: Favicon.logo\r\n    }\r\n    );\r\n    notif.onclick = function() {\r\n      Header.scrollToIfNeeded(post.nodes.bottom, true);\r\n      return window.focus();\r\n    };\r\n    return notif.onshow = () => setTimeout(() => notif.close()\r\n    , 7 * SECOND);\r\n  },\r\n\r\n  onUpdate() {\r\n    return $.queueTask(function() { // ThreadUpdater may scroll immediately after inserting posts\r\n      Unread.setLine();\r\n      Unread.read();\r\n      return Unread.update();\r\n    });\r\n  },\r\n\r\n  readSinglePost(post) {\r\n    const {ID} = post;\r\n    if (!Unread.posts.has(ID)) { return; }\r\n    Unread.posts.delete(ID);\r\n    Unread.postsQuotingYou.delete(ID);\r\n    Unread.updatePosition();\r\n    Unread.saveLastReadPost();\r\n    return Unread.update();\r\n  },\r\n\r\n  read: debounce(100, function(e) {\r\n    // Update the lastReadPost when hidden posts are added to the thread.\r\n    if (!Unread.posts.size && (Unread.readCount !== Unread.thread.posts.keys.length)) {\r\n      Unread.saveLastReadPost();\r\n    }\r\n\r\n    if (d.hidden || !Unread.posts.size) { return; }\r\n\r\n    let count = 0;\r\n    while (Unread.position) {\r\n      var {ID, data} = Unread.position;\r\n      var {bottom} = data.nodes;\r\n      if (!!bottom.getBoundingClientRect().height && // post has been hidden\r\n        (Header.getBottomOf(bottom) <= -1)) { break; }                      // post is completely read\r\n      count++;\r\n      Unread.posts.delete(ID);\r\n      Unread.postsQuotingYou.delete(ID);\r\n      Unread.position = Unread.position.next;\r\n    }\r\n\r\n    if (!count) { return; }\r\n    Unread.updatePosition();\r\n    Unread.saveLastReadPost();\r\n    if (e) { return Unread.update(); }\r\n  }),\r\n\r\n  updatePosition() {\r\n    while (Unread.position && !Unread.posts.has(Unread.position.ID)) {\r\n      Unread.position = Unread.position.next;\r\n    }\r\n  },\r\n\r\n  saveLastReadPost: debounce(2 * SECOND, function() {\r\n    let ID;\r\n    $.forceSync('Remember Last Read Post');\r\n    if (!Conf['Remember Last Read Post'] || !Unread.db) { return; }\r\n    const postIDs = Unread.thread.posts.keys;\r\n    for (let i = Unread.readCount, end = postIDs.length; i < end; i++) {\r\n      ID = +postIDs[i];\r\n      if (!Unread.thread.posts.get(ID).isFetchedQuote) {\r\n        if (Unread.posts.has(ID)) { break; }\r\n        Unread.lastReadPost = ID;\r\n      }\r\n      Unread.readCount++;\r\n    }\r\n    if (Unread.thread.isDead && !Unread.thread.isArchived) { return; }\r\n    return Unread.db.set({\r\n      boardID:  Unread.thread.board.ID,\r\n      threadID: Unread.thread.ID,\r\n      val:      Unread.lastReadPost\r\n    });\r\n  }),\r\n\r\n  setLine(force) {\r\n    if (!Conf['Unread Line']) { return; }\r\n    if (Unread.hr.hidden || d.hidden || (force === true)) {\r\n      const oldPosition = Unread.linePosition;\r\n      if (Unread.linePosition = Unread.positionPrev()) {\r\n        if (Unread.linePosition !== oldPosition) {\r\n          let node = Unread.linePosition.data.nodes.bottom;\r\n          if (node.nextSibling?.tagName === 'BR') { node = node.nextSibling; }\r\n          $.after(node, Unread.hr);\r\n        }\r\n      } else {\r\n        $.rm(Unread.hr);\r\n      }\r\n    }\r\n    return Unread.hr.hidden = Unread.linePosition === Unread.order.last;\r\n  },\r\n\r\n  update() {\r\n    const count = Unread.posts.size;\r\n    const countQuotingYou = Unread.postsQuotingYou.size;\r\n\r\n    if (Conf['Unread Count']) {\r\n      const titleQuotingYou = Conf['Quoted Title'] && countQuotingYou ? '(!) ' : '';\r\n      const titleCount = count || !Conf['Hide Unread Count at (0)'] ? `(${count}) ` : '';\r\n      const titleDead = Unread.thread.isDead ?\r\n        Unread.title.replace('-', (Unread.thread.isArchived ? '- Archived -' : '- 404 -'))\r\n      :\r\n        Unread.title;\r\n      d.title = `${titleQuotingYou}${titleCount}${titleDead}`;\r\n    }\r\n\r\n    Unread.saveThreadWatcherCount();\r\n\r\n    if (Conf['Unread Favicon'] && (g.SITE.software === 'yotsuba')) {\r\n      const {isDead} = Unread.thread;\r\n      return Favicon.set((\r\n        countQuotingYou ?\r\n          (isDead ? 'unreadDeadY' : 'unreadY')\r\n        : count ?\r\n          (isDead ? 'unreadDead' : 'unread')\r\n        :\r\n          (isDead ? 'dead' : 'default')\r\n      )\r\n      );\r\n    }\r\n  },\r\n\r\n  saveThreadWatcherCount: debounce(2 * SECOND, function() {\r\n    $.forceSync('Remember Last Read Post');\r\n    if (Conf['Remember Last Read Post'] && (!Unread.thread.isDead || Unread.thread.isArchived)) {\r\n      let posts;\r\n      const quotingYou = !Conf['Require OP Quote Link'] && QuoteYou.isYou(Unread.thread.OP) ? Unread.posts : Unread.postsQuotingYou;\r\n      if (!quotingYou.size) {\r\n        quotingYou.last = 0;\r\n      } else if (!quotingYou.has(quotingYou.last)) {\r\n        quotingYou.last = 0;\r\n        posts = Unread.thread.posts.keys;\r\n        for (let i = posts.length - 1; i >= 0; i--) {\r\n          if (quotingYou.has(+posts[i])) {\r\n            quotingYou.last = posts[i];\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      return ThreadWatcher.update(g.SITE.ID, Unread.thread.board.ID, Unread.thread.ID, {\r\n        last: Unread.thread.lastPost,\r\n        isDead: Unread.thread.isDead,\r\n        isArchived: Unread.thread.isArchived,\r\n        unread: Unread.posts.size,\r\n        quotingYou: (quotingYou.last || 0)\r\n      }\r\n      );\r\n    }\r\n  })\r\n};\r\nexport default Unread;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Post from \"../classes/Post\";\r\nimport Get from \"../General/Get\";\r\nimport Index from \"../General/Index\";\r\nimport { g, Conf, d } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ExpandThread = {\r\n  statuses: dict(),\r\n  init() {\r\n    if (!((g.VIEW === 'index') && Conf['Thread Expansion'])) { return; }\r\n    if (Conf['JSON Index']) {\r\n      return $.on(d, 'IndexRefreshInternal', this.onIndexRefresh);\r\n    } else {\r\n      return Callbacks.Thread.push({\r\n        name: 'Expand Thread',\r\n        cb() { return ExpandThread.setButton(this); }\r\n      });\r\n    }\r\n  },\r\n\r\n  setButton(thread) {\r\n    let a;\r\n    if (!(thread.nodes.root && (a = $('.summary', thread.nodes.root)))) { return; }\r\n    a.textContent = g.SITE.Build.summaryText('+', ...a.textContent.match(/\\d+/g));\r\n    a.style.cursor = 'pointer';\r\n    return $.on(a, 'click', ExpandThread.cbToggle);\r\n  },\r\n  \r\n  disconnect(refresh) {\r\n    if ((g.VIEW === 'thread') || !Conf['Thread Expansion']) { return; }\r\n    for (var threadID in ExpandThread.statuses) {\r\n      var oldReq;\r\n      var status = ExpandThread.statuses[threadID];\r\n      if (oldReq = status.req) {\r\n        delete status.req;\r\n        oldReq.abort();\r\n      }\r\n      delete ExpandThread.statuses[threadID];\r\n    }\r\n\r\n    if (!refresh) { return $.off(d, 'IndexRefreshInternal', this.onIndexRefresh); }\r\n  },\r\n\r\n  onIndexRefresh() {\r\n    ExpandThread.disconnect(true);\r\n    return g.BOARD.threads.forEach(thread => ExpandThread.setButton(thread));\r\n  },\r\n\r\n  cbToggle(e) {\r\n    if ($.modifiedClick(e)) { return; }\r\n    e.preventDefault();\r\n    return ExpandThread.toggle(Get.threadFromNode(this));\r\n  },\r\n\r\n  cbToggleBottom(e) {\r\n    if ($.modifiedClick(e)) { return; }\r\n    e.preventDefault();\r\n    const thread = Get.threadFromNode(this);\r\n    $.rm(this); // remove before fixing bottom of thread position\r\n    const {bottom} = thread.nodes.root.getBoundingClientRect();\r\n    ExpandThread.toggle(thread);\r\n    return window.scrollBy(0, (thread.nodes.root.getBoundingClientRect().bottom - bottom));\r\n  },\r\n\r\n  toggle(thread) {\r\n    let a;\r\n    if (!(thread.nodes.root && (a = $('.summary', thread.nodes.root)))) { return; }\r\n    if (thread.ID in ExpandThread.statuses) {\r\n      return ExpandThread.contract(thread, a, thread.nodes.root);\r\n    } else {\r\n      return ExpandThread.expand(thread, a);\r\n    }\r\n  },\r\n\r\n  expand(thread, a) {\r\n    let status;\r\n    ExpandThread.statuses[thread] = (status = {});\r\n    a.textContent = g.SITE.Build.summaryText('...', ...a.textContent.match(/\\d+/g));\r\n    status.req = $.cache(g.SITE.urls.threadJSON({boardID: thread.board.ID, threadID: thread.ID}), function() {\r\n      if (this !== status.req) { return; } // aborted\r\n      delete status.req;\r\n      return ExpandThread.parse(this, thread, a);\r\n    });\r\n    return status.numReplies = $$(g.SITE.selectors.replyOriginal, thread.nodes.root).length;\r\n  },\r\n\r\n  contract(thread, a, threadRoot) {\r\n    let oldReq;\r\n    const status = ExpandThread.statuses[thread];\r\n    delete ExpandThread.statuses[thread];\r\n    if (oldReq = status.req) {\r\n      delete status.req;\r\n      oldReq.abort();\r\n      if (a) { a.textContent = g.SITE.Build.summaryText('+', ...a.textContent.match(/\\d+/g)); }\r\n      return;\r\n    }\r\n\r\n    let replies = $$('.thread > .replyContainer', threadRoot);\r\n    if (status.numReplies) { replies = replies.slice(0, (-status.numReplies)); }\r\n    let postsCount = 0;\r\n    let filesCount = 0;\r\n    for (var reply of replies) {\r\n      // rm clones\r\n      if (Conf['Quote Inlining']) { var inlined;\r\n      while ((inlined = $('.inlined', reply))) { inlined.click(); } }\r\n      postsCount++;\r\n      if ('file' in Get.postFromRoot(reply)) { filesCount++; }\r\n      $.rm(reply);\r\n    }\r\n    if (Index.enabled) { // otherwise handled by Main.addPosts\r\n      $.event('PostsRemoved', null, a.parentNode);\r\n    }\r\n    a.textContent = g.SITE.Build.summaryText('+', postsCount, filesCount);\r\n    return $.rm($('.summary-bottom', threadRoot));\r\n  },\r\n\r\n  parse(req, thread, a) {\r\n    let root;\r\n    if (![200, 304].includes(req.status)) {\r\n      a.textContent = req.status ? `Error ${req.statusText} (${req.status})` : 'Connection Error';\r\n      return;\r\n    }\r\n\r\n    g.SITE.Build.spoilerRange[thread.board] = req.response.posts[0].custom_spoiler;\r\n\r\n    const posts      = [];\r\n    const postsRoot  = [];\r\n    let filesCount = 0;\r\n    for (var postData of req.response.posts) {\r\n      var post;\r\n      if (postData.no === thread.ID) { continue; }\r\n      if ((post = thread.posts.get(postData.no)) && !post.isFetchedQuote) {\r\n        if ('file' in post) { filesCount++; }\r\n        ({root} = post.nodes);\r\n        postsRoot.push(root);\r\n        continue;\r\n      }\r\n      root = g.SITE.Build.postFromObject(postData, thread.board.ID);\r\n      post = new Post(root, thread, thread.board);\r\n      if ('file' in post) { filesCount++; }\r\n      posts.push(post);\r\n      postsRoot.push(root);\r\n    }\r\n    Main.callbackNodes('Post', posts);\r\n    $.after(a, postsRoot);\r\n    $.event('PostsInserted', null, a.parentNode);\r\n\r\n    const postsCount    = postsRoot.length;\r\n    a.textContent = g.SITE.Build.summaryText('-', postsCount, filesCount);\r\n\r\n    if (root) {\r\n      const a2 = a.cloneNode(true);\r\n      a2.classList.add('summary-bottom');\r\n      $.on(a2, 'click', ExpandThread.cbToggleBottom);\r\n      return $.after(root, a2);\r\n    }\r\n  }\r\n};\r\nexport default ExpandThread;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport DataBoard from \"../classes/DataBoard\";\r\nimport Get from \"../General/Get\";\r\nimport Header from \"../General/Header\";\r\nimport Index from \"../General/Index\";\r\nimport { g, Conf, d } from \"../globals/globals\";\r\nimport ExpandThread from \"../Miscellaneous/ExpandThread\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\nimport QuoteYou from \"../Quotelinks/QuoteYou\";\r\nimport ThreadWatcher from \"./ThreadWatcher\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar UnreadIndex = {\r\n  lastReadPost: dict(),\r\n  hr:           dict(),\r\n  markReadLink: dict(),\r\n\r\n  init() {\r\n    if ((g.VIEW !== 'index') || !Conf['Remember Last Read Post'] || !Conf['Unread Line in Index']) { return; }\r\n\r\n    this.enabled = true;\r\n    this.db = new DataBoard('lastReadPosts', this.sync);\r\n\r\n    Callbacks.Thread.push({\r\n      name: 'Unread Line in Index',\r\n      cb:   this.node\r\n    });\r\n\r\n    $.on(d, 'IndexRefreshInternal', this.onIndexRefresh);\r\n    return $.on(d, 'PostsInserted PostsRemoved', this.onPostsInserted);\r\n  },\r\n\r\n  node() {\r\n    UnreadIndex.lastReadPost[this.fullID] = UnreadIndex.db.get({\r\n      boardID: this.board.ID,\r\n      threadID: this.ID\r\n    }) || 0;\r\n    if (!Index.enabled) { // let onIndexRefresh handle JSON Index\r\n      return UnreadIndex.update(this);\r\n    }\r\n  },\r\n\r\n  onIndexRefresh(e) {\r\n    if (e.detail.isCatalog) { return; }\r\n    return (() => {\r\n      const result = [];\r\n      for (var threadID of e.detail.threadIDs) {\r\n        var thread = g.threads.get(threadID);\r\n        result.push(UnreadIndex.update(thread));\r\n      }\r\n      return result;\r\n    })();\r\n  },\r\n\r\n  onPostsInserted(e) {\r\n    if (e.target === Index.root) { return; } // onIndexRefresh handles this case\r\n    const thread = Get.threadFromNode(e.target);\r\n    if (!thread || (thread.nodes.root !== e.target)) { return; }\r\n    const wasVisible = !!UnreadIndex.hr[thread.fullID]?.parentNode;\r\n    UnreadIndex.update(thread);\r\n    if (Conf['Scroll to Last Read Post'] && (e.type === 'PostsInserted') && !wasVisible && !!UnreadIndex.hr[thread.fullID]?.parentNode) {\r\n      return Header.scrollToIfNeeded(UnreadIndex.hr[thread.fullID], true);\r\n    }\r\n  },\r\n\r\n  sync() {\r\n    return g.threads.forEach(function(thread) {\r\n      const lastReadPost = UnreadIndex.db.get({\r\n        boardID: thread.board.ID,\r\n        threadID: thread.ID\r\n      }) || 0;\r\n      if (lastReadPost !== UnreadIndex.lastReadPost[thread.fullID]) {\r\n        UnreadIndex.lastReadPost[thread.fullID] = lastReadPost;\r\n        if (thread.nodes.root?.parentNode) {\r\n          return UnreadIndex.update(thread);\r\n        }\r\n      }\r\n    });\r\n  },\r\n\r\n  update(thread) {\r\n    let divider;\r\n    const lastReadPost = UnreadIndex.lastReadPost[thread.fullID];\r\n    let repliesShown = 0;\r\n    let repliesRead = 0;\r\n    let firstUnread = null;\r\n    thread.posts.forEach(function(post) {\r\n      if (post.isReply && thread.nodes.root.contains(post.nodes.root)) {\r\n        repliesShown++;\r\n        if (post.ID <= lastReadPost) {\r\n          return repliesRead++;\r\n        } else if ((!firstUnread || (post.ID < firstUnread.ID)) && !post.isHidden && !QuoteYou.isYou(post)) {\r\n          return firstUnread = post;\r\n        }\r\n      }\r\n    });\r\n\r\n    let hr = UnreadIndex.hr[thread.fullID];\r\n    if (firstUnread && (repliesRead || ((lastReadPost === thread.OP.ID) && (!$(g.SITE.selectors.summary, thread.nodes.root) || thread.ID in ExpandThread.statuses)))) {\r\n      if (!hr) {\r\n        hr = (UnreadIndex.hr[thread.fullID] = $.el('hr',\r\n          {className: 'unread-line'}));\r\n      }\r\n      $.before(firstUnread.nodes.root, hr);\r\n    } else {\r\n      $.rm(hr);\r\n    }\r\n\r\n    const hasUnread = repliesShown ?\r\n      firstUnread || !repliesRead\r\n    : Index.enabled ?\r\n      thread.lastPost > lastReadPost\r\n    :\r\n      thread.OP.ID > lastReadPost;\r\n    thread.nodes.root.classList.toggle('unread-thread', hasUnread);\r\n\r\n    let link = UnreadIndex.markReadLink[thread.fullID];\r\n    if (!link) {\r\n      link = (UnreadIndex.markReadLink[thread.fullID] = $.el('a', {\r\n        className: 'unread-mark-read brackets-wrap',\r\n        href: 'javascript:;',\r\n        textContent: 'Mark Read'\r\n      }\r\n      ));\r\n      $.on(link, 'click', UnreadIndex.markRead);\r\n    }\r\n    if (divider = $(g.SITE.selectors.threadDivider, thread.nodes.root)) { // divider inside thread as in Tinyboard\r\n      return $.before(divider, link);\r\n    } else {\r\n      return $.add(thread.nodes.root, link);\r\n    }\r\n  },\r\n\r\n  markRead() {\r\n    const thread = Get.threadFromNode(this);\r\n    UnreadIndex.lastReadPost[thread.fullID] = thread.lastPost;\r\n    UnreadIndex.db.set({\r\n      boardID:  thread.board.ID,\r\n      threadID: thread.ID,\r\n      val:      thread.lastPost\r\n    });\r\n    $.rm(UnreadIndex.hr[thread.fullID]);\r\n    thread.nodes.root.classList.remove('unread-thread');\r\n    return ThreadWatcher.update(g.SITE.ID, thread.board.ID, thread.ID, {\r\n      last: thread.lastPost,\r\n      unread: 0,\r\n      quotingYou: 0\r\n    }\r\n    );\r\n  }\r\n};\r\nexport default UnreadIndex;\r\n","import ThreadWatcherPage from './ThreadWatcher/ThreadWatcher.html';\r\nimport $ from \"../platform/$\";\r\nimport Board from '../classes/Board';\r\nimport Callbacks from '../classes/Callbacks';\r\nimport DataBoard from '../classes/DataBoard';\r\nimport Thread from '../classes/Thread';\r\nimport Filter from '../Filtering/Filter';\r\nimport Main from '../main/Main';\r\nimport $$ from '../platform/$$';\r\nimport Config from '../config/Config';\r\nimport CrossOrigin from '../platform/CrossOrigin';\r\nimport PostRedirect from '../Posting/PostRedirect';\r\nimport QuoteYou from '../Quotelinks/QuoteYou';\r\nimport Unread from './Unread';\r\nimport UnreadIndex from './UnreadIndex';\r\nimport Header from '../General/Header';\r\nimport Index from '../General/Index';\r\nimport { Conf, d, doc, g } from '../globals/globals';\r\nimport Menu from '../Menu/Menu';\r\nimport UI from '../General/UI';\r\nimport Get from '../General/Get';\r\nimport { dict, HOUR, MINUTE } from '../platform/helpers';\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n\r\nvar ThreadWatcher = {\r\n  init() {\r\n    let sc;\r\n    if (!(this.enabled = Conf['Thread Watcher'])) { return; }\r\n\r\n    this.shortcut = (sc = $.el('a', {\r\n      id:          'watcher-link',\r\n      textContent: 'Watcher',\r\n      title:       'Thread Watcher',\r\n      href:        'javascript:;',\r\n    }\r\n    ));\r\n\r\n    this.db     = new DataBoard('watchedThreads', this.refresh, true);\r\n    this.dbLM   = new DataBoard('watcherLastModified', null, true);\r\n    this.dialog = UI.dialog('thread-watcher', { innerHTML: ThreadWatcherPage });\r\n    this.status = $('#watcher-status', this.dialog);\r\n    this.list   = this.dialog.lastElementChild;\r\n    this.refreshButton = $('.refresh', this.dialog);\r\n    this.closeButton = $('.move > .close', this.dialog);\r\n    this.unreaddb = Unread.db || UnreadIndex.db || new DataBoard('lastReadPosts');\r\n    this.unreadEnabled = Conf['Remember Last Read Post'];\r\n\r\n    $.on(d, 'QRPostSuccessful',   this.cb.post);\r\n    $.on(sc, 'click', this.toggleWatcher);\r\n    $.on(this.refreshButton, 'click', this.buttonFetchAll);\r\n    $.on(this.closeButton, 'click', this.toggleWatcher);\r\n\r\n    this.menu.addHeaderMenuEntry();\r\n    $.onExists(doc, 'body', this.addDialog);\r\n\r\n    switch (g.VIEW) {\r\n      case 'index':\r\n        $.on(d, 'IndexUpdate', this.cb.onIndexUpdate);\r\n        break;\r\n      case 'thread':\r\n        $.on(d, 'ThreadUpdate', this.cb.onThreadRefresh);\r\n        break;\r\n    }\r\n\r\n    if (Conf['Fixed Thread Watcher']) {\r\n      $.addClass(doc, 'fixed-watcher');\r\n    }\r\n    if (!Conf['Persistent Thread Watcher']) {\r\n      $.addClass(ThreadWatcher.shortcut, 'disabled');\r\n      this.dialog.hidden = true;\r\n    }\r\n\r\n    Header.addShortcut('watcher', sc, 510, '👁︎');\r\n\r\n    ThreadWatcher.initLastModified();\r\n    ThreadWatcher.fetchAuto();\r\n    $.on(window, 'visibilitychange focus', () => $.queueTask(ThreadWatcher.fetchAuto));\r\n\r\n    if (Conf['Menu'] && Index.enabled) {\r\n      Menu.menu.addEntry({\r\n        el: $.el('a', {\r\n          href:      'javascript:;',\r\n          className: 'has-shortcut-text'\r\n        }\r\n        , {innerHTML: '<span></span><span class=\"shortcut-text\">Alt+click</span>'}),\r\n        order: 6,\r\n        open({thread}) {\r\n          if (Conf['Index Mode'] !== 'catalog') { return false; }\r\n          this.el.firstElementChild.textContent = ThreadWatcher.isWatched(thread) ?\r\n            'Unwatch'\r\n          :\r\n            'Watch';\r\n          if (this.cb) { $.off(this.el, 'click', this.cb); }\r\n          this.cb = function() {\r\n            $.event('CloseMenu');\r\n            return ThreadWatcher.toggle(thread);\r\n          };\r\n          $.on(this.el, 'click', this.cb);\r\n          return true;\r\n        }\r\n      });\r\n    }\r\n\r\n    if (!['index', 'thread'].includes(g.VIEW)) { return; }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Thread Watcher',\r\n      cb:   this.node\r\n    });\r\n    return Callbacks.CatalogThread.push({\r\n      name: 'Thread Watcher',\r\n      cb:   this.catalogNode\r\n    });\r\n  },\r\n\r\n  isWatched(thread) {\r\n    return !!ThreadWatcher.db?.get({boardID: thread.board.ID, threadID: thread.ID});\r\n  },\r\n\r\n  isWatchedRaw(boardID, threadID) {\r\n    return !!ThreadWatcher.db?.get({boardID, threadID});\r\n  },\r\n\r\n  setToggler(toggler, isWatched) {\r\n    toggler.classList.toggle('watched', isWatched);\r\n    return toggler.title = `${isWatched ? 'Unwatch' : 'Watch'} Thread`;\r\n  },\r\n\r\n  node() {\r\n    let toggler;\r\n    if (this.isReply) { return; }\r\n    if (this.isClone) {\r\n      toggler = $('.watch-thread-link', this.nodes.info);\r\n    } else {\r\n      toggler = $.el('a', {\r\n        href: 'javascript:;',\r\n        className: 'watch-thread-link'\r\n      }\r\n      );\r\n      $.before($('input', this.nodes.info), toggler);\r\n    }\r\n    const siteID = g.SITE.ID;\r\n    const boardID = this.board.ID;\r\n    const threadID = this.thread.ID;\r\n    const data = ThreadWatcher.db.get({siteID, boardID, threadID});\r\n    ThreadWatcher.setToggler(toggler, !!data);\r\n    $.on(toggler, 'click', ThreadWatcher.cb.toggle);\r\n    // Add missing excerpt for threads added by Auto Watch\r\n    if (data && (data.excerpt == null)) {\r\n      return $.queueTask(() => {\r\n        return ThreadWatcher.update(siteID, boardID, threadID, {excerpt: Get.threadExcerpt(this.thread)});\r\n    });\r\n    }\r\n  },\r\n\r\n  catalogNode() {\r\n    if (ThreadWatcher.isWatched(this.thread)) { $.addClass(this.nodes.root, 'watched'); }\r\n    return $.on(this.nodes.root, 'mousedown click', e => {\r\n      if ((e.button !== 0) || !e.altKey) { return; }\r\n      if (e.type === 'click') { ThreadWatcher.toggle(this.thread); }\r\n      return e.preventDefault();\r\n    });\r\n  }, // Also on mousedown to prevent highlighting thumbnail in Firefox.\r\n\r\n  addDialog() {\r\n    if (!Main.isThisPageLegit()) { return; }\r\n    ThreadWatcher.build();\r\n    return $.prepend(d.body, ThreadWatcher.dialog);\r\n  },\r\n\r\n  toggleWatcher() {\r\n    $.toggleClass(ThreadWatcher.shortcut, 'disabled');\r\n    return ThreadWatcher.dialog.hidden = !ThreadWatcher.dialog.hidden;\r\n  },\r\n\r\n  cb: {\r\n    openAll() {\r\n      if ($.hasClass(this, 'disabled')) { return; }\r\n      for (var a of $$('a.watcher-link', ThreadWatcher.list)) {\r\n        $.open(a.href);\r\n      }\r\n      return $.event('CloseMenu');\r\n    },\r\n    openUnread() {\r\n      if ($.hasClass(this, 'disabled')) { return; }\r\n      for (var a of $$('.replies-unread > a.watcher-link', ThreadWatcher.list)) {\r\n        $.open(a.href);\r\n      }\r\n      return $.event('CloseMenu');\r\n    },\r\n    openDeads() {\r\n      if ($.hasClass(this, 'disabled')) { return; }\r\n      for (var a of $$('.dead-thread > a.watcher-link', ThreadWatcher.list)) {\r\n        $.open(a.href);\r\n      }\r\n      return $.event('CloseMenu');\r\n    },\r\n    pruneDeads() {\r\n      if ($.hasClass(this, 'disabled')) { return; }\r\n      for (var {siteID, boardID, threadID, data} of ThreadWatcher.getAll()) {\r\n        if (data.isDead) {\r\n          ThreadWatcher.db.delete({siteID, boardID, threadID});\r\n        }\r\n      }\r\n      ThreadWatcher.refresh();\r\n      return $.event('CloseMenu');\r\n    },\r\n    dismiss() {\r\n      for (var {siteID, boardID, threadID, data} of ThreadWatcher.getAll()) {\r\n        if (data.quotingYou) {\r\n          ThreadWatcher.update(siteID, boardID, threadID, {dismiss: data.quotingYou || 0});\r\n        }\r\n      }\r\n      return $.event('CloseMenu');\r\n    },\r\n    toggle() {\r\n      const {thread} = Get.postFromNode(this);\r\n      return ThreadWatcher.toggle(thread);\r\n    },\r\n    rm() {\r\n      const {siteID} = this.parentNode.dataset;\r\n      const [boardID, threadID] = this.parentNode.dataset.fullID.split('.');\r\n      return ThreadWatcher.rm(siteID, boardID, +threadID);\r\n    },\r\n    post(e) {\r\n      const {boardID, threadID, postID} = e.detail;\r\n      const cb = PostRedirect.delay();\r\n      if (postID === threadID) {\r\n        if (Conf['Auto Watch']) {\r\n          return ThreadWatcher.addRaw(boardID, threadID, {}, cb);\r\n        }\r\n      } else if (Conf['Auto Watch Reply']) {\r\n        return ThreadWatcher.add((g.threads.get(boardID + '.' + threadID) || new Thread(threadID, g.boards[boardID] || new Board(boardID))), cb);\r\n      }\r\n    },\r\n    onIndexUpdate(e) {\r\n      const {db}    = ThreadWatcher;\r\n      const siteID  = g.SITE.ID;\r\n      const boardID = g.BOARD.ID;\r\n      let nKilled = 0;\r\n      for (var threadID in db.data[siteID].boards[boardID]) {\r\n        // Don't prune threads that have yet to appear in index.\r\n        var data = db.data[siteID].boards[boardID][threadID];\r\n        if (!data?.isDead && !e.detail.threads.includes(`${boardID}.${threadID}`)) {\r\n          if (!e.detail.threads.some(fullID => +fullID.split('.')[1] > threadID)) { continue; }\r\n          if (Conf['Auto Prune'] || !(data && (typeof data === 'object'))) { // corrupt data\r\n            db.delete({boardID, threadID});\r\n            nKilled++;\r\n          } else {\r\n            ThreadWatcher.fetchStatus({siteID, boardID, threadID, data});\r\n          }\r\n        }\r\n      }\r\n      if (nKilled) { return ThreadWatcher.refresh(); }\r\n    },\r\n    onThreadRefresh(e) {\r\n      const thread = g.threads.get(e.detail.threadID);\r\n      if (!e.detail[404] || !ThreadWatcher.isWatched(thread)) { return; }\r\n      // Update dead status.\r\n      return ThreadWatcher.add(thread);\r\n    }\r\n  },\r\n\r\n  requests: [],\r\n  fetched:  0,\r\n\r\n  fetch(url, {siteID, force}, args, cb) {\r\n    if (ThreadWatcher.requests.length === 0) {\r\n      ThreadWatcher.status.textContent = '...';\r\n      $.addClass(ThreadWatcher.refreshButton, 'spin');\r\n    }\r\n    const onloadend = function() {\r\n      if (this.finished) { return; }\r\n      this.finished = true;\r\n      ThreadWatcher.fetched++;\r\n      if (ThreadWatcher.fetched === ThreadWatcher.requests.length) {\r\n        ThreadWatcher.clearRequests();\r\n      } else {\r\n        ThreadWatcher.status.textContent = `${Math.round((ThreadWatcher.fetched / ThreadWatcher.requests.length) * 100)}%`;\r\n      }\r\n      return cb.apply(this, args);\r\n    };\r\n    const ajax = siteID === g.SITE.ID ? $.ajax : CrossOrigin.ajax;\r\n    if (force) {\r\n      delete $.lastModified.ThreadWatcher?.[url];\r\n    }\r\n    const req = $.whenModified(\r\n      url,\r\n      'ThreadWatcher',\r\n      onloadend,\r\n      { timeout: MINUTE, ajax }\r\n    );\r\n    return ThreadWatcher.requests.push(req);\r\n  },\r\n\r\n  clearRequests() {\r\n    ThreadWatcher.requests = [];\r\n    ThreadWatcher.fetched = 0;\r\n    ThreadWatcher.status.textContent = '';\r\n    return $.rmClass(ThreadWatcher.refreshButton, 'spin');\r\n  },\r\n\r\n  abort() {\r\n    delete ThreadWatcher.syncing;\r\n    for (var req of ThreadWatcher.requests) {\r\n      if (!req.finished) {\r\n        req.finished = true;\r\n        req.abort();\r\n      }\r\n    }\r\n    return ThreadWatcher.clearRequests();\r\n  },\r\n\r\n  initLastModified() {\r\n    const lm = ($.lastModified['ThreadWatcher'] || ($.lastModified['ThreadWatcher'] = dict()));\r\n    for (var siteID in ThreadWatcher.dbLM.data) {\r\n      var boards = ThreadWatcher.dbLM.data[siteID];\r\n      for (var boardID in boards.boards) {\r\n        var data = boards.boards[boardID];\r\n        if (ThreadWatcher.db.get({siteID, boardID})) {\r\n          for (var url in data) {\r\n            var date = data[url];\r\n            lm[url] = date;\r\n          }\r\n        } else {\r\n          ThreadWatcher.dbLM.delete({siteID, boardID});\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  fetchAuto() {\r\n    let middle;\r\n    clearTimeout(ThreadWatcher.timeout);\r\n    if (!Conf['Auto Update Thread Watcher']) { return; }\r\n    const {db} = ThreadWatcher;\r\n    const interval = Conf['Show Page'] || (ThreadWatcher.unreadEnabled && Conf['Show Unread Count']) ? 5 * MINUTE : 2 * HOUR;\r\n    const now = Date.now();\r\n    if ((now - interval >= ((middle = db.data.lastChecked || 0)) || middle > now) && !d.hidden && !!d.hasFocus()) {\r\n      ThreadWatcher.fetchAllStatus(interval);\r\n    }\r\n    return ThreadWatcher.timeout = setTimeout(ThreadWatcher.fetchAuto, interval);\r\n  },\r\n\r\n  buttonFetchAll() {\r\n    if (ThreadWatcher.syncing || ThreadWatcher.requests.length) {\r\n      return ThreadWatcher.abort();\r\n    } else {\r\n      return ThreadWatcher.fetchAllStatus();\r\n    }\r\n  },\r\n\r\n  fetchAllStatus(interval=0) {\r\n    ThreadWatcher.status.textContent = '...';\r\n    $.addClass(ThreadWatcher.refreshButton, 'spin');\r\n    ThreadWatcher.syncing = true;\r\n    const dbs = [ThreadWatcher.db, ThreadWatcher.unreaddb, QuoteYou.db].filter(x => x);\r\n    let n = 0;\r\n    return dbs.map((dbi) =>\r\n      dbi.forceSync(function() {\r\n        if ((++n) === dbs.length) {\r\n          let middle;\r\n          if (!ThreadWatcher.syncing) { return; } // aborted\r\n          delete ThreadWatcher.syncing;\r\n          if (0 > (middle = Date.now() - (ThreadWatcher.db.data.lastChecked || 0)) || middle >= interval) { // not checked in another tab\r\n            // XXX On vichan boards, last_modified field of threads.json does not account for sage posts.\r\n            // Occasionally check replies field of catalog.json to find these posts.\r\n            let middle1;\r\n            const {db} = ThreadWatcher;\r\n            const now = Date.now();\r\n            const deep = !(now - (2 * HOUR) < ((middle1 = db.data.lastChecked2 || 0)) && middle1 <= now);\r\n            const boards = ThreadWatcher.getAll(true);\r\n            for (var board of boards) {\r\n              ThreadWatcher.fetchBoard(board, deep);\r\n            }\r\n            db.setLastChecked();\r\n            if (deep) { db.setLastChecked('lastChecked2'); }\r\n          }\r\n          if (ThreadWatcher.fetched === ThreadWatcher.requests.length) {\r\n            return ThreadWatcher.clearRequests();\r\n          }\r\n        }\r\n      }));\r\n  },\r\n\r\n  fetchBoard(board, deep) {\r\n    if (!board.some(thread => !thread.data.isDead)) { return; }\r\n    let force = false;\r\n    for (var thread of board) {\r\n      var {data} = thread;\r\n      if (!data.isDead && (data.last !== -1)) {\r\n        if (Conf['Show Page'] && (data.page == null)) { force = true; }\r\n        if ((data.modified == null)) { force = (thread.force = true); }\r\n      }\r\n    }\r\n    const {siteID, boardID} = board[0];\r\n    const site = g.sites[siteID];\r\n    if (!site) { return; }\r\n    const urlF = deep && site.threadModTimeIgnoresSage ? 'catalogJSON' : 'threadsListJSON';\r\n    const url = site.urls[urlF]?.({siteID, boardID});\r\n    if (!url) { return; }\r\n    return ThreadWatcher.fetch(url, {siteID, force}, [board, url], ThreadWatcher.parseBoard);\r\n  },\r\n\r\n  parseBoard(board, url) {\r\n    let page, thread;\r\n    if (this.status !== 200) { return; }\r\n    const {siteID, boardID} = board[0];\r\n    const lmDate = this.getResponseHeader('Last-Modified');\r\n    ThreadWatcher.dbLM.extend({siteID, boardID, val: $.item(url, lmDate)});\r\n    const threads = dict();\r\n    let pageLength = 0;\r\n    let nThreads = 0;\r\n    let oldest = null;\r\n    try {\r\n      pageLength = this.response[0]?.threads.length || 0;\r\n      for (let i = 0; i < this.response.length; i++) {\r\n        page = this.response[i];\r\n        for (var item of page.threads) {\r\n          threads[item.no] = {\r\n            page: i + 1,\r\n            index: nThreads,\r\n            modified: item.last_modified,\r\n            replies: item.replies\r\n          };\r\n          nThreads++;\r\n          if ((oldest == null) || (item.no < oldest)) {\r\n            oldest = item.no;\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      for (thread of board) {\r\n        ThreadWatcher.fetchStatus(thread);\r\n      }\r\n    }\r\n    for (thread of board) {\r\n      var {threadID, data} = thread;\r\n      if (threads[threadID]) {\r\n        var index, modified, replies;\r\n        ({page, index, modified, replies} = threads[threadID]);\r\n        if (Conf['Show Page']) {\r\n          var lastPage = g.sites[siteID].isPrunedByAge?.({siteID, boardID}) ?\r\n            threadID === oldest\r\n          :\r\n            index >= (nThreads - pageLength);\r\n          ThreadWatcher.update(siteID, boardID, threadID, {page, lastPage});\r\n        }\r\n        if (ThreadWatcher.unreadEnabled && Conf['Show Unread Count']) {\r\n          if ((modified !== data.modified) || ((replies != null) && (replies !== data.replies))) {\r\n            (thread.newData || (thread.newData = {})).modified = modified;\r\n            ThreadWatcher.fetchStatus(thread);\r\n          }\r\n        }\r\n      } else {\r\n        ThreadWatcher.fetchStatus(thread);\r\n      }\r\n    }\r\n  },\r\n\r\n  fetchStatus(thread) {\r\n    const {siteID, boardID, threadID, data, force} = thread;\r\n    const url = g.sites[siteID]?.urls.threadJSON?.({siteID, boardID, threadID});\r\n    if (!url) { return; }\r\n    if (data.isDead && !force) { return; }\r\n    if (data.last === -1) { return; } // 404 or no JSON API\r\n    return ThreadWatcher.fetch(url, {siteID, force}, [thread], ThreadWatcher.parseStatus);\r\n  },\r\n\r\n  parseStatus(thread, isArchiveURL) {\r\n    let isDead, last;\r\n    let {siteID, boardID, threadID, data, newData, force} = thread;\r\n    const site = g.sites[siteID];\r\n    if ((this.status === 200) && this.response) {\r\n      let isArchived;\r\n      last = this.response.posts[this.response.posts.length-1].no;\r\n      const replies = this.response.posts.length-1;\r\n      isDead = (isArchived = !!(this.response.posts[0].archived || isArchiveURL));\r\n      if (isDead && Conf['Auto Prune']) {\r\n        ThreadWatcher.rm(siteID, boardID, threadID);\r\n        return;\r\n      }\r\n\r\n      if ((last === data.last) && (isDead === data.isDead) && (isArchived === data.isArchived)) { return; }\r\n\r\n      const lastReadPost = ThreadWatcher.unreaddb.get({siteID, boardID, threadID, defaultValue: 0});\r\n      let unread = data.unread || 0;\r\n      let quotingYou = data.quotingYou || 0;\r\n      const youOP = !!QuoteYou.db?.get({siteID, boardID, threadID, postID: threadID});\r\n\r\n      for (var postObj of this.response.posts) {\r\n        if ((postObj.no <= (data.last || 0)) || (postObj.no <= lastReadPost)) { continue; }\r\n        if (QuoteYou.db?.get({siteID, boardID, threadID, postID: postObj.no})) { continue; }\r\n\r\n        var quotesYou = false;\r\n        if (!Conf['Require OP Quote Link'] && youOP) {\r\n          quotesYou = true;\r\n        } else if (QuoteYou.db && postObj.com) {\r\n          var match;\r\n          var regexp = site.regexp.quotelinkHTML;\r\n          regexp.lastIndex = 0;\r\n          while (match = regexp.exec(postObj.com)) {\r\n            if (QuoteYou.db.get({\r\n              siteID,\r\n              boardID:  match[1] ? encodeURIComponent(match[1]) : boardID,\r\n              threadID: match[2] || threadID,\r\n              postID:   match[3] || match[2] || threadID\r\n            })) {\r\n              quotesYou = true;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n\r\n        if (!unread || (!quotingYou && quotesYou)) {\r\n          if (Filter.isHidden(site.Build.parseJSON(postObj, {siteID, boardID}))) { continue; }\r\n        }\r\n\r\n        unread++;\r\n        if (quotesYou) { quotingYou = postObj.no; }\r\n      }\r\n\r\n      if (!newData) { newData = {}; }\r\n      $.extend(newData, {last, replies, isDead, isArchived, unread, quotingYou});\r\n      return ThreadWatcher.update(siteID, boardID, threadID, newData);\r\n\r\n    } else if (this.status === 404) {\r\n      const archiveURL = g.sites[siteID]?.urls.archivedThreadJSON?.({siteID, boardID, threadID});\r\n      if (!isArchiveURL && archiveURL) {\r\n        return ThreadWatcher.fetch(archiveURL, {siteID, force}, [thread, true], ThreadWatcher.parseStatus);\r\n      } else if (site.mayLackJSON && (data.last == null)) {\r\n        return ThreadWatcher.update(siteID, boardID, threadID, {last: -1});\r\n      } else {\r\n        return ThreadWatcher.update(siteID, boardID, threadID, {isDead: true});\r\n      }\r\n    }\r\n  },\r\n\r\n  getAll(groupByBoard) {\r\n    const all = [];\r\n    for (var siteID in ThreadWatcher.db.data) {\r\n      var boards = ThreadWatcher.db.data[siteID];\r\n      for (var boardID in boards.boards) {\r\n        var cont;\r\n        var threads = boards.boards[boardID];\r\n        if (Conf['Current Board'] && ((siteID !== g.SITE.ID) || (boardID !== g.BOARD.ID))) {\r\n          continue;\r\n        }\r\n        if (groupByBoard) {\r\n          all.push((cont = []));\r\n        }\r\n        for (var threadID in threads) {\r\n          var data = threads[threadID];\r\n          if (data && (typeof data === 'object')) {\r\n            (groupByBoard ? cont : all).push({siteID, boardID, threadID, data});\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return all;\r\n  },\r\n\r\n  makeLine(siteID, boardID, threadID, data) {\r\n    let page;\r\n    const x = $.el('a', {\r\n      textContent: '✕',\r\n      href: 'javascript:;'\r\n    }\r\n    );\r\n    $.on(x, 'click', ThreadWatcher.cb.rm);\r\n\r\n    let {excerpt, isArchived} = data;\r\n    if (!excerpt) { excerpt = `/${boardID}/ - No.${threadID}`; }\r\n    if (Conf['Show Site Prefix']) { excerpt = ThreadWatcher.prefixes[siteID] + excerpt; }\r\n\r\n    const link = $.el('a', {\r\n      href: g.sites[siteID]?.urls.thread({siteID, boardID, threadID}, isArchived) || '',\r\n      title: excerpt,\r\n      className: 'watcher-link'\r\n    }\r\n    );\r\n\r\n    if (Conf['Show Page'] && (data.page != null)) {\r\n      page = $.el('span', {\r\n        textContent: `[${data.page}]`,\r\n        className: 'watcher-page'\r\n      }\r\n      );\r\n      $.add(link, page);\r\n    }\r\n\r\n    if (ThreadWatcher.unreadEnabled && Conf['Show Unread Count'] && (data.unread != null)) {\r\n      const count = $.el('span', {\r\n        textContent: `(${data.unread})`,\r\n        className: 'watcher-unread'\r\n      }\r\n      );\r\n      $.add(link, count);\r\n    }\r\n\r\n    const title = $.el('span', {\r\n      textContent: excerpt,\r\n      className: 'watcher-title'\r\n    }\r\n    );\r\n    $.add(link, title);\r\n\r\n    const div = $.el('div');\r\n    const fullID = `${boardID}.${threadID}`;\r\n    div.dataset.fullID = fullID;\r\n    div.dataset.siteID = siteID;\r\n    if ((g.VIEW === 'thread') && (fullID === `${g.BOARD}.${g.THREADID}`)) { $.addClass(div, 'current'); }\r\n    if (data.isDead) { $.addClass(div, 'dead-thread'); }\r\n    if (Conf['Show Page']) {\r\n      if (data.lastPage) { $.addClass(div, 'last-page'); }\r\n      if (data.page != null) { div.dataset.page = data.page; }\r\n    }\r\n    if (ThreadWatcher.unreadEnabled && Conf['Show Unread Count']) {\r\n      if (data.unread === 0) { $.addClass(div, 'replies-read'); }\r\n      if (data.unread) { $.addClass(div, 'replies-unread'); }\r\n      if ((data.quotingYou || 0) > (data.dismiss || 0)) { $.addClass(div, 'replies-quoting-you'); }\r\n    }\r\n    $.add(div, [x, $.tn(' '), link]);\r\n    return div;\r\n  },\r\n\r\n  setPrefixes(threads) {\r\n    const prefixes = dict();\r\n    for (var {siteID} of threads) {\r\n      if (siteID in prefixes) { continue; }\r\n      var len = 0;\r\n      var prefix = '';\r\n      var conflicts = Object.keys(prefixes);\r\n      while (conflicts.length > 0) {\r\n        len++;\r\n        prefix = siteID.slice(0, len);\r\n        var conflicts2 = [];\r\n        for (var siteID2 of conflicts) {\r\n          if (siteID2.slice(0, len) === prefix) {\r\n            conflicts2.push(siteID2);\r\n          } else if (prefixes[siteID2].length < len) {\r\n            prefixes[siteID2] = siteID2.slice(0, len);\r\n          }\r\n        }\r\n        conflicts = conflicts2;\r\n      }\r\n      prefixes[siteID] = prefix;\r\n    }\r\n    return ThreadWatcher.prefixes = prefixes;\r\n  },\r\n\r\n  build() {\r\n    const nodes = [];\r\n    const threads = ThreadWatcher.getAll();\r\n    ThreadWatcher.setPrefixes(threads);\r\n    for (var {siteID, boardID, threadID, data} of threads) {\r\n      // Add missing excerpt for threads added by Auto Watch\r\n      var thread;\r\n      if ((data.excerpt == null) && (siteID === g.SITE.ID) && (thread = g.threads.get(`${boardID}.${threadID}`)) && thread.OP) {\r\n        ThreadWatcher.db.extend({boardID, threadID, val: {excerpt: Get.threadExcerpt(thread)}});\r\n      }\r\n      nodes.push(ThreadWatcher.makeLine(siteID, boardID, threadID, data));\r\n    }\r\n    const {list} = ThreadWatcher;\r\n    $.rmAll(list);\r\n    $.add(list, nodes);\r\n\r\n    return ThreadWatcher.refreshIcon();\r\n  },\r\n\r\n  refresh() {\r\n    ThreadWatcher.build();\r\n\r\n    g.threads.forEach(function(thread) {\r\n      const isWatched = ThreadWatcher.isWatched(thread);\r\n      if (thread.OP) {\r\n        for (var post of [thread.OP, ...thread.OP.clones]) {\r\n          var toggler;\r\n          if (toggler = $('.watch-thread-link', post.nodes.info)) {\r\n            ThreadWatcher.setToggler(toggler, isWatched);\r\n          }\r\n        }\r\n      }\r\n      if (thread.catalogView) { return thread.catalogView.nodes.root.classList.toggle('watched', isWatched); }\r\n    });\r\n\r\n    if (Conf['Pin Watched Threads']) {\r\n      return $.event('SortIndex', {deferred: Conf['Index Mode'] !== 'catalog'});\r\n    }\r\n  },\r\n\r\n  refreshIcon() {\r\n    for (var className of ['replies-unread', 'replies-quoting-you']) {\r\n      ThreadWatcher.shortcut.classList.toggle(className, !!$(`.${className}`, ThreadWatcher.dialog));\r\n    }\r\n  },\r\n\r\n  update(siteID, boardID, threadID, newData) {\r\n    let data, key, line, val;\r\n    if (!(data = ThreadWatcher.db?.get({siteID, boardID, threadID}))) { return; }\r\n    if (newData.isDead && Conf['Auto Prune']) {\r\n      ThreadWatcher.rm(siteID, boardID, threadID);\r\n      return;\r\n    }\r\n    if (newData.isDead || (newData.last === -1)) {\r\n      for (key of ['isArchived', 'page', 'lastPage', 'unread', 'quotingyou']) {\r\n        if (!(key in newData)) {\r\n          newData[key] = undefined;\r\n        }\r\n      }\r\n    }\r\n    if ((newData.last != null) && (newData.last < data.last)) {\r\n      newData.modified = undefined;\r\n    }\r\n    let n = 0;\r\n    for (key in newData) { val = newData[key]; if (data[key] !== val) { n++; } }\r\n    if (!n) { return; }\r\n    ThreadWatcher.db.extend({siteID, boardID, threadID, val: newData});\r\n    if (line = $(`#watched-threads > [data-site-i-d='${siteID}'][data-full-i-d='${boardID}.${threadID}']`, ThreadWatcher.dialog)) {\r\n      const newLine = ThreadWatcher.makeLine(siteID, boardID, threadID, data);\r\n      $.replace(line, newLine);\r\n      return ThreadWatcher.refreshIcon();\r\n    } else {\r\n      return ThreadWatcher.refresh();\r\n    }\r\n  },\r\n\r\n  set404(boardID, threadID, cb) {\r\n    let data;\r\n    if (!(data = ThreadWatcher.db?.get({boardID, threadID}))) { return cb(); }\r\n    if (Conf['Auto Prune']) {\r\n      ThreadWatcher.db.delete({boardID, threadID});\r\n      return cb();\r\n    }\r\n    if (data.isDead && !((data.isArchived != null) || (data.page != null) || (data.lastPage != null) || (data.unread != null) || (data.quotingYou != null))) { return cb(); }\r\n    return ThreadWatcher.db.extend({boardID, threadID, val: {isDead: true, isArchived: undefined, page: undefined, lastPage: undefined, unread: undefined, quotingYou: undefined}}, cb);\r\n  },\r\n\r\n  toggle(thread) {\r\n    const siteID   = g.SITE.ID;\r\n    const boardID  = thread.board.ID;\r\n    const threadID = thread.ID;\r\n    if (ThreadWatcher.db.get({boardID, threadID})) {\r\n      return ThreadWatcher.rm(siteID, boardID, threadID);\r\n    } else {\r\n      return ThreadWatcher.add(thread);\r\n    }\r\n  },\r\n\r\n  add(thread, cb) {\r\n    const data     = {};\r\n    const siteID   = g.SITE.ID;\r\n    const boardID  = thread.board.ID;\r\n    const threadID = thread.ID;\r\n    if (thread.isDead) {\r\n      if (Conf['Auto Prune'] && ThreadWatcher.db.get({boardID, threadID})) {\r\n        ThreadWatcher.rm(siteID, boardID, threadID, cb);\r\n        return;\r\n      }\r\n      data.isDead = true;\r\n    }\r\n    if (thread.OP) { data.excerpt = Get.threadExcerpt(thread); }\r\n    return ThreadWatcher.addRaw(boardID, threadID, data, cb);\r\n  },\r\n\r\n  addRaw(boardID, threadID, data, cb) {\r\n    const oldData = ThreadWatcher.db.get({ boardID, threadID, defaultValue: dict() });\r\n    delete oldData.last;\r\n    delete oldData.modified;\r\n    $.extend(oldData, data);\r\n    ThreadWatcher.db.set({boardID, threadID, val: oldData}, cb);\r\n    ThreadWatcher.refresh();\r\n    const thread = {siteID: g.SITE.ID, boardID, threadID, data, force: true};\r\n    if (Conf['Show Page'] && !data.isDead) {\r\n      return ThreadWatcher.fetchBoard([thread]);\r\n    } else if (ThreadWatcher.unreadEnabled && Conf['Show Unread Count']) {\r\n      return ThreadWatcher.fetchStatus(thread);\r\n    }\r\n  },\r\n\r\n  rm(siteID, boardID, threadID, cb) {\r\n    ThreadWatcher.db.delete({siteID, boardID, threadID}, cb);\r\n    return ThreadWatcher.refresh();\r\n  },\r\n\r\n  menu: {\r\n    init() {\r\n      if (!Conf['Thread Watcher']) { return; }\r\n      const menu = (this.menu = new UI.Menu('thread watcher'));\r\n      $.on($('.menu-button', ThreadWatcher.dialog), 'click', function(e) {\r\n        return menu.toggle(e, this, ThreadWatcher);\r\n      });\r\n      return this.addMenuEntries();\r\n    },\r\n\r\n    addHeaderMenuEntry() {\r\n      if (g.VIEW !== 'thread') { return; }\r\n      const entryEl = $.el('a',\r\n        {href: 'javascript:;'});\r\n      Header.menu.addEntry({\r\n        el: entryEl,\r\n        order: 60,\r\n        open() {\r\n          const [addClass, rmClass, text] = !!ThreadWatcher.db.get({boardID: g.BOARD.ID, threadID: g.THREADID}) ?\r\n            ['unwatch-thread', 'watch-thread', 'Unwatch thread']\r\n          :\r\n            ['watch-thread', 'unwatch-thread', 'Watch thread'];\r\n          $.addClass(entryEl, addClass);\r\n          $.rmClass(entryEl, rmClass);\r\n          entryEl.textContent = text;\r\n          return true;\r\n        }\r\n      });\r\n      return $.on(entryEl, 'click', () => ThreadWatcher.toggle(g.threads.get(`${g.BOARD}.${g.THREADID}`)));\r\n    },\r\n\r\n    addMenuEntries() {\r\n      const entries = [];\r\n\r\n      // `Open all` entry\r\n      entries.push({\r\n        text: 'Open all threads',\r\n        cb: ThreadWatcher.cb.openAll,\r\n        open() {\r\n          this.el.classList.toggle('disabled', !ThreadWatcher.list.firstElementChild);\r\n          return true;\r\n        }\r\n      });\r\n\r\n      // `Open Unread` entry\r\n      entries.push({\r\n        text: 'Open unread threads',\r\n        cb: ThreadWatcher.cb.openUnread,\r\n        open() {\r\n          this.el.classList.toggle('disabled', !$('.replies-unread', ThreadWatcher.list));\r\n          return true;\r\n        }\r\n      });\r\n\r\n      // `Open dead threads` entry\r\n      entries.push({\r\n        text: 'Open dead threads',\r\n        cb: ThreadWatcher.cb.openDeads,\r\n        open() {\r\n          this.el.classList.toggle('disabled', !$('.dead-thread', ThreadWatcher.list));\r\n          return true;\r\n        }\r\n      });\r\n\r\n      // `Prune dead threads` entry\r\n      entries.push({\r\n        text: 'Prune dead threads',\r\n        cb: ThreadWatcher.cb.pruneDeads,\r\n        open() {\r\n          this.el.classList.toggle('disabled', !$('.dead-thread', ThreadWatcher.list));\r\n          return true;\r\n        }\r\n      });\r\n\r\n      // `Dismiss posts quoting you` entry\r\n      entries.push({\r\n        text: 'Dismiss posts quoting you',\r\n        title: 'Unhighlight the thread watcher icon and threads until there are new replies quoting you.',\r\n        cb: ThreadWatcher.cb.dismiss,\r\n        open() {\r\n          this.el.classList.toggle('disabled', !$.hasClass(ThreadWatcher.shortcut, 'replies-quoting-you'));\r\n          return true;\r\n        }\r\n      });\r\n\r\n      for (var {text, title, cb, open} of entries) {\r\n        var entry = {\r\n          el: $.el('a', {\r\n            textContent: text,\r\n            href: 'javascript:;'\r\n          }\r\n          )\r\n        };\r\n        if (title) { entry.el.title = title; }\r\n        $.on(entry.el, 'click', cb);\r\n        entry.open = open.bind(entry);\r\n        this.menu.addEntry(entry);\r\n      }\r\n\r\n      // Settings checkbox entries:\r\n      for (var name in Config.threadWatcher) {\r\n        var conf = Config.threadWatcher[name];\r\n        this.addCheckbox(name, conf[1]);\r\n      }\r\n\r\n    },\r\n\r\n    addCheckbox(name, desc) {\r\n      const entry = {\r\n        type: 'thread watcher',\r\n        el: UI.checkbox(name, name.replace(' Thread Watcher', ''))\r\n      };\r\n      entry.el.title = desc;\r\n      const input = entry.el.firstElementChild;\r\n      if ((name === 'Show Unread Count') && !ThreadWatcher.unreadEnabled) {\r\n        input.disabled = true;\r\n        $.addClass(entry.el, 'disabled');\r\n        entry.el.title += '\\n[Remember Last Read Post is disabled.]';\r\n      }\r\n      $.on(input, 'change', $.cb.checked);\r\n      if (['Current Board', 'Show Page', 'Show Unread Count', 'Show Site Prefix'].includes(name)) { $.on(input, 'change', ThreadWatcher.refresh); }\r\n      if (['Show Page', 'Show Unread Count', 'Auto Update Thread Watcher'].includes(name)) { $.on(input, 'change', ThreadWatcher.fetchAuto); }\r\n      return this.menu.addEntry(entry);\r\n    }\r\n  }\r\n};\r\nexport default ThreadWatcher;\r\n",null,null,null,"import Callbacks from \"../classes/Callbacks\";\r\nimport Fetcher from \"../classes/Fetcher\";\r\nimport Get from \"../General/Get\";\r\nimport Header from \"../General/Header\";\r\nimport UI from \"../General/UI\";\r\nimport { Conf, d, doc, g } from \"../globals/globals\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar QuotePreview = {\r\n  init() {\r\n    if (!Conf['Quote Previewing']) { return; }\r\n\r\n    if (g.VIEW === 'archive') {\r\n      $.on(d, 'mouseover', function(e) {\r\n        if ((e.target.nodeName === 'A') && $.hasClass(e.target, 'quotelink')) {\r\n          return QuotePreview.mouseover.call(e.target, e);\r\n        }\r\n      });\r\n    }\r\n\r\n    if (!['index', 'thread'].includes(g.VIEW)) { return; }\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Quote Previewing',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    for (var link of this.nodes.quotelinks.concat([...this.nodes.backlinks], this.nodes.archivelinks)) {\r\n      $.on(link, 'mouseover', QuotePreview.mouseover);\r\n    }\r\n  },\r\n\r\n  mouseover(e) {\r\n    let origin;\r\n    if (($.hasClass(this, 'inlined') && !$.hasClass(doc, 'catalog-mode')) || !d.contains(this)) { return; }\r\n\r\n    const {boardID, threadID, postID} = Get.postDataFromLink(this);\r\n\r\n    const qp = $.el('div', {\r\n      id: 'qp',\r\n      className: 'dialog'\r\n    }\r\n    );\r\n\r\n    $.add(Header.hover, qp);\r\n    new Fetcher(boardID, threadID, postID, qp, Get.postFromNode(this));\r\n\r\n    UI.hover({\r\n      root: this,\r\n      el: qp,\r\n      latestEvent: e,\r\n      endEvents: 'mouseout click',\r\n      cb: QuotePreview.mouseout\r\n    });\r\n\r\n    if (Conf['Quote Highlighting'] && (origin = g.posts.get(`${boardID}.${postID}`))) {\r\n      const posts = [origin].concat(origin.clones);\r\n      // Remove the clone that's in the qp from the array.\r\n      posts.pop();\r\n      for (var post of posts) {\r\n        $.addClass(post.nodes.post, 'qphl');\r\n      }\r\n    }\r\n  },\r\n\r\n  mouseout() {\r\n    // Stop if it only contains text.\r\n    let root;\r\n    if (!(root = this.el.firstElementChild)) { return; }\r\n\r\n    $.event('PostsRemoved', null, Header.hover);\r\n\r\n    const clone = Get.postFromRoot(root);\r\n    let post  = clone.origin;\r\n    post.rmClone(root.dataset.clone);\r\n\r\n    if (!Conf['Quote Highlighting']) { return; }\r\n    for (post of [post].concat(post.clones)) {\r\n      $.rmClass(post.nodes.post, 'qphl');\r\n    }\r\n  }\r\n};\r\nexport default QuotePreview;\r\n","/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nimport Callbacks from '../classes/Callbacks';\r\nimport CatalogThread from '../classes/CatalogThread';\r\nimport Notice from '../classes/Notice';\r\nimport Post from '../classes/Post';\r\nimport Thread from '../classes/Thread';\r\nimport Config from '../config/Config';\r\nimport Filter from '../Filtering/Filter';\r\nimport PostHiding from '../Filtering/PostHiding';\r\nimport ThreadHiding from '../Filtering/ThreadHiding';\r\nimport Main from '../main/Main';\r\nimport CatalogLinks from '../Miscellaneous/CatalogLinks';\r\nimport RelativeDates from '../Miscellaneous/RelativeDates';\r\nimport ThreadWatcher from '../Monitoring/ThreadWatcher';\r\nimport $$ from '../platform/$$';\r\nimport $ from '../platform/$';\r\nimport QuotePreview from '../Quotelinks/QuotePreview';\r\nimport { c, Conf, d, doc, g } from '../globals/globals';\r\nimport Header from './Header';\r\nimport UI from './UI';\r\nimport Menu from '../Menu/Menu';\r\n\r\nimport NavLinksPage from './Index/NavLinks.html';\r\nimport PageList from './Index/PageList.html';\r\nimport BoardConfig from './BoardConfig';\r\nimport Get from './Get';\r\nimport { dict, SECOND } from '../platform/helpers';\r\n\r\nvar Index = {\r\n  showHiddenThreads: false,\r\n  changed: {},\r\n\r\n  enabledOn({siteID, boardID}) {\r\n    return Conf['JSON Index'] && (g.sites[siteID].software === 'yotsuba') && (boardID !== 'f');\r\n  },\r\n\r\n  init() {\r\n    let input, inputs, name;\r\n    if (g.VIEW !== 'index') { return; }\r\n\r\n    // For IndexRefresh events\r\n    $.one(d, '4chanXInitFinished', this.cb.initFinished);\r\n    $.on(d, 'PostsInserted', this.cb.postsInserted);\r\n\r\n    if (!this.enabledOn(g.BOARD)) { return; }\r\n\r\n    this.enabled = true;\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Index Page Numbers',\r\n      cb:   this.node\r\n    });\r\n    Callbacks.CatalogThread.push({\r\n      name: 'Catalog Features',\r\n      cb:   this.catalogNode\r\n    });\r\n\r\n    this.search = history.state?.searched || '';\r\n    if (history.state?.mode) {\r\n      Conf['Index Mode'] = history.state?.mode;\r\n    }\r\n    this.currentSort = history.state?.sort;\r\n    if (!this.currentSort) { this.currentSort = typeof Conf['Index Sort'] === 'object' ? (\r\n        Conf['Index Sort'][g.BOARD.ID] || 'bump'\r\n      ) : (\r\n        Conf['Index Sort']\r\n      ); }\r\n    this.currentPage = this.getCurrentPage();\r\n    this.processHash();\r\n\r\n    $.addClass(doc, 'index-loading', `${Conf['Index Mode'].replace(/\\ /g, '-')}-mode`);\r\n    $.on(window, 'popstate', this.cb.popstate);\r\n    $.on(d, 'scroll', this.scroll);\r\n    $.on(d, 'SortIndex', this.cb.resort);\r\n\r\n    // Header refresh button\r\n    this.button = $.el('a', {\r\n      title: 'Refresh',\r\n      href: 'javascript:;',\r\n      textContent: 'Refresh',\r\n      className: 'bigger-icon',\r\n    });\r\n    $.on(this.button, 'click', () => Index.update());\r\n    Header.addShortcut('index-refresh', this.button, 590, '🗘');\r\n\r\n    // Header \"Index Navigation\" submenu\r\n    const entries = [];\r\n    this.inputs = (inputs = dict());\r\n    for (name in Config.Index) {\r\n      var arr = Config.Index[name];\r\n      if (arr instanceof Array) {\r\n        var label = UI.checkbox(name, `${name[0]}${name.slice(1).toLowerCase()}`);\r\n        label.title = arr[1];\r\n        entries.push({el: label});\r\n        input = label.firstChild;\r\n        $.on(input, 'change', $.cb.checked);\r\n        inputs[name] = input;\r\n      }\r\n    }\r\n    $.on(inputs['Show Replies'], 'change', this.cb.replies);\r\n    $.on(inputs['Catalog Hover Expand'], 'change', this.cb.hover);\r\n    $.on(inputs['Pin Watched Threads'], 'change', this.cb.resort);\r\n    $.on(inputs['Anchor Hidden Threads'], 'change', this.cb.resort);\r\n\r\n    const watchSettings = function(e) {\r\n      if (input = $.getOwn(inputs, e.target.name)) {\r\n        input.checked = e.target.checked;\r\n        return $.event('change', null, input);\r\n      }\r\n    };\r\n    $.on(d, 'OpenSettings', () => $.on($.id('fourchanx-settings'), 'change', watchSettings));\r\n\r\n    const sortEntry = UI.checkbox('Per-Board Sort Type', 'Per-board sort type', (typeof Conf['Index Sort'] === 'object'));\r\n    sortEntry.title = 'Set the sorting order of each board independently.';\r\n    $.on(sortEntry.firstChild, 'change', this.cb.perBoardSort);\r\n    entries.splice(3, 0, {el: sortEntry});\r\n\r\n    Header.menu.addEntry({\r\n      el: $.el('span',\r\n        {textContent: 'Index Navigation'}),\r\n      order: 100,\r\n      subEntries: entries\r\n    });\r\n\r\n    // Navigation links at top of index\r\n    this.navLinks = $.el('div', {className: 'navLinks json-index'});\r\n    $.extend(this.navLinks, {innerHTML: NavLinksPage});\r\n    $('.cataloglink a', this.navLinks).href = CatalogLinks.catalog();\r\n    if (!BoardConfig.isArchived(g.BOARD.ID)) { $('.archlistlink', this.navLinks).hidden = true; }\r\n    $.on($('#index-last-refresh a', this.navLinks), 'click', this.cb.refreshFront);\r\n\r\n    // Search field\r\n    this.searchInput = $('#index-search', this.navLinks);\r\n    this.setupSearch();\r\n    $.on(this.searchInput, 'input', this.onSearchInput);\r\n    $.on($('#index-search-clear', this.navLinks), 'click', this.clearSearch);\r\n\r\n    // Hidden threads toggle\r\n    this.hideLabel = $('#hidden-label', this.navLinks);\r\n    $.on($('#hidden-toggle a', this.navLinks), 'click', this.cb.toggleHiddenThreads);\r\n\r\n    // Drop-down menus and reverse sort toggle\r\n    this.selectRev   = $('#index-rev',  this.navLinks);\r\n    this.selectMode  = $('#index-mode', this.navLinks);\r\n    this.selectSort  = $('#index-sort', this.navLinks);\r\n    this.selectSize  = $('#index-size', this.navLinks);\r\n    $.on(this.selectRev,  'change', this.cb.sort);\r\n    $.on(this.selectMode, 'change', this.cb.mode);\r\n    $.on(this.selectSort, 'change', this.cb.sort);\r\n    $.on(this.selectSize, 'change', $.cb.value);\r\n    $.on(this.selectSize, 'change', this.cb.size);\r\n    for (var select of [this.selectMode, this.selectSize]) {\r\n      select.value = Conf[select.name];\r\n    }\r\n    this.selectRev.checked = /-rev$/.test(Index.currentSort);\r\n    this.selectSort.value  = Index.currentSort.replace(/-rev$/, '');\r\n\r\n    // Last Long Reply options\r\n    this.lastLongOptions = $('#lastlong-options', this.navLinks);\r\n    this.lastLongInputs = $$('input', this.lastLongOptions);\r\n    this.lastLongThresholds = [0, 0];\r\n    this.lastLongOptions.hidden = (this.selectSort.value !== 'lastlong');\r\n    for (let i = 0; i < this.lastLongInputs.length; i++) {\r\n      input = this.lastLongInputs[i];\r\n      $.on(input, 'change', this.cb.lastLongThresholds);\r\n      var tRaw = Conf[`Last Long Reply Thresholds ${i}`];\r\n      input.value = (this.lastLongThresholds[i] =\r\n        typeof tRaw === 'object' ? (tRaw[g.BOARD.ID] ?? 100) : tRaw);\r\n    }\r\n\r\n    // Thread container\r\n    this.root = $.el('div', {className: 'board json-index'});\r\n    $.on(this.root, 'click', this.cb.hoverToggle);\r\n    this.cb.size();\r\n    this.cb.hover();\r\n\r\n    // Page list\r\n    this.pagelist = $.el('div', {className: 'pagelist json-index'});\r\n    $.extend(this.pagelist, {innerHTML: PageList});\r\n    $('.cataloglink a', this.pagelist).href = CatalogLinks.catalog();\r\n    $.on(this.pagelist, 'click', this.cb.pageNav);\r\n\r\n    this.update(true);\r\n\r\n    $.onExists(doc, 'title + *', () => d.title = d.title.replace(/\\ -\\ Page\\ \\d+/, ''));\r\n\r\n    $.onExists(doc, '.board > .thread > .postContainer, .board + *', function() {\r\n      let el;\r\n      g.SITE.Build.hat = $('.board > .thread > img:first-child');\r\n      if (g.SITE.Build.hat) {\r\n        g.BOARD.threads.forEach(function(thread) {\r\n          if (thread.nodes.root) {\r\n            return $.prepend(thread.nodes.root, g.SITE.Build.hat.cloneNode(false));\r\n          }\r\n        });\r\n        $.addClass(doc, 'hats-enabled');\r\n        $.addStyle(`.catalog-thread::after {background-image: url(${g.SITE.Build.hat.src});}`);\r\n      }\r\n\r\n      const board = $('.board');\r\n      $.replace(board, Index.root);\r\n      if (Index.loaded) {\r\n        $.event('PostsInserted', null, Index.root);\r\n      }\r\n      // Hacks:\r\n      // - When removing an element from the document during page load,\r\n      //   its ancestors will still be correctly created inside of it.\r\n      // - Creating loadable elements inside of an origin-less document\r\n      //   will not download them.\r\n      // - Combine the two and you get a download canceller!\r\n      //   Does not work on Firefox unfortunately. bugzil.la/939713\r\n      try {\r\n        d.implementation.createDocument(null, null, null).appendChild(board);\r\n      } catch (error) {}\r\n\r\n      for (el of $$('.navLinks')) { $.rm(el); }\r\n      $.rm($.id('ctrl-top'));\r\n      const topNavPos = $.id('delform').previousElementSibling;\r\n      $.before(topNavPos, $.el('hr'));\r\n      $.before(topNavPos, Index.navLinks);\r\n      const timeEl = $('#index-last-refresh time', Index.navLinks);\r\n      if (timeEl.dataset.utc) { return RelativeDates.update(timeEl); }\r\n    });\r\n\r\n    return Main.ready(function() {\r\n      let pagelist;\r\n      if (pagelist = $('.pagelist')) {\r\n        $.replace(pagelist, Index.pagelist);\r\n      }\r\n      return $.rmClass(doc, 'index-loading');\r\n    });\r\n  },\r\n\r\n  scroll() {\r\n    if (Index.req || !Index.liveThreadData || (Conf['Index Mode'] !== 'infinite') || (window.scrollY <= (doc.scrollHeight - (300 + window.innerHeight)))) { return; }\r\n    if (Index.pageNum == null) { Index.pageNum = Index.currentPage; } // Avoid having to pushState to keep track of the current page\r\n\r\n    const pageNum = ++Index.pageNum;\r\n    if (pageNum > Index.pagesNum) { return Index.endNotice(); }\r\n\r\n    const threadIDs = Index.threadsOnPage(pageNum);\r\n    return Index.buildStructure(threadIDs);\r\n  },\r\n\r\n  endNotice: (function() {\r\n    let notify = false;\r\n    const reset = () => notify = false;\r\n    return function() {\r\n      if (notify) { return; }\r\n      notify = true;\r\n      new Notice('info', \"Last page reached.\", 2);\r\n      return setTimeout(reset, 3 * SECOND);\r\n    };\r\n  })(),\r\n\r\n  menu: {\r\n    init() {\r\n      if ((g.VIEW !== 'index') || !Conf['Menu'] || !Conf['Thread Hiding Link'] || !Index.enabledOn(g.BOARD)) { return; }\r\n\r\n      return Menu.menu.addEntry({\r\n        el: $.el('a', {\r\n          href:      'javascript:;',\r\n          className: 'has-shortcut-text'\r\n        }\r\n        , {innerHTML: \"<span></span><span class=\\\"shortcut-text\\\">Shift+click</span>\"}),\r\n        order: 20,\r\n        open({thread}) {\r\n          if (Conf['Index Mode'] !== 'catalog') { return false; }\r\n          this.el.firstElementChild.textContent = thread.isHidden ?\r\n            'Unhide'\r\n          :\r\n            'Hide';\r\n          if (this.cb) { $.off(this.el, 'click', this.cb); }\r\n          this.cb = function() {\r\n            $.event('CloseMenu');\r\n            return Index.toggleHide(thread);\r\n          };\r\n          $.on(this.el, 'click', this.cb);\r\n          return true;\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  node() {\r\n    if (this.isReply || this.isClone || (Index.threadPosition[this.ID] == null)) { return; }\r\n    return this.thread.setPage(Math.floor(Index.threadPosition[this.ID] / Index.threadsNumPerPage) + 1);\r\n  },\r\n\r\n  catalogNode() {\r\n    return $.on(this.nodes.root, 'mousedown click', e => {\r\n      if ((e.button !== 0) || !e.shiftKey) { return; }\r\n      if (e.type === 'click') { Index.toggleHide(this.thread); }\r\n      return e.preventDefault();\r\n    });\r\n  }, // Also on mousedown to prevent highlighting text.\r\n\r\n  toggleHide(thread) {\r\n    if (Index.showHiddenThreads) {\r\n      ThreadHiding.show(thread);\r\n      if (!ThreadHiding.db.get({boardID: thread.board.ID, threadID: thread.ID})) { return; }\r\n      // Don't save when un-hiding filtered threads.\r\n    } else {\r\n      ThreadHiding.hide(thread);\r\n    }\r\n    return ThreadHiding.saveHiddenState(thread);\r\n  },\r\n\r\n  cycleSortType() {\r\n    let i;\r\n    const types = Index.selectSort.options.filter(option => !option.disabled);\r\n    for (i = 0; i < types.length; i++) {\r\n      var type = types[i];\r\n      if (type.selected) { break; }\r\n    }\r\n    types[(i + 1) % types.length].selected = true;\r\n    return $.event('change', null, Index.selectSort);\r\n  },\r\n\r\n  cb: {\r\n    initFinished() {\r\n      Index.initFinishedFired = true;\r\n      return $.queueTask(() => Index.cb.postsInserted());\r\n    },\r\n\r\n    postsInserted() {\r\n      if (!Index.initFinishedFired) { return; }\r\n      let n = 0;\r\n      g.posts.forEach(function(post) {\r\n        if (!post.isFetchedQuote && !post.indexRefreshSeen && doc.contains(post.nodes.root)) {\r\n          post.indexRefreshSeen = true;\r\n          return n++;\r\n        }\r\n      });\r\n      if (n) { return $.event('IndexRefresh'); }\r\n    },\r\n\r\n    toggleHiddenThreads() {\r\n      $('#hidden-toggle a', Index.navLinks).textContent = (Index.showHiddenThreads = !Index.showHiddenThreads) ?\r\n        'Hide'\r\n      :\r\n        'Show';\r\n      Index.sort();\r\n      return Index.buildIndex();\r\n    },\r\n\r\n    mode() {\r\n      Index.pushState({mode: this.value});\r\n      return Index.pageLoad(false);\r\n    },\r\n\r\n    sort() {\r\n      const value = Index.selectRev.checked ? Index.selectSort.value + \"-rev\" : Index.selectSort.value;\r\n      Index.pushState({sort: value});\r\n      return Index.pageLoad(false);\r\n    },\r\n\r\n    resort(e) {\r\n      Index.changed.order = true;\r\n      if (!e?.detail?.deferred) { return Index.pageLoad(false); }\r\n    },\r\n\r\n    perBoardSort() {\r\n      Conf['Index Sort'] = this.checked ? dict() : '';\r\n      Index.saveSort();\r\n      for (let i = 0; i < 2; i++) {\r\n        Conf[`Last Long Reply Thresholds ${i}`] = this.checked ? dict() : '';\r\n        Index.saveLastLongThresholds(i);\r\n      }\r\n    },\r\n\r\n    lastLongThresholds() {\r\n      const i = [...this.parentNode.children].indexOf(this);\r\n      const value = +this.value;\r\n      if (!Number.isFinite(value)) {\r\n        this.value = Index.lastLongThresholds[i];\r\n        return;\r\n      }\r\n      Index.lastLongThresholds[i] = value;\r\n      Index.saveLastLongThresholds(i);\r\n      Index.changed.order = true;\r\n      return Index.pageLoad(false);\r\n    },\r\n\r\n    size(e) {\r\n      if (Conf['Index Mode'] !== 'catalog') {\r\n        $.rmClass(Index.root, 'catalog-small');\r\n        $.rmClass(Index.root, 'catalog-large');\r\n      } else if (Conf['Index Size'] === 'small') {\r\n        $.addClass(Index.root, 'catalog-small');\r\n        $.rmClass(Index.root,  'catalog-large');\r\n      } else {\r\n        $.addClass(Index.root, 'catalog-large');\r\n        $.rmClass(Index.root,  'catalog-small');\r\n      }\r\n      if (e) { return Index.buildIndex(); }\r\n    },\r\n\r\n    replies() {\r\n      return Index.buildIndex();\r\n    },\r\n\r\n    hover() {\r\n      return doc.classList.toggle('catalog-hover-expand', Conf['Catalog Hover Expand']);\r\n    },\r\n\r\n    hoverToggle(e) {\r\n      if (Conf['Catalog Hover Toggle'] && $.hasClass(doc, 'catalog-mode') && !$.modifiedClick(e) && !$.x('ancestor-or-self::a', e.target)) {\r\n        let thread;\r\n        const input = Index.inputs['Catalog Hover Expand'];\r\n        input.checked = !input.checked;\r\n        $.event('change', null, input);\r\n        if (thread = Get.threadFromNode(e.target)) {\r\n          Index.cb.catalogReplies.call(thread);\r\n          return Index.cb.hoverAdjust.call(thread.OP.nodes);\r\n        }\r\n      }\r\n    },\r\n\r\n    popstate(e) {\r\n      if (e?.state) {\r\n        const {searched, mode, sort} = e.state;\r\n        const page = Index.getCurrentPage();\r\n        Index.setState({search: searched, mode, sort, page});\r\n        return Index.pageLoad(false);\r\n      } else {\r\n        // page load or hash change\r\n        const nCommands = Index.processHash();\r\n        if (Conf['Refreshed Navigation'] && nCommands) {\r\n          return Index.update();\r\n        } else {\r\n          return Index.pageLoad();\r\n        }\r\n      }\r\n    },\r\n\r\n    pageNav(e) {\r\n      let a;\r\n      if ($.modifiedClick(e)) { return; }\r\n      switch (e.target.nodeName) {\r\n        case 'BUTTON':\r\n          e.target.blur();\r\n          a = e.target.parentNode;\r\n          break;\r\n        case 'A':\r\n          a = e.target;\r\n          break;\r\n        default:\r\n          return;\r\n      }\r\n      if (a.textContent === 'Catalog') { return; }\r\n      e.preventDefault();\r\n      return Index.userPageNav(+a.pathname.split(/\\/+/)[2] || 1);\r\n    },\r\n\r\n    refreshFront() {\r\n      Index.pushState({page: 1});\r\n      return Index.update();\r\n    },\r\n\r\n    catalogReplies() {\r\n      if (Conf['Show Replies'] && $.hasClass(doc, 'catalog-hover-expand') && !this.catalogView.nodes.replies) {\r\n        return Index.buildCatalogReplies(this);\r\n      }\r\n    },\r\n\r\n    hoverAdjust() {\r\n      // Prevent hovered catalog threads from going offscreen.\r\n      let x;\r\n      if (!$.hasClass(doc, 'catalog-hover-expand')) { return; }\r\n      const rect = this.post.getBoundingClientRect();\r\n      if (x = $.minmax(0, -rect.left, doc.clientWidth - rect.right)) {\r\n        const {style} = this.post;\r\n        style.left = `${x}px`;\r\n        style.right = `${-x}px`;\r\n        return $.one(this.root, 'mouseleave', () => style.left = (style.right = null));\r\n      }\r\n    }\r\n  },\r\n\r\n  scrollToIndex() {\r\n    // Scroll to navlinks, or top of board if navlinks are hidden.\r\n    return Header.scrollToIfNeeded((Index.navLinks.getBoundingClientRect().height ? Index.navLinks : Index.root));\r\n  },\r\n\r\n  getCurrentPage() {\r\n    return +window.location.pathname.split(/\\/+/)[2] || 1;\r\n  },\r\n\r\n  userPageNav(page) {\r\n    Index.pushState({page});\r\n    if (Conf['Refreshed Navigation']) {\r\n      return Index.update();\r\n    } else {\r\n      return Index.pageLoad();\r\n    }\r\n  },\r\n\r\n  hashCommands: {\r\n    mode: {\r\n      'paged':         'paged',\r\n      'infinite-scrolling': 'infinite',\r\n      'infinite':      'infinite',\r\n      'all-threads':   'all pages',\r\n      'all-pages':     'all pages',\r\n      'catalog':       'catalog'\r\n    },\r\n    sort: {\r\n      'bump-order':        'bump',\r\n      'last-reply':        'lastreply',\r\n      'last-long-reply':   'lastlong',\r\n      'creation-date':     'birth',\r\n      'reply-count':       'replycount',\r\n      'file-count':        'filecount',\r\n      'posts-per-minute':  'activity'\r\n    }\r\n  },\r\n\r\n  processHash() {\r\n    // XXX https://bugzilla.mozilla.org/show_bug.cgi?id=483304\r\n    let hash = location.href.match(/#.*/)?.[0] || '';\r\n    const state =\r\n      {replace: true};\r\n    const commands = hash.slice(1).split('/');\r\n    const leftover = [];\r\n    for (var command of commands) {\r\n      var mode, sort;\r\n      if (mode = $.getOwn(Index.hashCommands.mode, command)) {\r\n        state.mode = mode;\r\n      } else if (command === 'index') {\r\n        state.mode = Conf['Previous Index Mode'];\r\n        state.page = 1;\r\n      } else if (sort = $.getOwn(Index.hashCommands.sort, command.replace(/-rev$/, ''))) {\r\n        state.sort = sort;\r\n        if (/-rev$/.test(command)) { state.sort += '-rev'; }\r\n      } else if (/^s=/.test(command)) {\r\n        state.search = decodeURIComponent(command.slice(2)).replace(/\\+/g, ' ').trim();\r\n      } else {\r\n        leftover.push(command);\r\n      }\r\n    }\r\n    hash = leftover.join('/');\r\n    if (hash) { state.hash = `#${hash}`; }\r\n    Index.pushState(state);\r\n    return commands.length - leftover.length;\r\n  },\r\n\r\n  pushState(state) {\r\n    let {search, hash, replace} = state;\r\n    let pageBeforeSearch = history.state?.oldpage;\r\n    if ((search != null) && (search !== Index.search)) {\r\n      state.page = search ? 1 : (pageBeforeSearch || 1);\r\n      if (!search) {\r\n        pageBeforeSearch = undefined;\r\n      } else if (!Index.search) {\r\n        pageBeforeSearch = Index.currentPage;\r\n      }\r\n    }\r\n    Index.setState(state);\r\n    const pathname = Index.currentPage === 1 ? `/${g.BOARD}/` : `/${g.BOARD}/${Index.currentPage}`;\r\n    if (!hash) { hash = ''; }\r\n    return history[replace ? 'replaceState' : 'pushState']({\r\n      mode:     Conf['Index Mode'],\r\n      sort:     Index.currentSort,\r\n      searched: Index.search,\r\n      oldpage:  pageBeforeSearch\r\n    }\r\n    , '', `${location.protocol}//${location.host}${pathname}${hash}`);\r\n  },\r\n\r\n  setState({search, mode, sort, page, hash}) {\r\n    if ((search != null) && (search !== Index.search)) {\r\n      Index.changed.search = true;\r\n      Index.search = search;\r\n    }\r\n    if ((mode != null) && (mode !== Conf['Index Mode'])) {\r\n      Index.changed.mode = true;\r\n      Conf['Index Mode'] = mode;\r\n      $.set('Index Mode', mode);\r\n      if ((mode !== 'catalog') && (Conf['Previous Index Mode'] !== mode)) {\r\n        Conf['Previous Index Mode'] = mode;\r\n        $.set('Previous Index Mode', mode);\r\n      }\r\n    }\r\n    if ((sort != null) && (sort !== Index.currentSort)) {\r\n      Index.changed.sort = true;\r\n      Index.currentSort = sort;\r\n      Index.saveSort();\r\n    }\r\n    if (['all pages', 'catalog'].includes(Conf['Index Mode'])) { page = 1; }\r\n    if ((page != null) && (page !== Index.currentPage)) {\r\n      Index.changed.page = true;\r\n      Index.currentPage = page;\r\n    }\r\n    if (hash != null) {\r\n      return Index.changed.hash = true;\r\n    }\r\n  },\r\n\r\n  savePerBoard(key, value) {\r\n    if (typeof Conf[key] === 'object') {\r\n      Conf[key][g.BOARD.ID] = value;\r\n    } else {\r\n      Conf[key] = value;\r\n    }\r\n    return $.set(key, Conf[key]);\r\n  },\r\n\r\n  saveSort() {\r\n    return Index.savePerBoard('Index Sort', Index.currentSort);\r\n  },\r\n\r\n  saveLastLongThresholds(i) {\r\n    return Index.savePerBoard(`Last Long Reply Thresholds ${i}`, Index.lastLongThresholds[i]);\r\n  },\r\n\r\n  pageLoad(scroll=true) {\r\n    if (!Index.liveThreadData) { return; }\r\n    let {threads, order, search, mode, sort, page, hash} = Index.changed;\r\n    if (!threads) { threads = search; }\r\n    if (!order) { order = sort; }\r\n    if (threads || order) { Index.sort(); }\r\n    if (threads) { Index.buildPagelist(); }\r\n    if (search) { Index.setupSearch(); }\r\n    if (mode) { Index.setupMode(); }\r\n    if (sort) { Index.setupSort(); }\r\n    if (threads || mode || page || order) { Index.buildIndex(); }\r\n    if (threads || page) { Index.setPage(); }\r\n    if (scroll && !hash) { Index.scrollToIndex(); }\r\n    return Index.changed = {};\r\n  },\r\n\r\n  setupMode() {\r\n    for (var mode of ['paged', 'infinite', 'all pages', 'catalog']) {\r\n      $[mode === Conf['Index Mode'] ? 'addClass' : 'rmClass'](doc, `${mode.replace(/\\ /g, '-')}-mode`);\r\n    }\r\n    Index.selectMode.value = Conf['Index Mode'];\r\n    Index.cb.size();\r\n    Index.showHiddenThreads = false;\r\n    return $('#hidden-toggle a', Index.navLinks).textContent = 'Show';\r\n  },\r\n\r\n  setupSort() {\r\n    Index.selectRev.checked = /-rev$/.test(Index.currentSort);\r\n    Index.selectSort.value  = Index.currentSort.replace(/-rev$/, '');\r\n    return Index.lastLongOptions.hidden = (Index.selectSort.value !== 'lastlong');\r\n  },\r\n\r\n  getPagesNum() {\r\n    if (Index.search) {\r\n      return Math.ceil(Index.sortedThreadIDs.length / Index.threadsNumPerPage);\r\n    } else {\r\n      return Index.pagesNum;\r\n    }\r\n  },\r\n\r\n  getMaxPageNum() {\r\n    return Math.max(1, Index.getPagesNum());\r\n  },\r\n\r\n  buildPagelist() {\r\n    const pagesRoot = $('.pages', Index.pagelist);\r\n    const maxPageNum = Index.getMaxPageNum();\r\n    if (pagesRoot.childElementCount !== maxPageNum) {\r\n      const nodes = [];\r\n      for (let i = 1, end = maxPageNum; i <= end; i++) {\r\n        var a = $.el('a', {\r\n          textContent: i,\r\n          href: i === 1 ? './' : i\r\n        }\r\n        );\r\n        nodes.push($.tn('['), a, $.tn('] '));\r\n      }\r\n      $.rmAll(pagesRoot);\r\n      return $.add(pagesRoot, nodes);\r\n    }\r\n  },\r\n\r\n  setPage() {\r\n    let a, strong;\r\n    const pageNum    = Index.currentPage;\r\n    const maxPageNum = Index.getMaxPageNum();\r\n    const pagesRoot  = $('.pages', Index.pagelist);\r\n\r\n    // Previous/Next buttons\r\n    const prev = pagesRoot.previousElementSibling.firstElementChild;\r\n    const next = pagesRoot.nextElementSibling.firstElementChild;\r\n    let href = Math.max(pageNum - 1, 1);\r\n    prev.href = href === 1 ? './' : href;\r\n    prev.firstElementChild.disabled = href === pageNum;\r\n    href = Math.min(pageNum + 1, maxPageNum);\r\n    next.href = href === 1 ? './' : href;\r\n    next.firstElementChild.disabled = href === pageNum;\r\n\r\n    // <strong> current page\r\n    if (strong = $('strong', pagesRoot)) {\r\n      if (+strong.textContent === pageNum) { return; }\r\n      $.replace(strong, strong.firstChild);\r\n    } else {\r\n      strong = $.el('strong');\r\n    }\r\n\r\n    if (a = pagesRoot.children[pageNum - 1]) {\r\n      $.before(a, strong);\r\n      return $.add(strong, a);\r\n    }\r\n  },\r\n\r\n  updateHideLabel() {\r\n    if (!Index.hideLabel) { return; }\r\n    let hiddenCount = 0;\r\n    for (var threadID of Index.liveThreadIDs) {\r\n      if (Index.isHidden(threadID)) {\r\n        hiddenCount++;\r\n      }\r\n    }\r\n    if (!hiddenCount) {\r\n      Index.hideLabel.hidden = true;\r\n      if (Index.showHiddenThreads) { Index.cb.toggleHiddenThreads(); }\r\n      return;\r\n    }\r\n    Index.hideLabel.hidden = false;\r\n    return $('#hidden-count', Index.navLinks).textContent = hiddenCount === 1 ?\r\n      '1 hidden thread'\r\n    :\r\n      `${hiddenCount} hidden threads`;\r\n  },\r\n\r\n  update(firstTime) {\r\n    let oldReq;\r\n    if (oldReq = Index.req) {\r\n      delete Index.req;\r\n      oldReq.abort();\r\n    }\r\n\r\n    if (Conf['Index Refresh Notifications']) {\r\n      // Optional notification for manual refreshes\r\n      if (!Index.notice) { Index.notice = new Notice('info', 'Refreshing index...'); }\r\n      if (!Index.nTimeout) { Index.nTimeout = setTimeout(() => {\r\n          if (Index.notice) {\r\n            Index.notice.el.lastElementChild.textContent += ' (disable JSON Index if this takes too long)';\r\n          }\r\n        }\r\n        , 3 * SECOND); }\r\n    } else {\r\n      // Also display notice if Index Refresh is taking too long\r\n      if (!Index.nTimeout) { Index.nTimeout = setTimeout(() => Index.notice || (Index.notice = new Notice('info', 'Refreshing index... (disable JSON Index if this takes too long)'))\r\n      , 3 * SECOND); }\r\n    }\r\n\r\n    // Hard refresh in case of incomplete page load.\r\n    if (!firstTime && (d.readyState !== 'loading') && !$('.board + *')) {\r\n      location.reload();\r\n      return;\r\n    }\r\n\r\n    Index.req = $.whenModified(\r\n      g.SITE.urls.catalogJSON({boardID: g.BOARD.ID}),\r\n      'Index',\r\n      Index.load\r\n    );\r\n    return $.addClass(Index.button, 'spin');\r\n  },\r\n\r\n  load() {\r\n    let err;\r\n    if (this !== Index.req) { return; } // aborted\r\n\r\n    $.rmClass(Index.button, 'spin');\r\n    const {notice, nTimeout} = Index;\r\n    if (nTimeout) { clearTimeout(nTimeout); }\r\n    delete Index.nTimeout;\r\n    delete Index.req;\r\n    delete Index.notice;\r\n\r\n    if (![200, 304].includes(this.status)) {\r\n      err = `Index refresh failed. ${this.status ? `Error ${this.statusText} (${this.status})` : 'Connection Error'}`;\r\n      if (notice) {\r\n        notice.setType('warning');\r\n        notice.el.lastElementChild.textContent = err;\r\n        setTimeout(notice.close, SECOND);\r\n      } else {\r\n        new Notice('warning', err, 1);\r\n      }\r\n      return;\r\n    }\r\n\r\n    try {\r\n      if (this.status === 200) {\r\n        Index.parse(this.response);\r\n      } else if (this.status === 304) {\r\n        Index.pageLoad();\r\n      }\r\n    } catch (error) {\r\n      err = error;\r\n      c.error(`Index failure: ${err.message}`, err.stack);\r\n      if (notice) {\r\n        notice.setType('error');\r\n        notice.el.lastElementChild.textContent = 'Index refresh failed.';\r\n        setTimeout(notice.close, SECOND);\r\n      } else {\r\n        new Notice('error', 'Index refresh failed.', 1);\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (notice) {\r\n      if (Conf['Index Refresh Notifications']) {\r\n        notice.setType('success');\r\n        notice.el.lastElementChild.textContent = 'Index refreshed!';\r\n        setTimeout(notice.close, SECOND);\r\n      } else {\r\n        notice.close();\r\n      }\r\n    }\r\n\r\n    const timeEl = $('#index-last-refresh time', Index.navLinks);\r\n    timeEl.dataset.utc = Date.parse(this.getResponseHeader('Last-Modified'));\r\n    return RelativeDates.update(timeEl);\r\n  },\r\n\r\n  parse(pages) {\r\n    $.cleanCache(url => /^https?:\\/\\/a\\.4cdn\\.org\\//.test(url));\r\n    Index.parseThreadList(pages);\r\n    Index.changed.threads = true;\r\n    return Index.pageLoad();\r\n  },\r\n\r\n  parseThreadList(pages) {\r\n    Index.pagesNum          = pages.length;\r\n    Index.threadsNumPerPage = pages[0]?.threads.length || 1;\r\n    Index.liveThreadData    = pages.reduce(((arr, next) => arr.concat(next.threads)), []);\r\n    Index.liveThreadIDs     = Index.liveThreadData.map(data => data.no);\r\n    Index.liveThreadDict    = dict();\r\n    Index.threadPosition    = dict();\r\n    Index.parsedThreads     = dict();\r\n    Index.replyData         = dict();\r\n    for (let i = 0; i < Index.liveThreadData.length; i++) {\r\n      var obj, results;\r\n      var data = Index.liveThreadData[i];\r\n      Index.liveThreadDict[data.no] = data;\r\n      Index.threadPosition[data.no] = i;\r\n      Index.parsedThreads[data.no] = (obj = g.SITE.Build.parseJSON(data, g.BOARD));\r\n      obj.filterResults = (results = Filter.test(obj));\r\n      obj.isOnTop  = results.top;\r\n      obj.isHidden = results.hide || ThreadHiding.isHidden(obj.boardID, obj.threadID);\r\n      if (data.last_replies) {\r\n        for (var reply of data.last_replies) {\r\n          Index.replyData[`${g.BOARD}.${reply.no}`] = reply;\r\n        }\r\n      }\r\n    }\r\n    if (Index.liveThreadData[0]) {\r\n      g.SITE.Build.spoilerRange[g.BOARD.ID] = Index.liveThreadData[0].custom_spoiler;\r\n    }\r\n    g.BOARD.threads.forEach(function(thread) {\r\n      if (!Index.liveThreadIDs.includes(thread.ID)) { return thread.collect(); }\r\n    });\r\n    $.event('IndexUpdate',\r\n      {threads: ((Index.liveThreadIDs.map((ID) => `${g.BOARD}.${ID}`)))});\r\n  },\r\n\r\n  isHidden(threadID) {\r\n    let thread;\r\n    if ((thread = g.BOARD.threads.get(threadID)) && thread.OP && !thread.OP.isFetchedQuote) {\r\n      return thread.isHidden;\r\n    } else {\r\n      return Index.parsedThreads[threadID].isHidden;\r\n    }\r\n  },\r\n\r\n  isHiddenReply(threadID, replyData) {\r\n    return PostHiding.isHidden(g.BOARD.ID, threadID, replyData.no) || Filter.isHidden(g.SITE.Build.parseJSON(replyData, g.BOARD));\r\n  },\r\n\r\n  buildThreads(threadIDs, isCatalog, withReplies) {\r\n    let errors;\r\n    const threads    = [];\r\n    const newThreads = [];\r\n    let newPosts   = [];\r\n    for (var ID of threadIDs) {\r\n      var opRoot, thread;\r\n      try {\r\n        var OP;\r\n        var threadData = Index.liveThreadDict[ID];\r\n\r\n        if (thread = g.BOARD.threads.get(ID)) {\r\n          var isStale = (thread.json !== threadData) && (JSON.stringify(thread.json) !== JSON.stringify(threadData));\r\n          if (isStale) {\r\n            thread.setCount('post', threadData.replies + 1,                threadData.bumplimit);\r\n            thread.setCount('file', threadData.images  + !!threadData.ext, threadData.imagelimit);\r\n            thread.setStatus('Sticky', !!threadData.sticky);\r\n            thread.setStatus('Closed', !!threadData.closed);\r\n          }\r\n          if (thread.catalogView) {\r\n            $.rm(thread.catalogView.nodes.replies);\r\n            thread.catalogView.nodes.replies = null;\r\n          }\r\n        } else {\r\n          thread = new Thread(ID, g.BOARD);\r\n          newThreads.push(thread);\r\n        }\r\n        var lastPost = threadData.last_replies && threadData.last_replies.length ? threadData.last_replies[threadData.last_replies.length - 1].no : ID;\r\n        if (lastPost > thread.lastPost) { thread.lastPost = lastPost; }\r\n        thread.json = threadData;\r\n        threads.push(thread);\r\n\r\n        if ((OP = thread.OP) && !OP.isFetchedQuote) {\r\n          OP.setCatalogOP(isCatalog);\r\n          thread.setPage(Math.floor(Index.threadPosition[ID] / Index.threadsNumPerPage) + 1);\r\n        } else {\r\n          var obj = Index.parsedThreads[ID];\r\n          opRoot = g.SITE.Build.post(obj);\r\n          OP = new Post(opRoot, thread, g.BOARD);\r\n          OP.filterResults = obj.filterResults;\r\n          newPosts.push(OP);\r\n        }\r\n\r\n        if (!isCatalog || !thread.nodes.root) {\r\n          g.SITE.Build.thread(thread, threadData, withReplies);\r\n        }\r\n      } catch (err) {\r\n        // Skip posts that we failed to parse.\r\n        if (!errors) { errors = []; }\r\n        errors.push({\r\n          message: `Parsing of Thread No.${thread} failed. Thread will be skipped.`,\r\n          error: err,\r\n          html: opRoot?.outerHTML\r\n        });\r\n      }\r\n    }\r\n    if (errors) { Main.handleErrors(errors); }\r\n\r\n    if (withReplies) {\r\n      newPosts = newPosts.concat(Index.buildReplies(threads));\r\n    }\r\n\r\n    Main.callbackNodes('Thread', newThreads);\r\n    Main.callbackNodes('Post',   newPosts);\r\n    Index.updateHideLabel();\r\n    $.event('IndexRefreshInternal', {threadIDs: (threads.map((t) => t.fullID)), isCatalog});\r\n\r\n    return threads;\r\n  },\r\n\r\n  buildReplies(threads) {\r\n    let errors;\r\n    const posts = [];\r\n    for (var thread of threads) {\r\n      var lastReplies;\r\n      if (!(lastReplies = Index.liveThreadDict[thread.ID].last_replies)) { continue; }\r\n      var nodes = [];\r\n      for (var data of lastReplies) {\r\n        var node, post;\r\n        if ((post = thread.posts.get(data.no)) && !post.isFetchedQuote) {\r\n          nodes.push(post.nodes.root);\r\n          continue;\r\n        }\r\n        nodes.push(node = g.SITE.Build.postFromObject(data, thread.board.ID));\r\n        try {\r\n          posts.push(new Post(node, thread, thread.board));\r\n        } catch (err) {\r\n          // Skip posts that we failed to parse.\r\n          if (!errors) { errors = []; }\r\n          errors.push({\r\n            message: `Parsing of Post No.${data.no} failed. Post will be skipped.`,\r\n            error: err,\r\n            html: node?.outerHTML\r\n          });\r\n        }\r\n      }\r\n      $.add(thread.nodes.root, nodes);\r\n    }\r\n\r\n    if (errors) { Main.handleErrors(errors); }\r\n    return posts;\r\n  },\r\n\r\n  buildCatalogViews(threads) {\r\n    const catalogThreads = [];\r\n    for (var thread of threads) {\r\n      if (!thread.catalogView) {\r\n        var {ID} = thread;\r\n        var page = Math.floor(Index.threadPosition[ID] / Index.threadsNumPerPage) + 1;\r\n        var root = g.SITE.Build.catalogThread(thread, Index.liveThreadDict[ID], page);\r\n        catalogThreads.push(new CatalogThread(root, thread));\r\n      }\r\n    }\r\n    Main.callbackNodes('CatalogThread', catalogThreads);\r\n  },\r\n\r\n  sizeCatalogViews(threads) {\r\n    // XXX When browsers support CSS3 attr(), use it instead.\r\n    const size = Conf['Index Size'] === 'small' ? 150 : 250;\r\n    for (var thread of threads) {\r\n      var {thumb} = thread.catalogView.nodes;\r\n      var {width, height} = thumb.dataset;\r\n      if (!width) { continue; }\r\n      var ratio = size / Math.max(width, height);\r\n      thumb.style.width  = (width  * ratio) + 'px';\r\n      thumb.style.height = (height * ratio) + 'px';\r\n    }\r\n  },\r\n\r\n  buildCatalogReplies(thread) {\r\n    let lastReplies;\r\n    const {nodes} = thread.catalogView;\r\n    if (!(lastReplies = Index.liveThreadDict[thread.ID].last_replies)) { return; }\r\n\r\n    const replies = [];\r\n    for (var data of lastReplies) {\r\n      if (Index.isHiddenReply(thread.ID, data)) { continue; }\r\n      var reply = g.SITE.Build.catalogReply(thread, data);\r\n      RelativeDates.update($('time', reply));\r\n      $.on($('.catalog-reply-preview', reply), 'mouseover', QuotePreview.mouseover);\r\n      replies.push(reply);\r\n    }\r\n\r\n    nodes.replies = $.el('div', {className: 'catalog-replies'});\r\n    $.add(nodes.replies, replies);\r\n    $.add(thread.OP.nodes.post, nodes.replies);\r\n  },\r\n\r\n  sort() {\r\n    let threadIDs;\r\n    const {liveThreadIDs, liveThreadData} = Index;\r\n    if (!liveThreadData) { return; }\r\n    const tmp_time = new Date().getTime()/1000;\r\n    const sortType = Index.currentSort.replace(/-rev$/, '');\r\n    Index.sortedThreadIDs = (() => { switch (sortType) {\r\n      case 'lastreply': case 'lastlong':\r\n        var repliesAvailable = liveThreadData.some(thread => thread.last_replies?.length);\r\n        var lastlong = function(thread) {\r\n          if (!repliesAvailable) {\r\n            return thread.last_modified;\r\n          }\r\n          const iterable = thread.last_replies || [];\r\n          for (let i = iterable.length - 1; i >= 0; i--) {\r\n            var r = iterable[i];\r\n            if (Index.isHiddenReply(thread.no, r)) { continue; }\r\n            if (sortType === 'lastreply') {\r\n              return r;\r\n            }\r\n            var len = r.com ? g.SITE.Build.parseComment(r.com).replace(/[^a-z]/ig, '').length : 0;\r\n            if (len >= Index.lastLongThresholds[+!!r.ext]) {\r\n              return r;\r\n            }\r\n          }\r\n          if (thread.omitted_posts && thread.last_replies?.length) { return thread.last_replies[0]; } else { return thread; }\r\n        };\r\n        var lastlongD = dict();\r\n        for (var thread of liveThreadData) {\r\n          lastlongD[thread.no] = lastlong(thread).no;\r\n        }\r\n        return [...liveThreadData].sort((a, b) => lastlongD[b.no] - lastlongD[a.no]).map(post => post.no);\r\n      case 'bump':       return liveThreadIDs;\r\n      case 'birth':      return [...liveThreadIDs ].sort((a, b) => b - a);\r\n      case 'replycount': return [...liveThreadData].sort((a, b) => b.replies - a.replies).map(post => post.no);\r\n      case 'filecount':  return [...liveThreadData].sort((a, b) => b.images  - a.images).map(post => post.no);\r\n      case 'activity':   return [...liveThreadData].sort((a, b) => ((tmp_time-a.time)/(a.replies+1)) - ((tmp_time-b.time)/(b.replies+1))).map(post => post.no);\r\n      default: return liveThreadIDs;\r\n    } })();\r\n    if (/-rev$/.test(Index.currentSort)) {\r\n      Index.sortedThreadIDs.reverse();\r\n    }\r\n    if (Index.search && (threadIDs = Index.querySearch(Index.search))) {\r\n      Index.sortedThreadIDs = threadIDs;\r\n    }\r\n    // Sticky threads\r\n    Index.sortOnTop(obj => obj.isSticky);\r\n    // Highlighted threads\r\n    Index.sortOnTop(obj => obj.isOnTop || (Conf['Pin Watched Threads'] && ThreadWatcher.isWatchedRaw(obj.boardID, obj.threadID)));\r\n    // Non-hidden threads\r\n    if (Conf['Anchor Hidden Threads']) { return Index.sortOnTop(obj => !Index.isHidden(obj.threadID)); }\r\n  },\r\n\r\n  sortOnTop(match) {\r\n    const topThreads    = [];\r\n    const bottomThreads = [];\r\n    for (var ID of Index.sortedThreadIDs) {\r\n      (match(Index.parsedThreads[ID]) ? topThreads : bottomThreads).push(ID);\r\n    }\r\n    return Index.sortedThreadIDs = topThreads.concat(bottomThreads);\r\n  },\r\n\r\n  buildIndex() {\r\n    let threadIDs;\r\n    if (!Index.liveThreadData) { return; }\r\n    switch (Conf['Index Mode']) {\r\n      case 'all pages':\r\n        threadIDs = Index.sortedThreadIDs;\r\n        break;\r\n      case 'catalog':\r\n        threadIDs = Index.sortedThreadIDs.filter(ID => !Index.isHidden(ID) !== Index.showHiddenThreads);\r\n        break;\r\n      default:\r\n        threadIDs = Index.threadsOnPage(Index.currentPage);\r\n    }\r\n    delete Index.pageNum;\r\n    $.rmAll(Index.root);\r\n    $.rmAll(Header.hover);\r\n    if (Index.loaded && Index.root.parentNode) {\r\n      $.event('PostsRemoved', null, Index.root);\r\n    }\r\n    if (Conf['Index Mode'] === 'catalog') {\r\n      Index.buildCatalog(threadIDs);\r\n    } else {\r\n      Index.buildStructure(threadIDs);\r\n    }\r\n  },\r\n\r\n  threadsOnPage(pageNum) {\r\n    const nodesPerPage = Index.threadsNumPerPage;\r\n    const offset = nodesPerPage * (pageNum - 1);\r\n    return Index.sortedThreadIDs.slice(offset ,  offset + nodesPerPage);\r\n  },\r\n\r\n  buildStructure(threadIDs) {\r\n    const threads = Index.buildThreads(threadIDs, false, Conf['Show Replies']);\r\n    const nodes = [];\r\n    for (var thread of threads) {\r\n      nodes.push(thread.nodes.root, $.el('hr'));\r\n    }\r\n    $.add(Index.root, nodes);\r\n    if (Index.root.parentNode) {\r\n      $.event('PostsInserted', null, Index.root);\r\n    }\r\n    Index.loaded = true;\r\n  },\r\n\r\n  buildCatalog(threadIDs) {\r\n    let i = 0;\r\n    const n = threadIDs.length;\r\n    let node0 = null;\r\n    var fn = function() {\r\n      if (node0 && !node0.parentNode) { return; } // Index.root cleared\r\n      const j = (i > 0) && Index.root.parentNode ? n : i + 30;\r\n      node0 = Index.buildCatalogPart(threadIDs.slice(i, j))[0];\r\n      i = j;\r\n      if (i < n) {\r\n        return $.queueTask(fn);\r\n      } else {\r\n        if (Index.root.parentNode) {\r\n          $.event('PostsInserted', null, Index.root);\r\n        }\r\n        return Index.loaded = true;\r\n      }\r\n    };\r\n    fn();\r\n  },\r\n\r\n  buildCatalogPart(threadIDs) {\r\n    const threads = Index.buildThreads(threadIDs, true);\r\n    Index.buildCatalogViews(threads);\r\n    Index.sizeCatalogViews(threads);\r\n    const nodes = [];\r\n    for (var thread of threads) {\r\n      thread.OP.setCatalogOP(true);\r\n      $.add(thread.catalogView.nodes.root, thread.OP.nodes.root);\r\n      nodes.push(thread.catalogView.nodes.root);\r\n      $.on(thread.catalogView.nodes.root, 'mouseenter', Index.cb.catalogReplies.bind(thread));\r\n      $.on(thread.OP.nodes.root, 'mouseenter', Index.cb.hoverAdjust.bind(thread.OP.nodes));\r\n    }\r\n    $.add(Index.root, nodes);\r\n    return nodes;\r\n  },\r\n\r\n  clearSearch() {\r\n    Index.searchInput.value = '';\r\n    Index.onSearchInput();\r\n    return Index.searchInput.focus();\r\n  },\r\n\r\n  setupSearch() {\r\n    Index.searchInput.value = Index.search;\r\n    if (Index.search) {\r\n      return Index.searchInput.dataset.searching = 1;\r\n    } else {\r\n      // XXX https://bugzilla.mozilla.org/show_bug.cgi?id=1021289\r\n      return Index.searchInput.removeAttribute('data-searching');\r\n    }\r\n  },\r\n\r\n  onSearchInput() {\r\n    const search = Index.searchInput.value.trim();\r\n    if (search === Index.search) { return; }\r\n    Index.pushState({\r\n      search,\r\n      replace: !!search === !!Index.search\r\n    });\r\n    return Index.pageLoad(false);\r\n  },\r\n\r\n  querySearch(query) {\r\n    let keywords, match;\r\n    if (match = query.match(/^([\\w+]+):\\/(.*)\\/(\\w*)$/)) {\r\n      let regexp;\r\n      try {\r\n        regexp = RegExp(match[2], match[3]);\r\n      } catch (error) {\r\n        return [];\r\n      }\r\n      return Index.sortedThreadIDs.filter(ID => regexp.test(Filter.values(match[1], Index.parsedThreads[ID]).join('\\n')));\r\n    }\r\n    if (!(keywords = query.toLowerCase().match(/\\S+/g))) { return; }\r\n    return Index.sortedThreadIDs.filter(ID => Index.searchMatch(Index.parsedThreads[ID], keywords));\r\n  },\r\n\r\n  searchMatch(obj, keywords) {\r\n    const {info, file} = obj;\r\n    if (info.comment == null) { info.comment = g.SITE.Build.parseComment(info.commentHTML.innerHTML); }\r\n    let text = [];\r\n    for (var key of ['comment', 'subject', 'name', 'tripcode']) {\r\n      if (key in info) { text.push(info[key]); }\r\n    }\r\n    if (file) { text.push(file.name); }\r\n    text = text.join(' ').toLowerCase();\r\n    for (var keyword of keywords) {\r\n      if (-1 === text.indexOf(keyword)) { return false; }\r\n    }\r\n    return true;\r\n  }\r\n};\r\nexport default Index;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport DataBoard from \"../classes/DataBoard\";\r\nimport Thread from \"../classes/Thread\";\r\nimport Index from \"../General/Index\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf, d, doc } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport Menu from \"../Menu/Menu\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ThreadHiding = {\r\n  init() {\r\n    if (!['index', 'catalog'].includes(g.VIEW) || (!Conf['Thread Hiding Buttons'] && !(Conf['Menu'] && Conf['Thread Hiding Link']) && !Conf['JSON Index'])) { return; }\r\n    this.db = new DataBoard('hiddenThreads');\r\n    if (g.VIEW === 'catalog') { return this.catalogWatch(); }\r\n    this.catalogSet(g.BOARD);\r\n    $.on(d, 'IndexRefreshInternal', this.onIndexRefresh);\r\n    if (Conf['Thread Hiding Buttons']) {\r\n      $.addClass(doc, 'thread-hide');\r\n    }\r\n    return Callbacks.Post.push({\r\n      name: 'Thread Hiding',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  catalogSet(board) {\r\n    if (!$.hasStorage || (g.SITE.software !== 'yotsuba')) { return; }\r\n    const hiddenThreads = ThreadHiding.db.get({\r\n      boardID: board.ID,\r\n      defaultValue: dict()\r\n    });\r\n    for (var threadID in hiddenThreads) { hiddenThreads[threadID] = true; }\r\n    return localStorage.setItem(`4chan-hide-t-${board}`, JSON.stringify(hiddenThreads));\r\n  },\r\n\r\n  catalogWatch() {\r\n    if (!$.hasStorage || (g.SITE.software !== 'yotsuba')) { return; }\r\n    this.hiddenThreads = JSON.parse(localStorage.getItem(`4chan-hide-t-${g.BOARD}`)) || {};\r\n    return Main.ready(() => // 4chan's catalog sets the style to \"display: none;\" when hiding or unhiding a thread.\r\n    new MutationObserver(ThreadHiding.catalogSave).observe($.id('threads'), {\r\n      attributes: true,\r\n      subtree: true,\r\n      attributeFilter: ['style']\r\n    }));\r\n  },\r\n\r\n  catalogSave() {\r\n    let threadID;\r\n    const hiddenThreads2 = JSON.parse(localStorage.getItem(`4chan-hide-t-${g.BOARD}`)) || {};\r\n    for (threadID in hiddenThreads2) {\r\n      if (!$.hasOwn(ThreadHiding.hiddenThreads, threadID)) {\r\n        ThreadHiding.db.set({\r\n          boardID:  g.BOARD.ID,\r\n          threadID,\r\n          val:      {makeStub: Conf['Stubs']}});\r\n      }\r\n    }\r\n    for (threadID in ThreadHiding.hiddenThreads) {\r\n      if (!$.hasOwn(hiddenThreads2, threadID)) {\r\n        ThreadHiding.db.delete({\r\n          boardID:  g.BOARD.ID,\r\n          threadID\r\n        });\r\n      }\r\n    }\r\n    return ThreadHiding.hiddenThreads = hiddenThreads2;\r\n  },\r\n\r\n  isHidden(boardID, threadID) {\r\n    return !!(ThreadHiding.db && ThreadHiding.db.get({boardID, threadID}));\r\n  },\r\n\r\n  node() {\r\n    let data;\r\n    if (this.isReply || this.isClone || this.isFetchedQuote) { return; }\r\n\r\n    if (Conf['Thread Hiding Buttons']) {\r\n      $.prepend(this.nodes.root, ThreadHiding.makeButton(this.thread, 'hide'));\r\n    }\r\n\r\n    if (data = ThreadHiding.db.get({boardID: this.board.ID, threadID: this.ID})) {\r\n      return ThreadHiding.hide(this.thread, data.makeStub);\r\n    }\r\n  },\r\n\r\n  onIndexRefresh() {\r\n    return g.BOARD.threads.forEach(function(thread) {\r\n      const {root} = thread.nodes;\r\n      if (thread.isHidden && thread.stub && !root.contains(thread.stub)) {\r\n        return ThreadHiding.makeStub(thread, root);\r\n      }\r\n    });\r\n  },\r\n\r\n  menu: {\r\n    init() {\r\n      if ((g.VIEW !== 'index') || !Conf['Menu'] || !Conf['Thread Hiding Link']) { return; }\r\n\r\n      let div = $.el('div', {\r\n        className: 'hide-thread-link',\r\n        textContent: 'Hide'\r\n      }\r\n      );\r\n\r\n      const apply = $.el('a', {\r\n        textContent: 'Apply',\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.on(apply, 'click', ThreadHiding.menu.hide);\r\n\r\n      const makeStub = UI.checkbox('Stubs', 'Make stub');\r\n\r\n      Menu.menu.addEntry({\r\n        el: div,\r\n        order: 20,\r\n        open({thread, isReply}) {\r\n          if (isReply || thread.isHidden || (Conf['JSON Index'] && (Conf['Index Mode'] === 'catalog'))) {\r\n            return false;\r\n          }\r\n          ThreadHiding.menu.thread = thread;\r\n          return true;\r\n        },\r\n        subEntries: [{el: apply}, {el: makeStub}]});\r\n\r\n      div = $.el('a', {\r\n        className: 'show-thread-link',\r\n        textContent: 'Show',\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.on(div, 'click', ThreadHiding.menu.show);\r\n\r\n      Menu.menu.addEntry({\r\n        el: div,\r\n        order: 20,\r\n        open({thread, isReply}) {\r\n          if (isReply || !thread.isHidden || (Conf['JSON Index'] && (Conf['Index Mode'] === 'catalog'))) {\r\n            return false;\r\n          }\r\n          ThreadHiding.menu.thread = thread;\r\n          return true;\r\n        }\r\n      });\r\n\r\n      const hideStubLink = $.el('a', {\r\n        textContent: 'Hide stub',\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.on(hideStubLink, 'click', ThreadHiding.menu.hideStub);\r\n\r\n      return Menu.menu.addEntry({\r\n        el: hideStubLink,\r\n        order: 15,\r\n        open({thread, isReply}) {\r\n          if (isReply || !thread.isHidden || (Conf['JSON Index'] && (Conf['Index Mode'] === 'catalog'))) {\r\n            return false;\r\n          }\r\n          return ThreadHiding.menu.thread = thread;\r\n        }\r\n      });\r\n    },\r\n\r\n    hide() {\r\n      const makeStub = $('input', this.parentNode).checked;\r\n      const {thread} = ThreadHiding.menu;\r\n      ThreadHiding.hide(thread, makeStub);\r\n      ThreadHiding.saveHiddenState(thread, makeStub);\r\n      return $.event('CloseMenu');\r\n    },\r\n\r\n    show() {\r\n      const {thread} = ThreadHiding.menu;\r\n      ThreadHiding.show(thread);\r\n      ThreadHiding.saveHiddenState(thread);\r\n      return $.event('CloseMenu');\r\n    },\r\n\r\n    hideStub() {\r\n      const {thread} = ThreadHiding.menu;\r\n      ThreadHiding.show(thread);\r\n      ThreadHiding.hide(thread, false);\r\n      ThreadHiding.saveHiddenState(thread, false);\r\n      $.event('CloseMenu');\r\n    }\r\n  },\r\n\r\n  makeButton(thread, type) {\r\n    const a = $.el('a', {\r\n      className: `${type}-thread-button`,\r\n      href:      'javascript:;'\r\n    }\r\n    );\r\n    $.extend(a, {textContent: type === \"hide\" ? '➖︎' : '➕︎' });\r\n    a.dataset.fullID = thread.fullID;\r\n    $.on(a, 'click', ThreadHiding.toggle);\r\n    return a;\r\n  },\r\n\r\n  makeStub(thread, root) {\r\n    let summary, threadDivider;\r\n    let numReplies  = $$(g.SITE.selectors.replyOriginal, root).length;\r\n    if (summary = $(g.SITE.selectors.summary, root)) { numReplies += +summary.textContent.match(/\\d+/); }\r\n\r\n    const a = ThreadHiding.makeButton(thread, 'show');\r\n    $.add(a, $.tn(` ${thread.OP.info.nameBlock} (${numReplies === 1 ? '1 reply' : `${numReplies} replies`})`));\r\n    thread.stub = $.el('div',\r\n      {className: 'stub'});\r\n    if (Conf['Menu']) {\r\n      $.add(thread.stub, [a, Menu.makeButton(thread.OP)]);\r\n    } else {\r\n      $.add(thread.stub, a);\r\n    }\r\n    $.prepend(root, thread.stub);\r\n\r\n    // Prevent hiding of thread divider on sites that put it inside the thread\r\n    if (threadDivider = $(g.SITE.selectors.threadDivider, root)) {\r\n      return $.addClass(threadDivider, 'threadDivider');\r\n    }\r\n  },\r\n\r\n  saveHiddenState(thread, makeStub) {\r\n    if (thread.isHidden) {\r\n      ThreadHiding.db.set({\r\n        boardID:  thread.board.ID,\r\n        threadID: thread.ID,\r\n        val: {makeStub}});\r\n    } else {\r\n      ThreadHiding.db.delete({\r\n        boardID:  thread.board.ID,\r\n        threadID: thread.ID\r\n      });\r\n    }\r\n    return ThreadHiding.catalogSet(thread.board);\r\n  },\r\n\r\n  toggle(thread) {\r\n    if (!(thread instanceof Thread)) {\r\n      thread = g.threads.get(this.dataset.fullID);\r\n    }\r\n    if (thread.isHidden) {\r\n      ThreadHiding.show(thread);\r\n    } else {\r\n      ThreadHiding.hide(thread);\r\n    }\r\n    return ThreadHiding.saveHiddenState(thread);\r\n  },\r\n\r\n  hide(thread, makeStub=Conf['Stubs']) {\r\n    if (thread.isHidden) { return; }\r\n    const threadRoot = thread.nodes.root;\r\n    thread.isHidden = true;\r\n    Index.updateHideLabel();\r\n    if (thread.catalogView && !Index.showHiddenThreads) {\r\n      $.rm(thread.catalogView.nodes.root);\r\n      $.event('PostsRemoved', null, Index.root);\r\n    }\r\n\r\n    if (!makeStub) { return threadRoot.hidden = true; }\r\n\r\n    return ThreadHiding.makeStub(thread, threadRoot);\r\n  },\r\n\r\n  show(thread) {\r\n    if (thread.stub) {\r\n      $.rm(thread.stub);\r\n      delete thread.stub;\r\n    }\r\n    const threadRoot = thread.nodes.root;\r\n    threadRoot.hidden = (thread.isHidden = false);\r\n    Index.updateHideLabel();\r\n    if (thread.catalogView && Index.showHiddenThreads) {\r\n      $.rm(thread.catalogView.nodes.root);\r\n      return $.event('PostsRemoved', null, Index.root);\r\n    }\r\n  }\r\n};\r\nexport default ThreadHiding;\r\n",null,null,null,"import $ from \"../platform/$\";\r\nimport CSS from \"../css/CSS\";\r\nimport { Conf } from \"../globals/globals\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst CustomCSS = {\r\n  init() {\r\n    if (!Conf['Custom CSS']) { return; }\r\n    return this.addStyle();\r\n  },\r\n\r\n  addStyle() {\r\n    return this.style = $.addStyle(CSS.sub(Conf['usercss']), 'custom-css', '#fourchanx-css');\r\n  },\r\n\r\n  rmStyle() {\r\n    if (this.style) {\r\n      $.rm(this.style);\r\n      return delete this.style;\r\n    }\r\n  },\r\n\r\n  update() {\r\n    if (!this.style) {\r\n      return this.addStyle();\r\n    }\r\n    return this.style.textContent = CSS.sub(Conf['usercss']);\r\n  }\r\n};\r\nexport default CustomCSS;\r\n","import { Conf, d } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst SWTinyboard = {\r\n  isOPContainerThread: true,\r\n  mayLackJSON: true,\r\n  threadModTimeIgnoresSage: true,\r\n\r\n  disabledFeatures: [\r\n    'Resurrect Quotes',\r\n    'Quick Reply Personas',\r\n    'Quick Reply',\r\n    'Cooldown',\r\n    'Report Link',\r\n    'Delete Link',\r\n    'Edit Link',\r\n    'Quote Inlining',\r\n    'Quote Previewing',\r\n    'Quote Backlinks',\r\n    'File Info Formatting',\r\n    'Image Expansion',\r\n    'Image Expansion (Menu)',\r\n    'Comment Expansion',\r\n    'Thread Expansion',\r\n    'Favicon',\r\n    'Quote Threading',\r\n    'Thread Updater',\r\n    'Banner',\r\n    'Flash Features',\r\n    'Reply Pruning'\r\n  ],\r\n\r\n  detect() {\r\n    for (var script of $$('script:not([src])', d.head)) {\r\n      var m;\r\n      if (m = script.textContent.match(/\\bvar configRoot=(\".*?\")/)) {\r\n        var properties = dict();\r\n        try {\r\n          var root = JSON.parse(m[1]);\r\n          if (root[0] === '/') {\r\n            properties.root = location.origin + root;\r\n          } else if (/^https?:/.test(root)) {\r\n            properties.root = root;\r\n          }\r\n        } catch (error) {}\r\n        return properties;\r\n      }\r\n    }\r\n    return false;\r\n  },\r\n\r\n  awaitBoard(cb) {\r\n    let reactUI;\r\n    if (reactUI = $.id('react-ui')) {\r\n      const s = (this.selectors = Object.create(this.selectors));\r\n      s.boardFor = {index: '.page-container'};\r\n      s.thread = 'div[id^=\"thread_\"]';\r\n      return Main.mounted(cb);\r\n    } else {\r\n      return cb();\r\n    }\r\n  },\r\n\r\n  urls: {\r\n    thread({siteID, boardID, threadID}, isArchived) {\r\n      return `${Conf['siteProperties'][siteID]?.root || `http://${siteID}/`}${boardID}/${isArchived ? 'archive/' : ''}res/${threadID}.html`;\r\n    },\r\n    post({postID})                   { return `#${postID}`; },\r\n    index({siteID, boardID})          { return `${Conf['siteProperties'][siteID]?.root || `http://${siteID}/`}${boardID}/`; },\r\n    catalog({siteID, boardID})          { return `${Conf['siteProperties'][siteID]?.root || `http://${siteID}/`}${boardID}/catalog.html`; },\r\n    threadJSON({siteID, boardID, threadID}, isArchived) {\r\n      const root = Conf['siteProperties'][siteID]?.root;\r\n      if (root) { return `${root}${boardID}/${isArchived ? 'archive/' : ''}res/${threadID}.json`; } else { return ''; }\r\n    },\r\n    archivedThreadJSON(thread) {\r\n      return SWTinyboard.urls.threadJSON(thread, true);\r\n    },\r\n    threadsListJSON({siteID, boardID}) {\r\n      const root = Conf['siteProperties'][siteID]?.root;\r\n      if (root) { return `${root}${boardID}/threads.json`; } else { return ''; }\r\n    },\r\n    archiveListJSON({siteID, boardID}) {\r\n      const root = Conf['siteProperties'][siteID]?.root;\r\n      if (root) { return `${root}${boardID}/archive/archive.json`; } else { return ''; }\r\n    },\r\n    catalogJSON({siteID, boardID}) {\r\n      const root = Conf['siteProperties'][siteID]?.root;\r\n      if (root) { return `${root}${boardID}/catalog.json`; } else { return ''; }\r\n    },\r\n    file({siteID, boardID}, filename) {\r\n      return `${Conf['siteProperties'][siteID]?.root || `http://${siteID}/`}${boardID}/${filename}`;\r\n    },\r\n    thumb(board, filename) {\r\n      return SWTinyboard.urls.file(board, filename);\r\n    }\r\n  },\r\n\r\n  selectors: {\r\n    board:         'form[name=\"postcontrols\"]',\r\n    thread:        'input[name=\"board\"] ~ div[id^=\"thread_\"]',\r\n    threadDivider: 'div[id^=\"thread_\"] > hr:last-child',\r\n    summary:       '.omitted',\r\n    postContainer: 'div[id^=\"reply_\"]:not(.hidden)', // postContainer is thread for OP\r\n    opBottom:      '.op',\r\n    replyOriginal: 'div[id^=\"reply_\"]:not(.hidden)',\r\n    infoRoot:      '.intro',\r\n    info: {\r\n      subject:   '.subject',\r\n      name:      '.name',\r\n      email:     '.email',\r\n      tripcode:  '.trip',\r\n      uniqueID:  '.poster_id',\r\n      capcode:   '.capcode',\r\n      flag:      '.flag',\r\n      date:      'time',\r\n      nameBlock: 'label',\r\n      quote:     'a[href*=\"#q\"]',\r\n      reply:     'a[href*=\"/res/\"]:not([href*=\"#\"])'\r\n    },\r\n    icons: {\r\n      isSticky:   '.fa-thumb-tack',\r\n      isClosed:   '.fa-lock'\r\n    },\r\n    file: {\r\n      text:  '.fileinfo',\r\n      link:  '.fileinfo > a',\r\n      thumb: 'a > .post-image'\r\n    },\r\n    thumbLink: '.file > a',\r\n    multifile: '.files > .file',\r\n    highlightable: {\r\n      op:      ' > .op',\r\n      reply:   '.reply',\r\n      catalog: ' > .thread'\r\n    },\r\n    comment:   '.body',\r\n    spoiler:   '.spoiler',\r\n    quotelink: 'a[onclick*=\"highlightReply(\"]',\r\n    catalog: {\r\n      board:  '#Grid',\r\n      thread: '.mix',\r\n      thumb:  '.thread-image'\r\n    },\r\n    boardList: '.boardlist',\r\n    boardListBottom: '.boardlist.bottom',\r\n    styleSheet: '#stylesheet',\r\n    psa:       '.blotter',\r\n    nav: {\r\n      prev: '.pages > form > [value=Previous]',\r\n      next: '.pages > form > [value=Next]'\r\n    }\r\n  },\r\n\r\n  classes: {\r\n    highlight: 'highlighted'\r\n  },\r\n\r\n  xpath: {\r\n    thread:         'div[starts-with(@id,\"thread_\")]',\r\n    postContainer:  'div[starts-with(@id,\"reply_\") or starts-with(@id,\"thread_\")]',\r\n    replyContainer: 'div[starts-with(@id,\"reply_\")]'\r\n  },\r\n\r\n  regexp: {\r\n    quotelink:\r\n      new RegExp(`\\\r\n/\\\r\n([^/]+)\\\r\n/res/\\\r\n(\\\\d+)\\\r\n(?:\\\\.\\\\w+)?#\\\r\n(\\\\d+)\\\r\n$\\\r\n`),\r\n    quotelinkHTML:\r\n      /<a [^>]*\\bhref=\"[^\"]*\\/([^\\/]+)\\/res\\/(\\d+)(?:\\.\\w+)?#(\\d+)\"/g\r\n  },\r\n\r\n  Build: {\r\n    parseJSON(data, board) {\r\n      const o = this.parseJSON(data, board);\r\n      if (data.ext === 'deleted') {\r\n        delete o.file;\r\n        $.extend(o, {\r\n          files: [],\r\n          fileDeleted: true,\r\n          filesDeleted: [0]\r\n        });\r\n      }\r\n      if (data.extra_files) {\r\n        let file;\r\n        for (let i = 0; i < data.extra_files.length; i++) {\r\n          var extra_file = data.extra_files[i];\r\n          if (extra_file.ext === 'deleted') {\r\n            o.filesDeleted.push(i);\r\n          } else {\r\n            file = this.parseJSONFile(data, board);\r\n            o.files.push(file);\r\n          }\r\n        }\r\n        if (o.files.length) {\r\n          o.file = o.files[0];\r\n        }\r\n      }\r\n      return o;\r\n    },\r\n\r\n    parseComment(html) {\r\n      html = html\r\n        .replace(/<br\\b[^<]*>/gi, '\\n')\r\n        .replace(/<[^>]*>/g, '');\r\n      return $.unescape(html);\r\n    }\r\n  },\r\n\r\n  bgColoredEl() {\r\n    return $.el('div', {className: 'post reply'});\r\n  },\r\n\r\n  isFileURL(url) {\r\n    return /\\/src\\/[^\\/]+/.test(url.pathname);\r\n  },\r\n\r\n  preParsingFixes(board) {\r\n    // fixes effects of unclosed link in announcement\r\n    let broken;\r\n    if (broken = $('a > input[name=\"board\"]', board)) {\r\n      return $.before(broken.parentNode, broken);\r\n    }\r\n  },\r\n\r\n  parseNodes(post, nodes) {\r\n    // Add vichan's span.poster_id around the ID if not already present.\r\n    let m;\r\n    if (nodes.uniqueID) { return; }\r\n    let text = '';\r\n    let node = nodes.nameBlock.nextSibling;\r\n    while (node && (node.nodeType === 3)) {\r\n      text += node.textContent;\r\n      node = node.nextSibling;\r\n    }\r\n    if (m = text.match(/(\\s*ID:\\s*)(\\S+)/)) {\r\n      let uniqueID;\r\n      nodes.info.normalize();\r\n      let {nextSibling} = nodes.nameBlock;\r\n      nextSibling = nextSibling.splitText(m[1].length);\r\n      nextSibling.splitText(m[2].length);\r\n      nodes.uniqueID = (uniqueID = $.el('span', {className: 'poster_id'}));\r\n      $.replace(nextSibling, uniqueID);\r\n      return $.add(uniqueID, nextSibling);\r\n    }\r\n  },\r\n\r\n  parseDate(node) {\r\n    let date = Date.parse(node.getAttribute('datetime')?.trim());\r\n    if (!isNaN(date)) { return new Date(date); }\r\n    date = Date.parse(node.textContent.trim() + ' UTC'); // e.g. onesixtwo.club\r\n    if (!isNaN(date)) { return new Date(date); }\r\n    return undefined;\r\n  },\r\n\r\n  parseFile(post, file) {\r\n    let info, infoNode;\r\n    const {text, link, thumb} = file;\r\n    if ($.x(`ancestor::${this.xpath.postContainer}[1]`, text) !== post.nodes.root) { return false; } // file belongs to a reply\r\n    if (!(infoNode = link.nextSibling?.textContent.includes('(') ? link.nextSibling : link.nextElementSibling)) { return false; }\r\n    if (!(info = infoNode.textContent.match(/\\((.*,\\s*)?([\\d.]+ ?[KMG]?B).*\\)/))) { return false; }\r\n    const nameNode = $('.postfilename', text);\r\n    $.extend(file, {\r\n      name:       nameNode ? (nameNode.title || nameNode.textContent) : link.pathname.match(/[^/]*$/)[0],\r\n      size:       info[2],\r\n      dimensions: info[0].match(/\\d+x\\d+/)?.[0]\r\n    });\r\n    if (thumb) {\r\n      $.extend(file, {\r\n        thumbURL:  /\\/static\\//.test(thumb.src) && $.isImage(link.href) ? link.href : thumb.src,\r\n        isSpoiler: /^Spoiler/i.test(info[1] || '') || (link.textContent === 'Spoiler Image')\r\n      }\r\n      );\r\n    }\r\n    return true;\r\n  },\r\n\r\n  isThumbExpanded(file) {\r\n    // Detect old Tinyboard image expansion that changes src attribute on thumbnail.\r\n    return $.hasClass(file.thumb.parentNode, 'expanded') || (file.thumb.parentNode.dataset.expanded === 'true');\r\n  },\r\n\r\n  isLinkified(link) {\r\n    return /\\bnofollow\\b/.test(link.rel);\r\n  },\r\n\r\n  catalogPin(threadRoot) {\r\n    return threadRoot.dataset.sticky = 'true';\r\n  }\r\n};\r\nexport default SWTinyboard;\r\n",null,"import { Conf, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport PassMessagePage from './PassMessage/PassMessageHtml';\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n\r\nconst PassMessage = {\r\n  init() {\r\n    if (Conf['passMessageClosed']) { return; }\r\n    const msg = $.el('div',\r\n      {className: 'box-outer top-box'}\r\n    ,\r\n      PassMessagePage);\r\n    msg.style.cssText = 'padding-bottom: 0;';\r\n    const close = $('a', msg);\r\n    $.on(close, 'click', function() {\r\n      $.rm(msg);\r\n      return $.set('passMessageClosed', true);\r\n    });\r\n    return $.ready(function() {\r\n      let hd;\r\n      if (hd = $.id('hd')) {\r\n        return $.after(hd, msg);\r\n      } else {\r\n        return $.prepend(d.body, msg);\r\n      }\r\n    });\r\n  }\r\n};\r\nexport default PassMessage;\r\n","import Redirect from \"../Archive/Redirect\";\r\nimport $ from \"../platform/$\";\r\nimport ReportPage from './Report/ArchiveReport.html';\r\nimport CSS from \"../css/CSS\";\r\nimport Captcha from \"../Posting/Captcha\";\r\nimport { Conf, d, g } from \"../globals/globals\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n\r\nvar Report = {\r\n  init() {\r\n    let match;\r\n    if (!(match = location.search.match(/\\bno=(\\d+)/))) { return; }\r\n    Captcha.replace.init();\r\n    this.postID = +match[1];\r\n    return $.ready(this.ready);\r\n  },\r\n\r\n  ready() {\r\n    $.addStyle(CSS.report);\r\n\r\n    if (Conf['Archive Report']) { Report.archive(); }\r\n\r\n    new MutationObserver(function() {\r\n      Report.fit('iframe[src^=\"https://www.google.com/recaptcha/api2/frame\"]');\r\n      return Report.fit('body');\r\n    }).observe(d.body, {\r\n      childList:  true,\r\n      attributes: true,\r\n      subtree:    true\r\n    }\r\n    );\r\n    return Report.fit('body');\r\n  },\r\n\r\n  fit(selector) {\r\n    let el;\r\n    if (!((el = $(selector, doc)) && (getComputedStyle(el).visibility !== 'hidden'))) { return; }\r\n    const dy = (el.getBoundingClientRect().bottom - doc.clientHeight) + 8;\r\n    if (dy > 0) { return window.resizeBy(0, dy); }\r\n  },\r\n\r\n  archive() {\r\n    let match, urls;\r\n    if (!(urls = Redirect.report(g.BOARD.ID)).length) { return; }\r\n\r\n    const form    = $('form');\r\n    const types   = $.id('reportTypes');\r\n    const message = $('h3');\r\n\r\n    const fieldset = $.el('fieldset', {\r\n      id: 'archive-report',\r\n      hidden: true\r\n    }\r\n    ,\r\n      { innerHTML: ReportPage });\r\n    const enabled = $('#archive-report-enabled', fieldset);\r\n    const reason  = $('#archive-report-reason',  fieldset);\r\n    const submit  = $('#archive-report-submit',  fieldset);\r\n\r\n    $.on(enabled, 'change', function() {\r\n      return reason.disabled = !this.checked;\r\n    });\r\n\r\n    if (form && types) {\r\n      fieldset.hidden = !$('[value=\"31\"]', types).checked;\r\n      $.on(types, 'change', function(e) {\r\n        fieldset.hidden = (e.target.value !== '31');\r\n        return Report.fit('body');\r\n      });\r\n      $.after(types, fieldset);\r\n      Report.fit('body');\r\n      $.one(form, 'submit', function(e) {\r\n        if (!fieldset.hidden && enabled.checked) {\r\n          e.preventDefault();\r\n          return Report.archiveSubmit(urls, reason.value, results => {\r\n            this.action = '#archiveresults=' + encodeURIComponent(JSON.stringify(results));\r\n            return this.submit();\r\n          });\r\n        }\r\n      });\r\n    } else if (message) {\r\n      fieldset.hidden = /Report submitted!/.test(message.textContent);\r\n      $.on(enabled, 'change', function() {\r\n        return submit.hidden = !this.checked;\r\n      });\r\n      $.after(message, fieldset);\r\n      $.on(submit, 'click', () => Report.archiveSubmit(urls, reason.value, Report.archiveResults));\r\n    }\r\n\r\n    if (match = location.hash.match(/^#archiveresults=(.*)$/)) {\r\n      try {\r\n        return Report.archiveResults(JSON.parse(decodeURIComponent(match[1])));\r\n      } catch (error) {}\r\n    }\r\n  },\r\n\r\n  archiveSubmit(urls, reason, cb) {\r\n    const form = $.formData({\r\n      board:  g.BOARD.ID,\r\n      num:    Report.postID,\r\n      reason\r\n    });\r\n    const results = [];\r\n    for (var [name, url] of urls) {\r\n      (function(name, url) {\r\n        return $.ajax(url, {\r\n          onloadend() {\r\n            results.push([name, this.response || {error: ''}]);\r\n            if (results.length === urls.length) {\r\n              return cb(results);\r\n            }\r\n          },\r\n          form\r\n        });\r\n      })(name, url);\r\n    }\r\n  },\r\n\r\n  archiveResults(results) {\r\n    const fieldset = $.id('archive-report');\r\n    for (var [name, response] of results) {\r\n      var line = $.el('h3',\r\n        {className: 'archive-report-response'});\r\n      if ('success' in response) {\r\n        $.addClass(line, 'archive-report-success');\r\n        line.textContent = `${name}: ${response.success}`;\r\n      } else {\r\n        $.addClass(line, 'archive-report-error');\r\n        line.textContent = `${name}: ${response.error || 'Error reporting post.'}`;\r\n      }\r\n      if (fieldset) {\r\n        $.before(fieldset, line);\r\n      } else {\r\n        $.add(d.body, line);\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default Report;\r\n","import DataBoard from \"../classes/DataBoard\";\r\nimport { Conf, d, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst PostSuccessful = {\r\n  init() {\r\n    if (!Conf['Remember Your Posts']) { return; }\r\n    return $.ready(this.ready);\r\n  },\r\n\r\n  ready() {\r\n    if (d.title !== 'Post successful!') { return; }\r\n\r\n    let [_, threadID, postID] = $('h1').nextSibling.textContent.match(/thread:(\\d+),no:(\\d+)/);\r\n    postID   = +postID;\r\n    threadID = +threadID || postID;\r\n\r\n    const db = new DataBoard('yourPosts');\r\n    return db.set({\r\n      boardID: g.BOARD.ID,\r\n      threadID,\r\n      postID,\r\n      val: true\r\n    });\r\n  }\r\n};\r\nexport default PostSuccessful;\r\n",null,null,null,null,"import SWTinyboard from \"./SW.tinyboard\";\r\nimport SWYotsuba from \"./SW.yotsuba\";\r\n\r\nconst SW = { tinyboard: SWTinyboard, yotsuba: SWYotsuba };\r\nexport default SW;\r\n",null,null,"import Callbacks from \"../classes/Callbacks\";\r\nimport Header from \"../General/Header\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf, E, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport QuoteThreading from \"../Quotelinks/QuoteThreading\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ReplyPruning = {\r\n  init() {\r\n    if ((g.VIEW !== 'thread') || !Conf['Reply Pruning']) { return; }\r\n\r\n    this.container = $.frag();\r\n\r\n    this.summary = $.el('span', {\r\n      hidden:    true,\r\n      className: 'summary'\r\n    }\r\n    );\r\n    this.summary.style.cursor = 'pointer';\r\n    $.on(this.summary, 'click', () => {\r\n      this.inputs.enabled.checked = !this.inputs.enabled.checked;\r\n      return $.event('change', null, this.inputs.enabled);\r\n    });\r\n\r\n    const label = UI.checkbox('Prune Replies', 'Show Last', Conf['Prune All Threads']);\r\n    const el = $.el('span',\r\n      {title: 'Maximum number of replies to show.'}\r\n    ,\r\n      {innerHTML: \" <input type=\\\"number\\\" name=\\\"Max Replies\\\" min=\\\"0\\\" step=\\\"1\\\" value=\\\"\" + E(Conf[\"Max Replies\"]) + \"\\\" class=\\\"field\\\">\"});\r\n    $.prepend(el, label);\r\n\r\n    this.inputs = {\r\n      enabled: label.firstElementChild,\r\n      replies: el.lastElementChild\r\n    };\r\n\r\n    this.setEnabled.call(this.inputs.enabled);\r\n    $.on(this.inputs.enabled, 'change', this.setEnabled);\r\n    $.on(this.inputs.replies, 'change', $.cb.value);\r\n\r\n    Header.menu.addEntry({\r\n      el,\r\n      order: 190\r\n    });\r\n\r\n    return Callbacks.Thread.push({\r\n      name: 'Reply Pruning',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  position: 0,\r\n  hidden: 0,\r\n  hiddenFiles: 0,\r\n  total: 0,\r\n  totalFiles: 0,\r\n\r\n  setEnabled() {\r\n    const other = QuoteThreading.input;\r\n    if (this.checked && other?.checked) {\r\n      other.checked = false;\r\n      $.event('change', null, other);\r\n    }\r\n    return ReplyPruning.active = this.checked;\r\n  },\r\n\r\n  showIfHidden(id) {\r\n    if (ReplyPruning.container && $(`#${id}`, ReplyPruning.container)) {\r\n      ReplyPruning.inputs.enabled.checked = false;\r\n      return $.event('change', null, ReplyPruning.inputs.enabled);\r\n    }\r\n  },\r\n\r\n  node() {\r\n    let middle;\r\n    ReplyPruning.thread = this;\r\n\r\n    if (this.isSticky) {\r\n      ReplyPruning.active = (ReplyPruning.inputs.enabled.checked = true);\r\n      if (QuoteThreading.input) {\r\n        // Disable Quote Threading for this thread but don't save the setting.\r\n        Conf['Thread Quotes'] = (QuoteThreading.input.checked = false);\r\n      }\r\n    }\r\n\r\n    this.posts.forEach(function(post) {\r\n      if (post.isReply) {\r\n        ReplyPruning.total++;\r\n        if (post.file) { return ReplyPruning.totalFiles++; }\r\n      }\r\n    });\r\n\r\n    // If we're linked to a post that we would hide, don't hide the posts in the first place.\r\n    if (\r\n      ReplyPruning.active &&\r\n      /^#p\\d+$/.test(location.hash) &&\r\n      (1 <= (middle = this.posts.keys.indexOf(location.hash.slice(2))) && middle < 1 + Math.max(ReplyPruning.total - +Conf[\"Max Replies\"], 0))\r\n    ) {\r\n      ReplyPruning.active = (ReplyPruning.inputs.enabled.checked = false);\r\n    }\r\n\r\n    $.after(this.OP.nodes.root, ReplyPruning.summary);\r\n\r\n    $.on(ReplyPruning.inputs.enabled, 'change', ReplyPruning.update);\r\n    $.on(ReplyPruning.inputs.replies, 'change', ReplyPruning.update);\r\n    $.on(d, 'ThreadUpdate', ReplyPruning.updateCount);\r\n    $.on(d, 'ThreadUpdate', ReplyPruning.update);\r\n\r\n    return ReplyPruning.update();\r\n  },\r\n\r\n  updateCount(e) {\r\n    if (e.detail[404]) { return; }\r\n    for (var fullID of e.detail.newPosts) {\r\n      ReplyPruning.total++;\r\n      if (g.posts.get(fullID).file) { ReplyPruning.totalFiles++; }\r\n    }\r\n  },\r\n\r\n  update() {\r\n    let boardTop, node, post;\r\n    const hidden1 = ReplyPruning.hidden;\r\n    const hidden2 = ReplyPruning.active ?\r\n      Math.max(ReplyPruning.total - +Conf[\"Max Replies\"], 0)\r\n    :\r\n      0;\r\n\r\n    // Record position from bottom of document\r\n    const oldPos = d.body.clientHeight - window.scrollY;\r\n\r\n    const {posts} = ReplyPruning.thread;\r\n\r\n    if (ReplyPruning.hidden < hidden2) {\r\n      while ((ReplyPruning.hidden < hidden2) && (ReplyPruning.position < posts.keys.length)) {\r\n        post = posts.get(posts.keys[ReplyPruning.position++]);\r\n        if (post.isReply && !post.isFetchedQuote) {\r\n          while ((node = ReplyPruning.summary.nextSibling) && (node !== post.nodes.root)) { $.add(ReplyPruning.container, node); }\r\n          $.add(ReplyPruning.container, post.nodes.root);\r\n          ReplyPruning.hidden++;\r\n          if (post.file) { ReplyPruning.hiddenFiles++; }\r\n        }\r\n      }\r\n\r\n    } else if (ReplyPruning.hidden > hidden2) {\r\n      const frag = $.frag();\r\n      while ((ReplyPruning.hidden > hidden2) && (ReplyPruning.position > 0)) {\r\n        post = posts.get(posts.keys[--ReplyPruning.position]);\r\n        if (post.isReply && !post.isFetchedQuote) {\r\n          while ((node = ReplyPruning.container.lastChild) && (node !== post.nodes.root)) { $.prepend(frag, node); }\r\n          $.prepend(frag, post.nodes.root);\r\n          ReplyPruning.hidden--;\r\n          if (post.file) { ReplyPruning.hiddenFiles--; }\r\n        }\r\n      }\r\n      $.after(ReplyPruning.summary, frag);\r\n      $.event('PostsInserted', null, ReplyPruning.summary.parentNode);\r\n    }\r\n\r\n    ReplyPruning.summary.textContent = ReplyPruning.active ?\r\n      g.SITE.Build.summaryText('+', ReplyPruning.hidden, ReplyPruning.hiddenFiles)\r\n    :\r\n      g.SITE.Build.summaryText('-', ReplyPruning.total, ReplyPruning.totalFiles);\r\n    ReplyPruning.summary.hidden = (ReplyPruning.total <= +Conf[\"Max Replies\"]);\r\n\r\n    // Maintain position in thread when posts are added/removed above\r\n    if ((hidden1 !== hidden2) && ((boardTop = Header.getTopOf($('.board'))) < 0)) {\r\n      return window.scrollBy(0, Math.max(d.body.clientHeight - oldPos, window.scrollY + boardTop) - window.scrollY);\r\n    }\r\n  }\r\n};\r\nexport default ReplyPruning;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport RandomAccessList from \"../classes/RandomAccessList\";\r\nimport Header from \"../General/Header\";\r\nimport { Conf, d, g } from \"../globals/globals\";\r\nimport ReplyPruning from \"../Monitoring/ReplyPruning\";\r\nimport Unread from \"../Monitoring/Unread\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n/*\r\n  <3 aeosynth\r\n*/\r\n\r\nvar QuoteThreading = {\r\n  init() {\r\n    if (!Conf['Quote Threading'] || (g.VIEW !== 'thread')) { return; }\r\n\r\n    this.controls = $.el('label',\r\n      {innerHTML: \"<input id=\\\"threadingControl\\\" name=\\\"Thread Quotes\\\" type=\\\"checkbox\\\"> Threading\"});\r\n\r\n    this.threadNewLink = $.el('span', {\r\n      className: 'brackets-wrap threadnewlink',\r\n      hidden: true\r\n    }\r\n    );\r\n    $.extend(this.threadNewLink, {innerHTML: \"<a href=\\\"javascript:;\\\">Thread New Posts</a>\"});\r\n\r\n    this.input = $('input', this.controls);\r\n    this.input.checked = Conf['Thread Quotes'];\r\n\r\n    $.on(this.input, 'change', this.setEnabled);\r\n    $.on(this.input, 'change', this.rethread);\r\n    $.on(this.threadNewLink.firstElementChild, 'click', this.rethread);\r\n    $.on(d, '4chanXInitFinished', () => { return this.ready = true; });\r\n\r\n    Header.menu.addEntry(this.entry = {\r\n      el:    this.controls,\r\n      order: 99\r\n    }\r\n    );\r\n\r\n    Callbacks.Thread.push({\r\n      name: 'Quote Threading',\r\n      cb:   this.setThread\r\n    });\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Quote Threading',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  parent:   dict(),\r\n  children: dict(),\r\n  inserted: dict(),\r\n\r\n  toggleThreading() {\r\n    return this.setThreadingState(!Conf['Thread Quotes']);\r\n  },\r\n\r\n  setThreadingState(enabled) {\r\n    this.input.checked = enabled;\r\n    this.setEnabled.call(this.input);\r\n    return this.rethread.call(this.input);\r\n  },\r\n\r\n  setEnabled() {\r\n    if (this.checked) {\r\n      $.set('Prune All Threads', false);\r\n      const other = ReplyPruning.inputs?.enabled;\r\n      if (other?.checked) {\r\n        other.checked = false;\r\n        $.event('change', null, other);\r\n      }\r\n    }\r\n    return $.cb.checked.call(this);\r\n  },\r\n\r\n  setThread() {\r\n    QuoteThreading.thread = this;\r\n    return $.asap((() => !Conf['Thread Updater'] || $('.navLinksBot > .updatelink')), function() {\r\n      let navLinksBot;\r\n      if (navLinksBot = $('.navLinksBot')) { return $.add(navLinksBot, [$.tn(' '), QuoteThreading.threadNewLink]); }\r\n    });\r\n  },\r\n\r\n  node() {\r\n    let parent;\r\n    if (this.isFetchedQuote || this.isClone || !this.isReply) { return; }\r\n\r\n    const parents = new Set();\r\n    let lastParent = null;\r\n    for (var quote of this.quotes) {\r\n      if ((parent = g.posts.get(quote))) {\r\n        if (!parent.isFetchedQuote && parent.isReply && (parent.ID < this.ID)) {\r\n          parents.add(parent.ID);\r\n          if (!lastParent || (parent.ID > lastParent.ID)) { lastParent = parent; }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!lastParent) { return; }\r\n\r\n    let ancestor = lastParent;\r\n    while ((ancestor = QuoteThreading.parent[ancestor.fullID])) {\r\n      parents.delete(ancestor.ID);\r\n    }\r\n\r\n    if (parents.size === 1) {\r\n      return QuoteThreading.parent[this.fullID] = lastParent;\r\n    }\r\n  },\r\n\r\n  descendants(post) {\r\n    let children;\r\n    let posts = [post];\r\n    if (children = QuoteThreading.children[post.fullID]) {\r\n      for (var child of children) {\r\n        posts = posts.concat(QuoteThreading.descendants(child));\r\n      }\r\n    }\r\n    return posts;\r\n  },\r\n\r\n  insert(post) {\r\n    let parent, x;\r\n    if (!(\r\n      Conf['Thread Quotes'] &&\r\n      (parent = QuoteThreading.parent[post.fullID]) &&\r\n      !QuoteThreading.inserted[post.fullID]\r\n    )) { return false; }\r\n\r\n    const descendants = QuoteThreading.descendants(post);\r\n    if (!Unread.posts.has(parent.ID)) {\r\n      if ((function() { for (var x of descendants) { if (Unread.posts.has(x.ID)) { return true; } } })()) {\r\n        QuoteThreading.threadNewLink.hidden = false;\r\n        return false;\r\n      }\r\n    }\r\n\r\n    const {order} = Unread;\r\n    const children = (QuoteThreading.children[parent.fullID] || (QuoteThreading.children[parent.fullID] = []));\r\n    const threadContainer = parent.nodes.threadContainer || $.el('div', {className: 'threadContainer'});\r\n    const nodes = [post.nodes.root];\r\n    if (post.nodes.threadContainer) { nodes.push(post.nodes.threadContainer); }\r\n\r\n    let i = children.length;\r\n    for (let j = children.length - 1; j >= 0; j--) { var child = children[j]; if (child.ID >= post.ID) { i--; } }\r\n    if (i !== children.length) {\r\n      const next = children[i];\r\n      for (x of descendants) { order.before(order[next.ID], order[x.ID]); }\r\n      children.splice(i, 0, post);\r\n      $.before(next.nodes.root, nodes);\r\n    } else {\r\n      let prev2;\r\n      let prev = parent;\r\n      while ((prev2 = QuoteThreading.children[prev.fullID]) && prev2.length) {\r\n        prev = prev2[prev2.length-1];\r\n      }\r\n      for (let k = descendants.length - 1; k >= 0; k--) { x = descendants[k]; order.after(order[prev.ID], order[x.ID]); }\r\n      children.push(post);\r\n      $.add(threadContainer, nodes);\r\n    }\r\n\r\n    QuoteThreading.inserted[post.fullID] = true;\r\n\r\n    if (!parent.nodes.threadContainer) {\r\n      parent.nodes.threadContainer = threadContainer;\r\n      $.addClass(parent.nodes.root, 'threadOP');\r\n      $.after(parent.nodes.root, threadContainer);\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  rethread() {\r\n    if (!QuoteThreading.ready) { return; }\r\n    const {thread} = QuoteThreading;\r\n    const {posts} = thread;\r\n\r\n    QuoteThreading.threadNewLink.hidden = true;\r\n\r\n    if (Conf['Thread Quotes']) {\r\n      posts.forEach(QuoteThreading.insert);\r\n    } else {\r\n      const nodes = [];\r\n      Unread.order = new RandomAccessList();\r\n      QuoteThreading.inserted = dict();\r\n      posts.forEach(function(post) {\r\n        if (post.isFetchedQuote) { return; }\r\n        Unread.order.push(post);\r\n        if (post.isReply) { nodes.push(post.nodes.root); }\r\n        if (QuoteThreading.children[post.fullID]) {\r\n          delete QuoteThreading.children[post.fullID];\r\n          $.rmClass(post.nodes.root, 'threadOP');\r\n          $.rm(post.nodes.threadContainer);\r\n          return delete post.nodes.threadContainer;\r\n        }\r\n      });\r\n      $.add(thread.nodes.root, nodes);\r\n    }\r\n\r\n    Unread.position = Unread.order.first;\r\n    Unread.updatePosition();\r\n    Unread.setLine(true);\r\n    Unread.read();\r\n    return Unread.update();\r\n  }\r\n};\r\nexport default QuoteThreading;\r\n",null,null,"import Callbacks from \"../classes/Callbacks\";\r\nimport Header from \"../General/Header\";\r\nimport UI from \"../General/UI\";\r\nimport { Conf, doc, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar FappeTyme = {\r\n  init() {\r\n    if ((!Conf['Fappe Tyme'] && !Conf['Werk Tyme']) || !['index', 'thread', 'archive'].includes(g.VIEW)) { return; }\r\n\r\n    this.nodes = {};\r\n    this.enabled = {\r\n      fappe: false,\r\n      werk:  Conf['werk']\r\n    };\r\n\r\n    for (var type of [\"Fappe\", \"Werk\"]) {\r\n      if (Conf[`${type} Tyme`]) {\r\n        var lc = type.toLowerCase();\r\n        var el = UI.checkbox(lc, `${type} Tyme`, false);\r\n        el.title = `${type} Tyme`;\r\n\r\n        this.nodes[lc] = el.firstElementChild;\r\n        if (Conf[lc]) { this.set(lc, true); }\r\n        $.on(this.nodes[lc], 'change', this.toggle.bind(this, lc));\r\n\r\n        Header.menu.addEntry({\r\n          el,\r\n          order: 97\r\n        });\r\n\r\n        var indicator = $.el('span', {\r\n          className: 'indicator',\r\n          textContent: type[0],\r\n          title: `${type} Tyme active`\r\n        }\r\n        );\r\n        $.on(indicator, 'click', function() {\r\n          const check = $.getOwn(FappeTyme.nodes, this.parentNode.id.replace('shortcut-', ''));\r\n          check.checked = !check.checked;\r\n          return $.event('change', null, check);\r\n        });\r\n        Header.addShortcut(lc, indicator, 410);\r\n      }\r\n    }\r\n\r\n    if (Conf['Werk Tyme']) {\r\n      $.sync('werk', this.set.bind(this, 'werk'));\r\n    }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Fappe Tyme',\r\n      cb:   this.node\r\n    });\r\n\r\n    return Callbacks.CatalogThread.push({\r\n      name: 'Werk Tyme',\r\n      cb:   this.catalogNode\r\n    });\r\n  },\r\n\r\n  node() {\r\n    return this.nodes.root.classList.toggle('noFile', !this.files.length);\r\n  },\r\n\r\n  catalogNode() {\r\n    const file = this.thread.OP.files[0];\r\n    if (!file) { return; }\r\n    const filename = $.el('div', {\r\n      textContent: file.name,\r\n      className:   'werkTyme-filename'\r\n    }\r\n    );\r\n    return $.add(this.nodes.thumb.parentNode, filename);\r\n  },\r\n\r\n  set(type, enabled) {\r\n    this.enabled[type] = (this.nodes[type].checked = enabled);\r\n    return $[`${enabled ? 'add' : 'rm'}Class`](doc, `${type}Tyme`);\r\n  },\r\n\r\n  toggle(type) {\r\n    this.set(type, !this.enabled[type]);\r\n    if (type === 'werk') { return $.cb.checked.call(this.nodes[type]); }\r\n  }\r\n};\r\nexport default FappeTyme;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Notice from \"../classes/Notice\";\r\nimport Filter from \"../Filtering/Filter\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS204: Change includes calls to have a more natural evaluation order\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Sauce = {\r\n  init() {\r\n    let link;\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Sauce']) { return; }\r\n    $.addClass(doc, 'show-sauce');\r\n\r\n    const links = [];\r\n    for (link of Conf['sauces'].split('\\n')) {\r\n      var linkData;\r\n      if ((link[0] !== '#') && (linkData = this.parseLink(link))) {\r\n        links.push(linkData);\r\n      }\r\n    }\r\n    if (!links.length) { return; }\r\n\r\n    this.links = links;\r\n    this.link  = $.el('a', {\r\n      target:    '_blank',\r\n      className: 'sauce'\r\n    }\r\n    );\r\n    return Callbacks.Post.push({\r\n      name: 'Sauce',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  parseLink(link) {\r\n    if (!(link = link.trim())) { return null; }\r\n    const parts = dict();\r\n    const iterable = link.split(/;(?=(?:text|boards|types|regexp|sandbox):?)/);\r\n    for (let i = 0; i < iterable.length; i++) {\r\n      var part = iterable[i];\r\n      if (i === 0) {\r\n        parts['url'] = part;\r\n      } else {\r\n        var m = part.match(/^(\\w*):?(.*)$/);\r\n        parts[m[1]] = m[2];\r\n      }\r\n    }\r\n    if (!parts['text']) { parts['text'] = parts['url'].match(/(\\w+)\\.\\w+\\//)?.[1] || '?'; }\r\n    if ('boards' in parts) {\r\n      parts['boards'] = Filter.parseBoards(parts['boards']);\r\n    }\r\n    if ('regexp' in parts) {\r\n      try {\r\n        let regexp;\r\n        if (regexp = parts['regexp'].match(/^\\/(.*)\\/(\\w*)$/)) {\r\n          parts['regexp'] = RegExp(regexp[1], regexp[2]);\r\n        } else {\r\n          parts['regexp'] = RegExp(parts['regexp']);\r\n        }\r\n      } catch (err) {\r\n        new Notice('warning', [\r\n          $.tn(\"Invalid regexp for Sauce link:\"),\r\n          $.el('br'),\r\n          $.tn(link),\r\n          $.el('br'),\r\n          $.tn(err.message)\r\n        ], 60);\r\n        return null;\r\n      }\r\n    }\r\n    return parts;\r\n  },\r\n\r\n  createSauceLink(link, post, file) {\r\n    let a, matches, needle;\r\n    const ext = file.url.match(/[^.]*$/)[0];\r\n    const parts = dict();\r\n    $.extend(parts, link);\r\n\r\n    if (!!parts['boards'] && !parts['boards'][`${post.siteID}/${post.boardID}`] && !parts['boards'][`${post.siteID}/*`]) { return null; }\r\n    if (!!parts['types']  && (needle = ext, !parts['types'].split(',').includes(needle))) { return null; }\r\n    if (!!parts['regexp'] && (!(matches = file.name.match(parts['regexp'])))) { return null; }\r\n\r\n    const missing = [];\r\n    for (var key of ['url', 'text']) {\r\n      parts[key] = parts[key].replace(/%(T?URL|IMG|[sh]?MD5|board|name|%|semi|\\$\\d+)/g, function(orig, parameter) {\r\n        let type;\r\n        if (parameter[0] === '$') {\r\n          if (!matches) { return orig; }\r\n          type = matches[parameter.slice(1)] || '';\r\n        } else {\r\n          type = Sauce.formatters[parameter](post, file, ext);\r\n          if ((type == null)) {\r\n            missing.push(parameter);\r\n            return '';\r\n          }\r\n        }\r\n\r\n        if ((key === 'url') && !['%', 'semi'].includes(parameter)) {\r\n          if (/^javascript:/i.test(parts['url'])) { type = JSON.stringify(type); }\r\n          type = encodeURIComponent(type);\r\n        }\r\n        return type;\r\n      });\r\n    }\r\n\r\n    if (g.SITE.areMD5sDeferred?.(post.board) && missing.length && !missing.filter(x => !/^.?MD5$/.test(x)).length) {\r\n      a = Sauce.link.cloneNode(false);\r\n      a.dataset.skip = '1';\r\n      return a;\r\n    }\r\n\r\n    if (missing.length) { return null; }\r\n\r\n    a = Sauce.link.cloneNode(false);\r\n    a.href = parts['url'];\r\n    a.textContent = parts['text'];\r\n    if (/^javascript:/i.test(parts['url'])) { a.removeAttribute('target'); }\r\n    return a;\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) { return; }\r\n    for (var file of this.files) {\r\n      Sauce.file(this, file);\r\n    }\r\n  },\r\n\r\n  file(post, file) {\r\n    let link, node;\r\n    const nodes = [];\r\n    const skipped = [];\r\n    for (link of Sauce.links) {\r\n      if (node = Sauce.createSauceLink(link, post, file)) {\r\n        nodes.push($.tn(' '), node);\r\n        if (node.dataset.skip) { skipped.push([link, node]); }\r\n      }\r\n    }\r\n    $.add(file.text, nodes);\r\n\r\n    if (skipped.length) {\r\n      var observer = new MutationObserver(function() {\r\n        if (file.text.dataset.md5) {\r\n          for ([link, node] of skipped) {\r\n            var node2;\r\n            if (node2 = Sauce.createSauceLink(link, post, file)) {\r\n              $.replace(node, node2);\r\n            }\r\n          }\r\n          return observer.disconnect();\r\n        }\r\n      });\r\n      return observer.observe(file.text, {attributes: true});\r\n    }\r\n  },\r\n\r\n  formatters: {\r\n    TURL(post, file) { return file.thumbURL; },\r\n    URL(post, file) { return file.url; },\r\n    IMG(post, file, ext) { if (['gif', 'jpg', 'jpeg', 'png'].includes(ext)) { return file.url; } else { return file.thumbURL; } },\r\n    MD5(post, file) { return file.MD5; },\r\n    sMD5(post, file) { return file.MD5?.replace(/[+/=]/g, c => ({'+': '-', '/': '_', '=': ''})[c]); },\r\n    hMD5(post, file) { if (file.MD5) { return (atob(file.MD5).map((c) => `0${c.charCodeAt(0).toString(16)}`.slice(-2))).join(''); } },\r\n    board(post) { return post.board.ID; },\r\n    name(post, file) { return file.name; },\r\n    '%'() { return '%'; },\r\n    semi() { return ';'; }\r\n  }\r\n};\r\nexport default Sauce;\r\n","/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nimport galleryPage from './Gallery/Gallery.html';\r\nimport $ from '../platform/$';\r\nimport Callbacks from '../classes/Callbacks';\r\nimport Notice from '../classes/Notice';\r\nimport Main from '../main/Main';\r\nimport Keybinds from '../Miscellaneous/Keybinds';\r\nimport $$ from '../platform/$$';\r\nimport ImageCommon from './ImageCommon';\r\nimport Sauce from './Sauce';\r\nimport Volume from './Volume';\r\nimport Header from '../General/Header';\r\nimport { Conf, d, doc, g } from '../globals/globals';\r\nimport UI from '../General/UI';\r\nimport Get from '../General/Get';\r\nimport { debounce, dict, SECOND } from '../platform/helpers';\r\n\r\nvar Gallery = {\r\n  init() {\r\n    if (!(this.enabled = Conf['Gallery'] && ['index', 'thread'].includes(g.VIEW))) { return; }\r\n\r\n    this.delay = Conf['Slide Delay'];\r\n\r\n    const el = $.el('a', {\r\n      href: 'javascript:;',\r\n      title: 'Gallery',\r\n      textContent: 'Gallery',\r\n    });\r\n\r\n    $.on(el, 'click', this.cb.toggle);\r\n\r\n    Header.addShortcut('gallery', el, 530, '🖼︎');\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Gallery',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    return (() => {\r\n      const result = [];\r\n      for (var file of this.files) {\r\n        if (file.thumb) {\r\n          if (Gallery.nodes) {\r\n            Gallery.generateThumb(this, file);\r\n            Gallery.nodes.total.textContent = Gallery.images.length;\r\n          }\r\n\r\n          if (!Conf['Image Expansion'] && ((g.SITE.software !== 'tinyboard') || !Main.jsEnabled)) {\r\n            result.push($.on(file.thumbLink, 'click', Gallery.cb.image));\r\n          } else {\r\n            result.push(undefined);\r\n          }\r\n        }\r\n      }\r\n      return result;\r\n    })();\r\n  },\r\n\r\n  build(image) {\r\n    let dialog, thumb;\r\n    const {cb} = Gallery;\r\n\r\n    if (Conf['Fullscreen Gallery']) {\r\n      $.one(d, 'fullscreenchange mozfullscreenchange webkitfullscreenchange', () => $.on(d, 'fullscreenchange mozfullscreenchange webkitfullscreenchange', cb.close));\r\n      doc.mozRequestFullScreen?.();\r\n      doc.webkitRequestFullScreen?.(Element.ALLOW_KEYBOARD_INPUT);\r\n    }\r\n\r\n    Gallery.images  = [];\r\n    const nodes = (Gallery.nodes = {});\r\n    Gallery.fileIDs = dict();\r\n    Gallery.slideshow = false;\r\n\r\n    nodes.el = (dialog = $.el('div',\r\n      {id: 'a-gallery'}));\r\n    $.extend(dialog, {innerHTML: galleryPage });\r\n\r\n    const object = {\r\n      buttons: '.gal-buttons',\r\n      frame:   '.gal-image',\r\n      name:    '.gal-name',\r\n      count:   '.count',\r\n      total:   '.total',\r\n      sauce:   '.gal-sauce',\r\n      thumbs:  '.gal-thumbnails',\r\n      next:    '.gal-image a',\r\n      current: '.gal-image img'\r\n    };\r\n    for (var key in object) { var value = object[key]; nodes[key] = $(value, dialog); }\r\n\r\n    const menuButton = $('.menu-button', dialog);\r\n    nodes.menu = new UI.Menu('gallery');\r\n\r\n    $.on(nodes.frame, 'click', cb.blank);\r\n    if (Conf['Mouse Wheel Volume']) { $.on(nodes.frame, 'wheel', Volume.wheel); }\r\n    $.on(nodes.next,  'click', cb.click);\r\n    $.on(nodes.name,  'click', ImageCommon.download);\r\n\r\n    $.on($('.gal-prev',  dialog), 'click', cb.prev);\r\n    $.on($('.gal-next',  dialog), 'click', cb.next);\r\n    $.on($('.gal-start', dialog), 'click', cb.start);\r\n    $.on($('.gal-stop',  dialog), 'click', cb.stop);\r\n    $.on($('.gal-close', dialog), 'click', cb.close);\r\n\r\n    $.on(menuButton, 'click', function(e) {\r\n      return nodes.menu.toggle(e, this, g);\r\n    });\r\n\r\n    for (var entry of Gallery.menu.createSubEntries()) {\r\n      entry.order = 0;\r\n      nodes.menu.addEntry(entry);\r\n    }\r\n\r\n    $.on(d, 'keydown', cb.keybinds);\r\n    if (Conf['Keybinds']) { $.off(d, 'keydown', Keybinds.keydown); }\r\n\r\n    $.on(window, 'resize', Gallery.cb.setHeight);\r\n\r\n    for (var postThumb of $$(g.SITE.selectors.file.thumb)) {\r\n      var post;\r\n      if (!(post = Get.postFromNode(postThumb))) { continue; }\r\n      for (var file of post.files) {\r\n        if (file.thumb) {\r\n          Gallery.generateThumb(post, file);\r\n          // If no image to open is given, pick image we have scrolled to.\r\n          if (!image && Gallery.fileIDs[`${post.fullID}.${file.index}`]) {\r\n            var candidate = file.thumbLink;\r\n            if ((Header.getTopOf(candidate) + candidate.getBoundingClientRect().height) >= 0) {\r\n              image = candidate;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    $.addClass(doc, 'gallery-open');\r\n\r\n    $.add(d.body, dialog);\r\n\r\n    nodes.thumbs.scrollTop = 0;\r\n    nodes.current.parentElement.scrollTop = 0;\r\n\r\n    if (image) { thumb = $(`[href='${image.href}']`, nodes.thumbs); }\r\n    if (!thumb) { thumb = Gallery.images[Gallery.images.length-1]; }\r\n    if (thumb) { Gallery.open(thumb); }\r\n\r\n    doc.style.overflow = 'hidden';\r\n    return nodes.total.textContent = Gallery.images.length;\r\n  },\r\n\r\n  generateThumb(post, file) {\r\n    if (post.isClone || post.isHidden) { return; }\r\n    if (!file || !file.thumb || (!file.isImage && !file.isVideo && !Conf['PDF in Gallery'])) { return; }\r\n    if (Gallery.fileIDs[`${post.fullID}.${file.index}`]) { return; }\r\n\r\n    Gallery.fileIDs[`${post.fullID}.${file.index}`] = true;\r\n\r\n    const thumb = $.el('a', {\r\n      className: 'gal-thumb',\r\n      href:      file.url,\r\n      target:    '_blank',\r\n      title:     file.name\r\n    }\r\n    );\r\n\r\n    thumb.dataset.id   = Gallery.images.length;\r\n    thumb.dataset.post = post.fullID;\r\n    thumb.dataset.file = file.index;\r\n\r\n    const thumbImg = file.thumb.cloneNode(false);\r\n    thumbImg.style.cssText = '';\r\n    $.add(thumb, thumbImg);\r\n\r\n    $.on(thumb, 'click', Gallery.cb.open);\r\n\r\n    Gallery.images.push(thumb);\r\n    return $.add(Gallery.nodes.thumbs, thumb);\r\n  },\r\n\r\n  load(thumb, errorCB) {\r\n    const ext = thumb.href.match(/\\w*$/);\r\n    const elType = $.getOwn({'webm': 'video', 'mp4': 'video', 'ogv': 'video', 'pdf': 'iframe'}, ext) || 'img';\r\n    const file = $.el(elType);\r\n    $.extend(file.dataset, thumb.dataset);\r\n    $.on(file, 'error', errorCB);\r\n    file.src = thumb.href;\r\n    return file;\r\n  },\r\n\r\n  open(thumb) {\r\n    let el, file, post;\r\n    const {nodes} = Gallery;\r\n    const oldID = +nodes.current.dataset.id;\r\n    const newID = +thumb.dataset.id;\r\n\r\n    // Highlight, center selected thumbnail\r\n    if (el = Gallery.images[oldID]) { $.rmClass(el,    'gal-highlight'); }\r\n    $.addClass(thumb, 'gal-highlight');\r\n    nodes.thumbs.scrollTop = (thumb.offsetTop + (thumb.offsetHeight/2)) - (nodes.thumbs.clientHeight/2);\r\n\r\n    // Load image or use preloaded image\r\n    if (Gallery.cache?.dataset.id === (''+newID)) {\r\n      file = Gallery.cache;\r\n      $.off(file, 'error', Gallery.cacheError);\r\n      $.on(file, 'error', Gallery.error);\r\n    } else {\r\n      file = Gallery.load(thumb, Gallery.error);\r\n    }\r\n\r\n    // Replace old image with new one\r\n    $.off(nodes.current, 'error', Gallery.error);\r\n    ImageCommon.pause(nodes.current);\r\n    $.replace(nodes.current, file);\r\n    nodes.current = file;\r\n\r\n    if (file.nodeName === 'VIDEO') {\r\n      file.loop = true;\r\n      Volume.setup(file);\r\n      if (Conf['Autoplay']) { file.play(); }\r\n      if (Conf['Show Controls']) { ImageCommon.addControls(file); }\r\n    }\r\n\r\n    doc.classList.toggle('gal-pdf', file.nodeName === 'IFRAME');\r\n    Gallery.cb.setHeight();\r\n    nodes.count.textContent = +thumb.dataset.id + 1;\r\n    nodes.name.download     = (nodes.name.textContent = thumb.title);\r\n    nodes.name.href         = thumb.href;\r\n    nodes.frame.scrollTop   = 0;\r\n    nodes.next.focus();\r\n\r\n    // Set sauce links\r\n    $.rmAll(nodes.sauce);\r\n    if (Conf['Sauce'] && Sauce.links && (post = g.posts.get(file.dataset.post))) {\r\n      const sauces = [];\r\n      for (var link of Sauce.links) {\r\n        var node;\r\n        if (node = Sauce.createSauceLink(link, post, post.files[+file.dataset.file])) {\r\n          sauces.push($.tn(' '), node);\r\n        }\r\n      }\r\n      $.add(nodes.sauce, sauces);\r\n    }\r\n\r\n    // Continue slideshow if moving forward, stop otherwise\r\n    if (Gallery.slideshow && ((newID > oldID) || ((oldID === (Gallery.images.length-1)) && (newID === 0)))) {\r\n      Gallery.setupTimer();\r\n    } else {\r\n      Gallery.cb.stop();\r\n    }\r\n\r\n    // Scroll to post\r\n    if (Conf['Scroll to Post'] && (post = g.posts.get(file.dataset.post))) {\r\n      Header.scrollTo(post.nodes.root);\r\n    }\r\n\r\n    // Preload next image\r\n    if (isNaN(oldID) || (newID === ((oldID + 1) % Gallery.images.length))) {\r\n      return Gallery.cache = Gallery.load(Gallery.images[(newID + 1) % Gallery.images.length], Gallery.cacheError);\r\n    }\r\n  },\r\n\r\n  error() {\r\n    if (this.error?.code === MediaError.MEDIA_ERR_DECODE) {\r\n      return new Notice('error', 'Corrupt or unplayable video', 30);\r\n    }\r\n    if (ImageCommon.isFromArchive(this)) { return; }\r\n    const post = g.posts.get(this.dataset.post);\r\n    const file = post.files[+this.dataset.file];\r\n    return ImageCommon.error(this, post, file, null, url => {\r\n      if (!url) { return; }\r\n      Gallery.images[+this.dataset.id].href = url;\r\n      if (Gallery.nodes.current === this) { return this.src = url; }\r\n    });\r\n  },\r\n\r\n  cacheError() {\r\n    return delete Gallery.cache;\r\n  },\r\n\r\n  cleanupTimer() {\r\n    clearTimeout(Gallery.timeoutID);\r\n    const {current} = Gallery.nodes;\r\n    $.off(current, 'canplaythrough load', Gallery.startTimer);\r\n    return $.off(current, 'ended', Gallery.cb.next);\r\n  },\r\n\r\n  startTimer() {\r\n    return Gallery.timeoutID = setTimeout(Gallery.checkTimer, Gallery.delay * SECOND);\r\n  },\r\n\r\n  setupTimer() {\r\n    Gallery.cleanupTimer();\r\n    const {current} = Gallery.nodes;\r\n    const isVideo = current.nodeName === 'VIDEO';\r\n    if (isVideo) { current.play(); }\r\n    if ((isVideo ? current.readyState >= 4 : current.complete) || (current.nodeName === 'IFRAME')) {\r\n      return Gallery.startTimer();\r\n    } else {\r\n      return $.on(current, (isVideo ? 'canplaythrough' : 'load'), Gallery.startTimer);\r\n    }\r\n  },\r\n\r\n  checkTimer() {\r\n    const {current} = Gallery.nodes;\r\n    if ((current.nodeName === 'VIDEO') && !current.paused) {\r\n      $.on(current, 'ended', Gallery.cb.next);\r\n      return current.loop = false;\r\n    } else {\r\n      return Gallery.cb.next();\r\n    }\r\n  },\r\n\r\n  cb: {\r\n    keybinds(e) {\r\n      let key;\r\n      if (!(key = Keybinds.keyCode(e))) { return; }\r\n\r\n      const cb = (() => { switch (key) {\r\n        case Conf['Close']: case Conf['Open Gallery']:\r\n          return Gallery.cb.close;\r\n        case Conf['Next Gallery Image']:\r\n          return Gallery.cb.next;\r\n        case Conf['Advance Gallery']:\r\n          return Gallery.cb.advance;\r\n        case Conf['Previous Gallery Image']:\r\n          return Gallery.cb.prev;\r\n        case Conf['Pause']:\r\n          return Gallery.cb.pause;\r\n        case Conf['Slideshow']:\r\n          return Gallery.cb.toggleSlideshow;\r\n        case Conf['Rotate image anticlockwise']:\r\n          return Gallery.cb.rotateLeft;\r\n        case Conf['Rotate image clockwise']:\r\n          return Gallery.cb.rotateRight;\r\n        case Conf['Download Gallery Image']:\r\n          return Gallery.cb.download;\r\n      } })();\r\n\r\n      if (!cb) { return; }\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n      return cb();\r\n    },\r\n\r\n    open(e) {\r\n      if (e) { e.preventDefault(); }\r\n      if (this) { return Gallery.open(this); }\r\n    },\r\n\r\n    image(e) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      return Gallery.build(this);\r\n    },\r\n\r\n    prev() {\r\n      return Gallery.cb.open.call(\r\n        Gallery.images[+Gallery.nodes.current.dataset.id - 1] || Gallery.images[Gallery.images.length - 1]\r\n      );\r\n    },\r\n    next() {\r\n      return Gallery.cb.open.call(\r\n        Gallery.images[+Gallery.nodes.current.dataset.id + 1] || Gallery.images[0]\r\n      );\r\n    },\r\n\r\n    click(e) {\r\n      if (ImageCommon.onControls(e)) { return; }\r\n      e.preventDefault();\r\n      return Gallery.cb.advance();\r\n    },\r\n\r\n    advance() { if (!Conf['Autoplay'] && Gallery.nodes.current.paused) { return Gallery.nodes.current.play(); } else { return Gallery.cb.next(); } },\r\n    toggle() { return (Gallery.nodes ? Gallery.cb.close : Gallery.build)(); },\r\n    blank(e) { if (e.target === this) { return Gallery.cb.close(); } },\r\n    toggleSlideshow() {  return Gallery.cb[Gallery.slideshow ? 'stop' : 'start'](); },\r\n\r\n    download() {\r\n      const name = $('.gal-name');\r\n      return name.click();\r\n    },\r\n\r\n    pause() {\r\n      Gallery.cb.stop();\r\n      const {current} = Gallery.nodes;\r\n      if (current.nodeName === 'VIDEO') { return current[current.paused ? 'play' : 'pause'](); }\r\n    },\r\n\r\n    start() {\r\n      $.addClass(Gallery.nodes.buttons, 'gal-playing');\r\n      Gallery.slideshow = true;\r\n      return Gallery.setupTimer();\r\n    },\r\n\r\n    stop() {\r\n      if (!Gallery.slideshow) { return; }\r\n      Gallery.cleanupTimer();\r\n      const {current} = Gallery.nodes;\r\n      if (current.nodeName === 'VIDEO') { current.loop = true; }\r\n      $.rmClass(Gallery.nodes.buttons, 'gal-playing');\r\n      return Gallery.slideshow = false;\r\n    },\r\n\r\n    rotateLeft() { return Gallery.cb.rotate(270); },\r\n    rotateRight() { return Gallery.cb.rotate(90); },\r\n\r\n    rotate: debounce(100, function(delta) {\r\n      const {current} = Gallery.nodes;\r\n      if (current.nodeName === 'IFRAME') { return; }\r\n      current.dataRotate = ((current.dataRotate || 0) + delta) % 360;\r\n      current.style.transform = `rotate(${current.dataRotate}deg)`;\r\n      return Gallery.cb.setHeight();\r\n    }),\r\n\r\n    close() {\r\n      $.off(Gallery.nodes.current, 'error', Gallery.error);\r\n      ImageCommon.pause(Gallery.nodes.current);\r\n      $.rm(Gallery.nodes.el);\r\n      $.rmClass(doc, 'gallery-open');\r\n      if (Conf['Fullscreen Gallery']) {\r\n        $.off(d, 'fullscreenchange mozfullscreenchange webkitfullscreenchange', Gallery.cb.close);\r\n        d.mozCancelFullScreen?.();\r\n        d.webkitExitFullscreen?.();\r\n      }\r\n      delete Gallery.nodes;\r\n      delete Gallery.fileIDs;\r\n      doc.style.overflow = '';\r\n\r\n      $.off(d, 'keydown', Gallery.cb.keybinds);\r\n      if (Conf['Keybinds']) { $.on(d, 'keydown', Keybinds.keydown); }\r\n      $.off(window, 'resize', Gallery.cb.setHeight);\r\n      return clearTimeout(Gallery.timeoutID);\r\n    },\r\n\r\n    setFitness() {\r\n      return (this.checked ? $.addClass : $.rmClass)(doc, `gal-${this.name.toLowerCase().replace(/\\s+/g, '-')}`);\r\n    },\r\n\r\n    setHeight: debounce(100, function () {\r\n      let dim, margin, minHeight;\r\n      const {current, frame} = Gallery.nodes;\r\n      const {style} = current;\r\n\r\n      if (Conf['Stretch to Fit'] && (dim = g.posts.get(current.dataset.post)?.files[+current.dataset.file].dimensions)) {\r\n        const [width, height] = dim.split('x');\r\n        let containerWidth = frame.clientWidth;\r\n        let containerHeight = doc.clientHeight - 25;\r\n        if (((current.dataRotate || 0) % 180) === 90) {\r\n          [containerWidth, containerHeight] = [containerHeight, containerWidth];\r\n        }\r\n        minHeight = Math.min(containerHeight, (height / width) * containerWidth);\r\n        style.minHeight = minHeight + 'px';\r\n        style.minWidth = ((width / height) * minHeight) + 'px';\r\n      } else {\r\n        style.minHeight = (style.minWidth = '');\r\n      }\r\n\r\n      if (((current.dataRotate || 0) % 180) === 90) {\r\n        style.maxWidth  = Conf['Fit Height'] ? `${doc.clientHeight - 25}px` : 'none';\r\n        style.maxHeight = Conf['Fit Width']  ? `${frame.clientWidth}px`     : 'none';\r\n        margin = (current.clientWidth - current.clientHeight)/2;\r\n        return style.margin = `${margin}px ${-margin}px`;\r\n      } else {\r\n        return style.maxWidth = (style.maxHeight = (style.margin = ''));\r\n      }\r\n    }),\r\n\r\n    setDelay() { return Gallery.delay = +this.value; }\r\n  },\r\n\r\n  menu: {\r\n    init() {\r\n      if (!Gallery.enabled) { return; }\r\n\r\n      const el = $.el('span', {\r\n        textContent: 'Gallery',\r\n        className: 'gallery-link'\r\n      }\r\n      );\r\n\r\n      return Header.menu.addEntry({\r\n        el,\r\n        order: 105,\r\n        subEntries: Gallery.menu.createSubEntries()\r\n      });\r\n    },\r\n\r\n    createSubEntry(name) {\r\n      const label = UI.checkbox(name, name);\r\n      const input = label.firstElementChild;\r\n      if (['Hide Thumbnails', 'Fit Width', 'Fit Height'].includes(name)) { $.on(input, 'change', Gallery.cb.setFitness); }\r\n      $.event('change', null, input);\r\n      $.on(input, 'change', $.cb.checked);\r\n      if (['Hide Thumbnails', 'Fit Width', 'Fit Height', 'Stretch to Fit'].includes(name)) { $.on(input, 'change', Gallery.cb.setHeight); }\r\n      return {el: label};\r\n    },\r\n\r\n    createSubEntries() {\r\n      const subEntries = (['Hide Thumbnails', 'Fit Width', 'Fit Height', 'Stretch to Fit', 'Scroll to Post'].map((item) => Gallery.menu.createSubEntry(item)));\r\n\r\n      const delayLabel = $.el('label', {innerHTML: 'Slide Delay: <input type=\"number\" name=\"Slide Delay\" min=\"0\" step=\"any\" class=\"field\">'});\r\n      const delayInput = delayLabel.firstElementChild;\r\n      delayInput.value = Gallery.delay;\r\n      $.on(delayInput, 'change', Gallery.cb.setDelay);\r\n      $.on(delayInput, 'change', $.cb.value);\r\n      subEntries.push({el: delayLabel});\r\n\r\n      return subEntries;\r\n    }\r\n  }\r\n};\r\nexport default Gallery;\r\n","import Get from '../General/Get';\r\nimport Header from '../General/Header';\r\nimport UI from '../General/UI';\r\nimport { g, Conf, d, doc, E } from '../globals/globals';\r\nimport ImageHost from '../Images/ImageHost';\r\nimport Main from '../main/Main';\r\nimport $ from '../platform/$';\r\nimport $$ from '../platform/$$';\r\nimport CrossOrigin from '../platform/CrossOrigin';\r\nimport { dict } from '../platform/helpers';\r\nimport EmbeddingPage from './Embedding/Embed.html';\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n\r\nvar Embedding = {\r\n  init() {\r\n    if (!['index', 'thread', 'archive'].includes(g.VIEW) || !Conf['Linkify'] || (!Conf['Embedding'] && !Conf['Link Title'] && !Conf['Cover Preview'])) { return; }\r\n    this.types = dict();\r\n    for (var type of this.ordered_types) { this.types[type.key] = type; }\r\n\r\n    if (Conf['Embedding'] && (g.VIEW !== 'archive')) {\r\n      this.dialog = UI.dialog('embedding',\r\n        { innerHTML: EmbeddingPage });\r\n      this.media = $('#media-embed', this.dialog);\r\n      $.one(d, '4chanXInitFinished', this.ready);\r\n      $.on(d, 'IndexRefreshInternal', () => g.posts.forEach(function(post) {\r\n        for (post of [post, ...post.clones]) {\r\n          for (var embed of post.nodes.embedlinks) {\r\n            Embedding.cb.catalogRemove.call(embed);\r\n          }\r\n        }\r\n      }));\r\n    }\r\n    if (Conf['Link Title']) {\r\n      return $.on(d, '4chanXInitFinished PostsInserted', function() {\r\n        for (var key in Embedding.types) {\r\n          var service = Embedding.types[key];\r\n          if (service.title?.batchSize) {\r\n            Embedding.flushTitles(service.title);\r\n          }\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  events(post) {\r\n    let el, i, items;\r\n    if (g.VIEW === 'archive') { return; }\r\n    if (Conf['Embedding']) {\r\n      i = 0;\r\n      items = (post.nodes.embedlinks = $$('.embedder', post.nodes.comment));\r\n      while ((el = items[i++])) {\r\n        $.on(el, 'click', Embedding.cb.click);\r\n        if ($.hasClass(el, 'embedded')) { Embedding.cb.toggle.call(el); }\r\n      }\r\n    }\r\n    if (Conf['Cover Preview']) {\r\n      i = 0;\r\n      items = $$('.linkify', post.nodes.comment);\r\n      while ((el = items[i++])) {\r\n        var data;\r\n        if (data = Embedding.services(el)) {\r\n          Embedding.preview(data);\r\n        }\r\n      }\r\n      return;\r\n    }\r\n  },\r\n\r\n  process(link, post) {\r\n    let data;\r\n    if (!Conf['Embedding'] && !Conf['Link Title'] && !Conf['Cover Preview']) { return; }\r\n    if ($.x('ancestor::pre', link)) { return; }\r\n    if (data = Embedding.services(link)) {\r\n      data.post = post;\r\n      if (Conf['Embedding'] && (g.VIEW !== 'archive')) { Embedding.embed(data); }\r\n      if (Conf['Link Title']) { Embedding.title(data); }\r\n      if (Conf['Cover Preview'] && (g.VIEW !== 'archive')) { return Embedding.preview(data); }\r\n    }\r\n  },\r\n\r\n  services(link) {\r\n    const {href} = link;\r\n    for (var type of Embedding.ordered_types) {\r\n      var match;\r\n      if (match = type.regExp.exec(href)) {\r\n        return {key: type.key, uid: match[1], options: match[2], link};\r\n      }\r\n    }\r\n  },\r\n\r\n  embed(data) {\r\n    const {key, uid, options, link, post} = data;\r\n    const {href} = link;\r\n\r\n    $.addClass(link, key.toLowerCase());\r\n\r\n    const embed = $.el('a', {\r\n      className:   'embedder',\r\n      href:        'javascript:;'\r\n    }\r\n    ,\r\n      {innerHTML: '(<span>un</span>embed)'});\r\n\r\n    const object = {key, uid, options, href};\r\n    for (var name in object) { var value = object[name]; embed.dataset[name] = value; }\r\n\r\n    $.on(embed, 'click', Embedding.cb.click);\r\n    $.after(link, [$.tn(' '), embed]);\r\n    post.nodes.embedlinks.push(embed);\r\n\r\n    if (Conf['Auto-embed'] && !Conf['Floating Embeds'] && !post.isFetchedQuote) {\r\n      if ($.hasClass(doc, 'catalog-mode')) {\r\n        return $.addClass(embed, 'embed-removed');\r\n      } else {\r\n        return Embedding.cb.toggle.call(embed);\r\n      }\r\n    }\r\n  },\r\n\r\n  ready() {\r\n    if (!Main.isThisPageLegit()) { return; }\r\n    $.addClass(Embedding.dialog, 'empty');\r\n    $.on($('.close', Embedding.dialog), 'click',     Embedding.closeFloat);\r\n    $.on($('.move',  Embedding.dialog), 'mousedown', Embedding.dragEmbed);\r\n    $.on($('.jump',  Embedding.dialog), 'click', function() {\r\n      if (doc.contains(Embedding.lastEmbed)) { return Header.scrollTo(Embedding.lastEmbed); }\r\n    });\r\n    return $.add(d.body, Embedding.dialog);\r\n  },\r\n\r\n  closeFloat() {\r\n    delete Embedding.lastEmbed;\r\n    $.addClass(Embedding.dialog, 'empty');\r\n    return $.replace(Embedding.media.firstChild, $.el('div'));\r\n  },\r\n\r\n  dragEmbed() {\r\n    // only webkit can handle a blocking div\r\n    const {style} = Embedding.media;\r\n    if (Embedding.dragEmbed.mouseup) {\r\n      $.off(d, 'mouseup', Embedding.dragEmbed);\r\n      Embedding.dragEmbed.mouseup = false;\r\n      style.pointerEvents = '';\r\n      return;\r\n    }\r\n    $.on(d, 'mouseup', Embedding.dragEmbed);\r\n    Embedding.dragEmbed.mouseup = true;\r\n    return style.pointerEvents = 'none';\r\n  },\r\n\r\n  title(data) {\r\n    let service;\r\n    const {key, uid, options, link, post} = data;\r\n    if (!(service = Embedding.types[key].title)) { return; }\r\n    $.addClass(link, key.toLowerCase());\r\n    if (service.batchSize) {\r\n      (service.queue || (service.queue = [])).push(data);\r\n      if (service.queue.length >= service.batchSize) {\r\n        return Embedding.flushTitles(service);\r\n      }\r\n    } else {\r\n      return CrossOrigin.cache(service.api(uid), (function() { return Embedding.cb.title(this, data); }));\r\n    }\r\n  },\r\n\r\n  flushTitles(service) {\r\n    let data;\r\n    const {queue} = service;\r\n    if (!queue?.length) { return; }\r\n    service.queue = [];\r\n    const cb = function() {\r\n      for (data of queue) { Embedding.cb.title(this, data); }\r\n    };\r\n    return CrossOrigin.cache(service.api((() => {\r\n      const result = [];\r\n      for (data of queue) {         result.push(data.uid);\r\n      }\r\n      return result;\r\n    })()), cb);\r\n  },\r\n\r\n  preview(data) {\r\n    let service;\r\n    const {key, uid, link} = data;\r\n    if (!(service = Embedding.types[key].preview)) { return; }\r\n    return $.on(link, 'mouseover', function(e) {\r\n      const src = service.url(uid);\r\n      const {height} = service;\r\n      const el = $.el('img', {\r\n        src,\r\n        id: 'ihover'\r\n      }\r\n      );\r\n      $.add(Header.hover, el);\r\n      return UI.hover({\r\n        root: link,\r\n        el,\r\n        latestEvent: e,\r\n        endEvents: 'mouseout click',\r\n        height\r\n      });\r\n    });\r\n  },\r\n\r\n  cb: {\r\n    click(e) {\r\n      e.preventDefault();\r\n      if (!$.hasClass(this, 'embedded') && (Conf['Floating Embeds'] || $.hasClass(doc, 'catalog-mode'))) {\r\n        let div;\r\n        if (!(div = Embedding.media.firstChild)) { return; }\r\n        $.replace(div, Embedding.cb.embed(this));\r\n        Embedding.lastEmbed = Get.postFromNode(this).nodes.root;\r\n        return $.rmClass(Embedding.dialog, 'empty');\r\n      } else {\r\n        return Embedding.cb.toggle.call(this);\r\n      }\r\n    },\r\n\r\n    toggle() {\r\n      if ($.hasClass(this, \"embedded\")) {\r\n        $.rm(this.nextElementSibling);\r\n      } else {\r\n        $.after(this, Embedding.cb.embed(this));\r\n      }\r\n      return $.toggleClass(this, 'embedded');\r\n    },\r\n\r\n    embed(a) {\r\n      // We create an element to embed\r\n      let el, type;\r\n      const container = $.el('div', {className: 'media-embed'});\r\n      $.add(container, (el = (type = Embedding.types[a.dataset.key]).el(a)));\r\n\r\n      // Set style values.\r\n      el.style.cssText = (type.style != null) ?\r\n        type.style\r\n      :\r\n        'border: none; width: 640px; height: 360px;';\r\n\r\n      return container;\r\n    },\r\n\r\n    catalogRemove() {\r\n      const isCatalog = $.hasClass(doc, 'catalog-mode');\r\n      if ((isCatalog && $.hasClass(this, 'embedded')) || (!isCatalog && $.hasClass(this, 'embed-removed'))) {\r\n        Embedding.cb.toggle.call(this);\r\n        return $.toggleClass(this, 'embed-removed');\r\n      }\r\n    },\r\n\r\n    title(req, data) {\r\n      let text;\r\n      const {key, uid, options, link, post} = data;\r\n      const service = Embedding.types[key].title;\r\n\r\n      let {status} = req;\r\n      if ([200, 304].includes(status) && service.status) {\r\n        status = service.status(req.response)[0];\r\n      }\r\n\r\n      if (!status) { return; }\r\n\r\n      text = `[${key}] ${(() => { switch (status) {\r\n        case 200: case 304:\r\n          text = service.text(req.response, uid);\r\n          if (typeof text === 'string') {\r\n            return text;\r\n          } else {\r\n            return text = link.textContent;\r\n          }\r\n        case 404:\r\n          return \"Not Found\";\r\n        case 403: case 401:\r\n          return \"Forbidden or Private\";\r\n        default:\r\n          return `${status}'d`;\r\n      } })()\r\n      }`;\r\n\r\n      link.dataset.original = link.textContent;\r\n      link.textContent = text;\r\n      for (var post2 of post.clones) {\r\n        for (var link2 of $$('a.linkify', post2.nodes.comment)) {\r\n          if (link2.href === link.href) {\r\n            if (link2.dataset.original == null) { link2.dataset.original = link2.textContent; }\r\n            link2.textContent = text;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  ordered_types: [{\r\n      key: 'audio',\r\n      regExp: /^[^?#]+\\.(?:mp3|m4a|oga|wav|flac)(?:[?#]|$)/i,\r\n      style: '',\r\n      el(a) {\r\n        return $.el('audio', {\r\n          controls:    true,\r\n          preload:     'auto',\r\n          src:         a.dataset.href\r\n        }\r\n        );\r\n      }\r\n    }\r\n    , {\r\n      key: 'image',\r\n      regExp: /^[^?#]+\\.(?:gif|png|jpg|jpeg|bmp|webp)(?::\\w+)?(?:[?#]|$)/i,\r\n      style: '',\r\n      el(a) {\r\n        const hrefEsc = E(a.dataset.href);\r\n        return $.el('div', { innerHTML: `<a target=\"_blank\" href=\"${hrefEsc}\"><img src=\"${hrefEsc}\" style=\"max-width: 80vw; max-height: 80vh;\"></a>`});\r\n      }\r\n    }\r\n    , {\r\n      key: 'video',\r\n      regExp: /^[^?#]+\\.(?:og[gv]|webm|mp4)(?:[?#]|$)/i,\r\n      style: 'max-width: 80vw; max-height: 80vh;',\r\n      el(a) {\r\n        const el = $.el('video', {\r\n          hidden:   true,\r\n          controls: true,\r\n          preload:  'auto',\r\n          src:      a.dataset.href,\r\n          loop:     ImageHost.test(a.dataset.href.split('/')[2])\r\n        });\r\n        $.on(el, 'loadedmetadata', function() {\r\n          if ((el.videoHeight === 0) && el.parentNode) {\r\n            return $.replace(el, Embedding.types.audio.el(a));\r\n          } else {\r\n            return el.hidden = false;\r\n          }\r\n        });\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'PeerTube',\r\n      regExp: /^(\\w+:\\/\\/[^\\/]+\\/videos\\/watch\\/\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12})(.*)/,\r\n      el(a) {\r\n        let start;\r\n        const options = (start = a.dataset.options.match(/[?&](start=\\w+)/)) ? `?${start[1]}` : '';\r\n        const el = $.el('iframe',\r\n          {src: a.dataset.uid.replace('/videos/watch/', '/videos/embed/') + options});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'BitChute',\r\n      regExp:  /^\\w+:\\/\\/(?:www\\.)?bitchute\\.com\\/video\\/([\\w\\-]+)/,\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `https://www.bitchute.com/embed/${a.dataset.uid}/`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Clyp',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?clyp\\.it\\/(\\w{8})/,\r\n      style: 'border: 0; width: 640px; height: 160px;',\r\n      el(a) {\r\n        return $.el('iframe',\r\n          {src: `https://clyp.it/${a.dataset.uid}/widget`});\r\n      },\r\n      title: {\r\n        api(uid) { return `https://api.clyp.it/oembed?url=https://clyp.it/${uid}`; },\r\n        text(_) { return _.title; }\r\n      }\r\n    }\r\n    , {\r\n      key: 'Dailymotion',\r\n      regExp:  /^\\w+:\\/\\/(?:(?:www\\.)?dailymotion\\.com\\/(?:embed\\/)?video|dai\\.ly)\\/([A-Za-z0-9]+)[^?]*(.*)/,\r\n      el(a) {\r\n        let start;\r\n        const options = (start = a.dataset.options.match(/[?&](start=\\d+)/)) ? `?${start[1]}` : '';\r\n        const el = $.el('iframe',\r\n          {src: `//www.dailymotion.com/embed/video/${a.dataset.uid}${options}`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      },\r\n      title: {\r\n        api(uid) { return `https://api.dailymotion.com/video/${uid}`; },\r\n        text(_) { return _.title; }\r\n      },\r\n      preview: {\r\n        url(uid) { return `https://www.dailymotion.com/thumbnail/video/${uid}`; },\r\n        height: 240\r\n      }\r\n    }\r\n    , {\r\n      key: 'Gfycat',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?gfycat\\.com\\/(?:iframe\\/)?(\\w+)/,\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `//gfycat.com/ifr/${a.dataset.uid}`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Gist',\r\n      regExp: /^\\w+:\\/\\/gist\\.github\\.com\\/[\\w\\-]+\\/(\\w+)/,\r\n      style: '',\r\n      el: (function() {\r\n        let counter = 0;\r\n        return function(a) {\r\n          const el = $.el('pre', {\r\n            hidden: true,\r\n            id: `gist-embed-${counter++}`\r\n          }\r\n          );\r\n          CrossOrigin.cache(`https://api.github.com/gists/${a.dataset.uid}`, function() {\r\n            el.textContent = Object.values(this.response.files)[0].content;\r\n            el.className = 'prettyprint';\r\n            $.global(() => window.prettyPrint?.((function() {}), document.getElementById(document.currentScript.dataset.id).parentNode)\r\n            , {id: el.id});\r\n            return el.hidden = false;\r\n          });\r\n          return el;\r\n        };\r\n      })(),\r\n      title: {\r\n        api(uid) { return `https://api.github.com/gists/${uid}`; },\r\n        text({files}) {\r\n          for (var file in files) { if (files.hasOwnProperty(file)) { return file; } }\r\n        }\r\n      }\r\n    }\r\n    , {\r\n      key: 'InstallGentoo',\r\n      regExp: /^\\w+:\\/\\/paste\\.installgentoo\\.com\\/view\\/(?:raw\\/|download\\/|embed\\/)?(\\w+)/,\r\n      el(a) {\r\n        return $.el('iframe',\r\n          {src: `https://paste.installgentoo.com/view/embed/${a.dataset.uid}`});\r\n      }\r\n    }\r\n    , {\r\n      key: 'LiveLeak',\r\n      regExp: /^\\w+:\\/\\/(?:\\w+\\.)?liveleak\\.com\\/.*\\?.*[tif]=(\\w+)/,\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `https://www.liveleak.com/e/${a.dataset.uid}`,});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Loopvid',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?loopvid.appspot.com\\/#?((?:pf|kd|lv|gd|gh|db|dx|nn|cp|wu|ig|ky|mf|m2|pc|1c|pi|ni|wl|ko|mm|ic|gc)\\/[\\w\\-\\/]+(?:,[\\w\\-\\/]+)*|fc\\/\\w+\\/\\d+|https?:\\/\\/.+)/,\r\n      style: 'max-width: 80vw; max-height: 80vh;',\r\n      el(a) {\r\n        const el = $.el('video', {\r\n          controls: true,\r\n          preload:  'auto',\r\n          loop:     true\r\n        }\r\n        );\r\n        if (/^http/.test(a.dataset.uid)) {\r\n          $.add(el, $.el('source', {src: a.dataset.uid}));\r\n          return el;\r\n        }\r\n        const [_, host, names] = a.dataset.uid.match(/(\\w+)\\/(.*)/);\r\n        const types = (() => { switch (host) {\r\n          case 'gd': case 'wu': case 'fc': return [''];\r\n          case 'gc': return ['giant', 'fat', 'zippy'];\r\n          default: return ['.webm', '.mp4'];\r\n        } })();\r\n        for (var name of names.split(',')) {\r\n          for (var type of types) {\r\n            var base = `${name}${type}`;\r\n            var urls = (() => { switch (host) {\r\n              // list from src/common.py at http://loopvid.appspot.com/source.html\r\n              case 'pf': return [`https://kastden.org/_loopvid_media/pf/${base}`, `https://web.archive.org/web/2/http://a.pomf.se/${base}`];\r\n              case 'kd': return [`https://kastden.org/loopvid/${base}`];\r\n              case 'lv': return [`https://lv.kastden.org/${base}`];\r\n              case 'gd': return [`https://docs.google.com/uc?export=download&id=${base}`];\r\n              case 'gh': return [`https://googledrive.com/host/${base}`];\r\n              case 'db': return [`https://dl.dropboxusercontent.com/u/${base}`];\r\n              case 'dx': return [`https://dl.dropboxusercontent.com/${base}`];\r\n              case 'nn': return [`https://kastden.org/_loopvid_media/nn/${base}`];\r\n              case 'cp': return [`https://copy.com/${base}`];\r\n              case 'wu': return [`http://webmup.com/${base}/vid.webm`];\r\n              case 'ig': return [`https://i.imgur.com/${base}`];\r\n              case 'ky': return [`https://kastden.org/_loopvid_media/ky/${base}`];\r\n              case 'mf': return [`https://kastden.org/_loopvid_media/mf/${base}`, `https://web.archive.org/web/2/https://d.maxfile.ro/${base}`];\r\n              case 'm2': return [`https://kastden.org/_loopvid_media/m2/${base}`];\r\n              case 'pc': return [`https://kastden.org/_loopvid_media/pc/${base}`, `https://web.archive.org/web/2/http://a.pomf.cat/${base}`];\r\n              case '1c': return [`http://b.1339.cf/${base}`];\r\n              case 'pi': return [`https://kastden.org/_loopvid_media/pi/${base}`, `https://web.archive.org/web/2/https://u.pomf.is/${base}`];\r\n              case 'ni': return [`https://kastden.org/_loopvid_media/ni/${base}`, `https://web.archive.org/web/2/https://u.nya.is/${base}`];\r\n              case 'wl': return [`http://webm.land/media/${base}`];\r\n              case 'ko': return [`https://kordy.kastden.org/loopvid/${base}`];\r\n              case 'mm': return [`https://kastden.org/_loopvid_media/mm/${base}`, `https://web.archive.org/web/2/https://my.mixtape.moe/${base}`];\r\n              case 'ic': return [`https://media.8ch.net/file_store/${base}`];\r\n              case 'fc': return [`//${ImageHost.host()}/${base}.webm`];\r\n              case 'gc': return [`https://${type}.gfycat.com/${name}.webm`];\r\n            } })();\r\n\r\n            for (var url of urls) {\r\n              $.add(el, $.el('source', {src: url}));\r\n            }\r\n          }\r\n        }\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Openings.moe',\r\n      regExp: /^\\w+:\\/\\/openings.moe\\/\\?video=([^.&=]+)/,\r\n      style: 'width: 1280px; height: 720px; max-width: 80vw; max-height: 80vh;',\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `https://openings.moe/?video=${a.dataset.uid}`,});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Pastebin',\r\n      regExp: /^\\w+:\\/\\/(?:\\w+\\.)?pastebin\\.com\\/(?!u\\/)(?:[\\w.]+(?:\\/|\\?i\\=))?(\\w+)/,\r\n      el(a) {\r\n        let div;\r\n        return div = $.el('iframe',\r\n          {src: `//pastebin.com/embed_iframe.php?i=${a.dataset.uid}`});\r\n      }\r\n    }\r\n    , {\r\n      key: 'SoundCloud',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?(?:soundcloud\\.com\\/|snd\\.sc\\/)([\\w\\-\\/]+)/,\r\n      style: 'border: 0; width: 500px; height: 400px;',\r\n      el(a) {\r\n        return $.el('iframe',\r\n          {src: `https://w.soundcloud.com/player/?visual=true&show_comments=false&url=https%3A%2F%2Fsoundcloud.com%2F${encodeURIComponent(a.dataset.uid)}`});\r\n      },\r\n      title: {\r\n        api(uid) { return `${location.protocol}//soundcloud.com/oembed?format=json&url=https%3A%2F%2Fsoundcloud.com%2F${encodeURIComponent(uid)}`; },\r\n        text(_) { return _.title; }\r\n      }\r\n    }\r\n    , {\r\n      key: 'StrawPoll',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?strawpoll\\.me\\/(?:embed_\\d+\\/)?(\\d+(?:\\/r)?)/,\r\n      style: 'border: 0; width: 600px; height: 406px;',\r\n      el(a) {\r\n        return $.el('iframe',\r\n          {src: `https://www.strawpoll.me/embed_1/${a.dataset.uid}`});\r\n      }\r\n    }\r\n    , {\r\n      key: 'Streamable',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?streamable\\.com\\/(\\w+)/,\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `https://streamable.com/o/${a.dataset.uid}`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      },\r\n      title: {\r\n        api(uid) { return `https://api.streamable.com/oembed?url=https://streamable.com/${uid}`; },\r\n        text(_) { return _.title; }\r\n      }\r\n    }\r\n    , {\r\n      key: 'TwitchTV',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.|secure\\.|clips\\.|m\\.)?twitch\\.tv\\/(\\w[^#\\&\\?]*)/,\r\n      el(a) {\r\n        let url;\r\n        let m = a.dataset.href.match(/^\\w+:\\/\\/(?:(clips\\.)|\\w+\\.)?twitch\\.tv\\/(?:\\w+\\/)?(clip\\/)?(\\w[^#\\&\\?]*)/);\r\n        if (m[1] || m[2]) {\r\n          url = `//clips.twitch.tv/embed?clip=${m[3]}&parent=${location.hostname}`;\r\n        } else {\r\n          let time;\r\n          m = a.dataset.uid.match(/(\\w+)(?:\\/(?:v\\/)?(\\d+))?/);\r\n          url = `//player.twitch.tv/?${m[2] ? `video=v${m[2]}` : `channel=${m[1]}`}&autoplay=false&parent=${location.hostname}`;\r\n          if (time = a.dataset.href.match(/\\bt=(\\w+)/)) {\r\n            url += `&time=${time[1]}`;\r\n          }\r\n        }\r\n        const el = $.el('iframe',\r\n          {src: url});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Twitter',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.|mobile\\.)?(?:twitter|x)\\.com\\/(\\w+\\/status\\/\\d+)/,\r\n      style: 'border: none; width: 550px; height: 250px; overflow: hidden; resize: both;',\r\n      el(a) {\r\n        const el = $.el('iframe');\r\n        $.on(el, 'load', function() {\r\n          return this.contentWindow.postMessage({element: 't', query: 'height'}, 'https://twitframe.com');\r\n        });\r\n        var onMessage = function(e) {\r\n          if ((e.source === el.contentWindow) && (e.origin === 'https://twitframe.com')) {\r\n            $.off(window, 'message', onMessage);\r\n            return (cont || el).style.height = `${+$.minmax(e.data.height, 250, 0.8 * doc.clientHeight)}px`;\r\n          }\r\n        };\r\n        $.on(window, 'message', onMessage);\r\n        el.src = `https://twitframe.com/show?url=https://twitter.com/${a.dataset.uid}`;\r\n        if ($.engine === 'gecko') {\r\n          // XXX https://bugzilla.mozilla.org/show_bug.cgi?id=680823\r\n          el.style.cssText = 'border: none; width: 100%; height: 100%;';\r\n          var cont = $.el('div');\r\n          $.add(cont, el);\r\n          return cont;\r\n        } else {\r\n          return el;\r\n        }\r\n      }\r\n    }\r\n    , {\r\n      key: 'VidLii',\r\n      regExp:  /^\\w+:\\/\\/(?:www\\.)?vidlii\\.com\\/watch\\?v=(\\w{11})/,\r\n      style: 'border: none; width: 640px; height: 392px;',\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `https://www.vidlii.com/embed?v=${a.dataset.uid}&a=0`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'Vimeo',\r\n      regExp:  /^\\w+:\\/\\/(?:www\\.)?vimeo\\.com\\/(\\d+)/,\r\n      el(a) {\r\n        const el = $.el('iframe',\r\n          {src: `//player.vimeo.com/video/${a.dataset.uid}?wmode=opaque`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      },\r\n      title: {\r\n        api(uid) { return `https://vimeo.com/api/oembed.json?url=https://vimeo.com/${uid}`; },\r\n        text(_) { return _.title; }\r\n      }\r\n    }\r\n    , {\r\n      key: 'Vine',\r\n      regExp: /^\\w+:\\/\\/(?:www\\.)?vine\\.co\\/v\\/(\\w+)/,\r\n      style: 'border: none; width: 500px; height: 500px;',\r\n      el(a) {\r\n        return $.el('iframe',\r\n          {src: `https://vine.co/v/${a.dataset.uid}/card`});\r\n      }\r\n    }\r\n    , {\r\n      key: 'Vocaroo',\r\n      regExp: /^\\w+:\\/\\/(?:(?:www\\.|old\\.)?vocaroo\\.com|voca\\.ro)\\/((?:i\\/)?\\w+)/,\r\n      style: '',\r\n      el(a) {\r\n        const el = $.el('iframe');\r\n        el.width = 300;\r\n        el.height = 60;\r\n        el.setAttribute('frameborder', 0);\r\n        el.src = `https://vocaroo.com/embed/${a.dataset.uid.replace(/^i\\//, '')}?autoplay=0`;\r\n        return el;\r\n      }\r\n    }\r\n    , {\r\n      key: 'YouTube',\r\n      regExp: /^\\w+:\\/\\/(?:youtu.be\\/|[\\w.]*youtube[\\w.]*\\/.*(?:v=|\\bembed\\/|\\bv\\/|live\\/))([\\w\\-]{11})(.*)/,\r\n      el(a) {\r\n        let start = a.dataset.options.match(/\\b(?:star)?t\\=(\\w+)/);\r\n        if (start) { start = start[1]; }\r\n        if (start && !/^\\d+$/.test(start)) {\r\n          start += ' 0h0m0s';\r\n          start = (3600 * start.match(/(\\d+)h/)[1]) + (60 * start.match(/(\\d+)m/)[1]) + (1 * start.match(/(\\d+)s/)[1]);\r\n        }\r\n        const el = $.el('iframe',\r\n          {src: `//www.youtube.com/embed/${a.dataset.uid}?rel=0&wmode=opaque${start ? '&start=' + start : ''}`});\r\n        el.setAttribute(\"allowfullscreen\", \"true\");\r\n        return el;\r\n      },\r\n      title: {\r\n        api(uid) { return `https://www.youtube.com/oembed?url=https%3A//www.youtube.com/watch%3Fv%3D${uid}&format=json`; },\r\n        text(_) { return _.title; },\r\n        status(_) {\r\n          if (_.error) {\r\n            const m = _.error.match(/^(\\d*)\\s*(.*)/);\r\n            return [+m[1], m[2]];\r\n          } else {\r\n            return [200, 'OK'];\r\n          }\r\n        }\r\n      },\r\n      preview: {\r\n        url(uid) { return `https://img.youtube.com/vi/${uid}/0.jpg`; },\r\n        height: 360\r\n      }\r\n    }\r\n  ]\r\n};\r\nexport default Embedding;\r\n","import Notice from \"../classes/Notice\";\r\nimport Config from \"../config/Config\";\r\nimport Filter from \"../Filtering/Filter\";\r\nimport ThreadHiding from \"../Filtering/ThreadHiding\";\r\nimport BoardConfig from \"../General/BoardConfig\";\r\nimport Get from \"../General/Get\";\r\nimport Header from \"../General/Header\";\r\nimport Index from \"../General/Index\";\r\nimport Settings from \"../General/Settings\";\r\nimport { Conf, d, g } from \"../globals/globals\";\r\nimport FappeTyme from \"../Images/FappeTyme\";\r\nimport Gallery from \"../Images/Gallery\";\r\nimport ImageExpand from \"../Images/ImageExpand\";\r\nimport Embedding from \"../Linkification/Embedding\";\r\nimport ThreadUpdater from \"../Monitoring/ThreadUpdater\";\r\nimport ThreadWatcher from \"../Monitoring/ThreadWatcher\";\r\nimport UnreadIndex from \"../Monitoring/UnreadIndex\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport QR from \"../Posting/QR\";\r\nimport QuoteThreading from \"../Quotelinks/QuoteThreading\";\r\nimport QuoteYou from \"../Quotelinks/QuoteYou\";\r\nimport CatalogLinks from \"./CatalogLinks\";\r\nimport ExpandThread from \"./ExpandThread\";\r\nimport Nav from \"./Nav\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Keybinds = {\r\n  init() {\r\n    if (!Conf['Keybinds']) { return; }\r\n\r\n    for (var hotkey in Config.hotkeys) {\r\n      $.sync(hotkey, Keybinds.sync);\r\n    }\r\n\r\n    var init = function() {\r\n      $.off(d, '4chanXInitFinished', init);\r\n      $.on(d, 'keydown', Keybinds.keydown);\r\n      for (var node of $$('[accesskey]')) {\r\n        node.removeAttribute('accesskey');\r\n      }\r\n    };\r\n    return $.on(d, '4chanXInitFinished', init);\r\n  },\r\n\r\n  sync(key, hotkey) {\r\n    return Conf[hotkey] = key;\r\n  },\r\n\r\n  keydown(e) {\r\n    let key, thread, threadRoot;\r\n    let catalog, notifications;\r\n    if (!(key = Keybinds.keyCode(e))) { return; }\r\n    const {target} = e;\r\n    if (['INPUT', 'TEXTAREA'].includes(target.nodeName)) {\r\n      if (!/(Esc|Alt|Ctrl|Meta|Shift\\+\\w{2,})/.test(key) || !!/^Alt\\+(\\d|Up|Down|Left|Right)$/.test(key)) { return; }\r\n    }\r\n    if (['index', 'thread'].includes(g.VIEW)) {\r\n      threadRoot = Nav.getThread();\r\n      thread = Get.threadFromRoot(threadRoot);\r\n    }\r\n    switch (key) {\r\n      // QR & Options\r\n      case Conf['Toggle board list']:\r\n        if (!Conf['Custom Board Navigation']) { return; }\r\n        Header.toggleBoardList();\r\n        break;\r\n      case Conf['Toggle header']:\r\n        Header.toggleBarVisibility();\r\n        break;\r\n      case Conf['Open empty QR']:\r\n        if (!QR.postingIsEnabled) { return; }\r\n        Keybinds.qr();\r\n        break;\r\n      case Conf['Open QR']:\r\n        if (!QR.postingIsEnabled || !threadRoot) { return; }\r\n        Keybinds.qr(threadRoot);\r\n        break;\r\n      case Conf['Open settings']:\r\n        Settings.open();\r\n        break;\r\n      case Conf['Close']:\r\n        if (Settings.dialog) {\r\n          Settings.close();\r\n        } else if ((notifications = $$('.notification')).length) {\r\n          for (var notification of notifications) {\r\n            $('.close', notification).click();\r\n          }\r\n        } else if (QR.nodes && !(QR.nodes.el.hidden || (window.getComputedStyle(QR.nodes.form).display === 'none'))) {\r\n          if (Conf['Persistent QR']) {\r\n            QR.hide();\r\n          } else {\r\n            QR.close();\r\n          }\r\n        } else if (Embedding.lastEmbed) {\r\n          Embedding.closeFloat();\r\n        } else {\r\n          return;\r\n        }\r\n        break;\r\n      case Conf['Spoiler tags']:\r\n        if (target.nodeName !== 'TEXTAREA') { return; }\r\n        Keybinds.tags('spoiler', target);\r\n        break;\r\n      case Conf['Code tags']:\r\n        if (target.nodeName !== 'TEXTAREA') { return; }\r\n        Keybinds.tags('code', target);\r\n        break;\r\n      case Conf['Eqn tags']:\r\n        if (target.nodeName !== 'TEXTAREA') { return; }\r\n        Keybinds.tags('eqn', target);\r\n        break;\r\n      case Conf['Math tags']:\r\n        if (target.nodeName !== 'TEXTAREA') { return; }\r\n        Keybinds.tags('math', target);\r\n        break;\r\n      case Conf['SJIS tags']:\r\n        if (target.nodeName !== 'TEXTAREA') { return; }\r\n        Keybinds.tags('sjis', target);\r\n        break;\r\n      case Conf['Toggle sage']:\r\n        if (!QR.nodes || !!QR.nodes.el.hidden) { return; }\r\n        Keybinds.sage();\r\n        break;\r\n      case Conf['Toggle Cooldown']:\r\n        if (!QR.nodes || !!QR.nodes.el.hidden || !$.hasClass(QR.nodes.fileSubmit, 'custom-cooldown')) { return; }\r\n        QR.toggleCustomCooldown();\r\n        break;\r\n      case Conf['Post from URL']:\r\n        if (!QR.postingIsEnabled) { return; }\r\n        QR.handleUrl('');\r\n        break;\r\n      case Conf['Add new post']:\r\n        if (!QR.postingIsEnabled) { return; }\r\n        QR.addPost();\r\n        break;\r\n      case Conf['Submit QR']:\r\n        if (!QR.nodes || !!QR.nodes.el.hidden) { return; }\r\n        if (!QR.status()) { QR.submit(); }\r\n        break;\r\n      // Index/Thread related\r\n      case Conf['Update']:\r\n        switch (g.VIEW) {\r\n          case 'thread':\r\n            if (!ThreadUpdater.enabled) { return; }\r\n            ThreadUpdater.update();\r\n            break;\r\n          case 'index':\r\n            if (!Index.enabled) { return; }\r\n            Index.update();\r\n            break;\r\n          default:\r\n            return;\r\n        }\r\n        break;\r\n      case Conf['Watch']:\r\n        if (!ThreadWatcher.enabled || !thread) { return; }\r\n        ThreadWatcher.toggle(thread);\r\n        break;\r\n      case Conf['Update thread watcher']:\r\n        if (!ThreadWatcher.enabled) { return; }\r\n        ThreadWatcher.buttonFetchAll();\r\n        break;\r\n      case Conf['Toggle thread watcher']:\r\n        if (!ThreadWatcher.enabled) { return; }\r\n        ThreadWatcher.toggleWatcher();\r\n        break;\r\n      case Conf['Toggle threading']:\r\n        if (!QuoteThreading.ready) { return; }\r\n        QuoteThreading.toggleThreading();\r\n        break;\r\n      case Conf['Mark thread read']:\r\n        if ((g.VIEW !== 'index') || !thread || !UnreadIndex.enabled) { return; }\r\n        UnreadIndex.markRead.call(threadRoot);\r\n        break;\r\n      // Images\r\n      case Conf['Expand image']:\r\n        if (!ImageExpand.enabled || !threadRoot) { return; }\r\n        var post = Get.postFromNode(Keybinds.post(threadRoot));\r\n        if (post.file) { ImageExpand.toggle(post); }\r\n        break;\r\n      case Conf['Expand images']:\r\n        if (!ImageExpand.enabled) { return; }\r\n        ImageExpand.cb.toggleAll();\r\n        break;\r\n      case Conf['Open Gallery']:\r\n        if (!Gallery.enabled) { return; }\r\n        Gallery.cb.toggle();\r\n        break;\r\n      case Conf['fappeTyme']:\r\n        if (!FappeTyme.nodes?.fappe) { return; }\r\n        FappeTyme.toggle('fappe');\r\n        break;\r\n      case Conf['werkTyme']:\r\n        if (!FappeTyme.nodes?.werk) { return; }\r\n        FappeTyme.toggle('werk');\r\n        break;\r\n      // Board Navigation\r\n      case Conf['Front page']:\r\n        if (Index.enabled) {\r\n          Index.userPageNav(1);\r\n        } else {\r\n          location.href = `/${g.BOARD}/`;\r\n        }\r\n        break;\r\n      case Conf['Open front page']:\r\n        $.open(`${location.origin}/${g.BOARD}/`);\r\n        break;\r\n      case Conf['Next page']:\r\n        if ((g.VIEW !== 'index') || !!g.SITE.isOnePage?.(g.BOARD)) { return; }\r\n        if (Index.enabled) {\r\n          if (!['paged', 'infinite'].includes(Conf['Index Mode'])) { return; }\r\n          $('.next button', Index.pagelist).click();\r\n        } else {\r\n          $(g.SITE.selectors.nav.next)?.click();\r\n        }\r\n        break;\r\n      case Conf['Previous page']:\r\n        if ((g.VIEW !== 'index') || !!g.SITE.isOnePage?.(g.BOARD)) { return; }\r\n        if (Index.enabled) {\r\n          if (!['paged', 'infinite'].includes(Conf['Index Mode'])) { return; }\r\n          $('.prev button', Index.pagelist).click();\r\n        } else {\r\n          $(g.SITE.selectors.nav.prev)?.click();\r\n        }\r\n        break;\r\n      case Conf['Search form']:\r\n        if (g.VIEW !== 'index') { return; }\r\n        var searchInput = Index.enabled ?\r\n          Index.searchInput\r\n        : g.SITE.selectors.searchBox ?\r\n          $(g.SITE.selectors.searchBox)\r\n        :\r\n          undefined;\r\n        if (!searchInput) { return; }\r\n        Header.scrollToIfNeeded(searchInput);\r\n        searchInput.focus();\r\n        break;\r\n      case Conf['Paged mode']:\r\n        if (!Index.enabledOn(g.BOARD)) { return; }\r\n        location.href = g.VIEW === 'index' ? '#paged' : `/${g.BOARD}/#paged`;\r\n        break;\r\n      case Conf['Infinite scrolling mode']:\r\n        if (!Index.enabledOn(g.BOARD)) { return; }\r\n        location.href = g.VIEW === 'index' ? '#infinite' : `/${g.BOARD}/#infinite`;\r\n        break;\r\n      case Conf['All pages mode']:\r\n        if (!Index.enabledOn(g.BOARD)) { return; }\r\n        location.href = g.VIEW === 'index' ? '#all-pages' : `/${g.BOARD}/#all-pages`;\r\n        break;\r\n      case Conf['Open catalog']:\r\n        if (!(catalog = CatalogLinks.catalog())) { return; }\r\n        location.href = catalog;\r\n        break;\r\n      case Conf['Cycle sort type']:\r\n        if (!Index.enabled) { return; }\r\n        Index.cycleSortType();\r\n        break;\r\n      // Thread Navigation\r\n      case Conf['Next thread']:\r\n        if ((g.VIEW !== 'index') || !threadRoot) { return; }\r\n        Nav.scroll(+1);\r\n        break;\r\n      case Conf['Previous thread']:\r\n        if ((g.VIEW !== 'index') || !threadRoot) { return; }\r\n        Nav.scroll(-1);\r\n        break;\r\n      case Conf['Expand thread']:\r\n        if ((g.VIEW !== 'index') || !threadRoot) { return; }\r\n        ExpandThread.toggle(thread);\r\n        // Keep thread from moving off screen when contracted.\r\n        Header.scrollTo(threadRoot);\r\n        break;\r\n      case Conf['Open thread']:\r\n        if ((g.VIEW !== 'index') || !threadRoot) { return; }\r\n        Keybinds.open(thread);\r\n        break;\r\n      case Conf['Open thread tab']:\r\n        if ((g.VIEW !== 'index') || !threadRoot) { return; }\r\n        Keybinds.open(thread, true);\r\n        break;\r\n      // Reply Navigation\r\n      case Conf['Next reply']:\r\n        if (!threadRoot) { return; }\r\n        Keybinds.hl(+1, threadRoot);\r\n        break;\r\n      case Conf['Previous reply']:\r\n        if (!threadRoot) { return; }\r\n        Keybinds.hl(-1, threadRoot);\r\n        break;\r\n      case Conf['Deselect reply']:\r\n        if (!threadRoot) { return; }\r\n        Keybinds.hl(0, threadRoot);\r\n        break;\r\n      case Conf['Hide']:\r\n        if (!thread || !ThreadHiding.db) { return; }\r\n        Header.scrollTo(threadRoot);\r\n        ThreadHiding.toggle(thread);\r\n        break;\r\n      case Conf['Quick Filter MD5']:\r\n        if (!threadRoot) { return; }\r\n        post = Keybinds.post(threadRoot);\r\n        Keybinds.hl(+1, threadRoot);\r\n        Filter.quickFilterMD5.call(post, e);\r\n        break;\r\n      case Conf['Previous Post Quoting You']:\r\n        if (!threadRoot || !QuoteYou.db) { return; }\r\n        QuoteYou.cb.seek('preceding');\r\n        break;\r\n      case Conf['Next Post Quoting You']:\r\n        if (!threadRoot || !QuoteYou.db) { return; }\r\n        QuoteYou.cb.seek('following');\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n    e.preventDefault();\r\n    return e.stopPropagation();\r\n  },\r\n\r\n  keyCode(e) {\r\n    let key = (() => { let kc;\r\n    switch ((kc = e.keyCode)) {\r\n      case 8: // return\r\n        return '';\r\n      case 13:\r\n        return 'Enter';\r\n      case 27:\r\n        return 'Esc';\r\n      case 32:\r\n        return 'Space';\r\n      case 37:\r\n        return 'Left';\r\n      case 38:\r\n        return 'Up';\r\n      case 39:\r\n        return 'Right';\r\n      case 40:\r\n        return 'Down';\r\n      case 188:\r\n        return 'Comma';\r\n      case 190:\r\n        return 'Period';\r\n      case 191:\r\n        return 'Slash';\r\n      case 59: case 186:\r\n        return 'Semicolon';\r\n      default:\r\n        if ((48 <= kc && kc <= 57) || (65 <= kc && kc <= 90)) { // 0-9, A-Z\r\n          return String.fromCharCode(kc).toLowerCase();\r\n        } else if (96 <= kc && kc <= 105) { // numpad 0-9\r\n          return String.fromCharCode(kc - 48).toLowerCase();\r\n        } else {\r\n          return null;\r\n        }\r\n    } })();\r\n    if (key) {\r\n      if (e.altKey) {   key = 'Alt+'   + key; }\r\n      if (e.ctrlKey) {  key = 'Ctrl+'  + key; }\r\n      if (e.metaKey) {  key = 'Meta+'  + key; }\r\n      if (e.shiftKey) { key = 'Shift+' + key; }\r\n    }\r\n    return key;\r\n  },\r\n\r\n  post(thread) {\r\n    const s = g.SITE.selectors;\r\n    return (\r\n      $(`${s.postContainer}${s.highlightable.reply}.${g.SITE.classes.highlight}`, thread) ||\r\n      $(`${g.SITE.isOPContainerThread ? s.thread : s.postContainer}${s.highlightable.op}`, thread)\r\n    );\r\n  },\r\n\r\n  qr(thread) {\r\n    QR.open();\r\n    if (thread != null) {\r\n      QR.quote.call(Keybinds.post(thread));\r\n    }\r\n    return QR.nodes.com.focus();\r\n  },\r\n\r\n  tags(tag, ta) {\r\n    BoardConfig.ready(function() {\r\n      const {config} = g.BOARD;\r\n      const supported = (() => { switch (tag) {\r\n        case 'spoiler':     return !!config.spoilers;\r\n        case 'code':        return !!config.code_tags;\r\n        case 'math': case 'eqn': return !!config.math_tags;\r\n        case 'sjis':        return !!config.sjis_tags;\r\n      } })();\r\n      if (!supported) { return new Notice('warning', `[${tag}] tags are not supported on /${g.BOARD}/.`, 20); }\r\n    });\r\n\r\n    const {\r\n      value\r\n    } = ta;\r\n    const selStart = ta.selectionStart;\r\n    const selEnd   = ta.selectionEnd;\r\n\r\n    ta.value =\r\n      value.slice(0, selStart) +\r\n      `[${tag}]` + value.slice(selStart, selEnd) + `[/${tag}]` +\r\n      value.slice(selEnd);\r\n\r\n    // Move the caret to the end of the selection.\r\n    const range = (`[${tag}]`).length + selEnd;\r\n    ta.setSelectionRange(range, range);\r\n\r\n    // Fire the 'input' event\r\n    return $.event('input', null, ta);\r\n  },\r\n\r\n  sage() {\r\n    const isSage  = /sage/i.test(QR.nodes.email.value);\r\n    return QR.nodes.email.value = isSage ?\r\n      \"\"\r\n    : \"sage\";\r\n  },\r\n\r\n  open(thread, tab) {\r\n    if (g.VIEW !== 'index') { return; }\r\n    const url = Get.url('thread', thread);\r\n    if (tab) {\r\n      return $.open(url);\r\n    } else {\r\n      return location.href = url;\r\n    }\r\n  },\r\n\r\n  hl(delta, thread) {\r\n    const replySelector = `${g.SITE.selectors.postContainer}${g.SITE.selectors.highlightable.reply}`;\r\n    const {highlight} = g.SITE.classes;\r\n\r\n    const postEl = $(`${replySelector}.${highlight}`, thread);\r\n\r\n    if (!delta) {\r\n      if (postEl) { $.rmClass(postEl, highlight); }\r\n      return;\r\n    }\r\n\r\n    if (postEl) {\r\n      const {height} = postEl.getBoundingClientRect();\r\n      if ((Header.getTopOf(postEl) >= -height) && (Header.getBottomOf(postEl) >= -height)) { // We're at least partially visible\r\n        let next;\r\n        const {root} = Get.postFromNode(postEl).nodes;\r\n        const axis = delta === +1 ?\r\n          'following'\r\n        :\r\n          'preceding';\r\n        if (!(next = $.x(`${axis}-sibling::${g.SITE.xpath.replyContainer}[not(@hidden) and not(child::div[@class='stub'])][1]`, root))) { return; }\r\n        if (!next.matches(replySelector)) { next = $(replySelector, next); }\r\n        Header.scrollToIfNeeded(next, delta === +1);\r\n        $.addClass(next, highlight);\r\n        $.rmClass(postEl, highlight);\r\n        return;\r\n      }\r\n      $.rmClass(postEl, highlight);\r\n    }\r\n\r\n    const replies = $$(replySelector, thread);\r\n    if (delta === -1) { replies.reverse(); }\r\n    for (var reply of replies) {\r\n      if (((delta === +1) && (Header.getTopOf(reply) > 0)) || ((delta === -1) && (Header.getBottomOf(reply) > 0))) {\r\n        $.addClass(reply, highlight);\r\n        return;\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default Keybinds;\r\n","import $ from \"../platform/$\";\r\nimport CaptchaReplace from \"./Captcha.replace\";\r\nimport CaptchaT from \"./Captcha.t\";\r\nimport meta from '../../package.json';\r\nimport Main from \"../main/Main\";\r\nimport Keybinds from \"../Miscellaneous/Keybinds\";\r\nimport $$ from \"../platform/$$\";\r\nimport QR from \"./QR\";\r\nimport { Conf, d } from \"../globals/globals\";\r\nimport { MINUTE, SECOND } from \"../platform/helpers\";\r\n\r\nconst Captcha = {\r\n  Cache: {\r\n    init() {\r\n      $.on(d, 'SaveCaptcha', e => {\r\n        return this.saveAPI(e.detail);\r\n      });\r\n      return $.on(d, 'NoCaptcha', e => {\r\n        return this.noCaptcha(e.detail);\r\n      });\r\n    },\r\n\r\n    captchas: [],\r\n\r\n    getCount() {\r\n      return this.captchas.length;\r\n    },\r\n\r\n    neededRaw() {\r\n      return !(\r\n        this.haveCookie() || this.captchas.length || QR.req || this.submitCB\r\n      ) && (\r\n          (QR.posts.length > 1) || Conf['Auto-load captcha'] || !QR.posts[0].isOnlyQuotes() || QR.posts[0].file\r\n        );\r\n    },\r\n\r\n    needed() {\r\n      return this.neededRaw() && $.event('LoadCaptcha');\r\n    },\r\n\r\n    prerequest() {\r\n      if (!Conf['Prerequest Captcha']) { return; }\r\n      // Post count temporarily off by 1 when called from QR.post.rm, QR.close, or QR.submit\r\n      return $.queueTask(() => {\r\n        if (\r\n          !this.prerequested &&\r\n          this.neededRaw() &&\r\n          !$.event('LoadCaptcha') &&\r\n          !QR.captcha.occupied() &&\r\n          (QR.cooldown.seconds <= 60) &&\r\n          (QR.selected === QR.posts[QR.posts.length - 1]) &&\r\n          !QR.selected.isOnlyQuotes()\r\n        ) {\r\n          const isReply = (QR.selected.thread !== 'new');\r\n          if (!$.event('RequestCaptcha', { isReply })) {\r\n            this.prerequested = true;\r\n            this.submitCB = captcha => {\r\n              if (captcha) { return this.save(captcha); }\r\n            };\r\n            return this.updateCount();\r\n          }\r\n        }\r\n      });\r\n    },\r\n\r\n    haveCookie() {\r\n      return /\\b_ct=/.test(d.cookie) && (QR.posts[0].thread !== 'new');\r\n    },\r\n\r\n    getOne() {\r\n      let captcha;\r\n      delete this.prerequested;\r\n      this.clear();\r\n      if (captcha = this.captchas.shift()) {\r\n        this.count();\r\n        return captcha;\r\n      } else {\r\n        return null;\r\n      }\r\n    },\r\n\r\n    request(isReply) {\r\n      if (!this.submitCB) {\r\n        if ($.event('RequestCaptcha', { isReply })) { return; }\r\n      }\r\n      return cb => {\r\n        this.submitCB = cb;\r\n        return this.updateCount();\r\n      };\r\n    },\r\n\r\n    abort() {\r\n      if (this.submitCB) {\r\n        delete this.submitCB;\r\n        $.event('AbortCaptcha');\r\n        return this.updateCount();\r\n      }\r\n    },\r\n\r\n    saveAPI(captcha) {\r\n      let cb;\r\n      if (cb = this.submitCB) {\r\n        delete this.submitCB;\r\n        cb(captcha);\r\n        return this.updateCount();\r\n      } else {\r\n        return this.save(captcha);\r\n      }\r\n    },\r\n\r\n    noCaptcha(detail) {\r\n      let cb;\r\n      if (cb = this.submitCB) {\r\n        if (!this.haveCookie() || detail?.error) {\r\n          QR.error(detail?.error || 'Failed to retrieve captcha.');\r\n          QR.captcha.setup(d.activeElement === QR.nodes.status);\r\n        }\r\n        delete this.submitCB;\r\n        cb();\r\n        return this.updateCount();\r\n      }\r\n    },\r\n\r\n    save(captcha) {\r\n      let cb;\r\n      if (cb = this.submitCB) {\r\n        this.abort();\r\n        cb(captcha);\r\n        return;\r\n      }\r\n      this.captchas.push(captcha);\r\n      this.captchas.sort((a, b) => a.timeout - b.timeout);\r\n      return this.count();\r\n    },\r\n\r\n    clear() {\r\n      if (this.captchas.length) {\r\n        let i;\r\n        const now = Date.now();\r\n        for (i = 0; i < this.captchas.length; i++) {\r\n          var captcha = this.captchas[i];\r\n          if (captcha.timeout > now) { break; }\r\n        }\r\n        if (i) {\r\n          this.captchas = this.captchas.slice(i);\r\n          return this.count();\r\n        }\r\n      }\r\n    },\r\n\r\n    count() {\r\n      clearTimeout(this.timer);\r\n      if (this.captchas.length) {\r\n        this.timer = setTimeout(this.clear.bind(this), this.captchas[0].timeout - Date.now());\r\n      }\r\n      return this.updateCount();\r\n    },\r\n\r\n    updateCount() {\r\n      return $.event('CaptchaCount', this.captchas.length);\r\n    }\r\n  }, Replace: CaptchaReplace, t: CaptchaT, v2: {\r\n    lifetime: 2 * MINUTE,\r\n\r\n    init() {\r\n      if (d.cookie.indexOf('pass_enabled=1') >= 0) { return; }\r\n      if (!(this.isEnabled = !!$('#g-recaptcha, #captcha-forced-noscript') || !$.id('postForm'))) { return; }\r\n\r\n      if (this.noscript = Conf['Force Noscript Captcha'] || !Main.jsEnabled) {\r\n        $.addClass(QR.nodes.el, 'noscript-captcha');\r\n      }\r\n\r\n      Captcha.cache.init();\r\n      $.on(d, 'CaptchaCount', this.count.bind(this));\r\n\r\n      const root = $.el('div', { className: 'captcha-root' });\r\n      $.extend(root, {\r\n        innerHTML:\r\n          '<div class=\"captcha-counter\"><a href=\"javascript:;\"></a></div>'\r\n      }\r\n      );\r\n      const counter = $('.captcha-counter > a', root);\r\n      this.nodes = { root, counter };\r\n      this.count();\r\n      $.addClass(QR.nodes.el, 'has-captcha', 'captcha-v2');\r\n      $.after(QR.nodes.com.parentNode, root);\r\n\r\n      $.on(counter, 'click', this.toggle.bind(this));\r\n      $.on(counter, 'keydown', e => {\r\n        if (Keybinds.keyCode(e) !== 'Space') { return; }\r\n        this.toggle();\r\n        e.preventDefault();\r\n        return e.stopPropagation();\r\n      });\r\n      return $.on(window, 'captcha:success', () => {\r\n        // XXX Greasemonkey 1.x workaround to gain access to GM_* functions.\r\n        return $.queueTask(() => this.save(false));\r\n      });\r\n    },\r\n\r\n    timeouts: {},\r\n    prevNeeded: 0,\r\n\r\n    noscriptURL() {\r\n      let lang;\r\n      let url = `https://www.google.com/recaptcha/api/fallback?k=${meta.recaptchaKey}`;\r\n      if (lang = Conf['captchaLanguage'].trim()) {\r\n        url += `&hl=${encodeURIComponent(lang)}`;\r\n      }\r\n      return url;\r\n    },\r\n\r\n    moreNeeded() {\r\n      // Post count temporarily off by 1 when called from QR.post.rm, QR.close, or QR.submit\r\n      return $.queueTask(() => {\r\n        const needed = Captcha.cache.needed();\r\n        if (needed && !this.prevNeeded) {\r\n          this.setup(QR.cooldown.auto && (d.activeElement === QR.nodes.status));\r\n        }\r\n        return this.prevNeeded = needed;\r\n      });\r\n    },\r\n\r\n    toggle() {\r\n      if (this.nodes.container && !this.timeouts.destroy) {\r\n        return this.destroy();\r\n      } else {\r\n        return this.setup(true, true);\r\n      }\r\n    },\r\n\r\n    setup(focus, force) {\r\n      if (!this.isEnabled || (!Captcha.cache.needed() && !force)) { return; }\r\n\r\n      if (focus) {\r\n        $.addClass(QR.nodes.el, 'focus');\r\n        this.nodes.counter.focus();\r\n      }\r\n\r\n      if (this.timeouts.destroy) {\r\n        clearTimeout(this.timeouts.destroy);\r\n        delete this.timeouts.destroy;\r\n        return this.reload();\r\n      }\r\n\r\n      if (this.nodes.container) {\r\n        // XXX https://bugzilla.mozilla.org/show_bug.cgi?id=1226835\r\n        $.queueTask(() => {\r\n          let iframe;\r\n          if (this.nodes.container && (d.activeElement === this.nodes.counter) && (iframe = $('iframe[src^=\"https://www.google.com/recaptcha/\"]', this.nodes.container))) {\r\n            iframe.focus();\r\n            return QR.focus();\r\n          }\r\n        }); // Event handler not fired in Firefox\r\n        return;\r\n      }\r\n\r\n      this.nodes.container = $.el('div', { className: 'captcha-container' });\r\n      $.prepend(this.nodes.root, this.nodes.container);\r\n      new MutationObserver(this.afterSetup.bind(this)).observe(this.nodes.container, {\r\n        childList: true,\r\n        subtree: true\r\n      }\r\n      );\r\n\r\n      if (this.noscript) {\r\n        return this.setupNoscript();\r\n      } else {\r\n        return this.setupJS();\r\n      }\r\n    },\r\n\r\n    setupNoscript() {\r\n      const iframe = $.el('iframe', {\r\n        id: 'qr-captcha-iframe',\r\n        scrolling: 'no',\r\n        src: this.noscriptURL()\r\n      }\r\n      );\r\n      const div = $.el('div');\r\n      const textarea = $.el('textarea');\r\n      $.add(div, textarea);\r\n      return $.add(this.nodes.container, [iframe, div]);\r\n    },\r\n\r\n    setupJS() {\r\n      return $.global(function () {\r\n        const render = function () {\r\n          const { classList } = document.documentElement;\r\n          const container = document.querySelector('#qr .captcha-container');\r\n          return container.dataset.widgetID = window.grecaptcha.render(container, {\r\n            sitekey: meta.recaptchaKey,\r\n            theme: classList.contains('tomorrow') || classList.contains('spooky') || classList.contains('dark-captcha') ? 'dark' : 'light',\r\n            callback(response) {\r\n              return window.dispatchEvent(new CustomEvent('captcha:success', { detail: response }));\r\n            }\r\n          }\r\n          );\r\n        };\r\n        if (window.grecaptcha) {\r\n          return render();\r\n        } else {\r\n          const cbNative = window.onRecaptchaLoaded;\r\n          window.onRecaptchaLoaded = function () {\r\n            render();\r\n            return cbNative();\r\n          };\r\n          if (!document.head.querySelector('script[src^=\"https://www.google.com/recaptcha/api.js\"]')) {\r\n            const script = document.createElement('script');\r\n            script.src = 'https://www.google.com/recaptcha/api.js?onload=onRecaptchaLoaded&render=explicit';\r\n            return document.head.appendChild(script);\r\n          }\r\n        }\r\n      });\r\n    },\r\n\r\n    afterSetup(mutations) {\r\n      for (var mutation of mutations) {\r\n        for (var node of mutation.addedNodes) {\r\n          var iframe, textarea;\r\n          if (iframe = $.x('./descendant-or-self::iframe[starts-with(@src, \"https://www.google.com/recaptcha/\")]', node)) { this.setupIFrame(iframe); }\r\n          if (textarea = $.x('./descendant-or-self::textarea', node)) { this.setupTextArea(textarea); }\r\n        }\r\n      }\r\n    },\r\n\r\n    setupIFrame(iframe) {\r\n      let needle;\r\n      if (!doc.contains(iframe)) { return; }\r\n      Captcha.replace.iframe(iframe);\r\n      $.addClass(QR.nodes.el, 'captcha-open');\r\n      this.fixQRPosition();\r\n      $.on(iframe, 'load', this.fixQRPosition);\r\n      if (d.activeElement === this.nodes.counter) { iframe.focus(); }\r\n      // XXX Make sure scroll on space prevention (see src/css/style.css) doesn't cause scrolling of div\r\n      if (['blink', 'edge'].includes($.engine) && (needle = iframe.parentNode, $$('#qr .captcha-container > div > div:first-of-type').includes(needle))) {\r\n        return $.on(iframe.parentNode, 'scroll', function () { return this.scrollTop = 0; });\r\n      }\r\n    },\r\n\r\n    fixQRPosition() {\r\n      if (QR.nodes.el.getBoundingClientRect().bottom > doc.clientHeight) {\r\n        QR.nodes.el.style.top = '';\r\n        return QR.nodes.el.style.bottom = '0px';\r\n      }\r\n    },\r\n\r\n    setupTextArea(textarea) {\r\n      return $.one(textarea, 'input', () => this.save(true));\r\n    },\r\n\r\n    destroy() {\r\n      if (!this.isEnabled) { return; }\r\n      delete this.timeouts.destroy;\r\n      $.rmClass(QR.nodes.el, 'captcha-open');\r\n      if (this.nodes.container) {\r\n        $.global(function () {\r\n          const container = document.querySelector('#qr .captcha-container');\r\n          return window.grecaptcha.reset(container.dataset.widgetID);\r\n        });\r\n        $.rm(this.nodes.container);\r\n        return delete this.nodes.container;\r\n      }\r\n    },\r\n\r\n    getOne(isReply) {\r\n      return Captcha.cache.getOne(isReply);\r\n    },\r\n\r\n    save(pasted, token) {\r\n      Captcha.cache.save({\r\n        response: token || $('textarea', this.nodes.container).value,\r\n        timeout: Date.now() + this.lifetime\r\n      });\r\n\r\n      const focus = (d.activeElement?.nodeName === 'IFRAME') && /https?:\\/\\/www\\.google\\.com\\/recaptcha\\//.test(d.activeElement.src);\r\n      if (Captcha.cache.needed()) {\r\n        if (focus) {\r\n          if (QR.cooldown.auto || Conf['Post on Captcha Completion']) {\r\n            this.nodes.counter.focus();\r\n          } else {\r\n            QR.nodes.status.focus();\r\n          }\r\n        }\r\n        this.reload();\r\n      } else {\r\n        if (pasted) {\r\n          this.destroy();\r\n        } else {\r\n          if (this.timeouts.destroy == null) { this.timeouts.destroy = setTimeout(this.destroy.bind(this), 3 * SECOND); }\r\n        }\r\n        if (focus) { QR.nodes.status.focus(); }\r\n      }\r\n\r\n      if (Conf['Post on Captcha Completion'] && !QR.cooldown.auto) { return QR.submit(); }\r\n    },\r\n\r\n    count() {\r\n      const count = Captcha.cache.getCount();\r\n      const loading = Captcha.cache.submitCB ? '...' : '';\r\n      this.nodes.counter.textContent = `Captchas: ${count}${loading}`;\r\n      return this.moreNeeded();\r\n    },\r\n\r\n    reload() {\r\n      if ($('iframe[src^=\"https://www.google.com/recaptcha/api/fallback?\"]', this.nodes.container)) {\r\n        this.destroy();\r\n        return this.setup(false, true);\r\n      } else {\r\n        return $.global(function () {\r\n          const container = document.querySelector('#qr .captcha-container');\r\n          return window.grecaptcha.reset(container.dataset.widgetID);\r\n        });\r\n      }\r\n    },\r\n\r\n    occupied() {\r\n      return !!this.nodes.container && !this.timeouts.destroy;\r\n    }\r\n  }\r\n};\r\nexport default Captcha;\r\n","import QuickReplyPage from './QR/QuickReply.html';\r\nimport $ from '../platform/$';\r\nimport Callbacks from '../classes/Callbacks';\r\nimport Notice from '../classes/Notice';\r\nimport Main from '../main/Main';\r\nimport Favicon from '../Monitoring/Favicon';\r\nimport $$ from '../platform/$$';\r\nimport CrossOrigin from '../platform/CrossOrigin';\r\nimport Captcha from './Captcha';\r\nimport meta from '../../package.json';\r\nimport Header from '../General/Header';\r\nimport { Conf, E, d, doc, g } from '../globals/globals';\r\nimport Menu from '../Menu/Menu';\r\nimport UI from '../General/UI';\r\nimport BoardConfig from '../General/BoardConfig';\r\nimport Get from '../General/Get';\r\nimport { DAY, dict, SECOND } from '../platform/helpers';\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS202: Simplify dynamic range loops\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\n\r\nvar QR = {\r\n  mimeTypes: ['image/jpeg', 'image/png', 'image/gif', 'application/pdf', 'application/vnd.adobe.flash.movie', 'application/x-shockwave-flash', 'video/webm'],\r\n\r\n  validExtension: /\\.(jpe?g|png|gif|pdf|swf|webm)$/i,\r\n\r\n  typeFromExtension: {\r\n    'jpg':  'image/jpeg',\r\n    'jpeg': 'image/jpeg',\r\n    'png':  'image/png',\r\n    'gif':  'image/gif',\r\n    'pdf':  'application/pdf',\r\n    'swf':  'application/vnd.adobe.flash.movie',\r\n    'webm': 'video/webm'\r\n  },\r\n\r\n  extensionFromType: {\r\n    'image/jpeg': 'jpg',\r\n    'image/png': 'png',\r\n    'image/gif': 'gif',\r\n    'application/pdf': 'pdf',\r\n    'application/vnd.adobe.flash.movie': 'swf',\r\n    'application/x-shockwave-flash': 'swf',\r\n    'video/webm': 'webm'\r\n  },\r\n\r\n  init() {\r\n    let sc;\r\n    if (!Conf['Quick Reply']) { return; }\r\n\r\n    this.posts = [];\r\n\r\n    $.on(d, '4chanXInitFinished', () => BoardConfig.ready(QR.initReady));\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Quick Reply',\r\n      cb:   this.node\r\n    });\r\n\r\n    this.shortcut = (sc = $.el('a', {\r\n      className: 'disabled bolder-icon bigger-icon',\r\n      textContent: 'Quick Reply',\r\n      title: 'Quick Reply',\r\n      href: 'javascript:;',\r\n    }));\r\n    $.on(sc, 'click', function() {\r\n      if (!QR.postingIsEnabled) { return; }\r\n      if (Conf['Persistent QR'] || !QR.nodes || QR.nodes.el.hidden) {\r\n        QR.open();\r\n        return QR.nodes.com.focus();\r\n      } else {\r\n        return QR.close();\r\n      }\r\n    });\r\n\r\n    return Header.addShortcut('qr', sc, 540, '↩');\r\n  },\r\n\r\n  initReady() {\r\n    let origToggle;\r\n    const captchaVersion = $('#g-recaptcha, #captcha-forced-noscript') ? 'v2' : 't';\r\n    QR.captcha = Captcha[captchaVersion];\r\n    QR.postingIsEnabled = true;\r\n\r\n    const {config} = g.BOARD;\r\n    const prop = (key, def) => +(config[key] ?? def);\r\n\r\n    QR.min_width  = prop('min_image_width',  1);\r\n    QR.min_height = prop('min_image_height', 1);\r\n    QR.max_width  = (QR.max_height = 10000);\r\n\r\n    QR.max_size       = prop('max_filesize',      4194304);\r\n    QR.max_size_video = prop('max_webm_filesize', QR.max_size);\r\n    QR.max_comment    = prop('max_comment_chars', 2000);\r\n\r\n    QR.max_width_video = (QR.max_height_video = 2048);\r\n    QR.max_duration_video = prop('max_webm_duration', 120);\r\n\r\n    QR.forcedAnon = !!config.forced_anon;\r\n    QR.spoiler    = !!config.spoilers;\r\n\r\n    if (origToggle = $.id('togglePostFormLink')) {\r\n      const link = $.el('h1',\r\n        {className: \"qr-link-container\"});\r\n      $.extend(link, {\r\n        innerHTML:\r\n          `<a href=\"javascript:;\" class=\"qr-link\">${g.VIEW === \"thread\" ? \"Reply to Thread\" : \"Start a Thread\"}</a>`\r\n      });\r\n\r\n      QR.link = link.firstElementChild;\r\n      $.on(link.firstChild, 'click', function() {\r\n        QR.open();\r\n        return QR.nodes.com.focus();\r\n      });\r\n\r\n      $.before(origToggle, link);\r\n      origToggle.firstElementChild.textContent = 'Original Form';\r\n    }\r\n\r\n    if (g.VIEW === 'thread') {\r\n      let navLinksBot;\r\n      const linkBot = $.el('div',\r\n        {className: \"brackets-wrap qr-link-container-bottom\"});\r\n      $.extend(linkBot, {innerHTML: '<a href=\"javascript:;\" class=\"qr-link-bottom\">Reply to Thread</a>'});\r\n\r\n      $.on(linkBot.firstElementChild, 'click', function() {\r\n        QR.open();\r\n        return QR.nodes.com.focus();\r\n      });\r\n\r\n      if (navLinksBot = $('.navLinksBot')) { $.prepend(navLinksBot, linkBot); }\r\n    }\r\n\r\n    $.on(d, 'QRGetFile',          QR.getFile);\r\n    $.on(d, 'QRDrawFile',         QR.drawFile);\r\n    $.on(d, 'QRSetFile',          QR.setFile);\r\n\r\n    $.on(d, 'paste',              QR.paste);\r\n    $.on(d, 'dragover',           QR.dragOver);\r\n    $.on(d, 'drop',               QR.dropFile);\r\n    $.on(d, 'dragstart dragend',  QR.drag);\r\n\r\n    $.on(d, 'IndexRefreshInternal', QR.generatePostableThreadsList);\r\n    $.on(d, 'ThreadUpdate', QR.statusCheck);\r\n\r\n    if (!Conf['Persistent QR']) { return; }\r\n    QR.open();\r\n    if (Conf['Auto Hide QR']) { return QR.hide(); }\r\n  },\r\n\r\n  statusCheck() {\r\n    if (!QR.nodes) { return; }\r\n    const {thread} = QR.posts[0];\r\n    if ((thread !== 'new') && g.threads.get(`${g.BOARD}.${thread}`).isDead) {\r\n      return QR.abort();\r\n    } else {\r\n      return QR.status();\r\n    }\r\n  },\r\n\r\n  node() {\r\n    $.on(this.nodes.quote, 'click', QR.quote);\r\n    if (this.isFetchedQuote) { return QR.generatePostableThreadsList(); }\r\n  },\r\n\r\n  open() {\r\n    if (QR.nodes) {\r\n      if (QR.nodes.el.hidden) { QR.captcha.setup(); }\r\n      QR.nodes.el.hidden = false;\r\n      QR.unhide();\r\n    } else {\r\n      try {\r\n        QR.dialog();\r\n      } catch (err) {\r\n        delete QR.nodes;\r\n        Main.handleErrors({\r\n          message: 'Quick Reply dialog creation crashed.',\r\n          error: err\r\n        });\r\n        return;\r\n      }\r\n    }\r\n    return $.rmClass(QR.shortcut, 'disabled');\r\n  },\r\n\r\n  close() {\r\n    if (QR.req) {\r\n      QR.abort();\r\n      return;\r\n    }\r\n    QR.nodes.el.hidden = true;\r\n    QR.cleanNotifications();\r\n    QR.blur();\r\n    $.rmClass(QR.nodes.el, 'dump');\r\n    $.addClass(QR.shortcut, 'disabled');\r\n    new QR.post(true);\r\n    for (var post of QR.posts.splice(0, QR.posts.length - 1)) {\r\n      post.delete();\r\n    }\r\n    QR.cooldown.auto = false;\r\n    QR.status();\r\n    return QR.captcha.destroy();\r\n  },\r\n\r\n  focus() {\r\n    return $.queueTask(function() {\r\n      if (!QR.inBubble()) {\r\n        QR.hasFocus = d.activeElement && QR.nodes.el.contains(d.activeElement);\r\n        return QR.nodes.el.classList.toggle('focus', QR.hasFocus);\r\n      }\r\n    });\r\n  },\r\n\r\n  inBubble() {\r\n    const bubbles = $$('iframe[src^=\"https://www.google.com/recaptcha/api2/frame\"]');\r\n    return bubbles.includes(d.activeElement) || bubbles.some(el => (getComputedStyle(el).visibility !== 'hidden') && (el.getBoundingClientRect().bottom > 0));\r\n  },\r\n\r\n  hide() {\r\n    QR.blur();\r\n    $.addClass(QR.nodes.el, 'autohide');\r\n    return QR.nodes.autohide.checked = true;\r\n  },\r\n\r\n  unhide() {\r\n    $.rmClass(QR.nodes.el, 'autohide');\r\n    return QR.nodes.autohide.checked = false;\r\n  },\r\n\r\n  toggleHide() {\r\n    if (this.checked) {\r\n      return QR.hide();\r\n    } else {\r\n      return QR.unhide();\r\n    }\r\n  },\r\n\r\n  blur() {\r\n    if (QR.nodes.el.contains(d.activeElement)) { return d.activeElement.blur(); }\r\n  },\r\n\r\n  toggleSJIS(e) {\r\n    e.preventDefault();\r\n    Conf['sjisPreview'] = !Conf['sjisPreview'];\r\n    $.set('sjisPreview', Conf['sjisPreview']);\r\n    return QR.nodes.el.classList.toggle('sjis-preview', Conf['sjisPreview']);\r\n  },\r\n\r\n  texPreviewShow() {\r\n    if ($.hasClass(QR.nodes.el, 'tex-preview')) { return QR.texPreviewHide(); }\r\n    $.addClass(QR.nodes.el, 'tex-preview');\r\n    QR.nodes.texPreview.textContent = QR.nodes.com.value;\r\n    return $.event('mathjax', null, QR.nodes.texPreview);\r\n  },\r\n\r\n  texPreviewHide() {\r\n    return $.rmClass(QR.nodes.el, 'tex-preview');\r\n  },\r\n\r\n  addPost() {\r\n    const wasOpen = (QR.nodes && !QR.nodes.el.hidden);\r\n    QR.open();\r\n    if (wasOpen) {\r\n      $.addClass(QR.nodes.el, 'dump');\r\n      new QR.post(true);\r\n    }\r\n    return QR.nodes.com.focus();\r\n  },\r\n\r\n  setCustomCooldown(enabled) {\r\n    Conf['customCooldownEnabled'] = enabled;\r\n    QR.cooldown.customCooldown = enabled;\r\n    return QR.nodes.customCooldown.classList.toggle('disabled', !enabled);\r\n  },\r\n\r\n  toggleCustomCooldown() {\r\n    const enabled = $.hasClass(QR.nodes.customCooldown, 'disabled');\r\n    QR.setCustomCooldown(enabled);\r\n    return $.set('customCooldownEnabled', enabled);\r\n  },\r\n\r\n  error(err, focusOverride) {\r\n    let el;\r\n    QR.open();\r\n    if (typeof err === 'string') {\r\n      el = $.tn(err);\r\n    } else {\r\n      el = err;\r\n      el.removeAttribute('style');\r\n    }\r\n    const notice = new Notice('warning', el);\r\n    QR.notifications.push(notice);\r\n    if (!Header.areNotificationsEnabled) {\r\n      if (d.hidden && !QR.cooldown.auto) { return alert(el.textContent); }\r\n    } else if (d.hidden || !(focusOverride || d.hasFocus())) {\r\n      const notif = new Notification(el.textContent, {\r\n        body: el.textContent,\r\n        icon: Favicon.logo\r\n      }\r\n      );\r\n      notif.onclick = () => window.focus();\r\n      if ($.engine !== 'gecko') {\r\n        // Firefox automatically closes notifications\r\n        // so we can't control the onclose properly.\r\n        notif.onclose = () => notice.close();\r\n        return notif.onshow  = () => setTimeout(function() {\r\n          notif.onclose = null;\r\n          return notif.close();\r\n        }\r\n        , 7 * SECOND);\r\n      }\r\n    }\r\n  },\r\n\r\n  connectionError() {\r\n    return $.el('span',\r\n      { innerHTML:\r\n        'Connection error while posting. ' +\r\n        '[<a href=\"' + meta.faq + '#connection-errors\" target=\"_blank\">More info</a>]'\r\n      }\r\n    );\r\n  },\r\n\r\n  notifications: [],\r\n\r\n  cleanNotifications() {\r\n    for (var notification of QR.notifications) {\r\n      notification.close();\r\n    }\r\n    return QR.notifications = [];\r\n  },\r\n\r\n  status() {\r\n    let disabled, value;\r\n    if (!QR.nodes) { return; }\r\n    const {thread} = QR.posts[0];\r\n    if ((thread !== 'new') && g.threads.get(`${g.BOARD}.${thread}`).isDead) {\r\n      value    = 'Dead';\r\n      disabled = true;\r\n      QR.cooldown.auto = false;\r\n    }\r\n\r\n    value = QR.req ?\r\n      QR.req.progress\r\n    :\r\n      QR.cooldown.seconds || value;\r\n\r\n    const {status} = QR.nodes;\r\n    status.value = !value ?\r\n      'Submit'\r\n    : QR.cooldown.auto ?\r\n      `Auto ${value}`\r\n    :\r\n      value;\r\n    return status.disabled = disabled || false;\r\n  },\r\n\r\n  openPost() {\r\n    QR.open();\r\n    if (QR.selected.isLocked) {\r\n      const index = QR.posts.indexOf(QR.selected);\r\n      (QR.posts[index+1] || new QR.post()).select();\r\n      $.addClass(QR.nodes.el, 'dump');\r\n      return QR.cooldown.auto = true;\r\n    }\r\n  },\r\n\r\n  quote(e) {\r\n    let range;\r\n    e?.preventDefault();\r\n    if (!QR.postingIsEnabled) { return; }\r\n    const sel  = d.getSelection();\r\n    const post = Get.postFromNode(this);\r\n    const {root} = post.nodes;\r\n    const postRange = new Range();\r\n    postRange.selectNode(root);\r\n    let text = post.board.ID === g.BOARD.ID ? `>>${post}\\n` : `>>>/${post.board}/${post}\\n`;\r\n    for (let i = 0, end = sel.rangeCount, asc = 0 <= end; asc ? i < end : i > end; asc ? i++ : i--) {\r\n      try {\r\n        var insideCode, node;\r\n        range = sel.getRangeAt(i);\r\n        // Trim range to be fully inside post\r\n        if (range.compareBoundaryPoints(Range.START_TO_START, postRange) < 0) {\r\n          range.setStartBefore(root);\r\n        }\r\n        if (range.compareBoundaryPoints(Range.END_TO_END, postRange) > 0) {\r\n          range.setEndAfter(root);\r\n        }\r\n\r\n        if (!range.toString().trim()) { continue; }\r\n\r\n        var frag  = range.cloneContents();\r\n        var ancestor = range.commonAncestorContainer;\r\n        // Quoting the insides of a spoiler/code tag.\r\n        if ($.x('ancestor-or-self::*[self::s or contains(@class,\"removed-spoiler\")]', ancestor)) {\r\n          $.prepend(frag, $.tn('[spoiler]'));\r\n          $.add(frag, $.tn('[/spoiler]'));\r\n        }\r\n        if (insideCode = $.x('ancestor-or-self::pre[contains(@class,\"prettyprint\")]', ancestor)) {\r\n          $.prepend(frag, $.tn('[code]'));\r\n          $.add(frag, $.tn('[/code]'));\r\n        }\r\n        for (node of $$((insideCode ? 'br' : '.prettyprint br'), frag)) {\r\n          $.replace(node, $.tn('\\n'));\r\n        }\r\n        for (node of $$('br', frag)) {\r\n          if (node !== frag.lastChild) { $.replace(node, $.tn('\\n>')); }\r\n        }\r\n        g.SITE.insertTags?.(frag);\r\n        for (node of $$('.linkify[data-original]', frag)) {\r\n          $.replace(node, $.tn(node.dataset.original));\r\n        }\r\n        for (node of $$('.embedder', frag)) {\r\n          if (node.previousSibling?.nodeValue === ' ') { $.rm(node.previousSibling); }\r\n          $.rm(node);\r\n        }\r\n        text += `>${frag.textContent.trim()}\\n`;\r\n      } catch (error) { }\r\n    }\r\n\r\n    QR.openPost();\r\n    const {com, thread} = QR.nodes;\r\n    if (!com.value) { thread.value = Get.threadFromNode(this); }\r\n\r\n    const wasOnlyQuotes = QR.selected.isOnlyQuotes();\r\n\r\n    const caretPos = com.selectionStart;\r\n    // Replace selection for text.\r\n    com.value = com.value.slice(0, caretPos) + text + com.value.slice(com.selectionEnd);\r\n    // Move the caret to the end of the new quote.\r\n    range = caretPos + text.length;\r\n    com.setSelectionRange(range, range);\r\n    com.focus();\r\n\r\n    // This allows us to determine if any text other than quotes has been typed.\r\n    if (wasOnlyQuotes) { QR.selected.quotedText = com.value; }\r\n\r\n    QR.selected.save(com);\r\n    return QR.selected.save(thread);\r\n  },\r\n\r\n  characterCount() {\r\n    const counter = QR.nodes.charCount;\r\n    const count   = QR.nodes.com.value.replace(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g, '_').length;\r\n    counter.textContent = count;\r\n    counter.hidden      = count < (QR.max_comment/2);\r\n    return (count > QR.max_comment ? $.addClass : $.rmClass)(counter, 'warning');\r\n  },\r\n\r\n  getFile() {\r\n    return $.event('QRFile', QR.selected?.file);\r\n  },\r\n\r\n  drawFile(e) {\r\n    const file = QR.selected?.file;\r\n    if (!file || !/^(image|video)\\//.test(file.type)) { return; }\r\n    const isVideo = /^video\\//.test(file);\r\n    const el = $.el((isVideo ? 'video' : 'img'));\r\n    $.on(el, 'error', () => QR.openError());\r\n    $.on(el, (isVideo ? 'loadeddata' : 'load'), function() {\r\n      e.target.getContext('2d').drawImage(el, 0, 0);\r\n      URL.revokeObjectURL(el.src);\r\n      return $.event('QRImageDrawn', null, e.target);\r\n    });\r\n    return el.src = URL.createObjectURL(file);\r\n  },\r\n\r\n  openError() {\r\n    const div = $.el('div');\r\n    $.extend(div, {\r\n      innerHTML:\r\n        'Could not open file. [<a href=\"' + E(meta.faq) + '#error-reading-metadata\" target=\"_blank\">More info</a>]'\r\n    });\r\n    return QR.error(div);\r\n  },\r\n\r\n  setFile(e) {\r\n    const {file, name, source} = e.detail;\r\n    if (name != null) { file.name   = name; }\r\n    if (source != null) { file.source = source; }\r\n    QR.open();\r\n    return QR.handleFiles([file]);\r\n  },\r\n\r\n  drag(e) {\r\n    // Let it drag anything from the page.\r\n    const toggle = e.type === 'dragstart' ? $.off : $.on;\r\n    toggle(d, 'dragover', QR.dragOver);\r\n    return toggle(d, 'drop',     QR.dropFile);\r\n  },\r\n\r\n  dragOver(e) {\r\n    e.preventDefault();\r\n    return e.dataTransfer.dropEffect = 'copy';\r\n  }, // cursor feedback\r\n\r\n  dropFile(e) {\r\n    // Let it only handle files from the desktop.\r\n    if (!e.dataTransfer.files.length) { return; }\r\n    e.preventDefault();\r\n    QR.open();\r\n    return QR.handleFiles(e.dataTransfer.files);\r\n  },\r\n\r\n  paste(e) {\r\n    if (!e.clipboardData.items) { return; }\r\n    let file = null;\r\n    let score = -1;\r\n    for (var item of e.clipboardData.items) {\r\n      var file2;\r\n      if ((item.kind === 'file') && (file2 = item.getAsFile())) {\r\n        var score2 = (2*(file2.size <= QR.max_size)) + (file2.type === 'image/png');\r\n        if (score2 > score) {\r\n          file = file2;\r\n          score = score2;\r\n        }\r\n      }\r\n    }\r\n    if (file) {\r\n      const {type} = file;\r\n      const blob = new Blob([file], {type});\r\n      blob.name = `${Conf['pastedname']}.${$.getOwn(QR.extensionFromType, type) || 'jpg'}`;\r\n      QR.open();\r\n      QR.handleFiles([blob]);\r\n      $.addClass(QR.nodes.el, 'dump');\r\n    }\r\n  },\r\n\r\n  pasteFF() {\r\n    const {pasteArea} = QR.nodes;\r\n    if (!pasteArea.childNodes.length) { return; }\r\n    const images = $$('img', pasteArea);\r\n    $.rmAll(pasteArea);\r\n    for (var img of images) {\r\n      var m;\r\n      var {src} = img;\r\n      if (m = src.match(/data:(image\\/(\\w+));base64,(.+)/)) {\r\n        var bstr = atob(m[3]);\r\n        var arr = new Uint8Array(bstr.length);\r\n        for (var i = 0, end = bstr.length, asc = 0 <= end; asc ? i < end : i > end; asc ? i++ : i--) {\r\n          arr[i] = bstr.charCodeAt(i);\r\n        }\r\n        var blob = new Blob([arr], {type: m[1]});\r\n        blob.name = `${Conf['pastedname']}.${m[2]}`;\r\n        QR.handleFiles([blob]);\r\n      } else if (/^https?:\\/\\//.test(src)) {\r\n        QR.handleUrl(src);\r\n      }\r\n    }\r\n  },\r\n\r\n  handleUrl(urlDefault) {\r\n    QR.open();\r\n    QR.selected.preventAutoPost();\r\n    return CrossOrigin.permission(function() {\r\n      const url = prompt('Enter a URL:', urlDefault);\r\n      if (url === null) { return; }\r\n      QR.nodes.fileButton.focus();\r\n      return CrossOrigin.file(url, function(blob) {\r\n        if (blob && !/^text\\//.test(blob.type)) {\r\n          return QR.handleFiles([blob]);\r\n        } else {\r\n          return QR.error(\"Can't load file.\");\r\n        }\r\n      });\r\n    });\r\n  },\r\n\r\n  handleFiles(files) {\r\n    if (this !== QR) { // file input\r\n      files  = [...this.files];\r\n      this.value = null;\r\n    }\r\n    if (!files.length) { return; }\r\n    QR.cleanNotifications();\r\n    for (var file of files) {\r\n      QR.handleFile(file, files.length);\r\n    }\r\n    if (files.length !== 1) { $.addClass(QR.nodes.el, 'dump'); }\r\n    if ((d.activeElement === QR.nodes.fileButton) && $.hasClass(QR.nodes.fileSubmit, 'has-file')) {\r\n      return QR.nodes.filename.focus();\r\n    }\r\n  },\r\n\r\n  handleFile(file, nfiles) {\r\n    let post;\r\n    const isText = /^text\\//.test(file.type);\r\n    if (nfiles === 1) {\r\n      post = QR.selected;\r\n    } else {\r\n      post = QR.posts[QR.posts.length - 1];\r\n      if (isText ? post.com || post.pasting : post.file) {\r\n        post = new QR.post();\r\n      }\r\n    }\r\n    return post[isText ? 'pasteText' : 'setFile'](file);\r\n  },\r\n\r\n  openFileInput() {\r\n    if (QR.nodes.fileButton.disabled) { return; }\r\n    QR.nodes.fileInput.click();\r\n    return QR.nodes.fileButton.focus();\r\n  },\r\n\r\n  generatePostableThreadsList() {\r\n    if (!QR.nodes) { return; }\r\n    const list    = QR.nodes.thread;\r\n    const options = [list.firstElementChild];\r\n    for (var thread of g.BOARD.threads.keys) {\r\n      options.push($.el('option', {\r\n        value: thread,\r\n        textContent: `Thread ${thread}`\r\n      }\r\n      )\r\n      );\r\n    }\r\n    const val = list.value;\r\n    $.rmAll(list);\r\n    $.add(list, options);\r\n    list.value = val;\r\n    if (list.value === val) { return; }\r\n    // Fix the value if the option disappeared.\r\n    list.value = g.VIEW === 'thread' ?\r\n      g.THREADID\r\n    :\r\n      'new';\r\n    return (g.VIEW === 'thread' ? $.addClass : $.rmClass)(QR.nodes.el, 'reply-to-thread');\r\n  },\r\n\r\n  dialog() {\r\n    let dialog, event, nodes;\r\n    let name;\r\n    QR.nodes = (nodes = {\r\n      el: (dialog = UI.dialog('qr',\r\n        { innerHTML: QuickReplyPage }))\r\n    });\r\n\r\n    const setNode = (name, query) => nodes[name] = $(query, dialog);\r\n\r\n    setNode('move',           '.move');\r\n    setNode('autohide',       '#autohide');\r\n    setNode('close',          '.close');\r\n    setNode('thread',         'select');\r\n    setNode('form',           'form');\r\n    setNode('sjisToggle',     '#sjis-toggle');\r\n    setNode('texButton',      '#tex-preview-button');\r\n    setNode('name',           '[data-name=name]');\r\n    setNode('email',          '[data-name=email]');\r\n    setNode('sub',            '[data-name=sub]');\r\n    setNode('com',            '[data-name=com]');\r\n    setNode('charCount',      '#char-count');\r\n    setNode('texPreview',     '#tex-preview');\r\n    setNode('dumpList',       '#dump-list');\r\n    setNode('addPost',        '#add-post');\r\n    setNode('oekaki',         '.oekaki');\r\n    setNode('drawButton',     '#qr-draw-button');\r\n    setNode('fileSubmit',     '#file-n-submit');\r\n    setNode('fileButton',     '#qr-file-button');\r\n    setNode('noFile',         '#qr-no-file');\r\n    setNode('filename',       '#qr-filename');\r\n    setNode('spoiler',        '#qr-file-spoiler');\r\n    setNode('oekakiButton',   '#qr-oekaki-button');\r\n    setNode('fileRM',         '#qr-filerm');\r\n    setNode('urlButton',      '#url-button');\r\n    setNode('pasteArea',      '#paste-area');\r\n    setNode('customCooldown', '#custom-cooldown-button');\r\n    setNode('dumpButton',     '#dump-button');\r\n    setNode('status',         '[type=submit]');\r\n    setNode('flashTag',       '[name=filetag]');\r\n    setNode('fileInput',      '[type=file]');\r\n\r\n    const {config} = g.BOARD;\r\n    const {classList} = QR.nodes.el;\r\n    classList.toggle('forced-anon',  QR.forcedAnon);\r\n    classList.toggle('has-spoiler',  QR.spoiler);\r\n    classList.toggle('has-sjis',     !!config.sjis_tags);\r\n    classList.toggle('has-math',     !!config.math_tags);\r\n    classList.toggle('sjis-preview', !!config.sjis_tags && Conf['sjisPreview']);\r\n    classList.toggle('show-new-thread-option', Conf['Show New Thread Option in Threads']);\r\n\r\n    if (parseInt(Conf['customCooldown'], 10) > 0) {\r\n      $.addClass(QR.nodes.fileSubmit, 'custom-cooldown');\r\n      $.get('customCooldownEnabled', Conf['customCooldownEnabled'], function({customCooldownEnabled}) {\r\n        QR.setCustomCooldown(customCooldownEnabled);\r\n        return $.sync('customCooldownEnabled', QR.setCustomCooldown);\r\n      });\r\n    }\r\n\r\n    QR.flagsInput();\r\n\r\n    $.on(nodes.autohide,       'change',    QR.toggleHide);\r\n    $.on(nodes.close,          'click',     QR.close);\r\n    $.on(nodes.status,         'click',     QR.submit);\r\n    $.on(nodes.form,           'submit',    QR.submit);\r\n    $.on(nodes.sjisToggle,     'click',     QR.toggleSJIS);\r\n    $.on(nodes.texButton,      'mousedown', QR.texPreviewShow);\r\n    $.on(nodes.texButton,      'mouseup',   QR.texPreviewHide);\r\n    $.on(nodes.addPost,        'click',     () => new QR.post(true));\r\n    $.on(nodes.drawButton,     'click',     QR.oekaki.draw);\r\n    $.on(nodes.fileButton,     'click',     QR.openFileInput);\r\n    $.on(nodes.noFile,         'click',     QR.openFileInput);\r\n    $.on(nodes.filename,       'focus',     function() { return $.addClass(this.parentNode, 'focus'); });\r\n    $.on(nodes.filename,       'blur',      function() { return $.rmClass(this.parentNode, 'focus'); });\r\n    $.on(nodes.spoiler,        'change',    () => QR.selected.nodes.spoiler.click());\r\n    $.on(nodes.oekakiButton,   'click',     QR.oekaki.button);\r\n    $.on(nodes.fileRM,         'click',     () => QR.selected.rmFile());\r\n    $.on(nodes.urlButton,      'click',     () => QR.handleUrl(''));\r\n    $.on(nodes.customCooldown, 'click',     QR.toggleCustomCooldown);\r\n    $.on(nodes.dumpButton,     'click',     () => nodes.el.classList.toggle('dump'));\r\n    $.on(nodes.fileInput,      'change',    QR.handleFiles);\r\n\r\n    window.addEventListener('focus', QR.focus, true);\r\n    window.addEventListener('blur',  QR.focus, true);\r\n    // We don't receive blur events from captcha iframe.\r\n    $.on(d, 'click', QR.focus);\r\n\r\n    // XXX Workaround for image pasting in Firefox, obsolete as of v50.\r\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=906420\r\n    if (($.engine === 'gecko') && !window.DataTransferItemList) {\r\n      nodes.pasteArea.hidden = false;\r\n    }\r\n    new MutationObserver(QR.pasteFF).observe(nodes.pasteArea, {childList: true});\r\n\r\n    // save selected post's data\r\n    const items = ['thread', 'name', 'email', 'sub', 'com', 'filename', 'flag'];\r\n    let i = 0;\r\n    const save = function() { return QR.selected.save(this); };\r\n    while ((name = items[i++])) {\r\n      var node;\r\n      if (!(node = nodes[name])) { continue; }\r\n      event = node.nodeName === 'SELECT' ? 'change' : 'input';\r\n      $.on(nodes[name], event, save);\r\n    }\r\n\r\n    // XXX Blink and WebKit treat width and height of <textarea>s as min-width and min-height\r\n    if (($.engine === 'gecko') && Conf['Remember QR Size']) {\r\n      $.get('QR Size', '', item => nodes.com.style.cssText = item['QR Size']);\r\n      $.on(nodes.com, 'mouseup', function(e) {\r\n        if (e.button !== 0) { return; }\r\n        return $.set('QR Size', this.style.cssText);\r\n      });\r\n    }\r\n\r\n    QR.generatePostableThreadsList();\r\n    QR.persona.load();\r\n    new QR.post(true);\r\n    QR.status();\r\n    QR.cooldown.setup();\r\n    QR.captcha.init();\r\n\r\n    $.add(d.body, dialog);\r\n    QR.captcha.setup();\r\n    QR.oekaki.setup();\r\n\r\n    // Create a custom event when the QR dialog is first initialized.\r\n    // Use it to extend the QR's functionalities, or for XTRM RICE.\r\n    return $.event('QRDialogCreation', null, dialog);\r\n  },\r\n\r\n  flags() {\r\n    const select = $.el('select', {\r\n      name:      'flag',\r\n      className: 'flagSelector'\r\n    }\r\n    );\r\n\r\n    const addFlag = (value, textContent) => $.add(select, $.el('option', {value, textContent}));\r\n\r\n    addFlag('0', (g.BOARD.config.country_flags ? 'Geographic Location' : 'None'));\r\n    for (var value in g.BOARD.config.board_flags) {\r\n      var textContent = g.BOARD.config.board_flags[value];\r\n      addFlag(value, textContent);\r\n    }\r\n\r\n    return select;\r\n  },\r\n\r\n  flagsInput() {\r\n    const {nodes} = QR;\r\n    if (!nodes) { return; }\r\n    if (nodes.flag) {\r\n      $.rm(nodes.flag);\r\n      delete nodes.flag;\r\n    }\r\n\r\n    if (g.BOARD.config.board_flags) {\r\n      const flag = QR.flags();\r\n      flag.dataset.name    = 'flag';\r\n      flag.dataset.default = '0';\r\n      nodes.flag = flag;\r\n      return $.add(nodes.form, flag);\r\n    }\r\n  },\r\n\r\n  submit(e) {\r\n    let captcha, err, filetag;\r\n    e?.preventDefault();\r\n    const force = e?.shiftKey;\r\n\r\n    if (QR.req) {\r\n      QR.abort();\r\n      return;\r\n    }\r\n\r\n    $.forceSync('cooldowns');\r\n    if (QR.cooldown.seconds) {\r\n      if (force) {\r\n        QR.cooldown.clear();\r\n      } else {\r\n        QR.cooldown.auto = !QR.cooldown.auto;\r\n        QR.status();\r\n        return;\r\n      }\r\n    }\r\n\r\n    const post = QR.posts[0];\r\n    delete post.quotedText;\r\n    post.forceSave();\r\n    let threadID = post.thread;\r\n    const thread = g.BOARD.threads.get(threadID);\r\n    if ((g.BOARD.ID === 'f') && (threadID === 'new')) {\r\n      filetag = QR.nodes.flashTag.value;\r\n    }\r\n\r\n    // prevent errors\r\n    if (threadID === 'new') {\r\n      threadID = null;\r\n      if (!!g.BOARD.config.require_subject && !post.sub) {\r\n        err = 'New threads require a subject.';\r\n      } else if (!!!g.BOARD.config.text_only && !post.file) {\r\n        err = 'No file selected.';\r\n      }\r\n    } else if (g.BOARD.threads.get(threadID).isClosed) {\r\n      err = 'You can\\'t reply to this thread anymore.';\r\n    } else if (!post.com && !post.file) {\r\n      err = 'No comment or file.';\r\n    } else if (post.file && thread.fileLimit) {\r\n      err = 'Max limit of image replies has been reached.';\r\n    }\r\n\r\n    if ((g.BOARD.ID === 'r9k') && !post.com?.match(/[a-z-]/i)) {\r\n      if (!err) { err = 'Original comment required.'; }\r\n    }\r\n\r\n    if (QR.captcha.isEnabled && !((QR.captcha === Captcha.v2) && /\\b_ct=/.test(d.cookie) && threadID) && !(err && !force)) {\r\n      captcha = QR.captcha.getOne(!!threadID);\r\n      if (QR.captcha === Captcha.v2) {\r\n        if (!captcha) { captcha = Captcha.cache.request(!!threadID); }\r\n      }\r\n      if (!captcha) {\r\n        err = 'No valid captcha.';\r\n        QR.captcha.setup(!QR.cooldown.auto || (d.activeElement === QR.nodes.status));\r\n      }\r\n    }\r\n\r\n    QR.cleanNotifications();\r\n    if (err && !force) {\r\n      // stop auto-posting\r\n      QR.cooldown.auto = false;\r\n      QR.status();\r\n      QR.error(err);\r\n      return;\r\n    }\r\n\r\n    // Enable auto-posting if we have stuff to post, disable it otherwise.\r\n    QR.cooldown.auto = QR.posts.length > 1;\r\n\r\n    post.lock();\r\n\r\n    const formData = {\r\n      MAX_FILE_SIZE: QR.max_size,\r\n      mode:     'regist',\r\n      pwd:      QR.persona.getPassword(),\r\n      resto:    threadID,\r\n      name:     (!QR.forcedAnon ? post.name : undefined),\r\n      email:    post.email,\r\n      sub:      (!QR.forcedAnon && !threadID ? post.sub : undefined),\r\n      com:      post.com,\r\n      upfile:   post.file,\r\n      filetag,\r\n      spoiler:  post.spoiler,\r\n      flag:     post.flag,\r\n    };\r\n\r\n    const options = {\r\n      responseType: 'document',\r\n      withCredentials: true,\r\n      onloadend: QR.response,\r\n      form: $.formData(formData)\r\n    };\r\n    if (Conf['Show Upload Progress']) {\r\n      options.onprogress = function(e) {\r\n        if (this !== QR.req?.upload) { return; } // aborted\r\n        if (e.loaded < e.total) {\r\n          // Uploading...\r\n          QR.req.progress = `${Math.round((e.loaded / e.total) * 100)}%`;\r\n        } else {\r\n          // Upload done, waiting for server response.\r\n          QR.req.isUploadFinished = true;\r\n          QR.req.progress = '...';\r\n        }\r\n        return QR.status();\r\n      };\r\n    }\r\n\r\n    let cb = function(response) {\r\n      if (response != null) {\r\n        QR.currentCaptcha = response;\r\n        if (QR.captcha === Captcha.v2) {\r\n          if (response.challenge != null) {\r\n            options.form.append('recaptcha_challenge_field', response.challenge);\r\n            options.form.append('recaptcha_response_field', response.response);\r\n          } else {\r\n            options.form.append('g-recaptcha-response', response.response);\r\n          }\r\n        } else {\r\n          for (var key in response) {\r\n            var val = response[key];\r\n            options.form.append(key, val);\r\n          }\r\n        }\r\n      }\r\n      QR.req = $.ajax(`https://sys.${location.hostname.split('.')[1]}.org/${g.BOARD}/post`, options);\r\n      return QR.req.progress = '...';\r\n    };\r\n\r\n    if (typeof captcha === 'function') {\r\n      // Wait for captcha to be verified before submitting post.\r\n      QR.req = {\r\n        progress: '...',\r\n        abort() {\r\n          if (QR.captcha === Captcha.v2) {\r\n            Captcha.cache.abort();\r\n          }\r\n          return cb = null;\r\n        }\r\n      };\r\n      captcha(function(response) {\r\n        if ((QR.captcha === Captcha.v2) && Captcha.cache.haveCookie()) {\r\n          cb?.();\r\n          if (response) { return Captcha.cache.save(response); }\r\n        } else if (response) {\r\n          return cb?.(response);\r\n        } else {\r\n          delete QR.req;\r\n          post.unlock();\r\n          QR.cooldown.auto = !!Captcha.cache.getCount();\r\n          return QR.status();\r\n        }\r\n      });\r\n    } else {\r\n      cb(captcha);\r\n    }\r\n\r\n    // Starting to upload might take some time.\r\n    // Provide some feedback that we're starting to submit.\r\n    return QR.status();\r\n  },\r\n\r\n  response() {\r\n    let connErr, err;\r\n    if (this !== QR.req) { return; } // aborted\r\n    delete QR.req;\r\n\r\n    const post = QR.posts[0];\r\n    post.unlock();\r\n\r\n    if (err = this.response?.getElementById('errmsg')) { // error!\r\n      const el = $('a', err);\r\n      if (el) el.target = '_blank'; // duplicate image link\r\n    } else if (connErr = (!this.response || (this.response.title !== 'Post successful!'))) {\r\n      err = QR.connectionError();\r\n      if ((QR.captcha === Captcha.v2) && QR.currentCaptcha) { Captcha.cache.save(QR.currentCaptcha); }\r\n    } else if (this.status !== 200) {\r\n      err = `Error ${this.statusText} (${this.status})`;\r\n    }\r\n\r\n    if (!connErr) { QR.captcha.setUsed?.(); }\r\n    delete QR.currentCaptcha;\r\n\r\n    if (err) {\r\n      let m;\r\n      QR.errorCount = (QR.errorCount || 0) + 1;\r\n      if (/captcha|verification/i.test(err.textContent)) {\r\n        // Remove the obnoxious 4chan Pass ad.\r\n        if (/mistyped/i.test(err.textContent)) {\r\n          err = 'You mistyped the CAPTCHA, or the CAPTCHA malfunctioned.';\r\n        } else if (/expired/i.test(err.textContent)) {\r\n          err = 'This CAPTCHA is no longer valid because it has expired.';\r\n        }\r\n        // Do not auto post with a wrong captcha.\r\n        QR.cooldown.auto = false;\r\n      } else if (connErr) {\r\n        if (QR.errorCount >= 5) {\r\n          // Too many posting errors can ban you. Stop autoposting after 5 errors.\r\n          QR.cooldown.auto = false;\r\n        } else {\r\n          // Something must've gone terribly wrong if you get captcha errors without captchas.\r\n          // Don't auto-post indefinitely in that case.\r\n          QR.cooldown.auto = QR.captcha.isEnabled || connErr;\r\n          // Too many frequent mistyped captchas will auto-ban you!\r\n          // On connection error, the post most likely didn't go through.\r\n          // If the post did go through, it should be stopped by the duplicate reply cooldown.\r\n          QR.cooldown.addDelay(post, 2);\r\n        }\r\n      } else if (err.textContent && (m = err.textContent.match(/\\d+\\s+(?:minute|second)/gi)) && !/duplicate|hour/i.test(err.textContent)) {\r\n        QR.cooldown.auto = !/have\\s+been\\s+muted/i.test(err.textContent);\r\n        let seconds = 0;\r\n        for (var mi of m) {\r\n          seconds += (/minute/i.test(mi) ? 60 : 1) * (+mi.match(/\\d+/)[0]);\r\n        }\r\n        if (/muted/i.test(err.textContent)) {\r\n          QR.cooldown.addMute(seconds);\r\n        } else {\r\n          QR.cooldown.addDelay(post, seconds);\r\n        }\r\n      } else { // stop auto-posting\r\n        QR.cooldown.auto = false;\r\n      }\r\n      QR.captcha.setup(QR.cooldown.auto && [QR.nodes.status, d.body].includes(d.activeElement));\r\n      QR.status();\r\n      QR.error(err);\r\n      return;\r\n    }\r\n\r\n    delete QR.errorCount;\r\n\r\n    const h1 = $('h1', this.response);\r\n\r\n    let [_, threadID, postID] = h1.nextSibling.textContent.match(/thread:(\\d+),no:(\\d+)/);\r\n    postID   = +postID;\r\n    threadID = +threadID || postID;\r\n    const isReply  = threadID !== postID;\r\n\r\n    // Post/upload confirmed as successful.\r\n    $.event('QRPostSuccessful', {\r\n      boardID: g.BOARD.ID,\r\n      threadID,\r\n      postID\r\n    });\r\n    // XXX deprecated\r\n    $.event('QRPostSuccessful_', {boardID: g.BOARD.ID, threadID, postID});\r\n\r\n    // Enable auto-posting if we have stuff left to post, disable it otherwise.\r\n    const postsCount = QR.posts.length - 1;\r\n    QR.cooldown.auto = postsCount && isReply;\r\n\r\n    const lastPostToThread = !((function() { for (var p of QR.posts.slice(1)) { if (p.thread === post.thread) { return true; } } })());\r\n\r\n    if (postsCount) {\r\n      post.rm();\r\n      QR.captcha.setup(d.activeElement === QR.nodes.status);\r\n    } else if (Conf['Persistent QR']) {\r\n      post.rm();\r\n      if (Conf['Auto Hide QR']) {\r\n        QR.hide();\r\n      } else {\r\n        QR.blur();\r\n      }\r\n    } else {\r\n      QR.close();\r\n    }\r\n\r\n    QR.cleanNotifications();\r\n    if (Conf['Posting Success Notifications']) {\r\n      QR.notifications.push(new Notice('success', h1.textContent, 5));\r\n    }\r\n\r\n    QR.cooldown.add(threadID, postID);\r\n\r\n    const URL = threadID === postID ? ( // new thread\r\n      `${window.location.origin}/${g.BOARD}/thread/${threadID}`\r\n    ) : (threadID !== g.THREADID) && lastPostToThread && Conf['Open Post in New Tab'] ? ( // replying from the index or a different thread\r\n      `${window.location.origin}/${g.BOARD}/thread/${threadID}#p${postID}`\r\n    ) : undefined;\r\n\r\n    if (URL) {\r\n      const open = Conf['Open Post in New Tab'] || postsCount ?\r\n        () => $.open(URL)\r\n      :\r\n        () => location.href = URL;\r\n\r\n      if (threadID === postID) {\r\n        // XXX 4chan sometimes responds before the thread exists.\r\n        QR.waitForThread(URL, open);\r\n      } else {\r\n        open();\r\n      }\r\n    }\r\n\r\n    return QR.status();\r\n  },\r\n\r\n  waitForThread(url, cb) {\r\n    let attempts = 0;\r\n    var check = function() {\r\n      return $.ajax(url, {\r\n        onloadend() {\r\n          attempts++;\r\n          if ((attempts >= 6) || (this.status === 200)) {\r\n            return cb();\r\n          } else {\r\n            return setTimeout(check, attempts * SECOND);\r\n          }\r\n        },\r\n        responseType: 'text',\r\n        type: 'HEAD'\r\n      }\r\n      );\r\n    };\r\n    return check();\r\n  },\r\n\r\n  abort() {\r\n    let oldReq;\r\n    if ((oldReq = QR.req) && !QR.req.isUploadFinished) {\r\n      delete QR.req;\r\n      oldReq.abort();\r\n      if ((QR.captcha === Captcha.v2) && QR.currentCaptcha) { Captcha.cache.save(QR.currentCaptcha); }\r\n      delete QR.currentCaptcha;\r\n      QR.posts[0].unlock();\r\n      QR.cooldown.auto = false;\r\n      QR.notifications.push(new Notice('info', 'QR upload aborted.', 5));\r\n    }\r\n    return QR.status();\r\n  },\r\n\r\n  cooldown: {\r\n    seconds: 0,\r\n    delays: {\r\n      deletion: 60\r\n    }, // cooldown for deleting posts/files\r\n\r\n    // Called from Main\r\n    init() {\r\n      if (!Conf['Quick Reply']) { return; }\r\n      this.data = Conf['cooldowns'];\r\n      this.changes = dict();\r\n      return $.sync('cooldowns', this.sync);\r\n    },\r\n\r\n    // Called from QR\r\n    setup() {\r\n      // Read cooldown times\r\n      $.extend(QR.cooldown.delays, g.BOARD.cooldowns());\r\n\r\n      // The longest reply cooldown, for use in pruning old reply data\r\n      QR.cooldown.maxDelay = 0;\r\n      for (var type in QR.cooldown.delays) {\r\n        var delay = QR.cooldown.delays[type];\r\n        if (!['thread', 'thread_global'].includes(type)) {\r\n          QR.cooldown.maxDelay = Math.max(QR.cooldown.maxDelay, delay);\r\n        }\r\n      }\r\n\r\n      QR.cooldown.isSetup = true;\r\n      return QR.cooldown.start();\r\n    },\r\n\r\n    start() {\r\n      const { data } = QR.cooldown;\r\n      if (\r\n        !Conf['Cooldown'] ||\r\n        !QR.cooldown.isSetup ||\r\n        !!QR.cooldown.isCounting ||\r\n        ((Object.keys(data[g.BOARD.ID] || {}).length + Object.keys(data.global || {}).length) <= 0)\r\n      ) { return; }\r\n      QR.cooldown.isCounting = true;\r\n      return QR.cooldown.count();\r\n    },\r\n\r\n    sync(data) {\r\n      QR.cooldown.data = data || dict();\r\n      return QR.cooldown.start();\r\n    },\r\n\r\n    add(threadID, postID) {\r\n      if (!Conf['Cooldown']) { return; }\r\n      const start = Date.now();\r\n      const boardID = g.BOARD.ID;\r\n      QR.cooldown.set(boardID, start, { threadID, postID });\r\n      if (threadID === postID) { QR.cooldown.set('global', start, { boardID, threadID, postID }); }\r\n      QR.cooldown.save();\r\n      return QR.cooldown.start();\r\n    },\r\n\r\n    addDelay(post, delay) {\r\n      if (!Conf['Cooldown']) { return; }\r\n      const cooldown = QR.cooldown.categorize(post);\r\n      cooldown.delay = delay;\r\n      QR.cooldown.set(g.BOARD.ID, Date.now(), cooldown);\r\n      QR.cooldown.save();\r\n      return QR.cooldown.start();\r\n    },\r\n\r\n    addMute(delay) {\r\n      if (!Conf['Cooldown']) { return; }\r\n      QR.cooldown.set(g.BOARD.ID, Date.now(), { type: 'mute', delay });\r\n      QR.cooldown.save();\r\n      return QR.cooldown.start();\r\n    },\r\n\r\n    delete(post) {\r\n      let cooldown;\r\n      if (!QR.cooldown.data) { return; }\r\n      const cooldowns = (QR.cooldown.data[post.board.ID] || (QR.cooldown.data[post.board.ID] = dict()));\r\n      for (var id in cooldowns) {\r\n        cooldown = cooldowns[id];\r\n        if ((cooldown.delay == null) && (cooldown.threadID === post.thread.ID) && (cooldown.postID === post.ID)) {\r\n          QR.cooldown.set(post.board.ID, id, null);\r\n        }\r\n      }\r\n      return QR.cooldown.save();\r\n    },\r\n\r\n    secondsDeletion(post) {\r\n      if (!QR.cooldown.data || !Conf['Cooldown']) { return 0; }\r\n      const cooldowns = QR.cooldown.data[post.board.ID] || dict();\r\n      for (var start in cooldowns) {\r\n        var cooldown = cooldowns[start];\r\n        if ((cooldown.delay == null) && (cooldown.threadID === post.thread.ID) && (cooldown.postID === post.ID)) {\r\n          var seconds = QR.cooldown.delays.deletion - Math.floor((Date.now() - start) / SECOND);\r\n          return Math.max(seconds, 0);\r\n        }\r\n      }\r\n      return 0;\r\n    },\r\n\r\n    categorize(post) {\r\n      if (post.thread === 'new') {\r\n        return { type: 'thread' };\r\n      } else {\r\n        return {\r\n          type: !!post.file ? 'image' : 'reply',\r\n          threadID: +post.thread\r\n        };\r\n      }\r\n    },\r\n\r\n    mergeChange(data, scope, id, value) {\r\n      if (value) {\r\n        return (data[scope] || (data[scope] = dict()))[id] = value;\r\n      } else if (scope in data) {\r\n        delete data[scope][id];\r\n        if (Object.keys(data[scope]).length === 0) { return delete data[scope]; }\r\n      }\r\n    },\r\n\r\n    set(scope, id, value) {\r\n      QR.cooldown.mergeChange(QR.cooldown.data, scope, id, value);\r\n      return (QR.cooldown.changes[scope] || (QR.cooldown.changes[scope] = dict()))[id] = value;\r\n    },\r\n\r\n    save() {\r\n      const { changes } = QR.cooldown;\r\n      if (!Object.keys(changes).length) { return; }\r\n      return $.get('cooldowns', dict(), function ({ cooldowns }) {\r\n        for (var scope in QR.cooldown.changes) {\r\n          for (var id in QR.cooldown.changes[scope]) {\r\n            var value = QR.cooldown.changes[scope][id];\r\n            QR.cooldown.mergeChange(cooldowns, scope, id, value);\r\n          }\r\n          QR.cooldown.data = cooldowns;\r\n        }\r\n        return $.set('cooldowns', cooldowns, () => QR.cooldown.changes = dict());\r\n      });\r\n    },\r\n\r\n    clear() {\r\n      QR.cooldown.data = dict();\r\n      QR.cooldown.changes = dict();\r\n      QR.cooldown.auto = false;\r\n      QR.cooldown.update();\r\n      return $.queueTask($.delete, 'cooldowns');\r\n    },\r\n\r\n    update() {\r\n      let cooldown;\r\n      if (!QR.cooldown.isCounting) { return; }\r\n\r\n      let save = false;\r\n      let nCooldowns = 0;\r\n      const now = Date.now();\r\n      const { type, threadID } = QR.cooldown.categorize(QR.posts[0]);\r\n      let seconds = 0;\r\n\r\n      if (Conf['Cooldown']) {\r\n        for (var scope of [g.BOARD.ID, 'global']) {\r\n          var cooldowns = (QR.cooldown.data[scope] || (QR.cooldown.data[scope] = dict()));\r\n\r\n          for (var start in cooldowns) {\r\n            cooldown = cooldowns[start];\r\n            start = +start;\r\n            var elapsed = Math.floor((now - start) / SECOND);\r\n            if (elapsed < 0) { // clock changed since then?\r\n              QR.cooldown.set(scope, start, null);\r\n              save = true;\r\n              continue;\r\n            }\r\n\r\n            // Explicit delays from error messages\r\n            if (cooldown.delay != null) {\r\n              if (cooldown.delay <= elapsed) {\r\n                QR.cooldown.set(scope, start, null);\r\n                save = true;\r\n              } else if (((cooldown.type === type) && (cooldown.threadID === threadID)) || (cooldown.type === 'mute')) {\r\n                // Delays only apply to the given post type and thread.\r\n                seconds = Math.max(seconds, cooldown.delay - elapsed);\r\n              }\r\n              continue;\r\n            }\r\n\r\n            // Clean up expired cooldowns\r\n            var maxDelay = cooldown.threadID !== cooldown.postID ?\r\n              QR.cooldown.maxDelay\r\n              :\r\n              QR.cooldown.delays[scope === 'global' ? 'thread_global' : 'thread'];\r\n            if (QR.cooldown.customCooldown) {\r\n              maxDelay = Math.max(maxDelay, parseInt(Conf['customCooldown'], 10));\r\n            }\r\n            if (maxDelay <= elapsed) {\r\n              QR.cooldown.set(scope, start, null);\r\n              save = true;\r\n              continue;\r\n            }\r\n\r\n            if (((type === 'thread') === (cooldown.threadID === cooldown.postID)) && (cooldown.boardID !== g.BOARD.ID)) {\r\n              // Only cooldowns relevant to this post can set the seconds variable:\r\n              //   reply cooldown with a reply, thread cooldown with a thread.\r\n              // Inter-board thread cooldowns only apply on boards other than the one they were posted on.\r\n              var suffix = scope === 'global' ?\r\n                '_global'\r\n                :\r\n                '';\r\n              seconds = Math.max(seconds, QR.cooldown.delays[type + suffix] - elapsed);\r\n\r\n              // If additional cooldown is enabled, add the configured seconds to the count.\r\n              if (QR.cooldown.customCooldown) {\r\n                seconds = Math.max(seconds, parseInt(Conf['customCooldown'], 10) - elapsed);\r\n              }\r\n            }\r\n          }\r\n\r\n          nCooldowns += Object.keys(cooldowns).length;\r\n        }\r\n      }\r\n\r\n      if (save) { QR.cooldown.save; }\r\n\r\n      if (nCooldowns) {\r\n        clearTimeout(QR.cooldown.timeout);\r\n        QR.cooldown.timeout = setTimeout(QR.cooldown.count, SECOND);\r\n      } else {\r\n        delete QR.cooldown.isCounting;\r\n      }\r\n\r\n      // Update the status when we change posting type.\r\n      // Don't get stuck at some random number.\r\n      // Don't interfere with progress status updates.\r\n      const update = seconds !== QR.cooldown.seconds;\r\n      QR.cooldown.seconds = seconds;\r\n      if (update) { return QR.status(); }\r\n    },\r\n\r\n    count() {\r\n      QR.cooldown.update();\r\n      if ((QR.cooldown.seconds === 0) && QR.cooldown.auto && !QR.req) { return QR.submit(); }\r\n    }\r\n  },\r\n\r\n  oekaki: {\r\n    menu: {\r\n      init() {\r\n        if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Edit Link'] || !Conf['Quick Reply']) { return; }\r\n\r\n        const a = $.el('a', {\r\n          className: 'edit-link',\r\n          href: 'javascript:;',\r\n          textContent: 'Edit image'\r\n        }\r\n        );\r\n        $.on(a, 'click', this.editFile);\r\n\r\n        return Menu.menu.addEntry({\r\n          el: a,\r\n          order: 90,\r\n          open(post) {\r\n            QR.oekaki.menu.post = post;\r\n            const { file } = post;\r\n            return QR.postingIsEnabled && !!file && (file.isImage || file.isVideo);\r\n          }\r\n        });\r\n      },\r\n\r\n      editFile() {\r\n        const { post } = QR.oekaki.menu;\r\n        QR.quote.call(post.nodes.post);\r\n        const { isVideo } = post.file;\r\n        const currentTime = post.file.fullImage?.currentTime || 0;\r\n        return CrossOrigin.file(post.file.url, function (blob) {\r\n          if (!blob) {\r\n            return QR.error(\"Can't load file.\");\r\n          } else if (isVideo) {\r\n            const video = $.el('video');\r\n            $.on(video, 'loadedmetadata', function () {\r\n              $.on(video, 'seeked', function () {\r\n                const canvas = $.el('canvas', {\r\n                  width: video.videoWidth,\r\n                  height: video.videoHeight\r\n                }\r\n                );\r\n                canvas.getContext('2d').drawImage(video, 0, 0);\r\n                return canvas.toBlob(function (snapshot) {\r\n                  snapshot.name = post.file.name.replace(/\\.\\w+$/, '') + '.png';\r\n                  QR.handleFiles([snapshot]);\r\n                  return QR.oekaki.edit();\r\n                });\r\n              });\r\n              return video.currentTime = currentTime;\r\n            });\r\n            $.on(video, 'error', () => QR.openError());\r\n            return video.src = URL.createObjectURL(blob);\r\n          } else {\r\n            blob.name = post.file.name;\r\n            QR.handleFiles([blob]);\r\n            return QR.oekaki.edit();\r\n          }\r\n        });\r\n      }\r\n    },\r\n\r\n    setup() {\r\n      return $.global(function () {\r\n        const { FCX } = window;\r\n        FCX.oekakiCB = () => window.Tegaki.flatten().toBlob(function (file) {\r\n          const source = `oekaki-${Date.now()}`;\r\n          FCX.oekakiLatest = source;\r\n          return document.dispatchEvent(new CustomEvent('QRSetFile', {\r\n            bubbles: true,\r\n            detail: { file, name: FCX.oekakiName, source }\r\n          }));\r\n        });\r\n        if (window.Tegaki) {\r\n          return document.querySelector('#qr .oekaki').hidden = false;\r\n        }\r\n      });\r\n    },\r\n\r\n    load(cb) {\r\n      if ($('script[src^=\"//s.4cdn.org/js/tegaki\"]', d.head)) {\r\n        return cb();\r\n      } else {\r\n        const style = $.el('link', {\r\n          rel: 'stylesheet',\r\n          href: `//s.4cdn.org/css/tegaki.${Date.now()}.css`\r\n        }\r\n        );\r\n        const script = $.el('script',\r\n          { src: `//s.4cdn.org/js/tegaki.min.${Date.now()}.js` });\r\n        let n = 0;\r\n        const onload = function () {\r\n          if (++n === 2) { return cb(); }\r\n        };\r\n        $.on(style, 'load', onload);\r\n        $.on(script, 'load', onload);\r\n        return $.add(d.head, [style, script]);\r\n      }\r\n    },\r\n\r\n    draw() {\r\n      return $.global(function () {\r\n        const { Tegaki, FCX } = window;\r\n        if (Tegaki.bg) { Tegaki.destroy(); }\r\n        FCX.oekakiName = 'tegaki.png';\r\n        return Tegaki.open({\r\n          onDone: FCX.oekakiCB,\r\n          onCancel() { return Tegaki.bgColor = '#ffffff'; },\r\n          width: +document.querySelector('#qr [name=oekaki-width]').value,\r\n          height: +document.querySelector('#qr [name=oekaki-height]').value,\r\n          bgColor:\r\n            document.querySelector('#qr [name=oekaki-bg]').checked ?\r\n              document.querySelector('#qr [name=oekaki-bgcolor]').value\r\n              :\r\n              'transparent'\r\n        });\r\n      });\r\n    },\r\n\r\n    button() {\r\n      if (QR.selected.file) {\r\n        return QR.oekaki.edit();\r\n      } else {\r\n        return QR.oekaki.toggle();\r\n      }\r\n    },\r\n\r\n    edit() {\r\n      return QR.oekaki.load(() => $.global(function () {\r\n        const { Tegaki, FCX } = window;\r\n        const name = document.getElementById('qr-filename').value.replace(/\\.\\w+$/, '') + '.png';\r\n        const { source } = document.getElementById('file-n-submit').dataset;\r\n        const error = content => document.dispatchEvent(new CustomEvent('CreateNotification', {\r\n          bubbles: true,\r\n          detail: { type: 'warning', content, lifetime: 20 }\r\n        }));\r\n        var cb = function (e) {\r\n          if (e) { this.removeEventListener('QRMetadata', cb, false); }\r\n          const selected = document.getElementById('selected');\r\n          if (!selected?.dataset.type) { return error('No file to edit.'); }\r\n          if (!/^(image|video)\\//.test(selected.dataset.type)) { return error('Not an image.'); }\r\n          if (!selected.dataset.height) { return error('Metadata not available.'); }\r\n          if (selected.dataset.height === 'loading') {\r\n            selected.addEventListener('QRMetadata', cb, false);\r\n            return;\r\n          }\r\n          if (Tegaki.bg) { Tegaki.destroy(); }\r\n          FCX.oekakiName = name;\r\n          Tegaki.open({\r\n            onDone: FCX.oekakiCB,\r\n            onCancel() { return Tegaki.bgColor = '#ffffff'; },\r\n            width: +selected.dataset.width,\r\n            height: +selected.dataset.height,\r\n            bgColor: 'transparent'\r\n          });\r\n          const canvas = document.createElement('canvas');\r\n          canvas.width = (canvas.naturalWidth = +selected.dataset.width);\r\n          canvas.height = (canvas.naturalHeight = +selected.dataset.height);\r\n          canvas.hidden = true;\r\n          document.body.appendChild(canvas);\r\n          canvas.addEventListener('QRImageDrawn', function () {\r\n            this.remove();\r\n            return Tegaki.onOpenImageLoaded.call(this);\r\n          }\r\n            , false);\r\n          return canvas.dispatchEvent(new CustomEvent('QRDrawFile', { bubbles: true }));\r\n        };\r\n        if (Tegaki.bg && (Tegaki.onDoneCb === FCX.oekakiCB) && (source === FCX.oekakiLatest)) {\r\n          FCX.oekakiName = name;\r\n          return Tegaki.resume();\r\n        } else {\r\n          return cb();\r\n        }\r\n      }));\r\n    },\r\n\r\n    toggle() {\r\n      return QR.oekaki.load(() => QR.nodes.oekaki.hidden = !QR.nodes.oekaki.hidden);\r\n    }\r\n  },\r\n\r\n  persona: {\r\n    always: {},\r\n    types: {\r\n      name: [],\r\n      email: [],\r\n      sub: []\r\n    },\r\n\r\n    init() {\r\n      if (!Conf['Quick Reply'] && (!Conf['Menu'] || !Conf['Delete Link'])) { return; }\r\n      for (var item of Conf['QR.personas'].split('\\n')) {\r\n        QR.persona.parseItem(item.trim());\r\n      }\r\n    },\r\n\r\n    parseItem(item) {\r\n      let match, needle, type, val;\r\n      if (item[0] === '#') { return; }\r\n      if (!(match = item.match(/(name|options|email|subject|password):\"(.*)\"/i))) { return; }\r\n      [match, type, val] = match;\r\n\r\n      // Don't mix up item settings with val.\r\n      item = item.replace(match, '');\r\n\r\n      const boards = item.match(/boards:([^;]+)/i)?.[1].toLowerCase() || 'global';\r\n      if ((boards !== 'global') && (needle = g.BOARD.ID, !boards.split(',').includes(needle))) { return; }\r\n\r\n\r\n      if (type === 'password') {\r\n        QR.persona.pwd = val;\r\n        return;\r\n      }\r\n\r\n      if (type === 'options') { type = 'email'; }\r\n      if (type === 'subject') { type = 'sub'; }\r\n\r\n      if (/always/i.test(item)) {\r\n        QR.persona.always[type] = val;\r\n      }\r\n\r\n      if (!QR.persona.types[type].includes(val)) {\r\n        return QR.persona.types[type].push(val);\r\n      }\r\n    },\r\n\r\n    load() {\r\n      for (var type in QR.persona.types) {\r\n        var arr = QR.persona.types[type];\r\n        var list = $(`#list-${type}`, QR.nodes.el);\r\n        for (var val of arr) {\r\n          if (val) {\r\n            $.add(list, $.el('option',\r\n              { textContent: val })\r\n            );\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    getPassword() {\r\n      let m;\r\n      if (QR.persona.pwd != null) {\r\n        return QR.persona.pwd;\r\n      } else if (m = d.cookie.match(/4chan_pass=([^;]+)/)) {\r\n        return decodeURIComponent(m[1]);\r\n      } else {\r\n        return '';\r\n      }\r\n    },\r\n\r\n    get(cb) {\r\n      return $.get('QR.persona', {}, ({ 'QR.persona': persona }) => cb(persona));\r\n    },\r\n\r\n    set(post) {\r\n      return $.get('QR.persona', {}, function ({ 'QR.persona': persona }) {\r\n        persona = {\r\n          name: post.name,\r\n          flag: post.flag\r\n        };\r\n        return $.set('QR.persona', persona);\r\n      });\r\n    }\r\n  },\r\n\r\n  post: class {\r\n    constructor(select) {\r\n      this.select = this.select.bind(this);\r\n      const el = $.el('a', {\r\n        className: 'qr-preview',\r\n        draggable: true,\r\n        href: 'javascript:;'\r\n      }\r\n      );\r\n      $.extend(el, { innerHTML: '<a class=\"remove\" title=\"Remove\">✕</a><label class=\"qr-preview-spoiler\"><input type=\"checkbox\"> Spoiler</label><span></span>' });\r\n\r\n      this.nodes = {\r\n        el,\r\n        rm: el.firstChild,\r\n        spoiler: $('.qr-preview-spoiler input', el),\r\n        span: el.lastChild\r\n      };\r\n\r\n      $.on(el, 'click', this.select);\r\n      $.on(this.nodes.rm, 'click', e => { e.stopPropagation(); return this.rm(); });\r\n      $.on(this.nodes.spoiler, 'change', e => {\r\n        this.spoiler = e.target.checked;\r\n        if (this === QR.selected) { QR.nodes.spoiler.checked = this.spoiler; }\r\n        return this.preventAutoPost();\r\n      });\r\n      for (var label of $$('label', el)) {\r\n        $.on(label, 'click', e => e.stopPropagation());\r\n      }\r\n      $.add(QR.nodes.dumpList, el);\r\n\r\n      for (var event of ['dragStart', 'dragEnter', 'dragLeave', 'dragOver', 'dragEnd', 'drop']) {\r\n        $.on(el, event.toLowerCase(), this[event]);\r\n      }\r\n\r\n      this.thread = g.VIEW === 'thread' ?\r\n        g.THREADID\r\n        :\r\n        'new';\r\n\r\n      const prev = QR.posts[QR.posts.length - 1];\r\n      QR.posts.push(this);\r\n      this.nodes.spoiler.checked = (this.spoiler = prev && Conf['Remember Spoiler'] ?\r\n        prev.spoiler\r\n        :\r\n        false);\r\n      QR.persona.get(persona => {\r\n        this.name = 'name' in QR.persona.always ?\r\n          QR.persona.always.name\r\n          : prev ?\r\n            prev.name\r\n            :\r\n            persona.name;\r\n\r\n        this.email = 'email' in QR.persona.always ?\r\n          QR.persona.always.email\r\n          :\r\n          '';\r\n\r\n        this.sub = 'sub' in QR.persona.always ?\r\n          QR.persona.always.sub\r\n          :\r\n          '';\r\n\r\n        if (QR.nodes.flag) {\r\n          this.flag = (() => {\r\n            if (prev) {\r\n              return prev.flag;\r\n            } else if (persona.flag && persona.flag in g.BOARD.config.board_flags) {\r\n              return persona.flag;\r\n            }\r\n          })();\r\n        }\r\n        if (QR.selected === this) { return this.load(); }\r\n      }); // load persona\r\n      if (select) { this.select(); }\r\n      this.unlock();\r\n      QR.captcha.moreNeeded();\r\n    }\r\n\r\n    rm() {\r\n      this.delete();\r\n      const index = QR.posts.indexOf(this);\r\n      if (QR.posts.length === 1) {\r\n        new QR.post(true);\r\n        $.rmClass(QR.nodes.el, 'dump');\r\n      } else if (this === QR.selected) {\r\n        (QR.posts[index - 1] || QR.posts[index + 1]).select();\r\n      }\r\n      QR.posts.splice(index, 1);\r\n      QR.status();\r\n      return QR.captcha.updateThread?.();\r\n    }\r\n\r\n    delete() {\r\n      $.rm(this.nodes.el);\r\n      URL.revokeObjectURL(this.URL);\r\n      return this.dismissErrors();\r\n    }\r\n\r\n    lock(lock = true) {\r\n      this.isLocked = lock;\r\n      if (this !== QR.selected) { return; }\r\n      for (var name of ['thread', 'name', 'email', 'sub', 'com', 'fileButton', 'filename', 'spoiler', 'flag']) {\r\n        var node;\r\n        if ((node = QR.nodes[name])) {\r\n          node.disabled = lock;\r\n        }\r\n      }\r\n      this.nodes.rm.style.visibility = lock ? 'hidden' : '';\r\n      this.nodes.spoiler.disabled = lock;\r\n      return this.nodes.el.draggable = !lock;\r\n    }\r\n\r\n    unlock() {\r\n      return this.lock(false);\r\n    }\r\n\r\n    select() {\r\n      if (QR.selected) {\r\n        QR.selected.nodes.el.removeAttribute('id');\r\n        QR.selected.forceSave();\r\n      }\r\n      QR.selected = this;\r\n      this.lock(this.isLocked);\r\n      this.nodes.el.id = 'selected';\r\n      // Scroll the list to center the focused post.\r\n      const rectEl = this.nodes.el.getBoundingClientRect();\r\n      const rectList = this.nodes.el.parentNode.getBoundingClientRect();\r\n      this.nodes.el.parentNode.scrollLeft += (rectEl.left + (rectEl.width / 2)) - rectList.left - (rectList.width / 2);\r\n      return this.load();\r\n    }\r\n\r\n    load() {\r\n      // Load this post's values.\r\n\r\n      for (var name of ['thread', 'name', 'email', 'sub', 'com', 'filename', 'flag']) {\r\n        var node;\r\n        if (!(node = QR.nodes[name])) { continue; }\r\n        node.value = this[name] || node.dataset.default || '';\r\n      }\r\n\r\n      (this.thread !== 'new' ? $.addClass : $.rmClass)(QR.nodes.el, 'reply-to-thread');\r\n\r\n      this.showFileData();\r\n      return QR.characterCount();\r\n    }\r\n\r\n    save(input, forced) {\r\n      if (input.type === 'checkbox') {\r\n        this.spoiler = input.checked;\r\n        return;\r\n      }\r\n      const { name } = input.dataset;\r\n      if (!['thread', 'name', 'email', 'sub', 'com', 'filename', 'flag'].includes(name)) { return; }\r\n      const prev = this[name] || input.dataset.default || null;\r\n      this[name] = input.value || input.dataset.default || null;\r\n      switch (name) {\r\n        case 'thread':\r\n          (this.thread !== 'new' ? $.addClass : $.rmClass)(QR.nodes.el, 'reply-to-thread');\r\n          QR.status();\r\n          QR.captcha.updateThread?.();\r\n          break;\r\n        case 'com':\r\n          this.updateComment();\r\n          break;\r\n        case 'filename':\r\n          if (!this.file) { return; }\r\n          this.saveFilename();\r\n          this.updateFilename();\r\n          break;\r\n        case 'name': case 'flag':\r\n          if (this[name] !== prev) { // only save manual changes, not values filled in by persona settings\r\n            QR.persona.set(this);\r\n          }\r\n          break;\r\n      }\r\n      if (!forced) { return this.preventAutoPost(); }\r\n    }\r\n\r\n    forceSave() {\r\n      if (this !== QR.selected) { return; }\r\n      // Do this in case people use extensions\r\n      // that do not trigger the `input` event.\r\n      for (var name of ['thread', 'name', 'email', 'sub', 'com', 'filename', 'spoiler', 'flag']) {\r\n        var node;\r\n        if (!(node = QR.nodes[name])) { continue; }\r\n        this.save(node, true);\r\n      }\r\n    }\r\n\r\n    preventAutoPost() {\r\n      // Disable auto-posting if you're editing the first post\r\n      // during the last 5 seconds of the cooldown.\r\n      if (QR.cooldown.auto && (this === QR.posts[0])) {\r\n        QR.cooldown.update(); // adding/removing file can change cooldown\r\n        if (QR.cooldown.seconds <= 5) { return QR.cooldown.auto = false; }\r\n      }\r\n    }\r\n\r\n    setComment(com) {\r\n      this.com = com || null;\r\n      if (this === QR.selected) {\r\n        QR.nodes.com.value = this.com;\r\n      }\r\n      return this.updateComment();\r\n    }\r\n\r\n    updateComment() {\r\n      if (this === QR.selected) {\r\n        QR.characterCount();\r\n      }\r\n      this.nodes.span.textContent = this.com;\r\n      QR.captcha.moreNeeded();\r\n      if (QR.captcha === Captcha.v2) {\r\n        return Captcha.cache.prerequest();\r\n      }\r\n    }\r\n\r\n    isOnlyQuotes() {\r\n      return (this.com || '').trim() === (this.quotedText || '').trim();\r\n    }\r\n\r\n    static rmErrored(e) {\r\n      e.stopPropagation();\r\n      for (let i = QR.posts.length - 1; i >= 0; i--) {\r\n        var errors;\r\n        var post = QR.posts[i];\r\n        if ((errors = post.errors)) {\r\n          for (var error of errors) {\r\n            if (doc.contains(error)) {\r\n              post.rm();\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    error(className, message, link) {\r\n      const div = $.el('div', { className });\r\n      $.extend(div, {\r\n        innerHTML: message + (link ? ` [<a href=\"${E(link)}\" target=\"_blank\">More info</a>]` : '') +\r\n          `<br>[<a href=\"javascript:;\">delete post</a>] [<a href=\"javascript:;\">delete all</a>]`\r\n      });\r\n      (this.errors || (this.errors = [])).push(div);\r\n      const [rm, rmAll] = $$('a', div);\r\n      $.on(div, 'click', () => {\r\n        if (QR.posts.includes(this)) { return this.select(); }\r\n      });\r\n      $.on(rm, 'click', e => {\r\n        e.stopPropagation();\r\n        if (QR.posts.includes(this)) { return this.rm(); }\r\n      });\r\n      $.on(rmAll, 'click', QR.post.rmErrored);\r\n      return QR.error(div, true);\r\n    }\r\n\r\n    fileError(message, link) {\r\n      return this.error('file-error', `${this.filename}: ${message}`, link);\r\n    }\r\n\r\n    dismissErrors(test = () => true) {\r\n      if (this.errors) {\r\n        for (var error of this.errors) {\r\n          if (doc.contains(error) && test(error)) {\r\n            error.parentNode.previousElementSibling.click();\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    setFile(file) {\r\n      this.file = file;\r\n      if (Conf['Randomize Filename'] && (g.BOARD.ID !== 'f')) {\r\n        let ext;\r\n        this.filename = `${Date.now() * 1000 - Math.floor(Math.random() * 365 * DAY * 1000)}`;\r\n        if (ext = this.file.name.match(QR.validExtension)) { this.filename += ext[0]; }\r\n      } else {\r\n        this.filename = this.file.name;\r\n      }\r\n      this.filesize = $.bytesToString(this.file.size);\r\n      this.checkSize();\r\n      $.addClass(this.nodes.el, 'has-file');\r\n      QR.captcha.moreNeeded();\r\n      URL.revokeObjectURL(this.URL);\r\n      this.saveFilename();\r\n      if (this === QR.selected) {\r\n        this.showFileData();\r\n      } else {\r\n        this.updateFilename();\r\n      }\r\n      this.rmMetadata();\r\n      this.nodes.el.dataset.type = this.file.type;\r\n      this.nodes.el.style.backgroundImage = '';\r\n      if (!QR.mimeTypes.includes(this.file.type)) {\r\n        this.fileError('Unsupported file type.');\r\n      } else if (/^(image|video)\\//.test(this.file.type)) {\r\n        this.readFile();\r\n      }\r\n      return this.preventAutoPost();\r\n    }\r\n\r\n    checkSize() {\r\n      let max = QR.max_size;\r\n      if (/^video\\//.test(this.file.type)) { max = Math.min(max, QR.max_size_video); }\r\n      if (this.file.size > max) {\r\n        return this.fileError(`File too large (file: ${this.filesize}, max: ${$.bytesToString(max)}).`);\r\n      }\r\n    }\r\n\r\n    readFile() {\r\n      const isVideo = /^video\\//.test(this.file.type);\r\n      const el = $.el(isVideo ? 'video' : 'img');\r\n      if (isVideo && !el.canPlayType(this.file.type)) { return; }\r\n\r\n      const event = isVideo ? 'loadeddata' : 'load';\r\n      var onload = () => {\r\n        $.off(el, event, onload);\r\n        $.off(el, 'error', onerror);\r\n        this.checkDimensions(el);\r\n        this.setThumbnail(el);\r\n        return $.event('QRMetadata', null, this.nodes.el);\r\n      };\r\n      var onerror = () => {\r\n        $.off(el, event, onload);\r\n        $.off(el, 'error', onerror);\r\n        this.fileError(`Corrupt ${isVideo ? 'video' : 'image'} or error reading metadata.`, meta.faq + '#error-reading-metadata');\r\n        URL.revokeObjectURL(el.src);\r\n        // XXX https://bugzilla.mozilla.org/show_bug.cgi?id=1021289\r\n        this.nodes.el.removeAttribute('data-height');\r\n        return $.event('QRMetadata', null, this.nodes.el);\r\n      };\r\n      this.nodes.el.dataset.height = 'loading';\r\n      $.on(el, event, onload);\r\n      $.on(el, 'error', onerror);\r\n      return el.src = URL.createObjectURL(this.file);\r\n    }\r\n\r\n    checkDimensions(el) {\r\n      let height, width;\r\n      if (el.tagName === 'IMG') {\r\n        ({ height, width } = el);\r\n        this.nodes.el.dataset.height = height;\r\n        this.nodes.el.dataset.width = width;\r\n        if ((height > QR.max_height) || (width > QR.max_width)) {\r\n          this.fileError(`Image too large (image: ${height}x${width}px, max: ${QR.max_height}x${QR.max_width}px)`);\r\n        }\r\n        if ((height < QR.min_height) || (width < QR.min_width)) {\r\n          return this.fileError(`Image too small (image: ${height}x${width}px, min: ${QR.min_height}x${QR.min_width}px)`);\r\n        }\r\n      } else {\r\n        const { videoHeight, videoWidth, duration } = el;\r\n        this.nodes.el.dataset.height = videoHeight;\r\n        this.nodes.el.dataset.width = videoWidth;\r\n        this.nodes.el.dataset.duration = duration;\r\n        const max_height = Math.min(QR.max_height, QR.max_height_video);\r\n        const max_width = Math.min(QR.max_width, QR.max_width_video);\r\n        if ((videoHeight > max_height) || (videoWidth > max_width)) {\r\n          this.fileError(`Video too large (video: ${videoHeight}x${videoWidth}px, max: ${max_height}x${max_width}px)`);\r\n        }\r\n        if ((videoHeight < QR.min_height) || (videoWidth < QR.min_width)) {\r\n          this.fileError(`Video too small (video: ${videoHeight}x${videoWidth}px, min: ${QR.min_height}x${QR.min_width}px)`);\r\n        }\r\n        if (!isFinite(duration)) {\r\n          this.fileError('Video lacks duration metadata (try remuxing)');\r\n        } else if (duration > QR.max_duration_video) {\r\n          this.fileError(`Video too long (video: ${duration}s, max: ${QR.max_duration_video}s)`);\r\n        }\r\n        if (BoardConfig.noAudio(g.BOARD.ID) && $.hasAudio(el)) {\r\n          return this.fileError('Audio not allowed');\r\n        }\r\n      }\r\n    }\r\n\r\n    setThumbnail(el) {\r\n      // Create a redimensioned thumbnail.\r\n      let height, width;\r\n      const isVideo = el.tagName === 'VIDEO';\r\n\r\n      // Generate thumbnails only if they're really big.\r\n      // Resized pictures through canvases look like ass,\r\n      // so we generate thumbnails `s` times bigger then expected\r\n      // to avoid crappy resized quality.\r\n      let s = 90 * 2 * window.devicePixelRatio;\r\n      if (this.file.type === 'image/gif') { s *= 3; } // let them animate\r\n      if (isVideo) {\r\n        height = el.videoHeight;\r\n        width = el.videoWidth;\r\n      } else {\r\n        ({ height, width } = el);\r\n        if ((height < s) || (width < s)) {\r\n          this.URL = el.src;\r\n          this.nodes.el.style.backgroundImage = `url(${this.URL})`;\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (height <= width) {\r\n        width = (s / height) * width;\r\n        height = s;\r\n      } else {\r\n        height = (s / width) * height;\r\n        width = s;\r\n      }\r\n      const cv = $.el('canvas');\r\n      cv.height = height;\r\n      cv.width = width;\r\n      cv.getContext('2d').drawImage(el, 0, 0, width, height);\r\n      URL.revokeObjectURL(el.src);\r\n      return cv.toBlob(blob => {\r\n        this.URL = URL.createObjectURL(blob);\r\n        return this.nodes.el.style.backgroundImage = `url(${this.URL})`;\r\n      });\r\n    }\r\n\r\n    rmFile() {\r\n      if (this.isLocked) { return; }\r\n      delete this.file;\r\n      delete this.filename;\r\n      delete this.filesize;\r\n      this.nodes.el.removeAttribute('title');\r\n      QR.nodes.filename.removeAttribute('title');\r\n      this.rmMetadata();\r\n      this.nodes.el.style.backgroundImage = '';\r\n      $.rmClass(this.nodes.el, 'has-file');\r\n      this.showFileData();\r\n      URL.revokeObjectURL(this.URL);\r\n      this.dismissErrors(error => $.hasClass(error, 'file-error'));\r\n      return this.preventAutoPost();\r\n    }\r\n\r\n    rmMetadata() {\r\n      for (var attr of ['type', 'height', 'width', 'duration']) {\r\n        // XXX https://bugzilla.mozilla.org/show_bug.cgi?id=1021289\r\n        this.nodes.el.removeAttribute(`data-${attr}`);\r\n      }\r\n    }\r\n\r\n    saveFilename() {\r\n      this.file.newName = (this.filename || '').replace(/[/\\\\]/g, '-');\r\n      if (!QR.validExtension.test(this.filename)) {\r\n        // 4chan will truncate the filename if it has no extension.\r\n        return this.file.newName += `.${$.getOwn(QR.extensionFromType, this.file.type) || 'jpg'}`;\r\n      }\r\n    }\r\n\r\n    updateFilename() {\r\n      const long = `${this.filename} (${this.filesize})`;\r\n      this.nodes.el.title = long;\r\n      if (this !== QR.selected) { return; }\r\n      return QR.nodes.filename.title = long;\r\n    }\r\n\r\n    showFileData() {\r\n      if (this.file) {\r\n        this.updateFilename();\r\n        QR.nodes.filename.value = this.filename;\r\n        $.addClass(QR.nodes.oekaki, 'has-file');\r\n        $.addClass(QR.nodes.fileSubmit, 'has-file');\r\n      } else {\r\n        $.rmClass(QR.nodes.oekaki, 'has-file');\r\n        $.rmClass(QR.nodes.fileSubmit, 'has-file');\r\n      }\r\n      if (this.file?.source != null) {\r\n        QR.nodes.fileSubmit.dataset.source = this.file.source;\r\n      } else {\r\n        QR.nodes.fileSubmit.removeAttribute('data-source');\r\n      }\r\n      return QR.nodes.spoiler.checked = this.spoiler;\r\n    }\r\n\r\n    pasteText(file) {\r\n      this.pasting = true;\r\n      this.preventAutoPost();\r\n      const reader = new FileReader();\r\n      reader.onload = e => {\r\n        const { result } = e.target;\r\n        this.setComment((this.com ? `${this.com}\\n${result}` : result));\r\n        return delete this.pasting;\r\n      };\r\n      return reader.readAsText(file);\r\n    }\r\n\r\n    dragStart(e) {\r\n      const { left, top } = this.getBoundingClientRect();\r\n      e.dataTransfer.setDragImage(this, e.clientX - left, e.clientY - top);\r\n      return $.addClass(this, 'drag');\r\n    }\r\n    dragEnd() { return $.rmClass(this, 'drag'); }\r\n    dragEnter() { return $.addClass(this, 'over'); }\r\n    dragLeave() { return $.rmClass(this, 'over'); }\r\n\r\n    dragOver(e) {\r\n      e.preventDefault();\r\n      return e.dataTransfer.dropEffect = 'move';\r\n    }\r\n\r\n    drop() {\r\n      $.rmClass(this, 'over');\r\n      if (!this.draggable) { return; }\r\n      const el = $('.drag', this.parentNode);\r\n      const index = el => {\r\n        for (let i = 0; i < el.parentNode.children.length; i++) {\r\n          if (el.parentNode.children[i] === el) return i;\r\n        }\r\n        return -1;\r\n      }\r\n      const oldIndex = index(el);\r\n      const newIndex = index(this);\r\n      if (QR.posts[oldIndex].isLocked || QR.posts[newIndex].isLocked) { return; }\r\n      (oldIndex < newIndex ? $.after : $.before)(this, el);\r\n      const post = QR.posts.splice(oldIndex, 1)[0];\r\n      QR.posts.splice(newIndex, 0, post);\r\n      QR.status();\r\n      return QR.captcha.updateThread?.();\r\n    }\r\n  }\r\n\r\n};\r\nexport default QR;\r\n","import QR from \"../Posting/QR\";\r\nimport $ from \"./$\";\r\nimport { dict, platform } from \"./helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * DS206: Consider reworking classes to avoid initClass\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nlet eventPageRequest;\r\nif (platform === 'crx') {\r\n  eventPageRequest = (function () {\r\n    const callbacks = [];\r\n    chrome.runtime.onMessage.addListener(function(response) {\r\n      callbacks[response.id](response.data);\r\n      return delete callbacks[response.id];});\r\n    return (params, cb) => chrome.runtime.sendMessage(params, id => callbacks[id] = cb);\r\n  })();\r\n}\r\nvar CrossOrigin = {\r\n  binary(url, cb, headers = dict()) {\r\n    // XXX https://forums.lanik.us/viewtopic.php?f=64&t=24173&p=78310\r\n    url = url.replace(/^((?:https?:)?\\/\\/(?:\\w+\\.)?(?:4chan|4channel|4cdn)\\.org)\\/adv\\//, '$1//adv/');\r\n    if (platform === 'crx') {\r\n    eventPageRequest({type: 'ajax', url, headers, responseType: 'arraybuffer'}, function({response, responseHeaderString}) {\r\n      if (response) { response = new Uint8Array(response); }\r\n      return cb(response, responseHeaderString);\r\n    });\r\n    } else {\r\n      const fallback = function() {\r\n        return $.ajax(url, {\r\n          headers,\r\n          responseType: 'arraybuffer',\r\n          onloadend() {\r\n            if (this.status && this.response) {\r\n              return cb(new Uint8Array(this.response), this.getAllResponseHeaders());\r\n            } else {\r\n              return cb(null);\r\n            }\r\n          }\r\n        });\r\n      };\r\n      if ((typeof window.GM_xmlhttpRequest === 'undefined' || window.GM_xmlhttpRequest === null)) {\r\n        fallback();\r\n        return;\r\n      }\r\n      const gmOptions = {\r\n        method: \"GET\",\r\n        url,\r\n        headers,\r\n        responseType: 'arraybuffer',\r\n        overrideMimeType: 'text/plain; charset=x-user-defined',\r\n        onload(xhr) {\r\n          let data;\r\n          if (xhr.response instanceof ArrayBuffer) {\r\n            data = new Uint8Array(xhr.response);\r\n          } else {\r\n            const r = xhr.responseText;\r\n            data = new Uint8Array(r.length);\r\n            let i = 0;\r\n            while (i < r.length) {\r\n              data[i] = r.charCodeAt(i);\r\n              i++;\r\n            }\r\n          }\r\n          return cb(data, xhr.responseHeaders);\r\n        },\r\n        onerror() {\r\n          return cb(null);\r\n        },\r\n        onabort() {\r\n          return cb(null);\r\n        }\r\n      };\r\n      try {\r\n        return (GM?.xmlHttpRequest || GM_xmlhttpRequest)(gmOptions);\r\n      } catch (error) {\r\n        return fallback();\r\n      }\r\n    }\r\n  },\r\n\r\n  file(url, cb) {\r\n    return CrossOrigin.binary(url, function(data, headers) {\r\n      if (data == null) { return cb(null); }\r\n      let name = url.match(/([^\\/?#]+)\\/*(?:$|[?#])/)?.[1];\r\n      const contentType        = headers.match(/Content-Type:\\s*(.*)/i)?.[1];\r\n      const contentDisposition = headers.match(/Content-Disposition:\\s*(.*)/i)?.[1];\r\n      let mime = contentType?.match(/[^;]*/)[0] || 'application/octet-stream';\r\n      const match =\r\n        contentDisposition?.match(/\\bfilename\\s*=\\s*\"((\\\\\"|[^\"])+)\"/i)?.[1] ||\r\n        contentType?.match(/\\bname\\s*=\\s*\"((\\\\\"|[^\"])+)\"/i)?.[1];\r\n      if (match) {\r\n        name = match.replace(/\\\\\"/g, '\"');\r\n      }\r\n      if (/^text\\/plain;\\s*charset=x-user-defined$/i.test(mime)) {\r\n        // In JS Blocker (Safari) content type comes back as 'text/plain; charset=x-user-defined'; guess from filename instead.\r\n        mime = $.getOwn(QR.typeFromExtension, name.match(/[^.]*$/)[0].toLowerCase()) || 'application/octet-stream';\r\n      }\r\n      const blob = new Blob([data], {type: mime});\r\n      blob.name = name;\r\n      return cb(blob);\r\n    });\r\n  },\r\n\r\n  Request: (function() {\r\n    const Request = class Request {\r\n      static initClass() {\r\n        this.prototype.status = 0;\r\n        this.prototype.statusText = '';\r\n        this.prototype.response = null;\r\n        this.prototype.responseHeaderString = null;\r\n      }\r\n      getResponseHeader(headerName) {\r\n        if ((this.responseHeaders == null) && (this.responseHeaderString != null)) {\r\n          this.responseHeaders = dict();\r\n          for (var header of this.responseHeaderString.split('\\r\\n')) {\r\n            var i;\r\n            if ((i = header.indexOf(':')) >= 0) {\r\n              var key = header.slice(0, i).trim().toLowerCase();\r\n              var val = header.slice(i+1).trim();\r\n              this.responseHeaders[key] = val;\r\n            }\r\n          }\r\n        }\r\n        return this.responseHeaders?.[headerName.toLowerCase()] ?? null;\r\n      }\r\n      abort() {}\r\n      onloadend() {}\r\n    };\r\n    Request.initClass();\r\n    return Request;\r\n  })(),\r\n\r\n  // Attempts to fetch `url` using cross-origin privileges, if available.\r\n  // Interface is a subset of that of $.ajax.\r\n  // Options:\r\n  //   `onloadend` - called with the returned object as `this` on success or error/abort/timeout.\r\n  //   `timeout` - time limit for request\r\n  //   `responseType` - expected response type, 'json' by default; 'json' and 'text' supported\r\n  //   `headers` - request headers\r\n  // Returned object properties:\r\n  //   `status` - HTTP status (0 if connection not successful)\r\n  //   `statusText` - HTTP status text\r\n  //   `response` - decoded response body\r\n  //   `abort` - function for aborting the request (silently fails on some platforms)\r\n  //   `getResponseHeader` - function for reading response headers\r\n  ajax(url, options={}) {\r\n    let gmReq;\r\n    let {onloadend, timeout, responseType, headers} = options;\r\n    if (responseType == null) { responseType = 'json'; }\r\n\r\n    if ((window.GM?.xmlHttpRequest == null) && (typeof window.GM_xmlhttpRequest === 'undefined' || window.GM_xmlhttpRequest === null)) {\r\n      return $.ajax(url, options);\r\n    }\r\n\r\n    const req = new CrossOrigin.Request();\r\n    req.onloadend = onloadend;\r\n\r\n    if (platform === 'userscript') {\r\n      const gmOptions = {\r\n        method: 'GET',\r\n        url,\r\n        headers,\r\n        timeout,\r\n        onload(xhr) {\r\n          try {\r\n            const response = (() => { switch (responseType) {\r\n              case 'json':\r\n                if (xhr.responseText) { return JSON.parse(xhr.responseText); } else { return null; }\r\n              default:\r\n                return xhr.responseText;\r\n            } })();\r\n            $.extend(req, {\r\n              response,\r\n              status: xhr.status,\r\n              statusText: xhr.statusText,\r\n              responseHeaderString: xhr.responseHeaders\r\n            });\r\n          } catch (error) {}\r\n          return req.onloadend();\r\n        },\r\n        onerror() { return req.onloadend(); },\r\n        onabort() { return req.onloadend(); },\r\n        ontimeout() { return req.onloadend(); }\r\n      };\r\n      try {\r\n        gmReq = (GM?.xmlHttpRequest || GM_xmlhttpRequest)(gmOptions);\r\n      } catch (error) {\r\n        return $.ajax(url, options);\r\n      }\r\n\r\n      if (gmReq && (typeof gmReq.abort === 'function')) {\r\n        req.abort = function() {\r\n          try {\r\n            return gmReq.abort();\r\n          } catch (error1) {}\r\n        };\r\n      }\r\n    } else {\r\n      eventPageRequest({type: 'ajax', url, responseType, headers, timeout}, function(result) {\r\n        if (result.status) {\r\n          $.extend(req, result);\r\n        }\r\n        return req.onloadend();\r\n      });\r\n    }\r\n\r\n    return req;\r\n  },\r\n\r\n  cache(url, cb) {\r\n    return $.cache(url, cb,\r\n      {ajax: CrossOrigin.ajax});\r\n  },\r\n\r\n  permission(cb, cbFail, origins) {\r\n    if (platform === 'crx') {\r\n      return eventPageRequest({type: 'permission', origins}, function(result) {\r\n        if (result) {\r\n          return cb();\r\n        } else {\r\n          return cbFail();\r\n        }\r\n      });\r\n    }\r\n    return cb();\r\n  },\r\n};\r\nexport default CrossOrigin;\r\n",null,"import { Conf, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Get = {\r\n  url(type, IDs, ...args) {\r\n    let f, site;\r\n    if ((site = g.sites[IDs.siteID]) && (f = $.getOwn(site.urls, type))) {\r\n      return f(IDs, ...args);\r\n    } else {\r\n      return undefined;\r\n    }\r\n  },\r\n  threadExcerpt(thread) {\r\n    const {OP} = thread;\r\n    const excerpt = (`/${decodeURIComponent(thread.board.ID)}/ - `) + (\r\n      OP.info.subject?.trim() ||\r\n      OP.commentDisplay().replace(/\\n+/g, ' // ') ||\r\n      OP.file?.name ||\r\n      `No.${OP}`);\r\n    if (excerpt.length > 73) { return `${excerpt.slice(0, 70)}...`; }\r\n    return excerpt;\r\n  },\r\n  threadFromRoot(root) {\r\n    if (root == null) { return null; }\r\n    const {board} = root.dataset;\r\n    return g.threads.get(`${board ? encodeURIComponent(board) : g.BOARD.ID}.${root.id.match(/\\d*$/)[0]}`);\r\n  },\r\n  threadFromNode(node) {\r\n    return Get.threadFromRoot($.x(`ancestor-or-self::${g.SITE.xpath.thread}`, node));\r\n  },\r\n  postFromRoot(root) {\r\n    if (root == null) { return null; }\r\n    const post  = g.posts.get(root.dataset.fullID);\r\n    const index = root.dataset.clone;\r\n    if (index) { return post.clones[+index]; } else { return post; }\r\n  },\r\n  postFromNode(root) {\r\n    return Get.postFromRoot($.x(`ancestor-or-self::${g.SITE.xpath.postContainer}[1]`, root));\r\n  },\r\n  postDataFromLink(link) {\r\n    let boardID, postID, threadID;\r\n    if (link.dataset.postID) { // resurrected quote\r\n      ({boardID, threadID, postID} = link.dataset);\r\n      if (!threadID) { threadID = 0; }\r\n    } else {\r\n      const match = link.href.match(g.SITE.regexp.quotelink);\r\n      [boardID, threadID, postID] = match.slice(1);\r\n      if (!postID) { postID = threadID; }\r\n    }\r\n    return {\r\n      boardID,\r\n      threadID: +threadID,\r\n      postID:   +postID\r\n    };\r\n  },\r\n  allQuotelinksLinkingTo(post) {\r\n    // Get quotelinks & backlinks linking to the given post.\r\n    const quotelinks = [];\r\n    const {posts} = g;\r\n    const {fullID} = post;\r\n    const handleQuotes = function(qPost, type) {\r\n      quotelinks.push(...(qPost.nodes[type] || []));\r\n      for (var clone of qPost.clones) { quotelinks.push(...(clone.nodes[type] || [])); }\r\n    };\r\n    // First:\r\n    //   In every posts,\r\n    //   if it did quote this post,\r\n    //   get all their backlinks.\r\n    posts.forEach(function(qPost) {\r\n      if (qPost.quotes.includes(fullID)) {\r\n        return handleQuotes(qPost, 'quotelinks');\r\n      }\r\n    });\r\n\r\n    // Second:\r\n    //   If we have quote backlinks:\r\n    //   in all posts this post quoted\r\n    //   and their clones,\r\n    //   get all of their backlinks.\r\n    if (Conf['Quote Backlinks']) {\r\n      for (var quote of post.quotes) { var qPost;\r\n      if ((qPost = posts.get(quote))) { handleQuotes(qPost, 'backlinks'); } }\r\n    }\r\n\r\n    // Third:\r\n    //   Filter out irrelevant quotelinks.\r\n    return quotelinks.filter(function(quotelink) {\r\n      const {boardID, postID} = Get.postDataFromLink(quotelink);\r\n      return (boardID === post.board.ID) && (postID === post.ID);\r\n    });\r\n  }\r\n};\r\nexport default Get;\r\n",null,"import { Conf, doc, g } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\nimport SW from \"./SW\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Site = {\r\n  defaultProperties: {\r\n    '4chan.org':    {software: 'yotsuba'},\r\n    '4channel.org': {canonical: '4chan.org'},\r\n    '4cdn.org':     {canonical: '4chan.org'},\r\n    'notso.smuglo.li': {canonical: 'smuglo.li'},\r\n    'smugloli.net':    {canonical: 'smuglo.li'},\r\n    'smug.nepu.moe':   {canonical: 'smuglo.li'}\r\n  },\r\n\r\n  init(cb) {\r\n    $.extend(Conf['siteProperties'], Site.defaultProperties);\r\n    let hostname = Site.resolve();\r\n    if (hostname && $.hasOwn(SW, Conf['siteProperties'][hostname].software)) {\r\n      this.set(hostname);\r\n      cb();\r\n    }\r\n    return $.onExists(doc, 'body', () => {\r\n      for (var software in SW) {\r\n        var changes;\r\n        if (changes = SW[software].detect?.()) {\r\n          changes.software = software;\r\n          hostname = location.hostname.replace(/^www\\./, '');\r\n          var properties = (Conf['siteProperties'][hostname] || (Conf['siteProperties'][hostname] = dict()));\r\n          var changed = 0;\r\n          for (var key in changes) {\r\n            if (properties[key] !== changes[key]) {\r\n              properties[key] = changes[key];\r\n              changed++;\r\n            }\r\n          }\r\n          if (changed) {\r\n            $.set('siteProperties', Conf['siteProperties']);\r\n          }\r\n          if (!g.SITE) {\r\n            this.set(hostname);\r\n            cb();\r\n          }\r\n          return;\r\n        }\r\n      }\r\n    });\r\n  },\r\n\r\n  resolve(url=location) {\r\n    let {hostname} = url;\r\n    while (hostname && !$.hasOwn(Conf['siteProperties'], hostname)) {\r\n      hostname = hostname.replace(/^[^.]*\\.?/, '');\r\n    }\r\n    if (hostname) {\r\n      let canonical;\r\n      if (canonical = Conf['siteProperties'][hostname].canonical) { hostname = canonical; }\r\n    }\r\n    return hostname;\r\n  },\r\n\r\n  parseURL(url) {\r\n    const siteID = Site.resolve(url);\r\n    return Main.parseURL(g.sites[siteID], url);\r\n  },\r\n\r\n  set(hostname) {\r\n    for (var ID in Conf['siteProperties']) {\r\n      var site;\r\n      var properties = Conf['siteProperties'][ID];\r\n      if (properties.canonical) { continue; }\r\n      var {\r\n        software\r\n      } = properties;\r\n      if (!software || !$.hasOwn(SW, software)) { continue; }\r\n      g.sites[ID] = (site = Object.create(SW[software]));\r\n      $.extend(site, {ID, siteID: ID, properties, software});\r\n    }\r\n    return g.SITE = g.sites[hostname];\r\n  }\r\n};\r\nexport default Site;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Filter from \"../Filtering/Filter\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport meta from '../../package.json';\r\nimport Index from \"../General/Index\";\r\nimport Site from \"../site/Site\";\r\nimport Header from \"../General/Header\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport UI from \"../General/UI\";\r\nimport Get from \"../General/Get\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar CatalogLinks = {\r\n  init() {\r\n    if ((g.SITE.software === 'yotsuba') && (Conf['External Catalog'] || Conf['JSON Index']) && !(Conf['JSON Index'] && (g.VIEW === 'index'))) {\r\n      const selector = (() => { switch (g.VIEW) {\r\n        case 'thread': case 'archive': return '.navLinks.desktop > a';\r\n        case 'catalog':           return '.navLinks > :first-child > a';\r\n        case 'index':             return '#ctrl-top > a, .cataloglink > a';\r\n      } })();\r\n      $.ready(function() {\r\n        for (var link of $$(selector)) {\r\n          var catalogURL;\r\n          switch (link.pathname.replace(/\\/+/g, '/')) {\r\n            case `/${g.BOARD}/`:\r\n              if (Conf['JSON Index']) { link.textContent = 'Index'; }\r\n              link.href = CatalogLinks.index();\r\n              break;\r\n            case `/${g.BOARD}/catalog`:\r\n              link.href = CatalogLinks.catalog();\r\n              break;\r\n          }\r\n          if ((g.VIEW === 'catalog') && ((catalogURL = CatalogLinks.catalog()) !== g.SITE.urls.catalog?.(g.BOARD))) {\r\n            var catalogLink = link.parentNode.cloneNode(true);\r\n            var link2 = catalogLink.firstElementChild;\r\n            link2.href = catalogURL;\r\n            link2.textContent = link2.hostname === location.hostname ? `${meta.name} Catalog` : 'External Catalog';\r\n            $.after(link.parentNode, [$.tn(' '), catalogLink]);\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    if ((g.SITE.software === 'yotsuba') && Conf['JSON Index'] && Conf[`Use ${meta.name} Catalog`]) {\r\n      Callbacks.Post.push({\r\n        name: 'Catalog Link Rewrite',\r\n        cb:   this.node\r\n      });\r\n    }\r\n\r\n    if (this.enabled = Conf['Catalog Links']) {\r\n      let el;\r\n      CatalogLinks.el = (el = UI.checkbox('Header catalog links', 'Catalog Links'));\r\n      el.id = 'toggleCatalog';\r\n      const input = $('input', el);\r\n      $.on(input, 'change', this.toggle);\r\n      $.sync('Header catalog links', CatalogLinks.set);\r\n      return Header.menu.addEntry({\r\n        el,\r\n        order: 95\r\n      });\r\n    }\r\n  },\r\n\r\n  node() {\r\n    for (var a of $$('a', this.nodes.comment)) {\r\n      var m;\r\n      if (m = a.href.match(/^https?:\\/\\/(boards\\.4chan(?:nel)?\\.org\\/[^\\/]+)\\/catalog(#s=.*)?/)) {\r\n        a.href = `//${m[1]}/${m[2] || '#catalog'}`;\r\n      }\r\n    }\r\n  },\r\n\r\n  toggle() {\r\n    $.event('CloseMenu');\r\n    $.set('Header catalog links', this.checked);\r\n    return CatalogLinks.set(this.checked);\r\n  },\r\n\r\n  set(useCatalog) {\r\n    Conf['Header catalog links'] = useCatalog;\r\n    CatalogLinks.setLinks(Header.boardList);\r\n    CatalogLinks.setLinks(Header.bottomBoardList);\r\n    CatalogLinks.el.title = `Turn catalog links ${useCatalog ? 'off' : 'on'}.`;\r\n    return $('input', CatalogLinks.el).checked = useCatalog;\r\n  },\r\n\r\n  // Also called by Header when board lists are loaded / generated.\r\n  setLinks(list) {\r\n    if ((!(CatalogLinks.enabled ?? Conf['Catalog Links'])) || !list) { return; }\r\n\r\n    // do not transform links unless they differ from the expected value at most by this tail\r\n    const tail = /(?:index)?(?:\\.\\w+)?$/;\r\n\r\n    for (var a of $$('a:not([data-only])', list)) {\r\n      var {siteID, boardID} = a.dataset;\r\n      if (!siteID || !boardID) {\r\n        var VIEW;\r\n        ({siteID, boardID, VIEW} = Site.parseURL(a));\r\n        if (\r\n          !siteID || !boardID ||\r\n          !['index', 'catalog'].includes(VIEW) ||\r\n          (!a.dataset.indexOptions && (a.href.replace(tail, '') !== (Get.url(VIEW, {siteID, boardID}) || '').replace(tail, '')))\r\n        ) { continue; }\r\n        $.extend(a.dataset, {siteID, boardID});\r\n      }\r\n\r\n      var board = {siteID, boardID};\r\n      var url = Conf['Header catalog links'] ? CatalogLinks.catalog(board) : Get.url('index', board);\r\n      if (url) {\r\n        a.href = url;\r\n        if (a.dataset.indexOptions && (url.split('#')[0] === Get.url('index', board))) {\r\n          a.href += (a.hash ? '/' : '#') + a.dataset.indexOptions;\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  externalParse() {\r\n    CatalogLinks.externalList = dict();\r\n    for (var line of Conf['externalCatalogURLs'].split('\\n')) {\r\n      if (line[0] === '#') { continue; }\r\n      var url = line.split(';')[0];\r\n      var boards   = Filter.parseBoards(line.match(/;boards:([^;]+)/)?.[1] || '*');\r\n      var excludes = Filter.parseBoards(line.match(/;exclude:([^;]+)/)?.[1]) || dict();\r\n      for (var board in boards) {\r\n        if (!excludes[board] && !excludes[board.split('/')[0] + '/*']) {\r\n          CatalogLinks.externalList[board] = url;\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  external({siteID, boardID}) {\r\n    if (!CatalogLinks.externalList) { CatalogLinks.externalParse(); }\r\n    const external = (CatalogLinks.externalList[`${siteID}/${boardID}`] || CatalogLinks.externalList[`${siteID}/*`]);\r\n    if (external) { return external.replace(/%board/g, boardID); } else { return undefined; }\r\n  },\r\n\r\n  jsonIndex(board, hash) {\r\n    if ((g.SITE.ID === board.siteID) && (g.BOARD.ID === board.boardID) && (g.VIEW === 'index')) {\r\n      return hash;\r\n    } else {\r\n      return Get.url('index', board) + hash;\r\n    }\r\n  },\r\n\r\n  catalog(board=g.BOARD) {\r\n    let external, nativeCatalog;\r\n    if (Conf['External Catalog'] && (external = CatalogLinks.external(board))) {\r\n      return external;\r\n    } else if (Index.enabledOn(board) && Conf[`Use ${meta.name} Catalog`]) {\r\n      return CatalogLinks.jsonIndex(board, '#catalog');\r\n    } else if (nativeCatalog = Get.url('catalog', board)) {\r\n      return nativeCatalog;\r\n    } else {\r\n      return CatalogLinks.external(board);\r\n    }\r\n  },\r\n\r\n  index(board=g.BOARD) {\r\n    if (Index.enabledOn(board)) {\r\n      return CatalogLinks.jsonIndex(board, '#index');\r\n    } else {\r\n      return Get.url('index', board);\r\n    }\r\n  }\r\n};\r\nexport default CatalogLinks;\r\n",null,"import Header from \"../General/Header\";\r\nimport { d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { SECOND } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nexport default class Notice {\r\n  constructor(type, content, timeout, onclose) {\r\n    this.add = this.add.bind(this);\r\n    this.close = this.close.bind(this);\r\n    this.timeout = timeout;\r\n    this.onclose = onclose;\r\n    this.el = $.el('div',\r\n      {innerHTML: \"<a href=\\\"javascript:;\\\" class=\\\"close\\\" title=\\\"Close\\\">✕</a><div class=\\\"message\\\"></div>\"});\r\n    this.el.style.opacity = 0;\r\n    this.setType(type);\r\n    $.on(this.el.firstElementChild, 'click', this.close);\r\n    if (typeof content === 'string') {\r\n      content = $.tn(content);\r\n    }\r\n    $.add(this.el.lastElementChild, content);\r\n\r\n    $.ready(this.add);\r\n  }\r\n\r\n  setType(type) {\r\n    return this.el.className = `notification ${type}`;\r\n  }\r\n\r\n  add() {\r\n    if (this.closed) { return; }\r\n    if (d.hidden) {\r\n      $.on(d, 'visibilitychange', this.add);\r\n      return;\r\n    }\r\n    $.off(d, 'visibilitychange', this.add);\r\n    $.add(Header.noticesRoot, this.el);\r\n    this.el.clientHeight; // force reflow\r\n    this.el.style.opacity = 1;\r\n    if (this.timeout) { return setTimeout(this.close, this.timeout * SECOND); }\r\n  }\r\n\r\n  close() {\r\n    this.closed = true;\r\n    $.off(d, 'visibilitychange', this.add);\r\n    $.rm(this.el);\r\n    return this.onclose?.();\r\n  }\r\n}\r\n",null,"import { g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport Board from \"./Board\";\r\nimport Thread from \"./Thread\";\r\n\r\nexport default class CatalogThreadNative {\r\n  toString() { return this.ID; }\r\n\r\n  constructor(root) {\r\n    this.nodes = {\r\n      root,\r\n      thumb: $(g.SITE.selectors.catalog.thumb, root)\r\n    };\r\n    this.siteID  = g.SITE.ID;\r\n    this.boardID = this.nodes.thumb.parentNode.pathname.split(/\\/+/)[1];\r\n    this.board = g.boards[this.boardID] || new Board(this.boardID);\r\n    this.ID = (this.threadID = +(root.dataset.id || root.id).match(/\\d*$/)[0]);\r\n    this.thread = this.board.threads.get(this.ID) || new Thread(this.ID, this.board);\r\n  }\r\n}\r\n","import { Conf, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst Anonymize = {\r\n  init() {\r\n    if (!Conf['Anonymize']) { return; }\r\n    return $.addClass(doc, 'anonymize');\r\n  }\r\n};\r\nexport default Anonymize;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Header from \"../General/Header\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { SECOND } from \"../platform/helpers\";\r\nimport ImageCommon from \"./ImageCommon\";\r\nimport Volume from \"./Volume\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ImageHover = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW)) { return; }\r\n    if (Conf['Image Hover']) {\r\n      Callbacks.Post.push({\r\n        name: 'Image Hover',\r\n        cb:   this.node\r\n      });\r\n    }\r\n    if (Conf['Image Hover in Catalog']) {\r\n      return Callbacks.CatalogThread.push({\r\n        name: 'Image Hover',\r\n        cb:   this.catalogNode\r\n      });\r\n    }\r\n  },\r\n\r\n  node() {\r\n    return this.files.filter((file) => (file.isImage || file.isVideo) && file.thumb).map((file) =>\r\n      $.on(file.thumb, 'mouseover', ImageHover.mouseover(this, file)));\r\n  },\r\n\r\n  catalogNode() {\r\n    const file = this.thread.OP.files[0];\r\n    if (!file || (!file.isImage && !file.isVideo)) { return; }\r\n    return $.on(this.nodes.thumb, 'mouseover', ImageHover.mouseover(this.thread.OP, file));\r\n  },\r\n\r\n  mouseover(post, file) { return function(e) {\r\n    let el, height, width;\r\n    if (!doc.contains(this)) { return; }\r\n    const {isVideo} = file;\r\n    if (file.isExpanding || file.isExpanded || g.SITE.isThumbExpanded?.(file)) { return; }\r\n    const error = ImageHover.error(post, file);\r\n    if (ImageCommon.cache?.dataset.fileID === `${post.fullID}.${file.index}`) {\r\n      el = ImageCommon.popCache();\r\n      $.on(el, 'error', error);\r\n    } else {\r\n      el = $.el((isVideo ? 'video' : 'img'));\r\n      el.dataset.fileID = `${post.fullID}.${file.index}`;\r\n      $.on(el, 'error', error);\r\n      el.src = file.url;\r\n    }\r\n\r\n    if (Conf['Restart when Opened']) {\r\n      ImageCommon.rewind(el);\r\n      ImageCommon.rewind(this);\r\n    }\r\n    el.id = 'ihover';\r\n    $.add(Header.hover, el);\r\n    if (isVideo) {\r\n      el.loop     = true;\r\n      el.controls = false;\r\n      Volume.setup(el);\r\n      if (Conf['Autoplay']) {\r\n        el.play();\r\n        if (this.nodeName === 'VIDEO') { this.currentTime = el.currentTime; }\r\n      }\r\n    }\r\n    if (file.dimensions) {\r\n      [width, height] = file.dimensions.split('x').map((x) => +x);\r\n      const maxWidth = doc.clientWidth;\r\n      const maxHeight = doc.clientHeight - UI.hover.padding;\r\n      const scale = Math.min(1, maxWidth / width, maxHeight / height);\r\n      width *= scale;\r\n      height *= scale;\r\n      el.style.maxWidth  = `${width}px`;\r\n      el.style.maxHeight = `${height}px`;\r\n    }\r\n    return UI.hover({\r\n      root: this,\r\n      el,\r\n      latestEvent: e,\r\n      endEvents: 'mouseout click',\r\n      height,\r\n      width,\r\n      noRemove: true,\r\n      cb() {\r\n        $.off(el, 'error', error);\r\n        ImageCommon.pushCache(el);\r\n        ImageCommon.pause(el);\r\n        $.rm(el);\r\n        return el.removeAttribute('style');\r\n      }\r\n    });\r\n  }; },\r\n\r\n  error(post, file) { return function() {\r\n    if (ImageCommon.decodeError(this, file)) { return; }\r\n    return ImageCommon.error(this, post, file, 3 * SECOND, URL => {\r\n      if (URL) {\r\n        return this.src = URL + (this.src === URL ? '?' + Date.now() : '');\r\n      } else {\r\n        return $.rm(this);\r\n      }\r\n    });\r\n  }; }\r\n};\r\nexport default ImageHover;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Header from \"../General/Header\";\r\nimport { g, Conf, d, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ImageLoader = {\r\n  init() {\r\n    if (!['index', 'thread', 'archive'].includes(g.VIEW)) { return; }\r\n    const replace = Conf['Replace JPG'] || Conf['Replace PNG'] || Conf['Replace GIF'] || Conf['Replace WEBM'];\r\n    if (!Conf['Image Prefetching'] && !replace) { return; }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Image Replace',\r\n      cb:   this.node\r\n    });\r\n\r\n    $.on(d, 'PostsInserted', function() {\r\n      if (ImageLoader.prefetchEnabled || replace) {\r\n        return g.posts.forEach(ImageLoader.prefetchAll);\r\n      }\r\n    });\r\n\r\n    if (Conf['Replace WEBM']) {\r\n      $.on(d, 'scroll visibilitychange 4chanXInitFinished PostsInserted', this.playVideos);\r\n    }\r\n\r\n    if (!Conf['Image Prefetching'] || !['index', 'thread'].includes(g.VIEW)) { return; }\r\n\r\n    const el = $.el('a', {\r\n      href: 'javascript:;',\r\n      title: 'Prefetch Images',\r\n      innerHTML: 'Prefetch',\r\n    });\r\n\r\n    $.on(el, 'click', this.toggle);\r\n\r\n    return Header.addShortcut('prefetch', el, 525, '🗲︎');\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) { return; }\r\n    for (var file of this.files) {\r\n      if (Conf['Replace WEBM'] && file.isVideo) { ImageLoader.replaceVideo(this, file); }\r\n      ImageLoader.prefetch(this, file);\r\n    }\r\n  },\r\n\r\n  replaceVideo(post, file) {\r\n    const {thumb} = file;\r\n    const video = $.el('video', {\r\n      preload:     'none',\r\n      loop:        true,\r\n      muted:       true,\r\n      poster:      thumb.src || thumb.dataset.src,\r\n      textContent: thumb.alt,\r\n      className:   thumb.className\r\n    }\r\n    );\r\n    video.setAttribute('muted', 'muted');\r\n    video.dataset.md5 = thumb.dataset.md5;\r\n    for (var attr of ['height', 'width', 'maxHeight', 'maxWidth']) { video.style[attr] = thumb.style[attr]; }\r\n    video.src         = file.url;\r\n    $.replace(thumb, video);\r\n    file.thumb      = video;\r\n    return file.videoThumb = true;\r\n  },\r\n\r\n  prefetch(post, file) {\r\n    let clone, type;\r\n    const {isImage, isVideo, thumb, url} = file;\r\n    if (file.isPrefetched || !(isImage || isVideo) || post.isHidden || post.thread.isHidden) { return; }\r\n    if (isVideo) {\r\n      type = 'WEBM';\r\n    } else {\r\n      type = url.match(/\\.([^.]+)$/)?.[1].toUpperCase();\r\n      if (type === 'JPEG') { type = 'JPG'; }\r\n    }\r\n    const replace = Conf[`Replace ${type}`] && !/spoiler/.test(thumb.src || thumb.dataset.src);\r\n    if (!replace && !ImageLoader.prefetchEnabled) { return; }\r\n    if ($.hasClass(doc, 'catalog-mode')) { return; }\r\n    if (![post, ...post.clones].some(clone => doc.contains(clone.nodes.root))) { return; }\r\n    file.isPrefetched = true;\r\n    if (file.videoThumb) {\r\n      for (clone of post.clones) { clone.file.thumb.preload = 'auto'; }\r\n      thumb.preload = 'auto';\r\n      // XXX Cloned video elements with poster in Firefox cause momentary display of image loading icon.\r\n      if ($.engine === 'gecko') {\r\n        $.on(thumb, 'loadeddata', function() { return this.removeAttribute('poster'); });\r\n      }\r\n      return;\r\n    }\r\n\r\n    const el = $.el(isImage ? 'img' : 'video');\r\n    if (isVideo) { el.preload = 'auto'; }\r\n    if (replace && isImage) {\r\n      $.on(el, 'load', function() {\r\n        for (clone of post.clones) { clone.file.thumb.src = url; }\r\n        return thumb.src = url;\r\n      });\r\n    }\r\n    return el.src = url;\r\n  },\r\n\r\n  prefetchAll(post) {\r\n    for (var file of post.files) {\r\n      ImageLoader.prefetch(post, file);\r\n    }\r\n  },\r\n\r\n  toggle() {\r\n    ImageLoader.prefetchEnabled = !ImageLoader.prefetchEnabled;\r\n    this.classList.toggle('disabled', !ImageLoader.prefetchEnabled);\r\n    if (ImageLoader.prefetchEnabled) {\r\n      g.posts.forEach(ImageLoader.prefetchAll);\r\n    }\r\n  },\r\n\r\n  playVideos() {\r\n    // Special case: Quote previews are off screen when inserted into document, but quickly moved on screen.\r\n    const qpClone = $.id('qp')?.firstElementChild;\r\n    return g.posts.forEach(function(post) {\r\n      for (post of [post, ...post.clones]) {\r\n        for (var file of post.files) {\r\n          if (file.videoThumb) {\r\n            var {thumb} = file;\r\n            if (Header.isNodeVisible(thumb) || (post.nodes.root === qpClone)) { thumb.play(); } else { thumb.pause(); }\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n};\r\nexport default ImageLoader;\r\n","import $ from \"../platform/$\";\r\nimport Callbacks from \"../classes/Callbacks\";\r\nimport CrossOrigin from \"../platform/CrossOrigin\";\r\nimport { Conf, d, g } from \"../globals/globals\";\r\nimport Get from \"../General/Get\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Metadata = {\r\n  init() {\r\n    if (!Conf['WEBM Metadata'] || !['index', 'thread'].includes(g.VIEW)) { return; }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'WEBM Metadata',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    for (let i = 0; i < this.files.length; i++) {\r\n      var file = this.files[i];\r\n      if (/webm$/i.test(file.url)) {var el;\r\n      \r\n        if (this.isClone) {\r\n          el = $('.webm-title', file.text);\r\n        } else {\r\n          el = $.el('span',\r\n            {className: 'webm-title'});\r\n          el.dataset.index = i;\r\n          $.extend(el,\r\n            {innerHTML: \"<a href=\\\"javascript:;\\\"></a>\"});\r\n          $.add(file.text, [$.tn(' '), el]);\r\n        }\r\n        if (el.children.length === 1) { $.one(el.lastElementChild, 'mouseover focus', Metadata.load); }\r\n      }\r\n    }\r\n  },\r\n\r\n  load() {\r\n    $.rmClass(this.parentNode, 'error');\r\n    $.addClass(this.parentNode, 'loading');\r\n    const {index} = this.parentNode.dataset;\r\n    return CrossOrigin.binary(Get.postFromNode(this).files[+index].url, data => {\r\n      $.rmClass(this.parentNode, 'loading');\r\n      if (data != null) {\r\n        const title = Metadata.parse(data);\r\n        const output = $.el('span',\r\n          {textContent: title || ''});\r\n        if (title == null) { $.addClass(this.parentNode, 'not-found'); }\r\n        $.before(this, output);\r\n        this.parentNode.tabIndex = 0;\r\n        if (d.activeElement === this) { this.parentNode.focus(); }\r\n        return this.tabIndex = -1;\r\n      } else {\r\n        $.addClass(this.parentNode, 'error');\r\n        return $.one(this, 'click', Metadata.load);\r\n      }\r\n    }\r\n    ,\r\n      {Range: 'bytes=0-9999'});\r\n  },\r\n\r\n  parse(data) {\r\n    const readInt = function() {\r\n      let n = data[i++];\r\n      let len = 0;\r\n      while (n < (0x80 >> len)) { len++; }\r\n      n ^= (0x80 >> len);\r\n      while (len-- && (i < data.length)) {\r\n        n = (n << 8) ^ data[i++];\r\n      }\r\n      return n;\r\n    };\r\n\r\n    var i = 0;\r\n    while (i < data.length) {\r\n      var element = readInt();\r\n      var size    = readInt();\r\n      if (element === 0x3BA9) { // Title\r\n        var title = '';\r\n        while (size-- && (i < data.length)) {\r\n          title += String.fromCharCode(data[i++]);\r\n        }\r\n        return decodeURIComponent(escape(title)); // UTF-8 decoding\r\n      } else if (![0x8538067, 0x549A966].includes(element)) { // Segment, Info\r\n        i += size;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n};\r\nexport default Metadata;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g, Conf } from \"../globals/globals\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst RevealSpoilers = {\r\n  init() {\r\n    if (!['index', 'thread', 'archive'].includes(g.VIEW) || !Conf['Reveal Spoiler Thumbnails']) { return; }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Reveal Spoiler Thumbnails',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) { return; }\r\n    for (var file of this.files) {\r\n      if (file.thumb && file.isSpoiler) {\r\n        var {thumb} = file;\r\n        // Remove old width and height.\r\n        thumb.removeAttribute('style');\r\n        // Enforce thumbnail size if thumbnail is replaced.\r\n        thumb.style.maxHeight = (thumb.style.maxWidth = this.isReply ? '125px' : '250px');\r\n        if (thumb.src) {\r\n          thumb.src = file.thumbURL;\r\n        } else {\r\n          thumb.dataset.src = file.thumbURL;\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default RevealSpoilers;\r\n","import Callbacks from \"../classes/Callbacks\";\r\n// import Test from \"../General/Test\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport ImageHost from \"../Images/ImageHost\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport Embedding from \"./Embedding\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Linkify = {\r\n  init() {\r\n    if (!['index', 'thread', 'archive'].includes(g.VIEW) || !Conf['Linkify']) { return; }\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Linkify',\r\n      cb:   this.node\r\n    });\r\n\r\n    return Embedding.init();\r\n  },\r\n\r\n  node() {\r\n    let link;\r\n    if (this.isClone) { return Embedding.events(this); }\r\n    if (!Linkify.regString.test(this.info.comment)) { return; }\r\n    for (link of $$('a', this.nodes.comment)) {\r\n      if (g.SITE.isLinkified?.(link)) {\r\n        $.addClass(link, 'linkify');\r\n        if (ImageHost.useFaster) { ImageHost.fixLinks([link]); }\r\n        Embedding.process(link, this);\r\n      }\r\n    }\r\n    const links = Linkify.process(this.nodes.comment);\r\n    if (ImageHost.useFaster) { ImageHost.fixLinks(links); }\r\n    for (link of links) { Embedding.process(link, this); }\r\n  },\r\n\r\n  process(node) {\r\n    let length;\r\n    const test     = /[^\\s\"]+/g;\r\n    const space    = /[\\s\"]/;\r\n    const snapshot = $.X('.//br|.//text()', node);\r\n    let i = 0;\r\n    const links = [];\r\n    while ((node = snapshot.snapshotItem(i++))) {\r\n      var result;\r\n      var {data} = node;\r\n      if (!data || (node.parentElement.nodeName === \"A\")) { continue; }\r\n\r\n      while ((result = test.exec(data))) {\r\n        var {index} = result;\r\n        var endNode = node;\r\n        var word    = result[0];\r\n        // End of node, not necessarily end of space-delimited string\r\n        if ((length = index + word.length) === data.length) {\r\n          var saved;\r\n          test.lastIndex = 0;\r\n\r\n          while (saved = snapshot.snapshotItem(i++)) {\r\n            var end;\r\n            if ((saved.nodeName === 'BR') || ((saved.parentElement.nodeName === 'P') && !saved.previousSibling)) {\r\n              var part1, part2;\r\n              if (\r\n                // link deliberately split\r\n                (part1 = word.match(/(https?:\\/\\/)?([a-z\\d-]+\\.)*[a-z\\d-]+$/i)) &&\r\n                (part2 = snapshot.snapshotItem(i)?.data?.match(/^(\\.[a-z\\d-]+)*\\//i)) &&\r\n                ((part1[0] + part2[0]).search(Linkify.regString) === 0)\r\n              ) {\r\n                continue;\r\n              } else {\r\n                break;\r\n              }\r\n            }\r\n\r\n            if ((saved.parentElement.nodeName === \"A\") && !Linkify.regString.test(word)) {\r\n              break;\r\n            }\r\n\r\n            endNode  = saved;\r\n            ({data}   = saved);\r\n\r\n            if (end = space.exec(data)) {\r\n              // Set our snapshot and regex to start on this node at this position when the loop resumes\r\n              word += data.slice(0, end.index);\r\n              test.lastIndex = (length = end.index);\r\n              i--;\r\n              break;\r\n            } else {\r\n              ({length} = data);\r\n              word    += data;\r\n            }\r\n          }\r\n        }\r\n\r\n        if (Linkify.regString.test(word)) {\r\n          links.push(Linkify.makeRange(node, endNode, index, length));\r\n\r\n          // <% if (readJSON('/.tests_enabled')) { %>\r\n          // if (links.length) {\r\n          // Test.assert(() => word === links[links.length - 1]?.toString());\r\n          // }\r\n          // <% } %>\r\n        }\r\n\r\n        if (!test.lastIndex || (node !== endNode)) { break; }\r\n      }\r\n    }\r\n\r\n    i = links.length;\r\n    while (i--) {\r\n      links[i] = Linkify.makeLink(links[i]);\r\n    }\r\n    return links;\r\n  },\r\n\r\n  regString: new RegExp(`(\\\r\n\\\r\n(https?|mailto|git|magnet|ftp|irc):(\\\r\n[a-z\\\\d%/?]\\\r\n)\\\r\n|\\\r\n([-a-z\\\\d]+[.])+(\\\r\naero|asia|biz|cat|com|coop|dance|info|int|jobs|mobi|moe|museum|name|net|org|post|pro|tel|travel|xxx|xyz|edu|gov|mil|[a-z]{2}\\\r\n)([:/]|(?![^\\\\s\"]))\\\r\n|\\\r\n[\\\\d]{1,3}\\\\.[\\\\d]{1,3}\\\\.[\\\\d]{1,3}\\\\.[\\\\d]{1,3}\\\r\n|\\\r\n[-\\\\w\\\\d.@]+@[a-z\\\\d.-]+\\\\.[a-z\\\\d]\\\r\n)`, 'i'),\r\n\r\n  makeRange(startNode, endNode, startOffset, endOffset) {\r\n    const range = document.createRange();\r\n    range.setStart(startNode, startOffset);\r\n    range.setEnd(endNode,   endOffset);\r\n    return range;\r\n  },\r\n\r\n  makeLink(range) {\r\n    let t;\r\n    let encodedDomain;\r\n    let text = range.toString();\r\n\r\n    // Clean start of range\r\n    let i = text.search(Linkify.regString);\r\n\r\n    if (i > 0) {\r\n      text = text.slice(i);\r\n      while ((range.startOffset + i) >= range.startContainer.data.length) { i--; }\r\n\r\n      if (i) { range.setStart(range.startContainer, range.startOffset + i); }\r\n    }\r\n\r\n    // Clean end of range\r\n    i = 0;\r\n    while (/[)\\]}>.,]/.test(t = text.charAt(text.length - (1 + i)))) {\r\n      if (!/[.,]/.test(t) && !((text.match(/[()\\[\\]{}<>]/g)).length % 2)) { break; }\r\n      i++;\r\n    }\r\n\r\n    if (i) {\r\n      text = text.slice(0, -i);\r\n      while ((range.endOffset - i) < 0) { i--; }\r\n\r\n      if (i) {\r\n        range.setEnd(range.endContainer, range.endOffset - i);\r\n      }\r\n    }\r\n\r\n    // Make our link 'valid' if it is formatted incorrectly.\r\n    if (!/((mailto|magnet):|.+:\\/\\/)/.test(text)) {\r\n      text = (\r\n        /@/.test(text) ?\r\n          'mailto:'\r\n        :\r\n          'http://'\r\n      ) + text;\r\n    }\r\n\r\n    // Decode percent-encoded characters in domain so that they behave consistently across browsers.\r\n    if (encodedDomain = text.match(/^(https?:\\/\\/[^/]*%[0-9a-f]{2})(.*)$/i)) {\r\n      text = encodedDomain[1].replace(/%([0-9a-f]{2})/ig, function(x, y) {\r\n        if (y === '25') { return x; } else { return String.fromCharCode(parseInt(y, 16)); }\r\n      }) + encodedDomain[2];\r\n    }\r\n\r\n    const a = $.el('a', {\r\n      className: 'linkify',\r\n      rel:       'noreferrer noopener',\r\n      target:    '_blank',\r\n      href:      text\r\n    }\r\n    );\r\n\r\n    // Insert the range into the anchor, the anchor into the range's DOM location, and destroy the range.\r\n    $.add(a, range.extractContents());\r\n    range.insertNode(a);\r\n\r\n    return a;\r\n  }\r\n};\r\nexport default Linkify;\r\n","import $ from \"../platform/$\";\r\nimport Redirect from \"../Archive/Redirect\";\r\nimport Filter from \"../Filtering/Filter\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport Menu from \"./Menu\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst ArchiveLink = {\r\n  init() {\r\n    if ((g.SITE.software !== 'yotsuba') || !['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Archive Link']) { return; }\r\n\r\n    const div = $.el('div',\r\n      {textContent: 'Archive'});\r\n\r\n    const entry = {\r\n      el: div,\r\n      order: 60,\r\n      open({ID, thread, board}) {\r\n        return !!Redirect.to('thread', {postID: ID, threadID: thread.ID, boardID: board.ID});\r\n      },\r\n      subEntries: []\r\n    };\r\n\r\n    for (var type of [\r\n      ['Post',      'post'],\r\n      ['Name',      'name'],\r\n      ['Tripcode',  'tripcode'],\r\n      ['Capcode',   'capcode'],\r\n      ['Subject',   'subject'],\r\n      ['Flag',      'country'],\r\n      ['Filename',  'filename'],\r\n      ['Image MD5', 'MD5']\r\n    ]) {\r\n      // Add a sub entry for each type.\r\n      entry.subEntries.push(this.createSubEntry(type[0], type[1]));\r\n    }\r\n\r\n    return Menu.menu.addEntry(entry);\r\n  },\r\n\r\n  createSubEntry(text, type) {\r\n    const el = $.el('a', {\r\n      textContent: text,\r\n      target: '_blank'\r\n    }\r\n    );\r\n\r\n    const open = type === 'post' ?\r\n      function({ID, thread, board}) {\r\n        el.href = Redirect.to('thread', {postID: ID, threadID: thread.ID, boardID: board.ID});\r\n        return true;\r\n      }\r\n    :\r\n      function(post) {\r\n        const typeParam = (type === 'country') && post.info.flagCodeTroll ?\r\n          'troll_country'\r\n        :\r\n          type;\r\n        const value = type === 'country' ?\r\n          post.info.flagCode || post.info.flagCodeTroll?.toLowerCase()\r\n        :\r\n          Filter.values(type, post)[0];\r\n        // We want to parse the exact same stuff as the filter does already.\r\n        if (!value) { return false; }\r\n        el.href = Redirect.to('search', {\r\n          boardID:  post.board.ID,\r\n          type:     typeParam,\r\n          value,\r\n          isSearch: true\r\n        }\r\n        );\r\n        return true;\r\n      };\r\n\r\n    return {\r\n      el,\r\n      open\r\n    };\r\n  }\r\n};\r\nexport default ArchiveLink;\r\n","import { g, Conf, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport Menu from \"./Menu\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar CopyTextLink = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Copy Text Link']) { return; }\r\n\r\n    const a = $.el('a', {\r\n      className: 'copy-text-link',\r\n      href: 'javascript:;',\r\n      textContent: 'Copy Text'\r\n    }\r\n    );\r\n    $.on(a, 'click', CopyTextLink.copy);\r\n\r\n    return Menu.menu.addEntry({\r\n      el: a,\r\n      order: 12,\r\n      open(post) {\r\n        CopyTextLink.text = (post.origin || post).commentOrig();\r\n        return true;\r\n      }\r\n    });\r\n  },\r\n\r\n  copy() {\r\n    const el = $.el('textarea', {\r\n      className: 'copy-text-element',\r\n      value: CopyTextLink.text\r\n    }\r\n    );\r\n    $.add(d.body, el);\r\n    el.select();\r\n    try {\r\n      d.execCommand('copy');\r\n    } catch (error) {}\r\n    return $.rm(el);\r\n  }\r\n};\r\nexport default CopyTextLink;\r\n","import Notice from \"../classes/Notice\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\nimport QR from \"../Posting/QR\";\r\nimport Menu from \"./Menu\";\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar DeleteLink = {\r\n  auto: [dict(), dict()],\r\n\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Delete Link']) { return; }\r\n\r\n    const div = $.el('div', {\r\n      className: 'delete-link',\r\n      textContent: 'Delete'\r\n    }\r\n    );\r\n    const postEl = $.el('a', {\r\n      className: 'delete-post',\r\n      href: 'javascript:;'\r\n    }\r\n    );\r\n    const fileEl = $.el('a', {\r\n      className: 'delete-file',\r\n      href: 'javascript:;'\r\n    }\r\n    );\r\n    this.nodes = {\r\n      menu:  div.firstChild,\r\n      links: [postEl, fileEl]\r\n    };\r\n\r\n    const postEntry = {\r\n      el: postEl,\r\n      open() {\r\n        postEl.textContent = DeleteLink.linkText(false);\r\n        $.on(postEl, 'click', DeleteLink.toggle);\r\n        return true;\r\n      }\r\n    };\r\n    const fileEntry = {\r\n      el: fileEl,\r\n      open({file}) {\r\n        if (!file || file.isDead) { return false; }\r\n        fileEl.textContent = DeleteLink.linkText(true);\r\n        $.on(fileEl, 'click', DeleteLink.toggle);\r\n        return true;\r\n      }\r\n    };\r\n\r\n    return Menu.menu.addEntry({\r\n      el: div,\r\n      order: 40,\r\n      open(post) {\r\n        if (post.isDead) { return false; }\r\n        DeleteLink.post = post;\r\n        DeleteLink.nodes.menu.textContent = DeleteLink.menuText();\r\n        DeleteLink.cooldown.start(post);\r\n        return true;\r\n      },\r\n      subEntries: [postEntry, fileEntry]});\r\n  },\r\n\r\n  menuText() {\r\n    let seconds;\r\n    if ((seconds = DeleteLink.cooldown.seconds[DeleteLink.post.fullID])) {\r\n      return `Delete (${seconds})`;\r\n    } else {\r\n      return 'Delete';\r\n    }\r\n  },\r\n\r\n  linkText(fileOnly) {\r\n    let text = fileOnly ? 'File' : 'Post';\r\n    if (DeleteLink.auto[+fileOnly][DeleteLink.post.fullID]) {\r\n      text = `Deleting ${text.toLowerCase()}...`;\r\n    }\r\n    return text;\r\n  },\r\n\r\n  toggle() {\r\n    const {post} = DeleteLink;\r\n    const fileOnly = $.hasClass(this, 'delete-file');\r\n    const auto = DeleteLink.auto[+fileOnly];\r\n\r\n    if (auto[post.fullID]) {\r\n      delete auto[post.fullID];\r\n    } else {\r\n      auto[post.fullID] = true;\r\n    }\r\n    this.textContent = DeleteLink.linkText(fileOnly);\r\n\r\n    if (!DeleteLink.cooldown.seconds[post.fullID]) {\r\n      return DeleteLink.delete(post, fileOnly);\r\n    }\r\n  },\r\n\r\n  delete(post, fileOnly) {\r\n    const link = DeleteLink.nodes.links[+fileOnly];\r\n    delete DeleteLink.auto[+fileOnly][post.fullID];\r\n    if (post.fullID === DeleteLink.post.fullID) { $.off(link, 'click', DeleteLink.toggle); }\r\n\r\n    const form = {\r\n      mode: 'usrdel',\r\n      onlyimgdel: fileOnly,\r\n      pwd: QR.persona.getPassword()\r\n    };\r\n    form[+post.ID] = 'delete';\r\n\r\n    return $.ajax($.id('delform').action.replace(`/${g.BOARD}/`, `/${post.board}/`), {\r\n      responseType: 'document',\r\n      withCredentials: true,\r\n      onloadend() { return DeleteLink.load(link, post, fileOnly, this.response); },\r\n      form: $.formData(form)\r\n    }\r\n    );\r\n  },\r\n\r\n  load(link, post, fileOnly, resDoc) {\r\n    let msg;\r\n    if (!resDoc) {\r\n      new Notice('warning', 'Connection error, please retry.', 20);\r\n      if (post.fullID === DeleteLink.post.fullID) { $.on(link, 'click', DeleteLink.toggle); }\r\n      return;\r\n    }\r\n\r\n    link.textContent = DeleteLink.linkText(fileOnly);\r\n    if (resDoc.title === '4chan - Banned') { // Ban/warn check\r\n      const el = $.el('span', {innerHTML: \"You can&#039;t delete posts because you are <a href=\\\"//www.4chan.org/banned\\\" target=\\\"_blank\\\">banned</a>.\"});\r\n      return new Notice('warning', el, 20);\r\n    } else if (msg = resDoc.getElementById('errmsg')) { // error!\r\n      new Notice('warning', msg.textContent, 20);\r\n      if (post.fullID === DeleteLink.post.fullID) { $.on(link, 'click', DeleteLink.toggle); }\r\n      if (QR.cooldown.data && Conf['Cooldown'] && /\\bwait\\b/i.test(msg.textContent)) {\r\n        DeleteLink.cooldown.start(post, 5);\r\n        DeleteLink.auto[+fileOnly][post.fullID] = true;\r\n        return DeleteLink.nodes.links[+fileOnly].textContent = DeleteLink.linkText(fileOnly);\r\n      }\r\n    } else {\r\n      if (!fileOnly) { QR.cooldown.delete(post); }\r\n      if (resDoc.title === 'Updating index...') {\r\n        // We're 100% sure.\r\n        (post.origin || post).kill(fileOnly);\r\n      }\r\n      if (post.fullID === DeleteLink.post.fullID) { return link.textContent = 'Deleted'; }\r\n    }\r\n  },\r\n\r\n  cooldown: {\r\n    seconds: dict(),\r\n\r\n    start(post, seconds) {\r\n      // Already counting.\r\n      if (DeleteLink.cooldown.seconds[post.fullID] != null) { return; }\r\n\r\n      if (seconds == null) { seconds = QR.cooldown.secondsDeletion(post); }\r\n      if (seconds > 0) {\r\n        DeleteLink.cooldown.seconds[post.fullID] = seconds;\r\n        return DeleteLink.cooldown.count(post);\r\n      }\r\n    },\r\n\r\n    count(post) {\r\n      if (post.fullID === DeleteLink.post.fullID) { DeleteLink.nodes.menu.textContent = DeleteLink.menuText(); }\r\n      if ((DeleteLink.cooldown.seconds[post.fullID] > 0) && Conf['Cooldown']) {\r\n        DeleteLink.cooldown.seconds[post.fullID]--;\r\n        setTimeout(DeleteLink.cooldown.count, 1000, post);\r\n      } else {\r\n        delete DeleteLink.cooldown.seconds[post.fullID];\r\n        for (var fileOnly of [false, true]) {\r\n          if (DeleteLink.auto[+fileOnly][post.fullID]) {\r\n            DeleteLink.delete(post, fileOnly);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default DeleteLink;\r\n","import { g, Conf } from \"../globals/globals\";\r\nimport ImageCommon from \"../Images/ImageCommon\";\r\nimport $ from \"../platform/$\";\r\nimport Menu from \"./Menu\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst DownloadLink = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Download Link']) { return; }\r\n\r\n    const a = $.el('a', {\r\n      className: 'download-link',\r\n      textContent: 'Download file'\r\n    }\r\n    );\r\n\r\n    // Specifying the filename with the download attribute only works for same-origin links.\r\n    $.on(a, 'click', ImageCommon.download);\r\n\r\n    return Menu.menu.addEntry({\r\n      el: a,\r\n      order: 100,\r\n      open({file}) {\r\n        if (!file) { return false; }\r\n        a.href     = file.url;\r\n        a.download = file.name;\r\n        return true;\r\n      }\r\n    });\r\n  }\r\n};\r\nexport default DownloadLink;\r\n","import { g, Conf, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport Menu from \"./Menu\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ReportLink = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Menu'] || !Conf['Report Link']) { return; }\r\n\r\n    const a = $.el('a', {\r\n      className: 'report-link',\r\n      href: 'javascript:;',\r\n      textContent: 'Report'\r\n    }\r\n    );\r\n    $.on(a, 'click', ReportLink.report);\r\n\r\n    return Menu.menu.addEntry({\r\n      el: a,\r\n      order: 10,\r\n      open(post) {\r\n        ReportLink.url = `//sys.${location.hostname.split('.')[1]}.org/${post.board}/imgboard.php?mode=report&no=${post}`;\r\n        if (d.cookie.indexOf('pass_enabled=1') >= 0) {\r\n          ReportLink.dims = 'width=350,height=275';\r\n        } else {\r\n          ReportLink.dims = 'width=400,height=550';\r\n        }\r\n        return true;\r\n      }\r\n    });\r\n  },\r\n\r\n  report() {\r\n    const {url, dims} = ReportLink;\r\n    const id  = Date.now();\r\n    const set = `toolbar=0,scrollbars=1,location=0,status=1,menubar=0,resizable=1,${dims}`;\r\n    return window.open(url, id, set);\r\n  }\r\n};\r\nexport default ReportLink;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { Conf, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar AntiAutoplay = {\r\n  init() {\r\n    if (!Conf['Disable Autoplaying Sounds']) { return; }\r\n    $.addClass(doc, 'anti-autoplay');\r\n    for (var audio of $$('audio[autoplay]', doc)) { this.stop(audio); }\r\n    window.addEventListener('loadstart', (e => this.stop(e.target)), true);\r\n    Callbacks.Post.push({\r\n      name: 'Disable Autoplaying Sounds',\r\n      cb:   this.node\r\n    });\r\n    return $.ready(() => this.process(d.body));\r\n  },\r\n\r\n  stop(audio) {\r\n    if (!audio.autoplay) { return; }\r\n    audio.pause();\r\n    audio.autoplay = false;\r\n    if (audio.controls) { return; }\r\n    audio.controls = true;\r\n    return $.addClass(audio, 'controls-added');\r\n  },\r\n\r\n  node() {\r\n    return AntiAutoplay.process(this.nodes.comment);\r\n  },\r\n\r\n  process(root) {\r\n    for (var iframe of $$('iframe[src*=\"youtube\"][src*=\"autoplay=1\"]', root)) {\r\n      AntiAutoplay.processVideo(iframe, 'src');\r\n    }\r\n    for (var object of $$('object[data*=\"youtube\"][data*=\"autoplay=1\"]', root)) {\r\n      AntiAutoplay.processVideo(object, 'data');\r\n    }\r\n  },\r\n\r\n  processVideo(el, attr) {\r\n    el[attr] = el[attr].replace(/\\?autoplay=1&?/, '?').replace('&autoplay=1', '');\r\n    if (window.getComputedStyle(el).display === 'none') { el.style.display = 'block'; }\r\n    return $.addClass(el, 'autoplay-removed');\r\n  }\r\n};\r\nexport default AntiAutoplay;\r\n","import DataBoard from \"../classes/DataBoard\";\r\nimport { Conf, d, g } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport Unread from \"../Monitoring/Unread\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Banner = {\r\n  init() {\r\n    if (Conf['Custom Board Titles']) {\r\n      this.db = new DataBoard('customTitles', null, true);\r\n    }\r\n\r\n    $.asap((() => d.body), () => $.asap((() => $('hr')), Banner.ready));\r\n\r\n    // Let 4chan's JS load the banner if enabled; otherwise, load it ourselves.\r\n    if (g.BOARD.ID !== 'f') {\r\n      return Main.ready(() => $.queueTask(Banner.load));\r\n    }\r\n  },\r\n\r\n  ready() {\r\n    const banner = $(\".boardBanner\");\r\n    const {children} = banner;\r\n\r\n    if ((g.VIEW === 'thread') && Conf['Remove Thread Excerpt']) {\r\n      Banner.setTitle(children[1].textContent);\r\n    }\r\n\r\n    children[0].title = \"Click to change\";\r\n    $.on(children[0], 'click', Banner.cb.toggle);\r\n\r\n    if (Conf['Custom Board Titles']) {\r\n      Banner.custom(children[1]);\r\n      if (children[2]) { return Banner.custom(children[2]); }\r\n    }\r\n  },\r\n\r\n  load() {\r\n    const bannerCnt = $.id('bannerCnt');\r\n    if (!bannerCnt.firstChild) {\r\n      const img = $.el('img', {\r\n        alt: '4chan',\r\n        src: '//s.4cdn.org/image/title/' + bannerCnt.dataset.src\r\n      }\r\n      );\r\n      return $.add(bannerCnt, img);\r\n    }\r\n  },\r\n\r\n  setTitle(title) {\r\n    if (Unread.title != null) {\r\n      Unread.title = title;\r\n      return Unread.update();\r\n    } else {\r\n      return d.title = title;\r\n    }\r\n  },\r\n\r\n  cb: {\r\n    toggle() {\r\n      if (!Banner.choices?.length) {\r\n        Banner.choices = Conf['knownBanners'].split(',').slice();\r\n      }\r\n      const i = Math.floor(Banner.choices.length * Math.random());\r\n      const banner = Banner.choices.splice(i, 1);\r\n      return $('img', this.parentNode).src = `//s.4cdn.org/image/title/${banner}`;\r\n    },\r\n\r\n    click(e) {\r\n      if (!e.ctrlKey && !e.metaKey) { return; }\r\n      if (Banner.original[this.className] == null) { Banner.original[this.className] = this.cloneNode(true); }\r\n      this.contentEditable = true;\r\n      for (var br of $$('br', this)) { $.replace(br, $.tn('\\n')); }\r\n      return this.focus();\r\n    },\r\n\r\n    keydown(e) {\r\n      e.stopPropagation();\r\n      if (!e.shiftKey && (e.keyCode === 13)) { return this.blur(); }\r\n    },\r\n\r\n    blur() {\r\n      for (var br of $$('br', this)) { $.replace(br, $.tn('\\n')); }\r\n      if (this.textContent = this.textContent.replace(/\\n*$/, '')) {\r\n        this.contentEditable = false;\r\n        return Banner.db.set({\r\n          boardID:  g.BOARD.ID,\r\n          threadID: this.className,\r\n          val: {\r\n            title: this.textContent,\r\n            orig:  Banner.original[this.className].textContent\r\n          }\r\n        });\r\n      } else {\r\n        $.rmAll(this);\r\n        $.add(this, [...Banner.original[this.className].cloneNode(true).childNodes]);\r\n        return Banner.db.delete({\r\n          boardID:  g.BOARD.ID,\r\n          threadID: this.className\r\n        });\r\n      }\r\n    }\r\n  },\r\n\r\n  original: dict(),\r\n\r\n  custom(child) {\r\n    let data;\r\n    const {className} = child;\r\n    child.title = `Ctrl/\\u2318+click to edit board ${className.slice(5).toLowerCase()}`;\r\n    child.spellcheck = false;\r\n\r\n    for (var event of ['click', 'keydown', 'blur']) {\r\n      $.on(child, event, Banner.cb[event]);\r\n    }\r\n\r\n    if (data = Banner.db.get({boardID: g.BOARD.ID, threadID: className})) {\r\n      if (Conf['Persistent Custom Board Titles'] || (data.orig === child.textContent)) {\r\n        Banner.original[className] = child.cloneNode(true);\r\n        return child.textContent = data.title;\r\n      } else {\r\n        return Banner.db.delete({boardID: g.BOARD.ID, threadID: className});\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default Banner;\r\n","import { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Flash = {\r\n  init() {\r\n    if ((g.BOARD.ID === 'f') && Conf['Enable Native Flash Embedding']) {\r\n      return $.ready(Flash.initReady);\r\n    }\r\n  },\r\n\r\n  initReady() {\r\n    if ($.hasStorage) {\r\n      return $.global(function() { if (JSON.parse(localStorage['4chan-settings'] || '{}').disableAll) { return window.SWFEmbed.init(); } });\r\n    } else {\r\n      if (g.VIEW === 'thread') {\r\n        $.global(() => window.Main.tid = location.pathname.split(/\\/+/)[3]);\r\n      }\r\n      return $.global(() => window.SWFEmbed.init());\r\n    }\r\n  }\r\n};\r\nexport default Flash;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport BoardConfig from \"../General/BoardConfig\";\r\nimport { d, doc, g } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport ExpandComment from \"./ExpandComment\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Fourchan = {\r\n  init() {\r\n    if ((g.SITE.software !== 'yotsuba') || !['index', 'thread', 'archive'].includes(g.VIEW)) { return; }\r\n    BoardConfig.ready(this.initBoard);\r\n    return Main.ready(this.initReady);\r\n  },\r\n\r\n  initBoard() {\r\n    if (g.BOARD.config.code_tags) {\r\n      $.on(window, 'prettyprint:cb', function(e) {\r\n        let post, pre;\r\n        if (!(post = g.posts.get(e.detail.ID))) { return; }\r\n        if (!(pre  = $$('.prettyprint', post.nodes.comment)[+e.detail.i])) { return; }\r\n        if (!$.hasClass(pre, 'prettyprinted')) {\r\n          pre.innerHTML = e.detail.html;\r\n          return $.addClass(pre, 'prettyprinted');\r\n        }\r\n      });\r\n      $.global(() => window.addEventListener('prettyprint', e => window.dispatchEvent(new CustomEvent('prettyprint:cb', {\r\n        detail: {\r\n          ID:   e.detail.ID,\r\n          i:    e.detail.i,\r\n          html: window.prettyPrintOne(e.detail.html)\r\n        }\r\n      }))\r\n      , false));\r\n      Callbacks.Post.push({\r\n        name: 'Parse [code] tags',\r\n        cb:   Fourchan.code\r\n      });\r\n      g.posts.forEach(function(post) {\r\n        if (post.callbacksExecuted) {\r\n          return Callbacks.Post.execute(post, ['Parse [code] tags'], true);\r\n        }\r\n      });\r\n      ExpandComment.callbacks.push(Fourchan.code);\r\n    }\r\n\r\n    if (g.BOARD.config.math_tags) {\r\n      $.global(() => window.addEventListener('mathjax', function(e) {\r\n        if (window.MathJax) {\r\n          return window.MathJax.Hub.Queue(['Typeset', window.MathJax.Hub, e.target]);\r\n        } else {\r\n          if (!document.querySelector('script[src^=\"//cdn.mathjax.org/\"]')) { // don't load MathJax if already loading\r\n            window.loadMathJax();\r\n            window.loadMathJax = function() {};\r\n          }\r\n          // 4chan only handles post comments on MathJax load; anything else (e.g. the QR preview) must be queued explicitly.\r\n          if (!e.target.classList.contains('postMessage')) {\r\n            return document.querySelector('script[src^=\"//cdn.mathjax.org/\"]').addEventListener('load', () => window.MathJax.Hub.Queue(['Typeset', window.MathJax.Hub, e.target])\r\n            , false);\r\n          }\r\n        }\r\n      }\r\n      , false));\r\n      Callbacks.Post.push({\r\n        name: 'Parse [math] tags',\r\n        cb:   Fourchan.math\r\n      });\r\n      g.posts.forEach(function(post) {\r\n        if (post.callbacksExecuted) {\r\n          return Callbacks.Post.execute(post, ['Parse [math] tags'], true);\r\n        }\r\n      });\r\n      return ExpandComment.callbacks.push(Fourchan.math);\r\n    }\r\n  },\r\n\r\n  // Disable 4chan's ID highlighting (replaced by IDHighlight) and reported post hiding.\r\n  initReady() {\r\n    return $.global(function() {\r\n      window.clickable_ids = false;\r\n      for (var node of document.querySelectorAll('.posteruid, .capcode')) {\r\n        node.removeEventListener('click', window.idClick, false);\r\n      }\r\n    });\r\n  },\r\n\r\n  code() {\r\n    if (this.isClone) { return; }\r\n    return $.ready(() => {\r\n      const iterable = $$('.prettyprint', this.nodes.comment);\r\n      for (let i = 0; i < iterable.length; i++) {\r\n        var pre = iterable[i];\r\n        if (!$.hasClass(pre, 'prettyprinted')) {\r\n          $.event('prettyprint', {ID: this.fullID, i, html: pre.innerHTML}, window);\r\n        }\r\n      }\r\n    });\r\n  },\r\n\r\n  math() {\r\n    let wbrs;\r\n    if (!/\\[(math|eqn)\\]/.test(this.nodes.comment.textContent)) { return; }\r\n    // XXX <wbr> tags frequently break MathJax; remove them.\r\n    if ((wbrs = $$('wbr', this.nodes.comment)).length) {\r\n      for (var wbr of wbrs) { $.rm(wbr); }\r\n      this.nodes.comment.normalize();\r\n    }\r\n    var cb = () => {\r\n      if (!doc.contains(this.nodes.comment)) { return; }\r\n      $.off(d, 'PostsInserted', cb);\r\n      return $.event('mathjax', null, this.nodes.comment);\r\n    };\r\n    $.on(d, 'PostsInserted', cb);\r\n    return cb();\r\n  }\r\n};\r\nexport default Fourchan;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar IDColor = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Color User IDs']) { return; }\r\n    this.ids = dict();\r\n    this.ids['Heaven'] = [0, 0, 0, '#fff'];\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Color User IDs',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    let span, uid;\r\n    if (this.isClone || !((uid = this.info.uniqueID) && (span = this.nodes.uniqueID))) { return; }\r\n\r\n    const rgb = IDColor.ids[uid] || IDColor.compute(uid);\r\n\r\n    // Style the damn node.\r\n    const {style} = span;\r\n    style.color = rgb[3];\r\n    style.backgroundColor = `rgb(${rgb[0]},${rgb[1]},${rgb[2]})`;\r\n    return $.addClass(span, 'painted');\r\n  },\r\n\r\n  compute(uid) {\r\n    // Convert chars to integers, bitshift and math to create a larger integer\r\n    // Create a nice string of binary\r\n    const hash = g.SITE.uidColor ? g.SITE.uidColor(uid) : parseInt(uid, 16);\r\n\r\n    // Convert binary string to numerical values with bitshift and '&' truncation.\r\n    const rgb = [\r\n      (hash >> 16) & 0xFF,\r\n      (hash >> 8)  & 0xFF,\r\n      hash & 0xFF\r\n    ];\r\n\r\n    // Weight color luminance values, assign a font color that should be readable. \r\n    rgb.push($.luma(rgb) > 125 ?\r\n      '#000'\r\n    :\r\n      '#fff'\r\n    );\r\n\r\n    // Cache.\r\n    return this.ids[uid] = rgb;\r\n  }\r\n};\r\nexport default IDColor;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar IDHighlight = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW)) { return; }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Highlight by User ID',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  uniqueID: null,\r\n\r\n  node() {\r\n    if (this.nodes.uniqueIDRoot) { $.on(this.nodes.uniqueIDRoot, 'click', IDHighlight.click(this)); }\r\n    if (this.nodes.capcode) { $.on(this.nodes.capcode,      'click', IDHighlight.click(this)); }\r\n    if (!this.isClone) { return IDHighlight.set(this); }\r\n  },\r\n\r\n  set(post) {\r\n    const match = (post.info.uniqueID || post.info.capcode) === IDHighlight.uniqueID;\r\n    return $[match ? 'addClass' : 'rmClass'](post.nodes.post, 'highlight');\r\n  },\r\n\r\n  click(post) { return function() {\r\n    const uniqueID = post.info.uniqueID || post.info.capcode;\r\n    IDHighlight.uniqueID = IDHighlight.uniqueID === uniqueID ? null : uniqueID;\r\n    return g.posts.forEach(IDHighlight.set);\r\n  }; }\r\n};\r\nexport default IDHighlight;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Get from \"../General/Get\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar IDPostCount = {\r\n  init() {\r\n    if ((g.VIEW !== 'thread') || !Conf['Count Posts by ID']) { return; }\r\n    Callbacks.Thread.push({\r\n      name: 'Count Posts by ID',\r\n      cb() { return IDPostCount.thread = this; }\r\n    });\r\n    return Callbacks.Post.push({\r\n      name: 'Count Posts by ID',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.nodes.uniqueID && (this.thread === IDPostCount.thread)) {\r\n      return $.on(this.nodes.uniqueID, 'mouseover', IDPostCount.count);\r\n    }\r\n  },\r\n\r\n  count() {\r\n    const {uniqueID} = Get.postFromNode(this).info;\r\n    let n = 0;\r\n    IDPostCount.thread.posts.forEach(function(post) {\r\n      if (post.info.uniqueID === uniqueID) { return n++; }\r\n    });\r\n    return this.title = `${n} post${n === 1 ? '' : 's'} by this ID`;\r\n  }\r\n};\r\nexport default IDPostCount;\r\n","import $ from \"../platform/$\";\r\nimport Callbacks from \"../classes/Callbacks\";\r\nimport { g } from \"../globals/globals\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ModContact = {\r\n  init() {\r\n    if ((g.SITE.software !== 'yotsuba') || !['index', 'thread'].includes(g.VIEW)) { return; }\r\n    return Callbacks.Post.push({\r\n      name: 'Mod Contact Links',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    let moved;\r\n    if (this.isClone || !$.hasOwn(ModContact.specific, this.info.capcode)) { return; }\r\n    const links = $.el('span', {className: 'contact-links brackets-wrap'});\r\n    $.extend(links, ModContact.template(this.info.capcode));\r\n    $.after(this.nodes.capcode, links);\r\n    if ((moved = this.info.comment.match(/This thread was moved to >>>\\/(\\w+)\\//)) && $.hasOwn(ModContact.moveNote, moved[1])) {\r\n      const moveNote = $.el('div', {className: 'move-note'});\r\n      $.extend(moveNote, ModContact.moveNote[moved[1]]);\r\n      return $.add(this.nodes.post, moveNote);\r\n    }\r\n  },\r\n\r\n  template(capcode) {\r\n    return {innerHTML: \"<a href=\\\"https://www.4chan.org/feedback\\\" target=\\\"_blank\\\">feedback</a>\" + (ModContact.specific[capcode]()).innerHTML};\r\n  },\r\n\r\n  specific: {\r\n    Mod() { return {innerHTML: \" <a href=\\\"https://www.4chan-x.net/4chan-irc.html\\\" target=\\\"_blank\\\">IRC</a>\"}; },\r\n    Manager() { return ModContact.specific.Mod(); },\r\n    Developer() { return {innerHTML: \" <a href=\\\"https://github.com/4chan\\\" target=\\\"_blank\\\">github</a>\"}; },\r\n    Admin() { return {innerHTML: \" <a href=\\\"https://twitter.com/hiroyuki_ni\\\" target=\\\"_blank\\\">twitter</a>\"}; }\r\n  },\r\n\r\n  moveNote: {\r\n    qa: {innerHTML: \"Moving a thread to /qa/ does not imply mods will read it. If you wish to contact mods, use <a href=\\\"https://www.4chan.org/feedback\\\" target=\\\"_blank\\\">feedback</a><span class=\\\"invisible\\\"> (https://www.4chan.org/feedback)</span> or <a href=\\\"https://www.4chan-x.net/4chan-irc.html\\\" target=\\\"_blank\\\">IRC</a><span class=\\\"invisible\\\"> (https://www.4chan-x.net/4chan-irc.html)</span>.\"}\r\n  }\r\n};\r\nexport default ModContact;\r\n","import { Conf, g } from \"../globals/globals\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst NormalizeURL = {\r\n  init() {\r\n    if (!Conf['Normalize URL']) { return; }\r\n\r\n    let pathname = location.pathname.split(/\\/+/);\r\n    if (g.SITE.software === 'yotsuba') {\r\n      switch (g.VIEW) {\r\n        case 'thread':\r\n          pathname[2] = 'thread';\r\n          pathname = pathname.slice(0, 4);\r\n          break;\r\n        case 'index':\r\n          pathname = pathname.slice(0, 3);\r\n          break;\r\n      }\r\n    }\r\n    pathname = pathname.join('/');\r\n    if (location.pathname !== pathname) {\r\n      return history.replaceState(history.state, '', `${location.protocol}//${location.host}${pathname}${location.hash}`);\r\n    }\r\n  }\r\n};\r\nexport default NormalizeURL;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { Conf, g, E } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar PostJumper = { \r\n  init() {\r\n    if (!Conf['Unique ID and Capcode Navigation'] || !['index', 'thread'].includes(g.VIEW)) { return; }\r\n\r\n    this.buttons = this.makeButtons();\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Post Jumper',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) {\r\n      for (var buttons of $$('.postJumper', this.nodes.info)) {\r\n        PostJumper.addListeners(buttons);\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (this.nodes.uniqueIDRoot) {\r\n      PostJumper.addButtons(this,'uniqueID');\r\n    }\r\n\r\n    if (this.nodes.capcode) {\r\n      return PostJumper.addButtons(this,'capcode');\r\n    }\r\n  },\r\n\r\n  addButtons(post,type) {\r\n    const value = post.info[type];\r\n    const buttons = PostJumper.buttons.cloneNode(true);\r\n    $.extend(buttons.dataset, {type, value});\r\n    $.after(post.nodes[type+(type === 'capcode' ? '' : 'Root')], buttons);\r\n    return PostJumper.addListeners(buttons);\r\n  },\r\n\r\n  addListeners(buttons) {\r\n    $.on(buttons.firstChild, 'click', PostJumper.buttonClick);\r\n    return $.on(buttons.lastChild, 'click', PostJumper.buttonClick);\r\n  },\r\n\r\n  buttonClick() {\r\n    let toJumper;\r\n    const dir = $.hasClass(this, 'prev') ? -1 : 1;\r\n    if (toJumper = PostJumper.find(this.parentNode, dir)) {\r\n      return PostJumper.scroll(this.parentNode, toJumper);\r\n    }\r\n  },\r\n\r\n  find(jumper, dir) {\r\n    const {type, value} = jumper.dataset;\r\n    const xpath = `span[contains(@class,\\\"postJumper\\\") and @data-value=\\\"${value}\\\" and @data-type=\\\"${type}\\\"]`;\r\n    const axis = dir < 0 ? 'preceding' : 'following';\r\n    let jumper2 = jumper;\r\n    while (jumper2 = $.x(`${axis}::${xpath}`, jumper2)) {\r\n      if (jumper2.getBoundingClientRect().height) { return jumper2; }\r\n    }\r\n    if (jumper2 = $.x(`(//${xpath})[${dir < 0 ? 'last()' : '1'}]`)) {\r\n      if (jumper2.getBoundingClientRect().height) { return jumper2; }\r\n    }\r\n    while ((jumper2 = $.x(`${axis}::${xpath}`, jumper2)) && (jumper2 !== jumper)) {\r\n      if (jumper2.getBoundingClientRect().height) { return jumper2; }\r\n    }\r\n    return null;\r\n  },\r\n\r\n  makeButtons() {\r\n    const charPrev = '\\u23EB';\r\n    const charNext = '\\u23EC';\r\n    const classPrev = 'prev';\r\n    const classNext = 'next';\r\n    const span = $.el('span',\r\n      {className: 'postJumper'});\r\n    $.extend(span, {innerHTML: \"<a href=\\\"javascript:;\\\" class=\\\"\" + E(classPrev) + \"\\\">\" + E(charPrev) + \"</a><a href=\\\"javascript:;\\\" class=\\\"\" + E(classNext) + \"\\\">\" + E(charNext) + \"</a>\"});\r\n    return span;\r\n  },\r\n\r\n  scroll(fromJumper, toJumper) {\r\n    const prevPos = fromJumper.getBoundingClientRect().top;\r\n    const destPos = toJumper.getBoundingClientRect().top;\r\n    return window.scrollBy(0, destPos-prevPos);\r\n  }\r\n};\r\nexport default PostJumper;\r\n","import Notice from \"../classes/Notice\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst PSA = {\r\n  init() {\r\n    let el;\r\n    if ((g.SITE.software === 'yotsuba') && (g.BOARD.ID === 'qa')) {\r\n      const announcement = {innerHTML: \"Stay in touch with your <a href=\\\"https://www.4chan-x.net/qa_friends.html\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\">/qa/ friends</a>!\"};\r\n      el = $.el('div', {className: 'fcx-announcement'}, announcement);\r\n      $.onExists(doc, '.boardBanner', banner => $.after(banner, el));\r\n    }\r\n    if ('samachan.org' in Conf['siteProperties'] && !Conf['PSAseen'].includes('samachan')) {\r\n      el = $.el('span',\r\n        {innerHTML: \"<a href=\\\"https://sushigirl.us/yakuza/res/776.html\\\" target=\\\"_blank\\\" rel=\\\"noopener\\\">Looking for a new home?<br>Some former Samachan users are regrouping on SushiChan.</a><br>(a message from 4chan X)\"});\r\n      return Main.ready(function() {\r\n        new Notice('info', el);\r\n        Conf['PSAseen'].push('samachan');\r\n        return $.set('PSAseen', Conf['PSAseen']);});\r\n    }\r\n  }\r\n};\r\nexport default PSA;\r\n","import Header from \"../General/Header\";\r\nimport { Conf, doc, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar PSAHiding = {\r\n  init() {\r\n    if (!Conf['Announcement Hiding'] || !g.SITE.selectors.psa) { return; }\r\n    $.addClass(doc, 'hide-announcement');\r\n    $.onExists(doc, g.SITE.selectors.psa, this.setup);\r\n    return $.ready(function() {\r\n      if (!$(g.SITE.selectors.psa)) { return $.rmClass(doc, 'hide-announcement'); }\r\n    });\r\n  },\r\n\r\n  setup(psa) {\r\n    let btn, hr;\r\n    PSAHiding.psa = psa;\r\n    PSAHiding.text = psa.dataset.utc ?? psa.innerHTML;\r\n    if (g.SITE.selectors.psaTop && (hr = $(g.SITE.selectors.psaTop)?.previousElementSibling) && (hr.nodeName === 'HR')) {\r\n      PSAHiding.hr = hr;\r\n    }\r\n    PSAHiding.content = $.el('div');\r\n\r\n    const entry = {\r\n      el: $.el('a', {\r\n        textContent: 'Show announcement',\r\n        className: 'show-announcement',\r\n        href: 'javascript:;'\r\n      }\r\n      ),\r\n      order: 50,\r\n      open() { return psa.hidden; }\r\n    };\r\n    Header.menu.addEntry(entry);\r\n    $.on(entry.el, 'click', PSAHiding.toggle);\r\n\r\n    PSAHiding.btn = (btn = $.el('a', {\r\n      title:       'Mark announcement as read and hide.',\r\n      className:   'hide-announcement-button',\r\n      href:        'javascript:;',\r\n      textContent: '➖︎',\r\n    }\r\n    ));\r\n    $.on(btn, 'click', PSAHiding.toggle);\r\n    if (psa.firstChild?.tagName === 'HR') {\r\n      $.after(psa.firstChild, btn);\r\n    } else {\r\n      $.prepend(psa, btn);\r\n    }\r\n\r\n    PSAHiding.sync(Conf['hiddenPSAList']);\r\n    $.rmClass(doc, 'hide-announcement');\r\n\r\n    return $.sync('hiddenPSAList', PSAHiding.sync);\r\n  },\r\n\r\n  toggle() {\r\n    const hide = $.hasClass(this, 'hide-announcement-button');\r\n    const set = function(hiddenPSAList) {\r\n      if (hide) {\r\n        return hiddenPSAList[g.SITE.ID] = PSAHiding.text;\r\n      } else {\r\n        return delete hiddenPSAList[g.SITE.ID];\r\n      }\r\n    };\r\n    set(Conf['hiddenPSAList']);\r\n    PSAHiding.sync(Conf['hiddenPSAList']);\r\n    return $.get('hiddenPSAList', Conf['hiddenPSAList'], function({hiddenPSAList}) {\r\n      set(hiddenPSAList);\r\n      return $.set('hiddenPSAList', hiddenPSAList);\r\n    });\r\n  },\r\n\r\n  sync(hiddenPSAList) {\r\n    const {psa, content} = PSAHiding;\r\n    psa.hidden = (hiddenPSAList[g.SITE.ID] === PSAHiding.text);\r\n    // Remove content to prevent autoplaying sounds from hidden announcements\r\n    if (psa.hidden) {\r\n      $.add(content, [...psa.childNodes]);\r\n    } else {\r\n      $.add(psa, [...content.childNodes]);\r\n    }\r\n    if (PSAHiding.hr) PSAHiding.hr.hidden = psa.hidden;\r\n  }\r\n};\r\nexport default PSAHiding;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { Conf, doc, g } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar RemoveSpoilers = {\r\n  init() {\r\n    if (Conf['Reveal Spoilers']) {\r\n      $.addClass(doc, 'reveal-spoilers');\r\n    }\r\n\r\n    if (!Conf['Remove Spoilers']) { return; }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Reveal Spoilers',\r\n      cb:   this.node\r\n    });\r\n\r\n    if (g.VIEW === 'archive') {\r\n      return $.ready(() => RemoveSpoilers.unspoiler($.id('arc-list')));\r\n    }\r\n  },\r\n\r\n  node() {\r\n    return RemoveSpoilers.unspoiler(this.nodes.comment);\r\n  },\r\n\r\n  unspoiler(el) {\r\n    const spoilers = $$(g.SITE.selectors.spoiler, el);\r\n    for (var spoiler of spoilers) {\r\n      var span = $.el('span', {className: 'removed-spoiler'});\r\n      $.replace(spoiler, span);\r\n      $.add(span, [...spoiler.childNodes]);\r\n    }\r\n  }\r\n};\r\nexport default RemoveSpoilers;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g, Conf } from \"../globals/globals\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ThreadLinks = {\r\n  init() {\r\n    if ((g.VIEW !== 'index') || !Conf['Open Threads in New Tab']) { return; }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Thread Links',\r\n      cb:   this.node\r\n    });\r\n    return Callbacks.CatalogThread.push({\r\n      name: 'Thread Links',\r\n      cb:   this.catalogNode\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isReply || this.isClone) { return; }\r\n    return ThreadLinks.process(this.nodes.reply);\r\n  },\r\n\r\n  catalogNode() {\r\n    return ThreadLinks.process(this.nodes.thumb.parentNode);\r\n  },\r\n\r\n  process(link) {\r\n    return link.target = '_blank';\r\n  }\r\n};\r\nexport default ThreadLinks;\r\n","import { g } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst Tinyboard = {\r\n  init() {\r\n    if (g.SITE.software !== 'tinyboard') { return; }\r\n    if (g.VIEW === 'thread') {\r\n      return Main.ready(() => $.global(function() {\r\n        let base;\r\n        let {boardID, threadID} = document.currentScript.dataset;\r\n        threadID = +threadID;\r\n        const form = document.querySelector('form[name=\"post\"]');\r\n        window.$(document).ajaxComplete(function(event, request, settings) {\r\n          let postID;\r\n          if (settings.url !== form.action) { return; }\r\n          if (!(postID = +request.responseJSON?.id)) { return; }\r\n          const detail = {boardID, threadID, postID};\r\n          try {\r\n            const {redirect, noko} = request.responseJSON;\r\n            if (redirect && (originalNoko != null) && !originalNoko && !noko) {\r\n              detail.redirect = redirect;\r\n            }\r\n          } catch (error) {}\r\n          event = new CustomEvent('QRPostSuccessful', {bubbles: true, detail});\r\n          return document.dispatchEvent(event);\r\n        });\r\n        var originalNoko = window.tb_settings?.ajax?.always_noko_replies;\r\n        return (((base = window.tb_settings || (window.tb_settings = {}))).ajax || (base.ajax = {})).always_noko_replies = true;\r\n      }\r\n      , {boardID: g.BOARD.ID, threadID: g.THREADID}));\r\n    }\r\n  }\r\n};\r\nexport default Tinyboard;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g, Conf, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar MarkNewIPs = {\r\n  init() {\r\n    if ((g.SITE.software !== 'yotsuba') || (g.VIEW !== 'thread') || !Conf['Mark New IPs']) { return; }\r\n    return Callbacks.Thread.push({\r\n      name: 'Mark New IPs',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    MarkNewIPs.ipCount = this.ipCount;\r\n    MarkNewIPs.postCount = this.posts.keys.length;\r\n    return $.on(d, 'ThreadUpdate', MarkNewIPs.onUpdate);\r\n  },\r\n\r\n  onUpdate(e) {\r\n    let fullID;\r\n    const {ipCount, postCount, newPosts, deletedPosts} = e.detail;\r\n    if (ipCount == null) { return; }\r\n\r\n    switch (ipCount - MarkNewIPs.ipCount) {\r\n      case (postCount - MarkNewIPs.postCount) + deletedPosts.length:\r\n        var i = MarkNewIPs.ipCount;\r\n        for (fullID of newPosts) {\r\n          MarkNewIPs.markNew(g.posts.get(fullID), ++i);\r\n        }\r\n        break;\r\n      case -deletedPosts.length:\r\n        for (fullID of newPosts) {\r\n          MarkNewIPs.markOld(g.posts.get(fullID));\r\n        }\r\n        break;\r\n    }\r\n    MarkNewIPs.ipCount = ipCount;\r\n    return MarkNewIPs.postCount = postCount;\r\n  },\r\n\r\n  markNew(post, ipCount) {\r\n    const suffix = ((Math.floor(ipCount / 10)) % 10) === 1 ?\r\n      'th'\r\n    :\r\n      ['st', 'nd', 'rd'][(ipCount % 10) - 1] || 'th'; // fuck switches\r\n    const counter = $.el('span', {\r\n      className: 'ip-counter',\r\n      textContent: `(${ipCount})`\r\n    }\r\n    );\r\n    post.nodes.nameBlock.title = `This is the ${ipCount}${suffix} IP in the thread.`;\r\n    $.add(post.nodes.nameBlock, [$.tn(' '), counter]);\r\n    return $.addClass(post.nodes.root, 'new-ip');\r\n  },\r\n\r\n  markOld(post) {\r\n    post.nodes.nameBlock.title = 'Not the first post from this IP.';\r\n    return $.addClass(post.nodes.root, 'old-ip');\r\n  }\r\n};\r\nexport default MarkNewIPs;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Header from \"../General/Header\";\r\nimport UI from \"../General/UI\";\r\nimport { g, Conf, E, doc, d } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { MINUTE, SECOND } from \"../platform/helpers\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar ThreadStats = {\r\n  postCount: 0,\r\n  fileCount: 0,\r\n  postIndex: 0,\r\n\r\n  init() {\r\n    let sc;\r\n    if ((g.VIEW !== 'thread') || !Conf['Thread Stats']) { return; }\r\n\r\n    if (Conf['Page Count in Stats']) {\r\n      this[g.SITE.isPrunedByAge?.(g.BOARD) ? 'showPurgePos' : 'showPage'] = true;\r\n    }\r\n\r\n    const statsHTML = {innerHTML: \"<span id=\\\"post-count\\\">?</span> / <span id=\\\"file-count\\\">?</span>\" + ((Conf[\"IP Count in Stats\"] && g.SITE.hasIPCount) ? \" / <span id=\\\"ip-count\\\">?</span>\" : \"\") + ((Conf[\"Page Count in Stats\"]) ? \" / <span id=\\\"page-count\\\">?</span>\" : \"\")};\r\n    let statsTitle = 'Posts / Files';\r\n    if (Conf['IP Count in Stats'] && g.SITE.hasIPCount) { statsTitle += ' / IPs'; }\r\n    if (Conf['Page Count in Stats']) { statsTitle += (this.showPurgePos ? ' / Purge Position' : ' / Page'); }\r\n\r\n    if (Conf['Updater and Stats in Header']) {\r\n      this.dialog = (sc = $.el('span', {\r\n        id:    'thread-stats',\r\n        title: statsTitle\r\n      }\r\n      ));\r\n      $.extend(sc, statsHTML);\r\n      Header.addShortcut('stats', sc, 200);\r\n\r\n    } else {\r\n      this.dialog = (sc = UI.dialog('thread-stats',\r\n        {innerHTML: \"<div class=\\\"move\\\" title=\\\"\" + E(statsTitle) + \"\\\">\" + (statsHTML).innerHTML + \"</div>\"}));\r\n      $.addClass(doc, 'float');\r\n      $.ready(() => $.add(d.body, sc));\r\n    }\r\n\r\n    this.postCountEl = $('#post-count', sc);\r\n    this.fileCountEl = $('#file-count', sc);\r\n    this.ipCountEl   = $('#ip-count',   sc);\r\n    this.pageCountEl = $('#page-count', sc);\r\n\r\n    if (this.pageCountEl) { $.on(this.pageCountEl, 'click', ThreadStats.fetchPage); }\r\n\r\n    return Callbacks.Thread.push({\r\n      name: 'Thread Stats',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    ThreadStats.thread = this;\r\n    ThreadStats.count();\r\n    ThreadStats.update();\r\n    ThreadStats.fetchPage();\r\n    $.on(d, 'PostsInserted', () => $.queueTask(ThreadStats.onPostsInserted));\r\n    return $.on(d, 'ThreadUpdate', ThreadStats.onUpdate);\r\n  },\r\n\r\n  count() {\r\n    const {posts} = ThreadStats.thread;\r\n    const n = posts.keys.length;\r\n    for (let i = ThreadStats.postIndex, end = n; i < end; i++) {\r\n      var post = posts.get(posts.keys[i]);\r\n      if (!post.isFetchedQuote) {\r\n        ThreadStats.postCount++;\r\n        ThreadStats.fileCount += post.files.length;\r\n      }\r\n    }\r\n    return ThreadStats.postIndex = n;\r\n  },\r\n\r\n  onUpdate(e) {\r\n    if (e.detail[404]) { return; }\r\n    const {postCount, fileCount} = e.detail;\r\n    $.extend(ThreadStats, {postCount, fileCount});\r\n    ThreadStats.postIndex = ThreadStats.thread.posts.keys.length;\r\n    ThreadStats.update();\r\n    if (ThreadStats.showPage && (ThreadStats.pageCountEl.textContent !== '1')) {\r\n      return ThreadStats.fetchPage();\r\n    }\r\n  },\r\n\r\n  onPostsInserted() {\r\n    if (ThreadStats.thread.posts.keys.length <= ThreadStats.postIndex) { return; }\r\n    ThreadStats.count();\r\n    ThreadStats.update();\r\n    if (ThreadStats.showPage && (ThreadStats.pageCountEl.textContent !== '1')) {\r\n      return ThreadStats.fetchPage();\r\n    }\r\n  },\r\n\r\n  update() {\r\n    const {thread, postCountEl, fileCountEl, ipCountEl} = ThreadStats;\r\n    postCountEl.textContent = ThreadStats.postCount;\r\n    fileCountEl.textContent = ThreadStats.fileCount;\r\n    // TOTO check if ipCountEl exists\r\n    ipCountEl.textContent  = thread.ipCount ?? '?';\r\n    postCountEl.classList.toggle('warning', (thread.postLimit && !thread.isSticky));\r\n    return fileCountEl.classList.toggle('warning', (thread.fileLimit && !thread.isSticky));\r\n  },\r\n\r\n  fetchPage() {\r\n    if (!ThreadStats.pageCountEl) { return; }\r\n    clearTimeout(ThreadStats.timeout);\r\n    if (ThreadStats.thread.isDead) {\r\n      ThreadStats.pageCountEl.textContent = 'Dead';\r\n      $.addClass(ThreadStats.pageCountEl, 'warning');\r\n      return;\r\n    }\r\n    ThreadStats.timeout = setTimeout(ThreadStats.fetchPage, 2 * MINUTE);\r\n    return $.whenModified(\r\n      g.SITE.urls.threadsListJSON(ThreadStats.thread),\r\n      'ThreadStats',\r\n      ThreadStats.onThreadsLoad\r\n    );\r\n  },\r\n\r\n  onThreadsLoad() {\r\n    if (this.status === 200) {\r\n      let page, thread;\r\n      if (ThreadStats.showPurgePos) {\r\n        let purgePos = 1;\r\n        for (page of this.response) {\r\n          for (thread of page.threads) {\r\n            if (thread.no < ThreadStats.thread.ID) {\r\n              purgePos++;\r\n            }\r\n          }\r\n        }\r\n        ThreadStats.pageCountEl.textContent = purgePos;\r\n        return ThreadStats.pageCountEl.classList.toggle('warning', (purgePos === 1));\r\n      } else {\r\n        let nThreads;\r\n        let i = (nThreads = 0);\r\n        for (page of this.response) {\r\n          nThreads += page.threads.length;\r\n        }\r\n        for (let pageNum = 0; pageNum < this.response.length; pageNum++) {\r\n          page = this.response[pageNum];\r\n          for (thread of page.threads) {\r\n            if (thread.no === ThreadStats.thread.ID) {\r\n              ThreadStats.pageCountEl.textContent = pageNum + 1;\r\n              ThreadStats.pageCountEl.classList.toggle('warning', (i >= (nThreads - this.response[0].threads.length)));\r\n              ThreadStats.lastPageUpdate = new Date(thread.last_modified * SECOND);\r\n              ThreadStats.retry();\r\n              return;\r\n            }\r\n            i++;\r\n          }\r\n        }\r\n      }\r\n    } else if (this.status === 304) {\r\n      return ThreadStats.retry();\r\n    }\r\n  },\r\n\r\n  retry() {\r\n    // If thread data is stale (modification date given < time of last post), try again.\r\n    // Skip this on vichan sites due to sage posts not updating modification time in threads.json.\r\n    if (\r\n      !ThreadStats.showPage ||\r\n      (ThreadStats.pageCountEl.textContent === '1') ||\r\n      !!g.SITE.threadModTimeIgnoresSage ||\r\n      (ThreadStats.thread.posts.get(ThreadStats.thread.lastPost).info.date <= ThreadStats.lastPageUpdate)\r\n    ) { return; }\r\n    clearTimeout(ThreadStats.timeout);\r\n    return ThreadStats.timeout = setTimeout(ThreadStats.fetchPage, 5 * SECOND);\r\n  }\r\n};\r\nexport default ThreadStats;\r\n","import { g, Conf } from \"../globals/globals\";\r\nimport Main from \"../main/Main\";\r\nimport $ from \"../platform/$\";\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst PassLink = {\r\n  init() {\r\n    if ((g.SITE.software !== 'yotsuba') || !Conf['Pass Link']) { return; }\r\n    return Main.ready(this.ready);\r\n  },\r\n\r\n  ready() {\r\n    let styleSelector;\r\n    if (!(styleSelector = $.id('styleSelector'))) { return; }\r\n\r\n    const passLink = $.el('span',\r\n      {className: 'brackets-wrap pass-link-container'});\r\n    $.extend(passLink, {innerHTML: \"<a href=\\\"javascript:;\\\">4chan Pass</a>\"});\r\n    $.on(passLink.firstElementChild, 'click', () => window.open(`//sys.${location.hostname.split('.')[1]}.org/auth`,\r\n      Date.now(),\r\n      'width=500,height=280,toolbar=0'));\r\n    return $.before(styleSelector.previousSibling, [passLink, $.tn('\\u00A0\\u00A0')]);\r\n  }\r\n};\r\nexport default PassLink;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Fetcher from \"../classes/Fetcher\";\r\nimport Get from \"../General/Get\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport Unread from \"../Monitoring/Unread\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar QuoteInline = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Quote Inlining']) { return; }\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Quote Inlining',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    const {process} = QuoteInline;\r\n    const {isClone} = this;\r\n    for (var link of this.nodes.quotelinks.concat([...this.nodes.backlinks], this.nodes.archivelinks)) {\r\n      process(link, isClone);\r\n    }\r\n  },\r\n\r\n  process(link, clone) {\r\n    if (Conf['Quote Hash Navigation']) {\r\n      if (!clone) { $.after(link, QuoteInline.qiQuote(link, $.hasClass(link, 'filtered'))); }\r\n    }\r\n    return $.on(link, 'click', QuoteInline.toggle);\r\n  },\r\n\r\n  qiQuote(link, hidden) {\r\n    let name = \"hashlink\";\r\n    if (hidden) { name += \" filtered\"; }\r\n    return $.el('a', {\r\n      className: name,\r\n      textContent: '#',\r\n      href: link.href\r\n    }\r\n    );\r\n  },\r\n\r\n  toggle(e) {\r\n    if ($.modifiedClick(e)) { return; }\r\n\r\n    const {boardID, threadID, postID} = Get.postDataFromLink(this);\r\n    if (Conf['Inline Cross-thread Quotes Only'] && (g.VIEW === 'thread') && g.posts.get(`${boardID}.${postID}`)?.nodes.root.offsetParent) { return; } // exists and not hidden\r\n    if ($.hasClass(doc, 'catalog-mode')) { return; }\r\n\r\n    e.preventDefault();\r\n    const quoter = Get.postFromNode(this);\r\n    const {context} = quoter;\r\n    if ($.hasClass(this, 'inlined')) {\r\n      QuoteInline.rm(this, boardID, threadID, postID, context);\r\n    } else {\r\n      if ($.x(`ancestor::div[@data-full-i-d='${boardID}.${postID}']`, this)) { return; }\r\n      QuoteInline.add(this, boardID, threadID, postID, context, quoter);\r\n    }\r\n    return this.classList.toggle('inlined');\r\n  },\r\n\r\n  findRoot(quotelink, isBacklink) {\r\n    if (isBacklink) {\r\n      return $.x('ancestor::*[parent::*[contains(@class,\"post\")]][1]', quotelink);\r\n    } else {\r\n      return $.x('ancestor-or-self::*[parent::blockquote][1]', quotelink);\r\n    }\r\n  },\r\n\r\n  add(quotelink, boardID, threadID, postID, context, quoter) {\r\n    let post;\r\n    const isBacklink = $.hasClass(quotelink, 'backlink');\r\n    const inline = $.el('div',\r\n      {className: 'inline'});\r\n    inline.dataset.fullID = `${boardID}.${postID}`;\r\n    const root = QuoteInline.findRoot(quotelink, isBacklink);\r\n    $.after(root, inline);\r\n\r\n    const qroot = $.x('ancestor::*[contains(@class,\"postContainer\")][1]', root);\r\n\r\n    $.addClass(qroot, 'hasInline');\r\n    new Fetcher(boardID, threadID, postID, inline, quoter);\r\n\r\n    if (!(\r\n      (post = g.posts.get(`${boardID}.${postID}`)) &&\r\n      (context.thread === post.thread)\r\n    )) { return; }\r\n\r\n    // Hide forward post if it's a backlink of a post in this thread.\r\n    // Will only unhide if there's no inlined backlinks of it anymore.\r\n    if (isBacklink && Conf['Forward Hiding']) {\r\n      $.addClass(post.nodes.root, 'forwarded');\r\n      post.forwarded++ || (post.forwarded = 1);\r\n    }\r\n\r\n    // Decrease the unread count if this post\r\n    // is in the array of unread posts.\r\n    if (!Unread.posts) { return; }\r\n    return Unread.readSinglePost(post);\r\n  },\r\n\r\n  rm(quotelink, boardID, threadID, postID, context) {\r\n    let el;\r\n    let inlined;\r\n    const isBacklink = $.hasClass(quotelink, 'backlink');\r\n    // Select the corresponding inlined quote, and remove it.\r\n    let root = QuoteInline.findRoot(quotelink, isBacklink);\r\n    root = $.x(`following-sibling::div[@data-full-i-d='${boardID}.${postID}'][1]`, root);\r\n    const qroot = $.x('ancestor::*[contains(@class,\"postContainer\")][1]', root);\r\n    const {parentNode} = root;\r\n    $.rm(root);\r\n    $.event('PostsRemoved', null, parentNode);\r\n\r\n    if (!$('.inline', qroot)) {\r\n      $.rmClass(qroot, 'hasInline');\r\n    }\r\n\r\n    // Stop if it only contains text.\r\n    if (!(el = root.firstElementChild)) { return; }\r\n\r\n    // Dereference clone.\r\n    const post = g.posts.get(`${boardID}.${postID}`);\r\n    post.rmClone(el.dataset.clone);\r\n\r\n    // Decrease forward count and unhide.\r\n    if (Conf['Forward Hiding'] &&\r\n      isBacklink &&\r\n      (context.thread === g.threads.get(`${boardID}.${threadID}`)) &&\r\n      !--post.forwarded) {\r\n        delete post.forwarded;\r\n        $.rmClass(post.nodes.root, 'forwarded');\r\n      }\r\n\r\n    // Repeat.\r\n    while ((inlined = $('.inlined', el))) {\r\n      ({boardID, threadID, postID} = Get.postDataFromLink(inlined));\r\n      QuoteInline.rm(inlined, boardID, threadID, postID, context);\r\n      $.rmClass(inlined, 'inlined');\r\n    }\r\n  }\r\n};\r\nexport default QuoteInline;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\nimport { dict } from \"../platform/helpers\";\r\nimport QuoteInline from \"./QuoteInline\";\r\nimport QuotePreview from \"./QuotePreview\";\r\nimport QuoteYou from \"./QuoteYou\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar QuoteBacklink = {\r\n  // Backlinks appending need to work for:\r\n  //  - previous, same, and following posts.\r\n  //  - existing and yet-to-exist posts.\r\n  //  - newly fetched posts.\r\n  //  - in copies.\r\n  // XXX what about order for fetched posts?\r\n  //\r\n  // First callback creates backlinks and add them to relevant containers.\r\n  // Second callback adds relevant containers into posts.\r\n  // This is is so that fetched posts can get their backlinks,\r\n  // and that as much backlinks are appended in the background as possible.\r\n  containers: dict(),\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Quote Backlinks']) { return; }\r\n\r\n    // Add a class to differentiate when backlinks are at\r\n    // the top (default) or bottom of a post\r\n    if (this.bottomBacklinks = Conf['Bottom Backlinks']) {\r\n      $.addClass(doc, 'bottom-backlinks');\r\n    }\r\n\r\n    Callbacks.Post.push({\r\n      name: 'Quote Backlinking Part 1',\r\n      cb:   this.firstNode\r\n    });\r\n    return Callbacks.Post.push({\r\n      name: 'Quote Backlinking Part 2',\r\n      cb:   this.secondNode\r\n    });\r\n  },\r\n  firstNode() {\r\n    if (this.isClone || !this.quotes.length || this.isRebuilt) { return; }\r\n    const markYours = Conf['Mark Quotes of You'] && QuoteYou.isYou(this);\r\n    const a = $.el('a', {\r\n      href: g.SITE.Build.postURL(this.board.ID, this.thread.ID, this.ID),\r\n      className: this.isHidden ? 'filtered backlink' : 'backlink',\r\n      textContent: Conf['backlink'].replace(/%(?:id|%)/g, x => ({'%id': this.ID, '%%': '%'})[x])\r\n    }\r\n    );\r\n    if (markYours) { $.add(a, QuoteYou.mark.cloneNode(true)); }\r\n    for (var quote of this.quotes) {\r\n      var post;\r\n      var containers = [QuoteBacklink.getContainer(quote)];\r\n      if ((post = g.posts.get(quote)) && post.nodes.backlinkContainer) {\r\n        // Don't add OP clones when OP Backlinks is disabled,\r\n        // as the clones won't have the backlink containers.\r\n        for (var clone of post.clones) {\r\n          containers.push(clone.nodes.backlinkContainer);\r\n        }\r\n      }\r\n      for (var container of containers) {\r\n        var link = a.cloneNode(true);\r\n        var nodes = container.firstChild ? [$.tn(' '), link] : [link];\r\n        if (Conf['Quote Previewing']) {\r\n          $.on(link, 'mouseover', QuotePreview.mouseover);\r\n        }\r\n        if (Conf['Quote Inlining']) {\r\n          $.on(link, 'click', QuoteInline.toggle);\r\n          if (Conf['Quote Hash Navigation']) {\r\n            var hash = QuoteInline.qiQuote(link, $.hasClass(link, 'filtered'));\r\n            nodes.push(hash);\r\n          }\r\n        }\r\n        $.add(container, nodes);\r\n      }\r\n    }\r\n  },\r\n  secondNode() {\r\n    if (this.isClone && (this.origin.isReply || Conf['OP Backlinks'])) {\r\n      this.nodes.backlinkContainer = $('.container', this.nodes.post);\r\n      return;\r\n    }\r\n    // Don't backlink the OP.\r\n    if (!this.isReply && !Conf['OP Backlinks']) { return; }\r\n    const container = QuoteBacklink.getContainer(this.fullID);\r\n    this.nodes.backlinkContainer = container;\r\n    if (QuoteBacklink.bottomBacklinks) {\r\n      return $.add(this.nodes.post, container);\r\n    } else {\r\n      return $.add(this.nodes.info, container);\r\n    }\r\n  },\r\n  getContainer(id) {\r\n    return this.containers[id] ||\r\n      (this.containers[id] = $.el('span', {className: 'container'}));\r\n  }\r\n};\r\nexport default QuoteBacklink;\r\n","import $ from \"../platform/$\";\r\nimport Callbacks from \"../classes/Callbacks\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport Get from \"../General/Get\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar QuoteCT = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Mark Cross-thread Quotes']) { return; }\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    // \\u00A0 is nbsp\r\n    this.mark = $.el('span', {\r\n      textContent: '\\u00A0(Cross-thread)',\r\n      className:   'qmark-ct'\r\n    }\r\n    );\r\n    return Callbacks.Post.push({\r\n      name: 'Mark Cross-thread Quotes',\r\n      cb:   this.node\r\n    });\r\n  },\r\n  node() {\r\n    // Stop there if it's a clone of a post in the same thread.\r\n    if (this.isClone && (this.thread === this.context.thread)) { return; }\r\n\r\n    const {board, thread} = this.context;\r\n    for (var quotelink of this.nodes.quotelinks) {\r\n      var {boardID, threadID} = Get.postDataFromLink(quotelink);\r\n      if (!threadID) { continue; } // deadlink\r\n      if (this.isClone) {\r\n        $.rm($('.qmark-ct', quotelink));\r\n      }\r\n      if ((boardID === board.ID) && (threadID !== thread.ID)) {\r\n        $.add(quotelink, QuoteCT.mark.cloneNode(true));\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default QuoteCT;\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Get from \"../General/Get\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar QuoteOP = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Mark OP Quotes']) { return; }\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    // \\u00A0 is nbsp\r\n    this.mark = $.el('span', {\r\n      textContent: '\\u00A0(OP)',\r\n      className:   'qmark-op'\r\n    }\r\n    );\r\n    return Callbacks.Post.push({\r\n      name: 'Mark OP Quotes',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    // Stop there if it's a clone of a post in the same thread.\r\n    let i, quotelink, quotes;\r\n    if (this.isClone && (this.thread === this.context.thread)) { return; }\r\n    // Stop there if there's no quotes in that post.\r\n    if (!(quotes = this.quotes).length) { return; }\r\n    const {quotelinks} = this.nodes;\r\n\r\n    // rm (OP) from cross-thread quotes.\r\n    if (this.isClone && quotes.includes(this.thread.fullID)) {\r\n      i = 0;\r\n      while ((quotelink = quotelinks[i++])) {\r\n        $.rm($('.qmark-op', quotelink));\r\n      }\r\n    }\r\n\r\n    const {fullID} = this.context.thread;\r\n    // add (OP) to quotes quoting this context's OP.\r\n\r\n    if (!quotes.includes(fullID)) { return; }\r\n    i = 0;\r\n    while ((quotelink = quotelinks[i++])) {\r\n      var {boardID, postID} = Get.postDataFromLink(quotelink);\r\n      if (`${boardID}.${postID}` === fullID) {\r\n        $.add(quotelink, QuoteOP.mark.cloneNode(true));\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default QuoteOP;\r\n","import Redirect from \"../Archive/Redirect\";\r\nimport Callbacks from \"../classes/Callbacks\";\r\nimport Post from \"../classes/Post\";\r\nimport { g, Conf, doc } from \"../globals/globals\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Quotify = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) || !Conf['Resurrect Quotes']) { return; }\r\n\r\n    $.addClass(doc, 'resurrect-quotes');\r\n\r\n    if (Conf['Comment Expansion']) {\r\n      ExpandComment.callbacks.push(this.node);\r\n    }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Resurrect Quotes',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) {\r\n      this.nodes.archivelinks = $$('a.linkify.quotelink', this.nodes.comment);\r\n      return;\r\n    }\r\n    for (var link of $$('a.linkify', this.nodes.comment)) {\r\n      Quotify.parseArchivelink.call(this, link);\r\n    }\r\n    for (var deadlink of $$('.deadlink', this.nodes.comment)) {\r\n      Quotify.parseDeadlink.call(this, deadlink);\r\n    }\r\n  },\r\n\r\n  parseArchivelink(link) {\r\n    let m;\r\n    if (!(m = link.pathname.match(/^\\/([^/]+)\\/thread\\/S?(\\d+)\\/?$/))) { return; }\r\n    if (['boards.4chan.org', 'boards.4channel.org'].includes(link.hostname)) { return; }\r\n    const boardID  = m[1];\r\n    const threadID = m[2];\r\n    const postID   = link.hash.match(/^#[pq]?(\\d+)$|$/)[1] || threadID;\r\n    if (Redirect.to('post', {boardID, postID})) {\r\n      $.addClass(link, 'quotelink');\r\n      $.extend(link.dataset, {boardID, threadID, postID});\r\n      return this.nodes.archivelinks.push(link);\r\n    }\r\n  },\r\n\r\n  parseDeadlink(deadlink) {\r\n    let a, m, post, postID;\r\n    if ($.hasClass(deadlink.parentNode, 'prettyprint')) {\r\n      // Don't quotify deadlinks inside code tags,\r\n      // un-`span` them.\r\n      // This won't be necessary once 4chan\r\n      // stops quotifying inside code tags:\r\n      // https://github.com/4chan/4chan-JS/issues/77\r\n      Quotify.fixDeadlink(deadlink);\r\n      return;\r\n    }\r\n\r\n    const quote = deadlink.textContent;\r\n    if (!(postID = quote.match(/\\d+$/)?.[0])) { return; }\r\n    if (postID[0] === '0') {\r\n      // Fix quotelinks that start with a `0`.\r\n      Quotify.fixDeadlink(deadlink);\r\n      return;\r\n    }\r\n    const boardID = (m = quote.match(/^>>>\\/([a-z\\d]+)/)) ?\r\n      m[1]\r\n    :\r\n      this.board.ID;\r\n    const quoteID = `${boardID}.${postID}`;\r\n\r\n    if (post = g.posts.get(quoteID)) {\r\n      if (!post.isDead) {\r\n        // Don't (Dead) when quotifying in an archived post,\r\n        // and we know the post still exists.\r\n        a = $.el('a', {\r\n          href:        g.SITE.Build.postURL(boardID, post.thread.ID, postID),\r\n          className:   'quotelink',\r\n          textContent: quote\r\n        }\r\n        );\r\n      } else {\r\n        // Replace the .deadlink span if we can redirect.\r\n        a = $.el('a', {\r\n          href:        g.SITE.Build.postURL(boardID, post.thread.ID, postID),\r\n          className:   'quotelink deadlink',\r\n          textContent: quote\r\n        }\r\n        );\r\n        $.add(a, Post.deadMark.cloneNode(true));\r\n        $.extend(a.dataset, {boardID, threadID: post.thread.ID, postID});\r\n      }\r\n\r\n    } else {\r\n      const redirect = Redirect.to('thread', {boardID, threadID: 0, postID});\r\n      const fetchable = Redirect.to('post', {boardID, postID});\r\n      if (redirect || fetchable) {\r\n        // Replace the .deadlink span if we can redirect or fetch the post.\r\n        a = $.el('a', {\r\n          href:        redirect || 'javascript:;',\r\n          className:   'deadlink',\r\n          textContent: quote\r\n        }\r\n        );\r\n        $.add(a, Post.deadMark.cloneNode(true));\r\n        if (fetchable) {\r\n          // Make it function as a normal quote if we can fetch the post.\r\n          $.addClass(a, 'quotelink');\r\n          $.extend(a.dataset, {boardID, postID});\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!this.quotes.includes(quoteID)) { this.quotes.push(quoteID); }\r\n\r\n    if (!a) {\r\n      $.add(deadlink, Post.deadMark.cloneNode(true));\r\n      return;\r\n    }\r\n\r\n    $.replace(deadlink, a);\r\n    if ($.hasClass(a, 'quotelink')) {\r\n      return this.nodes.quotelinks.push(a);\r\n    }\r\n  },\r\n\r\n  fixDeadlink(deadlink) {\r\n    let el;\r\n    if (!(el = deadlink.previousSibling) || (el.nodeName === 'BR')) {\r\n      const green = $.el('span',\r\n        {className: 'quote'});\r\n      $.before(deadlink, green);\r\n      $.add(green, deadlink);\r\n    }\r\n    return $.replace(deadlink, [...deadlink.childNodes]);\r\n  }\r\n};\r\nexport default Quotify;\r\n","import $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst Polyfill = {\r\n  init() {\r\n    this.toBlob();\r\n    $.global(this.toBlob);\r\n    if (!Element.prototype.matches) { Element.prototype.matches = Element.prototype.mozMatchesSelector || Element.prototype.webkitMatchesSelector; }\r\n  },\r\n  // This function is converted to a string and then put in a script tag.\r\n  // Do NOT shorten to `toBlob() {`.\r\n  toBlob: function() {\r\n    if (HTMLCanvasElement.prototype.toBlob) { return; }\r\n    HTMLCanvasElement.prototype.toBlob = function(cb, type, encoderOptions) {\r\n      const url = this.toDataURL(type, encoderOptions);\r\n      const data = atob(url.slice(url.indexOf(',')+1));\r\n      // DataUrl to Binary code from Aeosynth's 4chan X repo\r\n      const l = data.length;\r\n      const ui8a = new Uint8Array(l);\r\n      for (let i = 0, end = l; i < end; i++) {\r\n        ui8a[i] = data.charCodeAt(i);\r\n      }\r\n      return cb(new Blob([ui8a], {type: type || 'image/png'}));\r\n    };\r\n  }\r\n};\r\nexport default Polyfill;\r\n",null,"import Redirect from \"../Archive/Redirect\";\r\nimport Board from \"../classes/Board\";\r\nimport Callbacks from \"../classes/Callbacks\";\r\nimport CatalogThreadNative from \"../classes/CatalogThreadNative\";\r\nimport DataBoard from \"../classes/DataBoard\";\r\nimport Notice from \"../classes/Notice\";\r\nimport Post from \"../classes/Post\";\r\nimport SimpleDict from \"../classes/SimpleDict\";\r\nimport Thread from \"../classes/Thread\";\r\nimport Config from \"../config/Config\";\r\nimport Anonymize from \"../Filtering/Anonymize\";\r\nimport Filter from \"../Filtering/Filter\";\r\nimport PostHiding from \"../Filtering/PostHiding\";\r\nimport Recursive from \"../Filtering/Recursive\";\r\nimport ThreadHiding from \"../Filtering/ThreadHiding\";\r\nimport Index from \"../General/Index\";\r\nimport Settings from \"../General/Settings\";\r\nimport FappeTyme from \"../Images/FappeTyme\";\r\nimport Gallery from \"../Images/Gallery\";\r\nimport ImageCommon from \"../Images/ImageCommon\";\r\nimport ImageExpand from \"../Images/ImageExpand\";\r\nimport ImageHost from \"../Images/ImageHost\";\r\nimport ImageHover from \"../Images/ImageHover\";\r\nimport ImageLoader from \"../Images/ImageLoader\";\r\nimport Metadata from \"../Images/Metadata\";\r\nimport RevealSpoilers from \"../Images/RevealSpoilers\";\r\nimport Sauce from \"../Images/Sauce\";\r\nimport Volume from \"../Images/Volume\";\r\nimport Linkify from \"../Linkification/Linkify\";\r\nimport ArchiveLink from \"../Menu/ArchiveLink\";\r\nimport CopyTextLink from \"../Menu/CopyTextLink\";\r\nimport DeleteLink from \"../Menu/DeleteLink\";\r\nimport DownloadLink from \"../Menu/DownloadLink\";\r\nimport ReportLink from \"../Menu/ReportLink\";\r\nimport AntiAutoplay from \"../Miscellaneous/AntiAutoplay\";\r\nimport Banner from \"../Miscellaneous/Banner\";\r\nimport CatalogLinks from \"../Miscellaneous/CatalogLinks\";\r\nimport CustomCSS from \"../Miscellaneous/CustomCSS\";\r\nimport ExpandComment from \"../Miscellaneous/ExpandComment\";\r\nimport ExpandThread from \"../Miscellaneous/ExpandThread\";\r\nimport FileInfo from \"../Miscellaneous/FileInfo\";\r\nimport Flash from \"../Miscellaneous/Flash\";\r\nimport Fourchan from \"../Miscellaneous/Fourchan\";\r\nimport IDColor from \"../Miscellaneous/IDColor\";\r\nimport IDHighlight from \"../Miscellaneous/IDHighlight\";\r\nimport IDPostCount from \"../Miscellaneous/IDPostCount\";\r\nimport Keybinds from \"../Miscellaneous/Keybinds\";\r\nimport ModContact from \"../Miscellaneous/ModContact\";\r\nimport Nav from \"../Miscellaneous/Nav\";\r\nimport NormalizeURL from \"../Miscellaneous/NormalizeURL\";\r\nimport PostJumper from \"../Miscellaneous/PostJumper\";\r\nimport PSA from \"../Miscellaneous/PSA\";\r\nimport PSAHiding from \"../Miscellaneous/PSAHiding\";\r\nimport RelativeDates from \"../Miscellaneous/RelativeDates\";\r\nimport RemoveSpoilers from \"../Miscellaneous/RemoveSpoilers\";\r\nimport ThreadLinks from \"../Miscellaneous/ThreadLinks\";\r\nimport Time from \"../Miscellaneous/Time\";\r\nimport Tinyboard from \"../Miscellaneous/Tinyboard\";\r\nimport Favicon from \"../Monitoring/Favicon\";\r\nimport MarkNewIPs from \"../Monitoring/MarkNewIPs\";\r\nimport ReplyPruning from \"../Monitoring/ReplyPruning\";\r\nimport ThreadStats from \"../Monitoring/ThreadStats\";\r\nimport ThreadUpdater from \"../Monitoring/ThreadUpdater\";\r\nimport ThreadWatcher from \"../Monitoring/ThreadWatcher\";\r\nimport Unread from \"../Monitoring/Unread\";\r\nimport UnreadIndex from \"../Monitoring/UnreadIndex\";\r\nimport $ from \"../platform/$\";\r\nimport $$ from \"../platform/$$\";\r\nimport PassLink from \"../Posting/PassLink\";\r\nimport PostRedirect from \"../Posting/PostRedirect\";\r\nimport QR from \"../Posting/QR\";\r\nimport QuoteBacklink from \"../Quotelinks/QuoteBacklink\";\r\nimport QuoteCT from \"../Quotelinks/QuoteCT\";\r\nimport QuoteInline from \"../Quotelinks/QuoteInline\";\r\nimport QuoteOP from \"../Quotelinks/QuoteOP\";\r\nimport QuotePreview from \"../Quotelinks/QuotePreview\";\r\nimport QuoteStrikeThrough from \"../Quotelinks/QuoteStrikeThrough\";\r\nimport QuoteThreading from \"../Quotelinks/QuoteThreading\";\r\nimport QuoteYou from \"../Quotelinks/QuoteYou\";\r\nimport Quotify from \"../Quotelinks/Quotify\";\r\nimport Site from \"../site/Site\";\r\nimport SW from \"../site/SW\";\r\nimport CSS from \"../css/CSS\";\r\nimport meta from '../../package.json';\r\nimport Header from \"../General/Header\";\r\nimport { c, Conf, d, doc, docSet, E, g } from \"../globals/globals\";\r\nimport Menu from \"../Menu/Menu\";\r\nimport BoardConfig from \"../General/BoardConfig\";\r\nimport CaptchaReplace from \"../Posting/Captcha.replace\";\r\nimport Get from \"../General/Get\";\r\nimport { dict, platform } from \"../platform/helpers\";\r\nimport Polyfill from \"../General/Polyfill\";\r\nimport RestoreDeletedFromArchive from \"../Archive/RestoreDeletedFromArchive\";\r\n// import Test from \"../General/Test\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS104: Avoid inline assignments\r\n * DS205: Consider reworking code to avoid use of IIFEs\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nvar Main = {\r\n  init() {\r\n    // XXX dwb userscripts extension reloads scripts run at document-start when replaceState/pushState is called.\r\n    // XXX Firefox reinjects WebExtension content scripts when extension is updated / reloaded.\r\n    let key;\r\n    try {\r\n      let w = window;\r\n      if (platform === 'crx') { w = (w.wrappedJSObject || w); }\r\n      if (`${meta.name} antidup` in w) { return; }\r\n      w[`${meta.name} antidup`] = true;\r\n    } catch (error) {}\r\n\r\n    // Don't run inside ad iframes.\r\n    try {\r\n      if (window.frameElement && ['', 'about:blank'].includes(window.frameElement.src)) { return; }\r\n    } catch (error1) {}\r\n\r\n    // Detect multiple copies of 4chan X\r\n    if (doc && $.hasClass(doc, 'fourchan-x')) { return; }\r\n    $.asap(docSet, function() {\r\n      $.addClass(doc, 'fourchan-xt', 'fourchan-x', 'seaweedchan');\r\n      if ($.engine) { return $.addClass(doc, `ua-${$.engine}`); }\r\n    });\r\n    try {\r\n      $.global(\r\n        function () {\r\n          const date = +this.buildDate;\r\n          Object.defineProperty(window, 'fourchanXT', {\r\n            value: Object.freeze({\r\n              version: this.version,\r\n              // Getter to prevent mutations.\r\n              get buildDate() { return new Date(date) },\r\n            }),\r\n            writable: false,\r\n          });\r\n        },\r\n        { version: g.VERSION, buildDate: g.VERSION_DATE.getTime().toString() },\r\n      );\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    $.on(d, '4chanXInitFinished', function() {\r\n      if (Main.expectInitFinished) {\r\n        return delete Main.expectInitFinished;\r\n      } else {\r\n        new Notice('error', 'Error: Multiple copies of 4chan X are enabled.');\r\n        return $.addClass(doc, 'tainted');\r\n      }\r\n    });\r\n\r\n    // Detect \"mounted\" event from Kissu\r\n    var mountedCB = function() {\r\n      d.removeEventListener('mounted', mountedCB, true);\r\n      Main.isMounted = true;\r\n      return Main.mountedCBs.map((cb) =>\r\n        (() => { try {\r\n          return cb();\r\n        } catch (error2) {} })());\r\n    };\r\n    d.addEventListener('mounted', mountedCB, true);\r\n\r\n    // Flatten default values from Config into Conf\r\n    var flatten = function(parent, obj) {\r\n      if (obj instanceof Array) {\r\n        Conf[parent] = dict.clone(obj[0]);\r\n      } else if (typeof obj === 'object') {\r\n        for (var key in obj) {\r\n          var val = obj[key];\r\n          flatten(key, val);\r\n        }\r\n      } else { // string or number\r\n        Conf[parent] = obj;\r\n      }\r\n    };\r\n\r\n    // XXX Remove document-breaking ad\r\n    if (['boards.4chan.org', 'boards.4channel.org'].includes(location.hostname)) {\r\n      $.global(function() {\r\n        const fromCharCode0 = String.fromCharCode;\r\n        return String.fromCharCode = function() {\r\n          if (document.body) {\r\n            String.fromCharCode = fromCharCode0;\r\n          } else if (document.currentScript && !document.currentScript.src) {\r\n            throw Error();\r\n          }\r\n          return fromCharCode0.apply(this, arguments);\r\n        };\r\n      });\r\n      $.asap(docSet, () => $.onExists(doc, 'iframe[srcdoc]', $.rm));\r\n    }\r\n\r\n    flatten(null, Config);\r\n\r\n    for (var db of DataBoard.keys) {\r\n      Conf[db] = dict();\r\n    }\r\n    Conf['customTitles'] = dict.clone({'4chan.org': {boards: {'qa': {'boardTitle': {orig: '/qa/ - Question & Answer', title: '/qa/ - 2D/Random'}}}}});\r\n    Conf['boardConfig'] = {boards: dict()};\r\n    Conf['archives'] = Redirect.archives;\r\n    Conf['selectedArchives'] = dict();\r\n    Conf['cooldowns'] = dict();\r\n    Conf['Index Sort'] = dict();\r\n    for (let i = 0; i < 2; i++) { Conf[`Last Long Reply Thresholds ${i}`] = dict(); }\r\n    Conf['siteProperties'] = dict();\r\n\r\n    // XXX old key names\r\n    Conf['Except Archives from Encryption'] = false;\r\n    Conf['JSON Navigation'] = true;\r\n    Conf['Oekaki Links'] = true;\r\n    Conf['Show Name and Subject'] = false;\r\n    Conf['QR Shortcut'] = true;\r\n    Conf['Bottom QR Link'] = true;\r\n    Conf['Toggleable Thread Watcher'] = true;\r\n    Conf['siteSoftware'] = '';\r\n    Conf['Use Faster Image Host'] = 'true';\r\n    Conf['Captcha Fixes'] = true;\r\n    Conf['captchaServiceDomain'] = '';\r\n    Conf['captchaServiceKey'] = dict();\r\n\r\n    // Enforce JS whitelist\r\n    if (\r\n      /\\.4chan(?:nel)?\\.org$/.test(location.hostname) &&\r\n      !SW.yotsuba.regexp.pass.test(location.href) &&\r\n      !SW.yotsuba.regexp.captcha.test(location.href) &&\r\n      !$$('script:not([src])', d).filter(s => /this\\[/.test(s.textContent)).length\r\n    ) {\r\n      ($.getSync || $.get)({'jsWhitelist': Conf['jsWhitelist']}, ({jsWhitelist}) => $.addCSP(`script-src ${jsWhitelist.replace(/^#.*$/mg, '').replace(/[\\s;]+/g, ' ').trim()}`));\r\n    }\r\n\r\n    // Get saved values as items\r\n    const items = dict();\r\n    for (key in Conf) { items[key] = undefined; }\r\n    items['previousversion'] = undefined;\r\n    return ($.getSync || $.get)(items, function(items) {\r\n      if (!$.perProtocolSettings && /\\.4chan(?:nel)?\\.org$/.test(location.hostname) && (items['Redirect to HTTPS'] ?? Conf['Redirect to HTTPS']) && (location.protocol !== 'https:')) {\r\n        location.replace('https://' + location.host + location.pathname + location.search + location.hash);\r\n        return;\r\n      }\r\n      return $.asap(docSet, function() {\r\n\r\n        // Don't hide the local storage warning behind a settings panel.\r\n        if ($.cantSet) {\r\n          // pass\r\n\r\n        // Fresh install\r\n        } else if ((items.previousversion == null)) {\r\n          Main.isFirstRun = true;\r\n          Main.ready(function() {\r\n            $.set('previousversion', g.VERSION);\r\n            return Settings.open();\r\n          });\r\n\r\n        // Migrate old settings\r\n        } else if (items.previousversion !== g.VERSION) {\r\n          Main.upgrade(items);\r\n        }\r\n\r\n        // Combine default values with saved values\r\n        for (key in Conf) {\r\n          var val = Conf[key];\r\n          Conf[key] = items[key] ?? val;\r\n        }\r\n\r\n        return Site.init(Main.initFeatures);\r\n      });\r\n    });\r\n  },\r\n\r\n  upgrade(items) {\r\n    const {previousversion} = items;\r\n    const changes = Settings.upgrade(items, previousversion);\r\n    items.previousversion = (changes.previousversion = g.VERSION);\r\n    return $.set(changes, function() {\r\n      if (items['Show Updated Notifications'] ?? true) {\r\n        const el = $.el('span',\r\n          { innerHTML: `${meta.name} has been updated to <a href=\"${meta.changelog}\" target=\"_blank\">version ${g.VERSION}</a>.` });\r\n        return new Notice('info', el, 15);\r\n      }\r\n    });\r\n  },\r\n\r\n  parseURL(site=g.SITE, url=location) {\r\n    const r = {};\r\n\r\n    if (!site) { return r; }\r\n    r.siteID = site.ID;\r\n\r\n    if (site.isBoardlessPage?.(url)) { return r; }\r\n    const pathname = url.pathname.split(/\\/+/);\r\n    r.boardID = pathname[1];\r\n\r\n    if (site.isFileURL(url)) {\r\n      r.VIEW = 'file';\r\n    } else if (site.isAuxiliaryPage?.(url)) {\r\n      // pass\r\n    } else if (['thread', 'res'].includes(pathname[2])) {\r\n      r.VIEW = 'thread';\r\n      r.threadID = (r.THREADID = +pathname[3].replace(/\\.\\w+$/, ''));\r\n    } else if ((pathname[2] === 'archive') && (pathname[3] === 'res')) {\r\n      r.VIEW = 'thread';\r\n      r.threadID = (r.THREADID = +pathname[4].replace(/\\.\\w+$/, ''));\r\n      r.threadArchived = true;\r\n    } else if (/^(?:catalog|archive)(?:\\.\\w+)?$/.test(pathname[2])) {\r\n      r.VIEW = pathname[2].replace(/\\.\\w+$/, '');\r\n    } else if (/^(?:index|\\d*)(?:\\.\\w+)?$/.test(pathname[2])) {\r\n      r.VIEW = 'index';\r\n    }\r\n    return r;\r\n  },\r\n\r\n  initFeatures() {\r\n    $.global(function() {\r\n      document.documentElement.classList.add('js-enabled');\r\n      return window.FCX = {};});\r\n    Main.jsEnabled = $.hasClass(doc, 'js-enabled');\r\n\r\n    // XXX https://bugs.chromium.org/p/chromium/issues/detail?id=920638\r\n    $.ajaxPageInit?.();\r\n\r\n    $.extend(g, Main.parseURL());\r\n    if (g.boardID) { g.BOARD = new Board(g.boardID); }\r\n\r\n    if (!g.VIEW) {\r\n      g.SITE.initAuxiliary?.();\r\n      return;\r\n    }\r\n\r\n    if (g.VIEW === 'file') {\r\n      $.asap((() => d.readyState !== 'loading'), function() {\r\n        let video;\r\n        if ((g.SITE.software === 'yotsuba') && Conf['404 Redirect'] && g.SITE.is404?.()) {\r\n          const pathname = location.pathname.split(/\\/+/);\r\n          return Redirect.navigate('file', {\r\n            boardID:  g.BOARD.ID,\r\n            filename: pathname[pathname.length - 1]\r\n          });\r\n        } else if (video = $('video')) {\r\n          if (Conf['Volume in New Tab']) {\r\n            Volume.setup(video);\r\n          }\r\n          if (Conf['Loop in New Tab']) {\r\n            video.loop = true;\r\n            video.controls = false;\r\n            video.play();\r\n            return ImageCommon.addControls(video);\r\n          }\r\n        }\r\n      });\r\n      return;\r\n    }\r\n\r\n    g.threads = new SimpleDict();\r\n    g.posts   = new SimpleDict();\r\n\r\n    // set up CSS when <head> is completely loaded\r\n    $.onExists(doc, 'body', Main.initStyle);\r\n\r\n    // c.time 'All initializations'\r\n    for (var [name, feature] of Main.features) {\r\n      if (g.SITE.disabledFeatures && g.SITE.disabledFeatures.includes(name)) { continue; }\r\n      // c.time \"#{name} initialization\"\r\n      try {\r\n        feature.init();\r\n      } catch (err) {\r\n        Main.handleErrors({\r\n          message: `\\\"${name}\\\" initialization crashed.`,\r\n          error: err\r\n        });\r\n      }\r\n    }\r\n      // finally\r\n      //   c.timeEnd \"#{name} initialization\"\r\n\r\n    // c.timeEnd 'All initializations'\r\n\r\n    return $.ready(Main.initReady);\r\n  },\r\n\r\n  initStyle() {\r\n    if (!Main.isThisPageLegit()) { return; }\r\n\r\n    // disable the mobile layout\r\n    const mobileLink = $('link[href*=mobile]', d.head);\r\n    if (mobileLink) mobileLink.disabled = true;\r\n    doc.dataset.host = location.host;\r\n    $.addClass(doc, `sw-${g.SITE.software}`);\r\n    $.addClass(doc, g.VIEW === 'thread' ? 'thread-view' : g.VIEW);\r\n    $.onExists(doc, '.ad-cnt, .adg-rects > .desktop', ad => $.onExists(ad, 'img, iframe', () => $.addClass(doc, 'ads-loaded')));\r\n    if (Conf['Autohiding Scrollbar']) { $.addClass(doc, 'autohiding-scrollbar'); }\r\n    $.ready(function() {\r\n      if ((d.body.clientHeight > doc.clientHeight) && ((window.innerWidth === doc.clientWidth) !== Conf['Autohiding Scrollbar'])) {\r\n        Conf['Autohiding Scrollbar'] = !Conf['Autohiding Scrollbar'];\r\n        $.set('Autohiding Scrollbar', Conf['Autohiding Scrollbar']);\r\n        return $.toggleClass(doc, 'autohiding-scrollbar');\r\n      }\r\n    });\r\n    $.addStyle(CSS.sub(CSS.boards), 'fourchanx-css');\r\n    Main.bgColorStyle = $.el('style', {id: 'fourchanx-bgcolor-css'});\r\n\r\n    let keyboard = false;\r\n    $.on(d, 'mousedown', () => keyboard = false);\r\n    $.on(d, 'keydown', function(e) { if (e.keyCode === 9) { return keyboard = true; } }); // tab\r\n    window.addEventListener('focus', (() => doc.classList.toggle('keyboard-focus', keyboard)), true);\r\n\r\n    return Main.setClass();\r\n  },\r\n\r\n  setClass() {\r\n    let mainStyleSheet, style, styleSheets;\r\n    const knownStyles = ['yotsuba', 'yotsuba-b', 'futaba', 'burichan', 'photon', 'tomorrow', 'spooky'];\r\n\r\n    if ((g.SITE.software === 'yotsuba') && (g.VIEW === 'catalog')) {\r\n      if (mainStyleSheet = $.id('base-css')) {\r\n        style = mainStyleSheet.href.match(/catalog_(\\w+)/)?.[1].replace('_new', '').replace(/_+/g, '-');\r\n        if (knownStyles.includes(style)) {\r\n          $.addClass(doc, style);\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n    style = (mainStyleSheet = (styleSheets = null));\r\n\r\n    const setStyle = function() {\r\n      // Use preconfigured CSS for 4chan's default themes.\r\n      if (g.SITE.software === 'yotsuba') {\r\n        $.rmClass(doc, style);\r\n        style = null;\r\n        for (var styleSheet of styleSheets) {\r\n          if (styleSheet.href === mainStyleSheet?.href) {\r\n            style = styleSheet.title.toLowerCase().replace('new', '').trim().replace(/\\s+/g, '-');\r\n            if (style === '_special') { style = styleSheet.href.match(/[a-z]*(?=[^/]*$)/)[0]; }\r\n            if (!knownStyles.includes(style)) { style = null; }\r\n            break;\r\n          }\r\n        }\r\n        if (style) {\r\n          $.addClass(doc, style);\r\n          $.rm(Main.bgColorStyle);\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Determine proper dialog background color for other themes.\r\n      const div = g.SITE.bgColoredEl();\r\n      div.style.position = 'absolute';\r\n      div.style.visibility = 'hidden';\r\n      $.add(d.body, div);\r\n      let bgColor = window.getComputedStyle(div).backgroundColor;\r\n      $.rm(div);\r\n      const rgb = bgColor.match(/[\\d.]+/g);\r\n      // Use body background if reply background is transparent\r\n      if (!/^rgb\\(/.test(bgColor)) {\r\n        const s = window.getComputedStyle(d.body);\r\n        bgColor = `${s.backgroundColor} ${s.backgroundImage} ${s.backgroundRepeat} ${s.backgroundPosition}`;\r\n      }\r\n      let css = `\\\r\n.dialog, .suboption-list > div:last-of-type, :root.catalog-hover-expand .catalog-container:hover > .post {\r\n  background: ${bgColor};\r\n}\r\n.unread-mark-read {\r\n  background-color: rgba(${rgb.slice(0, 3).join(', ')}, ${0.5*(rgb[3] || 1)});\r\n}\\\r\n`;\r\n      if ($.luma(rgb) < 100) {\r\n        css += `\\\r\n.watch-thread-link {\r\n  background-image: url(\"data:image/svg+xml,<svg viewBox='0 0 26 26' preserveAspectRatio='true' xmlns='http://www.w3.org/2000/svg'><path fill='rgb(200,200,200)' d='M24.132,7.971c-2.203-2.205-5.916-2.098-8.25,0.235L15.5,8.588l-0.382-0.382c-2.334-2.333-6.047-2.44-8.25-0.235c-2.204,2.203-2.098,5.916,0.235,8.249l8.396,8.396l8.396-8.396C26.229,13.887,26.336,10.174,24.132,7.971z'/></svg>\");\r\n}\\\r\n`;\r\n      }\r\n      Main.bgColorStyle.textContent = css;\r\n      return $.after($.id('fourchanx-css'), Main.bgColorStyle);\r\n    };\r\n\r\n    $.onExists(d.head, g.SITE.selectors.styleSheet, function(el) {\r\n      mainStyleSheet = el;\r\n      if (g.SITE.software === 'yotsuba') {\r\n        styleSheets = $$('link[rel=\"alternate stylesheet\"]', d.head);\r\n      }\r\n      new MutationObserver(setStyle).observe(mainStyleSheet, {\r\n        attributes: true,\r\n        attributeFilter: ['href']\r\n      });\r\n      $.on(mainStyleSheet, 'load', setStyle);\r\n      return setStyle();\r\n    });\r\n    if (!mainStyleSheet) {\r\n      for (var styleSheet of $$('link[rel=\"stylesheet\"]', d.head)) {\r\n        $.on(styleSheet, 'load', setStyle);\r\n      }\r\n      return setStyle();\r\n    }\r\n  },\r\n\r\n  initReady() {\r\n    if (g.SITE.is404?.()) {\r\n      if (g.VIEW === 'thread') {\r\n        ThreadWatcher.set404(g.BOARD.ID, g.THREADID, function() {\r\n          if (Conf['404 Redirect']) {\r\n            return Redirect.navigate('thread', {\r\n              boardID:  g.BOARD.ID,\r\n              threadID: g.THREADID,\r\n              postID:   +location.hash.match(/\\d+/)\r\n            } // post number or 0\r\n            , `/${g.BOARD}/`);\r\n          }\r\n        });\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    if (g.SITE.isIncomplete?.()) {\r\n      const msg = $.el('div',\r\n        {innerHTML: 'The page didn&#039;t load completely.<br>Some features may not work unless you <a href=\"javascript:;\">reload</a>.'});\r\n      $.on($('a', msg), 'click', () => location.reload());\r\n      new Notice('warning', msg);\r\n    }\r\n\r\n    // Parse HTML or skip it and start building from JSON.\r\n    if (g.VIEW === 'catalog') {\r\n      return Main.initCatalog();\r\n    } else if (!Index.enabled) {\r\n      if (g.SITE.awaitBoard) {\r\n        return g.SITE.awaitBoard(Main.initThread);\r\n      } else {\r\n        return Main.initThread();\r\n      }\r\n    } else {\r\n      Main.expectInitFinished = true;\r\n      return $.event('4chanXInitFinished');\r\n    }\r\n  },\r\n\r\n  initThread() {\r\n    let board;\r\n    const s = g.SITE.selectors;\r\n    if (board = $((s.boardFor?.[g.VIEW] || s.board))) {\r\n      const threads = [];\r\n      const posts   = [];\r\n      const errors  = [];\r\n\r\n      try {\r\n        g.SITE.preParsingFixes?.(board);\r\n      } catch (error) {}\r\n\r\n      Main.addThreadsObserver = new MutationObserver(Main.addThreads);\r\n      Main.addPostsObserver   = new MutationObserver(Main.addPosts);\r\n      Main.addThreadsObserver.observe(board, {childList: true});\r\n\r\n      Main.parseThreads($$(s.thread, board), threads, posts, errors);\r\n      if (errors.length) { Main.handleErrors(errors); }\r\n\r\n      if (g.VIEW === 'thread') {\r\n        if (g.threadArchived) {\r\n          threads[0].isArchived = true;\r\n          threads[0].kill();\r\n        }\r\n        g.SITE.parseThreadMetadata?.(threads[0]);\r\n      }\r\n\r\n      Main.callbackNodes('Thread', threads);\r\n      return Main.callbackNodesDB('Post', posts, function() {\r\n        for (var post of posts) { QuoteThreading.insert(post); }\r\n        Main.expectInitFinished = true;\r\n        return $.event('4chanXInitFinished');\r\n      });\r\n\r\n    } else {\r\n      Main.expectInitFinished = true;\r\n      return $.event('4chanXInitFinished');\r\n    }\r\n  },\r\n\r\n  parseThreads(threadRoots, threads, posts, errors) {\r\n    for (var threadRoot of threadRoots) {\r\n      var boardObj = (() => {\r\n        let boardID;\r\n        if (boardID = threadRoot.dataset.board) {\r\n        boardID = encodeURIComponent(boardID);\r\n        return g.boards[boardID] || new Board(boardID);\r\n      } else {\r\n        return g.BOARD;\r\n      }\r\n      })();\r\n      var threadID = +threadRoot.id.match(/\\d*$/)[0];\r\n      if (!threadID || boardObj.threads.get(threadID)?.nodes.root) { return; }\r\n      var thread = new Thread(threadID, boardObj);\r\n      thread.nodes.root = threadRoot;\r\n      threads.push(thread);\r\n      var postRoots = $$(g.SITE.selectors.postContainer, threadRoot);\r\n      if (g.SITE.isOPContainerThread) { postRoots.unshift(threadRoot); }\r\n      Main.parsePosts(postRoots, thread, posts, errors);\r\n      Main.addPostsObserver.observe(threadRoot, {childList: true});\r\n    }\r\n  },\r\n\r\n  parsePosts(postRoots, thread, posts, errors) {\r\n    for (var postRoot of postRoots) {\r\n      if (!(postRoot.dataset.fullID && g.posts.get(postRoot.dataset.fullID)) && $(g.SITE.selectors.comment, postRoot)) {\r\n        try {\r\n          posts.push(new Post(postRoot, thread, thread.board));\r\n        } catch (err) {\r\n          // Skip posts that we failed to parse.\r\n          errors.push({\r\n            message: `Parsing of Post No.${postRoot.id.match(/\\d+/)} failed. Post will be skipped.`,\r\n            error: err,\r\n            html: postRoot.outerHTML\r\n          });\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  addThreads(records) {\r\n    const threadRoots = [];\r\n    for (var record of records) {\r\n      for (var node of record.addedNodes) {\r\n        if ((node.nodeType === Node.ELEMENT_NODE) && node.matches(g.SITE.selectors.thread)) {\r\n          threadRoots.push(node);\r\n        }\r\n      }\r\n    }\r\n    if (!threadRoots.length) { return; }\r\n    const threads = [];\r\n    const posts   = [];\r\n    const errors  = [];\r\n    Main.parseThreads(threadRoots, threads, posts, errors);\r\n    if (errors.length) { Main.handleErrors(errors); }\r\n    Main.callbackNodes('Thread', threads);\r\n    return Main.callbackNodesDB('Post', posts, () => $.event('PostsInserted', null, records[0].target));\r\n  },\r\n\r\n  addPosts(records) {\r\n    let thread;\r\n    const threads   = [];\r\n    const threadsRM = [];\r\n    const posts     = [];\r\n    const errors    = [];\r\n    for (var record of records) {\r\n      thread = Get.threadFromRoot(record.target);\r\n      var postRoots = [];\r\n      for (var node of record.addedNodes) {\r\n        if (node.nodeType === Node.ELEMENT_NODE) {\r\n          if (node.matches(g.SITE.selectors.postContainer) || (node = $(g.SITE.selectors.postContainer, node))) {\r\n            postRoots.push(node);\r\n          }\r\n        }\r\n      }\r\n      var n = posts.length;\r\n      Main.parsePosts(postRoots, thread, posts, errors);\r\n      if ((posts.length > n) && !threads.includes(thread)) {\r\n        threads.push(thread);\r\n      }\r\n      var anyRemoved = false;\r\n      for (var el of record.removedNodes) {\r\n        if ((Get.postFromRoot(el)?.nodes.root === el) && !doc.contains(el)) {\r\n          anyRemoved = true;\r\n          break;\r\n        }\r\n      }\r\n      if (anyRemoved && !threadsRM.includes(thread)) {\r\n        threadsRM.push(thread);\r\n      }\r\n    }\r\n    if (errors.length) { Main.handleErrors(errors); }\r\n    return Main.callbackNodesDB('Post', posts, function() {\r\n      for (thread of threads) {\r\n        $.event('PostsInserted', null, thread.nodes.root);\r\n      }\r\n      for (thread of threadsRM) {\r\n        $.event('PostsRemoved', null, thread.nodes.root);\r\n      }\r\n    });\r\n  },\r\n\r\n  initCatalog() {\r\n    let board;\r\n    const s = g.SITE.selectors.catalog;\r\n    if (s && (board = $(s.board))) {\r\n      const threads = [];\r\n      const errors  = [];\r\n\r\n      Main.addCatalogThreadsObserver = new MutationObserver(Main.addCatalogThreads);\r\n      Main.addCatalogThreadsObserver.observe(board, {childList: true});\r\n\r\n      Main.parseCatalogThreads($$(s.thread, board), threads, errors);\r\n      if (errors.length) { Main.handleErrors(errors); }\r\n\r\n      Main.callbackNodes('CatalogThreadNative', threads);\r\n    }\r\n\r\n    Main.expectInitFinished = true;\r\n    return $.event('4chanXInitFinished');\r\n  },\r\n\r\n  parseCatalogThreads(threadRoots, threads, errors) {\r\n    for (var threadRoot of threadRoots) {\r\n      try {\r\n        var thread = new CatalogThreadNative(threadRoot);\r\n        if (thread.thread.catalogViewNative?.nodes.root !== threadRoot) {\r\n          thread.thread.catalogViewNative = thread;\r\n          threads.push(thread);\r\n        }\r\n      } catch (err) {\r\n        // Skip threads that we failed to parse.\r\n        errors.push({\r\n          message: `Parsing of Catalog Thread No.${(threadRoot.dataset.id || threadRoot.id).match(/\\d+/)} failed. Thread will be skipped.`,\r\n          error: err,\r\n          html: threadRoot.outerHTML\r\n        });\r\n      }\r\n    }\r\n  },\r\n\r\n  addCatalogThreads(records) {\r\n    const threadRoots = [];\r\n    for (var record of records) {\r\n      for (var node of record.addedNodes) {\r\n        if ((node.nodeType === Node.ELEMENT_NODE) && node.matches(g.SITE.selectors.catalog.thread)) {\r\n          threadRoots.push(node);\r\n        }\r\n      }\r\n    }\r\n    if (!threadRoots.length) { return; }\r\n    const threads = [];\r\n    const errors  = [];\r\n    Main.parseCatalogThreads(threadRoots, threads, errors);\r\n    if (errors.length) { Main.handleErrors(errors); }\r\n    return Main.callbackNodes('CatalogThreadNative', threads);\r\n  },\r\n\r\n  callbackNodes(klass, nodes) {\r\n    let node;\r\n    let i = 0;\r\n    const cb = Callbacks[klass];\r\n    while ((node = nodes[i++])) {\r\n      cb.execute(node);\r\n    }\r\n  },\r\n\r\n  callbackNodesDB(klass, nodes, cb) {\r\n    let i   = 0;\r\n    const cbs = Callbacks[klass];\r\n    const fn  = function() {\r\n      let node;\r\n      if (!(node = nodes[i])) { return false; }\r\n      cbs.execute(node);\r\n      return ++i % 250;\r\n    };\r\n\r\n    var softTask = function() {\r\n      while (fn()) {\r\n        continue;\r\n      }\r\n      if (!nodes[i]) {\r\n        if (cb) { cb(); }\r\n        return;\r\n      }\r\n      return setTimeout(softTask, 0);\r\n    };\r\n\r\n    return softTask();\r\n  },\r\n\r\n  handleErrors(errors) {\r\n    // Detect conflicts with 4chan X v2\r\n    let error;\r\n    if (d.body && $.hasClass(d.body, 'fourchan_x') && !$.hasClass(doc, 'tainted')) {\r\n      new Notice('error', 'Error: Multiple copies of 4chan X are enabled.');\r\n      $.addClass(doc, 'tainted');\r\n    }\r\n\r\n    // Detect conflicts with native extension\r\n    if (g.SITE.testNativeExtension && !$.hasClass(doc, 'tainted')) {\r\n      const {enabled} = g.SITE.testNativeExtension();\r\n      if (enabled) {\r\n        $.addClass(doc, 'tainted');\r\n        if (Conf['Disable Native Extension'] && !Main.isFirstRun) {\r\n          const msg = $.el('div',\r\n            { innerHTML: 'Failed to disable the native extension. You may need to <a href=\"' + E(meta.faq) + '#blocking-native-extension\" target=\"_blank\">block it</a>.' });\r\n          new Notice('error', msg);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!(errors instanceof Array)) {\r\n      error = errors;\r\n    } else if (errors.length === 1) {\r\n      error = errors[0];\r\n    }\r\n    if (error) {\r\n      new Notice('error', Main.parseError(error, Main.reportLink([error])), 15);\r\n      return;\r\n    }\r\n\r\n    const div = $.el('div', {\r\n      innerHTML:\r\n        `${errors.length} errors occurred.${Main.reportLink(errors).innerHTML} [<a href=\"javascript:;\">show</a>]`\r\n    });\r\n    $.on(div.lastElementChild, 'click', function () {\r\n      return [this.textContent, logs.hidden] = this.textContent === 'show' ? ['hide', false] : ['show', true];\r\n    });\r\n\r\n    var logs = $.el('div',\r\n      {hidden: true});\r\n    for (error of errors) {\r\n      $.add(logs, Main.parseError(error));\r\n    }\r\n\r\n    return new Notice('error', [div, logs], 30);\r\n  },\r\n\r\n  parseError(data, reportLink) {\r\n    c.error(data.message, data.error.stack);\r\n    const message = $.el('div',\r\n      { innerHTML: E(data.message) + ((reportLink) ? (reportLink).innerHTML : \"\") });\r\n    const error = $.el('div',\r\n      {textContent: `${data.error.name || 'Error'}: ${data.error.message || 'see console for details'}`});\r\n    const lines = data.error.stack?.match(/\\d+(?=:\\d+\\)?$)/mg)?.join().replace(/^/, ' at ') || '';\r\n    const context = $.el('div',\r\n      { textContent: `(${meta.name} ${meta.fork} v${g.VERSION} ${platform} on ${$.engine}${lines})` });\r\n    return [message, error, context];\r\n  },\r\n\r\n  reportLink(errors) {\r\n    let info;\r\n    const data = errors[0];\r\n    let title  = data.message;\r\n    if (errors.length > 1) { title += ` (+${errors.length - 1} other errors)`; }\r\n    let details = '';\r\n    const addDetails = function(text) {\r\n      if (encodeURIComponent(title + details + text + '\\n').length <= meta.newIssueMaxLength - meta.newIssue.replace(/%(title|details)/, '').length) {\r\n        return details += text + '\\n';\r\n      }\r\n    };\r\n    addDetails(`\\\r\n[Please describe the steps needed to reproduce this error.]\r\n\r\nScript: ${meta.name} ${meta.fork} v${g.VERSION} ${platform}\r\nURL: ${location.href}\r\nUser agent: ${navigator.userAgent}\\\r\n`\r\n    );\r\n    if ((platform === 'userscript') && (info = (() => {\r\n      if (typeof GM !== 'undefined' && GM !== null) { return GM.info; } else { if (typeof GM_info !== 'undefined' && GM_info !== null) { return GM_info; }\r\n  }\r\n    })())) {\r\n      addDetails(`Userscript manager: ${info.scriptHandler} ${info.version}`);\r\n    }\r\n    addDetails('\\n' + data.error);\r\n    if (data.error.stack) { addDetails(data.error.stack.replace(data.error.toString(), '').trim()); }\r\n    if (data.html) { addDetails('\\n`' + data.html + '`'); }\r\n    details = details.replace(/file:\\/{3}.+\\//g, ''); // Remove local file paths\r\n    const url = meta.newIssue.replace('%title', encodeURIComponent(title)).replace('%details', encodeURIComponent(details));\r\n    return { innerHTML: `<span class=\"report-error\"> [<a href=\"${url}\" target=\"_blank\">report</a>]</span>` };\r\n  },\r\n\r\n  isThisPageLegit() {\r\n    // not 404 error page or similar.\r\n    if (!('thisPageIsLegit' in Main)) {\r\n      Main.thisPageIsLegit = g.SITE.isThisPageLegit ?\r\n        g.SITE.isThisPageLegit()\r\n      :\r\n        !/^[45]\\d\\d\\b/.test(document.title) && !/\\.(?:json|rss)$/.test(location.pathname);\r\n    }\r\n    return Main.thisPageIsLegit;\r\n  },\r\n\r\n  ready(cb) {\r\n    return $.ready(function() {\r\n      if (Main.isThisPageLegit()) { return cb(); }\r\n    });\r\n  },\r\n\r\n  mounted(cb) {\r\n    if (Main.isMounted) {\r\n      return cb();\r\n    } else {\r\n      return Main.mountedCBs.push(cb);\r\n    }\r\n  },\r\n\r\n  mountedCBs: [],\r\n\r\n  features: [\r\n    ['Polyfill',                  Polyfill],\r\n    ['Board Configuration',       BoardConfig],\r\n    ['Normalize URL',             NormalizeURL],\r\n    ['Delay Redirect on Post',    PostRedirect],\r\n    ['Captcha Configuration',     CaptchaReplace],\r\n    ['Image Host Rewriting',      ImageHost],\r\n    ['Redirect',                  Redirect],\r\n    ['Header',                    Header],\r\n    ['Catalog Links',             CatalogLinks],\r\n    ['Settings',                  Settings],\r\n    ['Index Generator',           Index],\r\n    ['Disable Autoplay',          AntiAutoplay],\r\n    ['Announcement Hiding',       PSAHiding],\r\n    ['Fourchan thingies',         Fourchan],\r\n    ['Tinyboard Glue',            Tinyboard],\r\n    ['Color User IDs',            IDColor],\r\n    ['Highlight by User ID',      IDHighlight],\r\n    ['Count Posts by ID',         IDPostCount],\r\n    ['Custom CSS',                CustomCSS],\r\n    ['Thread Links',              ThreadLinks],\r\n    ['Linkify',                   Linkify],\r\n    ['Reveal Spoilers',           RemoveSpoilers],\r\n    ['Resurrect Quotes',          Quotify],\r\n    ['Filter',                    Filter],\r\n    ['Thread Hiding Buttons',     ThreadHiding],\r\n    ['Reply Hiding Buttons',      PostHiding],\r\n    ['Recursive',                 Recursive],\r\n    ['Strike-through Quotes',     QuoteStrikeThrough],\r\n    ['Quick Reply Personas',      QR.persona],\r\n    ['Quick Reply',               QR],\r\n    ['Cooldown',                  QR.cooldown],\r\n    ['Post Jumper',               PostJumper],\r\n    ['Pass Link',                 PassLink],\r\n    ['Menu',                      Menu],\r\n    ['Index Generator (Menu)',    Index.menu],\r\n    ['Report Link',               ReportLink],\r\n    ['Copy Text Link',            CopyTextLink],\r\n    ['Thread Hiding (Menu)',      ThreadHiding.menu],\r\n    ['Reply Hiding (Menu)',       PostHiding.menu],\r\n    ['Delete Link',               DeleteLink],\r\n    ['Filter (Menu)',             Filter.menu],\r\n    ['Edit Link',                 QR.oekaki.menu],\r\n    ['Download Link',             DownloadLink],\r\n    ['Archive Link',              ArchiveLink],\r\n    ['Quote Inlining',            QuoteInline],\r\n    ['Quote Previewing',          QuotePreview],\r\n    ['Quote Backlinks',           QuoteBacklink],\r\n    ['Mark Quotes of You',        QuoteYou],\r\n    ['Mark OP Quotes',            QuoteOP],\r\n    ['Mark Cross-thread Quotes',  QuoteCT],\r\n    ['Anonymize',                 Anonymize],\r\n    ['Time Formatting',           Time],\r\n    ['Relative Post Dates',       RelativeDates],\r\n    ['File Info Formatting',      FileInfo],\r\n    ['Fappe Tyme',                FappeTyme],\r\n    ['Gallery',                   Gallery],\r\n    ['Gallery (menu)',            Gallery.menu],\r\n    ['Sauce',                     Sauce],\r\n    ['Image Expansion',           ImageExpand],\r\n    ['Image Expansion (Menu)',    ImageExpand.menu],\r\n    ['Reveal Spoiler Thumbnails', RevealSpoilers],\r\n    ['Image Loading',             ImageLoader],\r\n    ['Image Hover',               ImageHover],\r\n    ['Volume Control',            Volume],\r\n    ['WEBM Metadata',             Metadata],\r\n    ['Comment Expansion',         ExpandComment],\r\n    ['Thread Expansion',          ExpandThread],\r\n    ['Favicon',                   Favicon],\r\n    ['Unread',                    Unread],\r\n    ['Unread Line in Index',      UnreadIndex],\r\n    ['Quote Threading',           QuoteThreading],\r\n    ['Thread Stats',              ThreadStats],\r\n    ['Thread Updater',            ThreadUpdater],\r\n    ['Thread Watcher',            ThreadWatcher],\r\n    ['Thread Watcher (Menu)',     ThreadWatcher.menu],\r\n    ['Mark New IPs',              MarkNewIPs],\r\n    ['Index Navigation',          Nav],\r\n    ['Keybinds',                  Keybinds],\r\n    ['Banner',                    Banner],\r\n    ['Announcements',             PSA],\r\n    ['Flash Features',            Flash],\r\n    ['Reply Pruning',             ReplyPruning],\r\n    ['Mod Contact Links',         ModContact],\r\n    ['Restore deleted posts from archive', RestoreDeletedFromArchive],\r\n  ]\r\n};\r\nexport default Main;\r\n$.ready(() => Main.init());\r\n\r\n// <% if (readJSON('/.tests_enabled')) { %>\r\n// Main.features.push(['Build Test', Test]);\r\n// <% } %>\r\n","import Callbacks from \"../classes/Callbacks\";\r\nimport Get from \"../General/Get\";\r\nimport { g, Conf } from \"../globals/globals\";\r\nimport $ from \"../platform/$\";\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\r\n */\r\nconst QuoteStrikeThrough = {\r\n  init() {\r\n    if (!['index', 'thread'].includes(g.VIEW) ||\r\n      (!Conf['Reply Hiding Buttons'] && (!Conf['Menu'] || !Conf['Reply Hiding Link']) && !Conf['Filter'])) { return; }\r\n\r\n    return Callbacks.Post.push({\r\n      name: 'Strike-through Quotes',\r\n      cb:   this.node\r\n    });\r\n  },\r\n\r\n  node() {\r\n    if (this.isClone) { return; }\r\n    for (var quotelink of this.nodes.quotelinks) {\r\n      var {boardID, postID} = Get.postDataFromLink(quotelink);\r\n      if (g.posts.get(`${boardID}.${postID}`)?.isHidden) {\r\n        $.addClass(quotelink, 'filtered');\r\n      }\r\n    }\r\n  }\r\n};\r\nexport default QuoteStrikeThrough;\r\n"],"names":["Conf","Object","create","g","VERSION","version","VERSION_DATE","Date","NAMESPACE","meta","name","sites","boards","E","str","regex","fn","x","output","text","toString","replace","cat","templates","html","i","length","innerHTML","d","document","doc","documentElement","c","console","docSet","Callbacks","static","this","Post","Thread","CatalogThread","CatalogThreadNative","constructor","type","keys","push","cb","execute","node","force","errors","callbacksExecuted","call","err","message","ID","board","join","error","nodes","root","outerHTML","Main","handleErrors","initClass","Config","main","Miscellaneous","Keybinds","Linkification","Linkify","Embedding","Filtering","Anonymize","Filter","Stubs","Gallery","Sauce","Autoplay","Menu","Monitoring","Cooldown","imageExpansion","gallery","threadWatcher","filter","general","postID","uniqueID","tripcode","capcode","pass","email","subject","comment","flag","filename","dimensions","filesize","MD5","sauces","FappeT","werk","Index","Header","archives","archiveLists","lastarchivecheck","archiveAutoUpdate","externalCatalogURLs","boardnav","QR","sjisPreview","jsWhitelist","captchaLanguage","time","timeLocale","backlink","pastedname","fileInfo","favicon","usercss","hotkeys","Close","Watch","Update","Pause","Slideshow","fappeTyme","werkTyme","Hide","updater","checkbox","Beep","Interval","customCooldown","customCooldownEnabled","position","fourchanImageHost","hiddenPSAList","knownBanners","passMessageClosed","PSAseen","Favicon","init","$","asap","head","el","initAsap","set","status","href","add","isSFW","test","default","switch","items","ferongr","Mayhem","Original","Metro","getOwn","f","unreadDead","unreadDeadY","unreadSFW","unreadSFWY","unreadNSFW","unreadNSFWY","update","unread","unreadY","SFW","NSFW","dead","logo","$$","selector","body","Array","from","querySelectorAll","CaptchaReplace","SITE","software","cookie","indexOf","jsEnabled","ready","noscript","trim","includes","location","hostname","onExists","iframe","original","toggle","parentNode","span","id","rm","insert","textContent","on","lang","src","encodeURIComponent","CaptchaT","isEnabled","className","addClass","after","com","moreNeeded","getThread","threadID","boardID","BOARD","posts","thread","setup","focus","container","prepend","currentThread","global","querySelector","window","TCaptcha","setErrorCb","dispatchEvent","CustomEvent","detail","content","destroy","updateThread","newThread","getOne","response","key","value","setUsed","clearChallenge","occupied","debounce","wait","lastCall","timeout","that","args","exec","now","apply","arguments","clearTimeout","setTimeout","dict","clone","obj","arr","end","map","val","json","JSON","parse","SECOND","MINUTE","HOUR","DAY","platform","GM_xmlhttpRequest","DataBoard","sync","dontClean","changes","onSync","bind","initData","clean","off","data","lastChecked","save","change","get","needSync","forceSync","delete","siteID","deleteIfEmpty","setUnsafe","undefined","base","extend","oldVal","defaultValue","subVal","setLastChecked","middle","ajaxClean","threadsList","urls","threadsListJSON","cache","archiveList","archiveListJSON","ajaxCleanParse","response1","archivedBoardsKnown","response2","threads","page","no","SimpleDict","splice","forEach","fullID","isDead","isHidden","isSticky","isClosed","isArchived","postLimit","fileLimit","lastPost","ipCount","OP","catalogView","setPage","pageNum","icon","info","reply","previousSibling","tn","title","pageCount","setCount","count","reachedLimit","rmClass","setStatus","setIcon","typeLC","toLowerCase","icons","Build","staticPath","gifIcon","alt","style","cssText","quote","cloneNode","kill","collect","n","post","clones","thumb","postCount","fileCount","replies","currentMenu","lastToggledButton","setPosition","close","keybinds","onFocus","addEntry","open","entries","makeMenu","menu","tabIndex","dataset","e","stopPropagation","button","preventDefault","previousButton","entry","sort","first","second","order","insertEntry","mRect","getBoundingClientRect","bRect","scrollY","top","scrollX","left","cHeight","clientHeight","cWidth","clientWidth","bottom","height","right","width","classList","parent","submenu","subEntries","subEntry","findNextEntry","direction","children","next","keyCode","click","firstElementChild","nextPrev","target","focused","sRect","eRect","parseEntry","dragstart","isTouching","changedTouches","rect","screenHeight","screenWidth","o","dx","clientX","dy","clientY","topBorder","bottomBorder","bar","identifier","move","touchmove","up","touchend","drag","dragend","touch","hoverstart","latestEvent","endEvents","noRemove","isImage","nodeName","hover","hoverend","MutationObserver","observe","childList","workaround","contains","padding","offsetHeight","offsetWidth","Math","max","min","threshold","marginX","UI","dialog","properties","child","tagName","checked","label","input","Nav","VIEW","prev","append","scrollTo","scroll","scrollHeight","THREADID","hasClass","threadRoot","selectors","Get","threadFromRoot","stub","getTopOf","delta","activeElement","blur","axis","xpath","extra","marginBottom","haveExtra","removeExtra","ImageHost","useFaster","suggestions","host","flashHost","thumbHost","isClone","file","url","split","link","thumbLink","fixLinks","links","pathname","Volume","inputs","unmute","volume","noAudio","catalogNode","unmuteEntry","volumeEntry","video","muted","files","isVideo","wheel","shiftKey","altKey","ctrlKey","metaKey","hasAudio","deltaY","minmax","ImageCommon","pause","rewind","readyState","HAVE_METADATA","currentTime","queueTask","pushCache","cacheError","popCache","decodeError","fileObj","code","MediaError","MEDIA_ERR_DECODE","isFromArchive","delay","timeoutID","Redirect","to","securityCheck","redirect","threadJSON","parseJSON","isArchiveURL","needle","postObj","archivedThreadJSON","ajax","onloadend","index","docIndex","filesDeleted","addControls","handler","t","getTime","engine","duration","controls","onControls","download","protocol","CrossOrigin","blob","a","URL","createObjectURL","hidden","Notice","Audio","setupSync","audio","addEventListener","play","playbackRate","once","setupAudioSlider","createElement","appendChild","createTextNode","control","step","valueAsNumber","downloadLink","ImageExpand","enabled","EAI","toggleAll","addShortcut","playVideos","videoControls","isExpanding","contract","expand","isExpanded","fullImage","setupVideoCB","setupVideo","origin","paused","wasPlaying","isFetchedQuote","isSpoiler","modifiedClick","postFromNode","func","event","setProperty","visible","isNodeVisible","setFitness","scrollIntoView","oldHeight","scrollBy","scrollToIfNeeded","eventName","videoCB","remove","audioSlider","fileID","removeAttribute","loop","completeExpand","naturalHeight","soundUrlMatch","match","decodeURIComponent","startsWith","audioEl","parentElement","autoplay","imageBottom","getBottomOf","playing","mousedown","mouseover","mouseup","mouseout","buttons","createSubEntry","conf","desc","flags","context","isReply","parseNodes","flagCode","toUpperCase","flagCodeTroll","date","parseDate","nameBlock","parseComment","parseQuotes","parseFiles","isRebuilt","s","infoRoot","isOPContainerThread","opBottom","quotelinks","archivelinks","embedlinks","backlinks","getElementsByClassName","uniqueIDRoot","bq","normalize","commentClean","cleanComment","nodesToText","commentDisplay","cleanSpoilers","cleanCommentDisplay","commentOrig","insertTags","X","snapshotItem","spoilers","spoiler","quotelink","quotes","parseQuote","regexp","fileRoots","fileRoot","parseFile","multifile","roots","size","unit","sizeInBytes","strong","allQuotelinksLinkingTo","deadMark","resurrect","some","addClone","contractThumb","PostClone","rmClone","slice","setCatalogOP","isCatalogOP","super","cloneWithoutVideo","suffix","inline","inlined","originFile","videoThumb","md5","nodeType","Node","ELEMENT_NODE","childNodes","makeButton","Recursive","recursives","recursive","PostHiding","db","sa","thisPost","hide","makeStub","hideRecursively","sideArrows","firstChild","div","show","hideStubLink","hideStub","saveHiddenState","isHiding","showRecursively","RelativeDates","INTERVAL","flush","dateEl","relative","diff","abbrev","number","years","getFullYear","months","getMonth","days","getDate","rounded","round","stale","isPost","utc","singlePost","concat","setOwnTimeout","markStale","Element","BoardConfig","cbs","load","statusText","config","sfwBoards","sfw","result","object","ws_board","domain","is_archived","webm_audio","Board","cooldowns","c2","image","images","thread_global","ceil","PostRedirect","delays","ExpandComment","callbacks","longComment","shortComment","req","spoilerRange","custom_spoiler","getAttribute","callback","QuoteYou","mark","isYou","postDataFromLink","quoter","seek","highlighted","highlight","classes","lastRead","snapshotLength","postFromRoot","sel","postContainer","highlightable","matches","RandomAccessList","item","last","before","rmi","shift","Unread","hr","Set","postsQuotingYou","addPost","lastReadPost","readCount","one","onUpdate","resetLink","reset","setLine","read","positionPrev","hash","updatePosition","postIDs","addPostQuotingYou","openNotification","predicate","areNotificationsEnabled","notif","Notification","onclick","onshow","readSinglePost","has","saveLastReadPost","oldPosition","linePosition","nextSibling","countQuotingYou","titleQuotingYou","titleCount","titleDead","saveThreadWatcherCount","quotingYou","ThreadWatcher","ExpandThread","statuses","onIndexRefresh","setButton","summaryText","cursor","cbToggle","disconnect","refresh","oldReq","abort","threadFromNode","cbToggleBottom","numReplies","replyOriginal","postsCount","filesCount","postsRoot","postData","postFromObject","callbackNodes","a2","UnreadIndex","markReadLink","onPostsInserted","isCatalog","threadIDs","wasVisible","divider","repliesShown","repliesRead","firstUnread","summary","hasUnread","markRead","threadDivider","sc","shortcut","dbLM","list","lastElementChild","refreshButton","closeButton","unreaddb","unreadEnabled","toggleWatcher","buttonFetchAll","addHeaderMenuEntry","addDialog","onIndexUpdate","onThreadRefresh","initLastModified","fetchAuto","isWatched","isWatchedRaw","setToggler","toggler","excerpt","threadExcerpt","isThisPageLegit","build","toggleClass","openAll","openUnread","openDeads","pruneDeads","getAll","dismiss","addRaw","nKilled","fetchStatus","requests","fetched","fetch","lastModified","whenModified","finished","clearRequests","syncing","lm","interval","hasFocus","fetchAllStatus","dbs","dbi","middle1","deep","lastChecked2","fetchBoard","modified","site","urlF","threadModTimeIgnoresSage","parseBoard","lmDate","getResponseHeader","pageLength","nThreads","oldest","last_modified","lastPage","isPrunedByAge","newData","parseStatus","archived","youOP","quotesYou","quotelinkHTML","lastIndex","archiveURL","mayLackJSON","groupByBoard","all","cont","makeLine","prefixes","setPrefixes","len","prefix","conflicts","conflicts2","siteID2","rmAll","refreshIcon","deferred","line","newLine","set404","oldData","addMenuEntries","entryEl","addCheckbox","disabled","isEscaped","Symbol","voidElements","hFragment","h","tag","attributes","attribute","isVoid","TypeError","parseArchivePost","Fetcher","archiveTags","greentext","text2","j","num","thread_num","shortname","fileDeleted","trip","poster_hash","poster_country","troll_country_code","poster_country_name","troll_country_name","dateUTC","timestamp","dateText","fourchan_date","commentHTML","media","banned","media_filename","thumb_link","media_link","media_orig","media_h","media_w","media_hash","bytesToString","media_size","thumbURL","preview_orig","theight","preview_h","twidth","preview_w","exif","Tag","replyData","isCached","fetchedPost","archivedPost","flagCSS","cssVersion","rel","api","cleanCache","archive","encryptionOK","parseArchivedPost","QuotePreview","qp","pop","showHiddenThreads","changed","enabledOn","initFinished","postsInserted","search","history","state","searched","mode","currentSort","currentPage","getCurrentPage","processHash","popstate","resort","watchSettings","sortEntry","select","perBoardSort","navLinks","CatalogLinks","catalog","refreshFront","searchInput","setupSearch","onSearchInput","clearSearch","hideLabel","toggleHiddenThreads","selectRev","selectMode","selectSort","selectSize","lastLongOptions","lastLongInputs","lastLongThresholds","tRaw","hoverToggle","pagelist","pageNav","hat","addStyle","loaded","implementation","createDocument","topNavPos","previousElementSibling","timeEl","liveThreadData","innerHeight","pagesNum","endNotice","threadsOnPage","buildStructure","notify","toggleHide","threadPosition","floor","threadsNumPerPage","ThreadHiding","cycleSortType","types","options","option","selected","initFinishedFired","indexRefreshSeen","buildIndex","pushState","pageLoad","saveSort","saveLastLongThresholds","Number","isFinite","catalogReplies","hoverAdjust","setState","nCommands","userPageNav","buildCatalogReplies","scrollToIndex","hashCommands","paged","infinite","commands","leftover","command","pageBeforeSearch","oldpage","savePerBoard","buildPagelist","setupMode","setupSort","getPagesNum","sortedThreadIDs","getMaxPageNum","pagesRoot","maxPageNum","childElementCount","nextElementSibling","updateHideLabel","hiddenCount","liveThreadIDs","firstTime","notice","nTimeout","catalogJSON","reload","setType","stack","pages","parseThreadList","reduce","liveThreadDict","parsedThreads","results","filterResults","isOnTop","last_replies","isHiddenReply","buildThreads","withReplies","newThreads","newPosts","opRoot","threadData","stringify","bumplimit","ext","imagelimit","sticky","closed","buildReplies","lastReplies","buildCatalogViews","catalogThreads","catalogThread","sizeCatalogViews","ratio","catalogReply","tmp_time","sortType","repliesAvailable","lastlong","iterable","r","omitted_posts","lastlongD","b","reverse","querySearch","sortOnTop","topThreads","bottomThreads","buildCatalog","nodesPerPage","offset","node0","buildCatalogPart","searching","query","keywords","RegExp","values","searchMatch","keyword","Index$1","catalogWatch","catalogSet","hasStorage","hiddenThreads","localStorage","setItem","getItem","catalogSave","subtree","attributeFilter","hiddenThreads2","hasOwn","separator","settingsHtml","class","changelog","issues","CSS","report","www","sub","css","variables","words","CustomCSS","rmStyle","SWTinyboard","disabledFeatures","detect","script","m","awaitBoard","boardFor","mounted","op","boardList","boardListBottom","styleSheet","psa","nav","replyContainer","extra_files","parseJSONFile","unescape","bgColoredEl","isFileURL","preParsingFixes","broken","splitText","isNaN","infoNode","nameNode","isThumbExpanded","expanded","isLinkified","catalogPin","passMessagePage","captchaFAQ","PassMessage","msg","PassMessagePage","hd","Report","Captcha","fit","getComputedStyle","visibility","resizeBy","form","fieldset","reason","submit","archiveSubmit","action","archiveResults","formData","success","PostSuccessful","_","SWYotsuba","hasIPCount","areMD5sDeferred","isOnePage","psaTop","searchBox","captcha","doctype","is404","isIncomplete","isBoardlessPage","isAuxiliaryPage","initAuxiliary","navigate","scriptData","parseThreadMetadata","abbr","br","hasCORS","uidColor","uid","charCodeAt","testNativeExtension","Parser","postMenuIcon","transformBoardList","spacer","chr","nodeValue","devicePixelRatio","shortFilename","spoilerThumb","random","sameThread","threadURL","postURL","resto","filedeleted","since4pass","country","board_flag","country_name","flag_name","capcodeHighlight","tim","w","fsize","tn_h","tn_w","hasDownscale","m_img","parseCommentDisplay","html2","capcodeDescription","capcodePlural","capcodeLC","capcodeLong","Admin","Mod","postInfo","postLink","quoteLink","nameHtml","nameBlockContent","postNumContent","generatePostInfoHtml","fileURL","fileThumb","fileBlock","fileContent","loading","generateFileHtml","postClass","wholePost","imgClass","generateCatalogThreadHtml","highlights","SW","tinyboard","yotsuba","FileInfo","quickFilterMD5","oldInfo","format","formatString","outputNode","formatters","T","l","L","N","fullname","p","B","K","M","Time","zeroPad","formatterCache","Map","formatter","Intl","DateTimeFormat","weekday","A","month","H","getHours","I","k","getMinutes","hour","hour12","formatToParts","find","P","S","getSeconds","y","Y","ReplyPruning","frag","setEnabled","hiddenFiles","total","totalFiles","other","QuoteThreading","active","showIfHidden","updateCount","boardTop","hidden1","hidden2","oldPos","lastChild","threadNewLink","rethread","setThread","inserted","toggleThreading","setThreadingState","navLinksBot","parents","lastParent","ancestor","descendants","threadContainer","prev2","ThreadUpdater","beep","checkPostCount","timer","updateLink","scrollBG","setInterval","settings","intervalShortcut","outdateCount","fileIDs","checkpost","playBeep","seconds","parseInt","confirmed","limit","cur","Settings","klass","updateThreadStatus","ipCountEl","postObjects","unique_ips","postObject","deletedPosts","deletedFiles","unreadCount","unreadQYCount","firstPost","addSection","sauce","advanced","disableAll","defineProperty","openSection","sectionToOpen","SettingsPage","export","import","onImport","section","sections","hyphenatedTitle","scrollTop","warnings","cantSync","why","cantSet","ads","ad","addWarning","warning","addCheckboxes","containers","description","level","keyFS","fs","perProtocolSettings","hiddenPosts","hiddenNum","removeItem","Conf2","downloadExport","Blob","confirm","reader","FileReader","onload","loadSettings","readAsText","convertFrom","loadletter","prevKey","newKey","convertSettings","uniqueid","mod","openEmptyQR","openQR","openOptions","sageru","sjis","watch","unreadCountTo0","expandAllImages","expandImage","zero","nextPage","previousPage","nextThread","previousThread","expandThread","openThreadTab","openThread","nextReply","previousReply","Scrolling","Verbose","WatchedThreads","upgrade","corrupted","setD","addSauces","addCSS","compareString","padStart","val2","error1","uids","Moe","warosu","fgts","not4plebs","DesuStorage","record","rice","siteProperties","faq","clear","selectFilter","ta","spellcheck","feature","listImageHost","customCSS","applyCSS","togglecss","itemsArchive","selectArchives","addArchiveTable","boardSelect","table","updateArchives","toLocaleString","tbody","archBoards","rows","boardOptions","row","addArchiveCell","td","setAttribute","saveSelectedArchive","selectedArchives","boardid","generateBoardList","img","tr","keybind","FappeTyme","fappe","lc","indicator","check","linkData","parseLink","parts","part","parseBoards","createSauceLink","missing","orig","parameter","skip","skipped","observer","node2","TURL","IMG","sMD5","hMD5","atob","semi","generateThumb","mozRequestFullScreen","webkitRequestFullScreen","ALLOW_KEYBOARD_INPUT","slideshow","frame","thumbs","current","menuButton","blank","start","stop","createSubEntries","postThumb","keydown","setHeight","candidate","overflow","thumbImg","errorCB","elType","webm","mp4","ogv","pdf","oldID","newID","offsetTop","setupTimer","cleanupTimer","startTimer","checkTimer","complete","advance","toggleSlideshow","rotateLeft","rotateRight","rotate","dataRotate","transform","mozCancelFullScreen","webkitExitFullscreen","dim","margin","minHeight","containerWidth","containerHeight","minWidth","maxWidth","maxHeight","setDelay","delayLabel","delayInput","ordered_types","embed","catalogRemove","service","batchSize","flushTitles","events","services","preview","process","regExp","closeFloat","dragEmbed","lastEmbed","pointerEvents","queue","post2","link2","preload","hrefEsc","videoHeight","counter","prettyPrint","getElementById","currentScript","hasOwnProperty","names","contentWindow","postMessage","element","onMessage","source","hotkey","notifications","toggleBoardList","toggleBarVisibility","postingIsEnabled","qr","notification","display","tags","sage","fileSubmit","toggleCustomCooldown","handleUrl","hl","kc","String","fromCharCode","code_tags","math_tags","sjis_tags","selStart","selectionStart","selEnd","selectionEnd","range","setSelectionRange","isSage","tab","replySelector","postEl","Cache","saveAPI","noCaptcha","captchas","getCount","neededRaw","haveCookie","submitCB","isOnlyQuotes","needed","prerequest","prerequested","cooldown","request","Replace","v2","lifetime","timeouts","prevNeeded","noscriptURL","recaptchaKey","auto","afterSetup","setupNoscript","setupJS","scrolling","textarea","render","widgetID","grecaptcha","sitekey","theme","cbNative","onRecaptchaLoaded","mutations","mutation","addedNodes","setupIFrame","setupTextArea","fixQRPosition","pasted","token","mimeTypes","validExtension","typeFromExtension","jpg","jpeg","png","gif","swf","extensionFromType","initReady","origToggle","captchaVersion","prop","def","min_width","min_height","max_width","max_height","max_size","max_size_video","max_comment","max_width_video","max_height_video","max_duration_video","forcedAnon","forced_anon","linkBot","getFile","drawFile","setFile","paste","dragOver","dropFile","generatePostableThreadsList","statusCheck","unhide","cleanNotifications","inBubble","bubbles","autohide","toggleSJIS","texPreviewShow","texPreviewHide","texPreview","wasOpen","setCustomCooldown","focusOverride","onclose","alert","connectionError","progress","openPost","isLocked","getSelection","postRange","Range","selectNode","rangeCount","asc","insideCode","getRangeAt","compareBoundaryPoints","START_TO_START","setStartBefore","END_TO_END","setEndAfter","cloneContents","commonAncestorContainer","wasOnlyQuotes","caretPos","quotedText","characterCount","charCount","openError","getContext","drawImage","revokeObjectURL","handleFiles","dataTransfer","dropEffect","clipboardData","score","file2","kind","getAsFile","score2","pasteFF","pasteArea","bstr","Uint8Array","urlDefault","preventAutoPost","permission","prompt","fileButton","handleFile","nfiles","isText","pasting","openFileInput","fileInput","setNode","flagsInput","sjisToggle","texButton","drawButton","oekaki","draw","noFile","oekakiButton","fileRM","rmFile","urlButton","dumpButton","DataTransferItemList","persona","addFlag","country_flags","board_flags","filetag","forceSave","flashTag","require_subject","text_only","lock","MAX_FILE_SIZE","pwd","getPassword","upfile","responseType","withCredentials","onprogress","upload","isUploadFinished","currentCaptcha","challenge","unlock","connErr","errorCount","addDelay","mi","addMute","h1","lastPostToThread","waitForThread","attempts","deletion","maxDelay","isSetup","isCounting","categorize","secondsDeletion","mergeChange","scope","nCooldowns","elapsed","editFile","canvas","videoWidth","toBlob","snapshot","edit","FCX","oekakiCB","Tegaki","flatten","oekakiLatest","oekakiName","bg","onDone","onCancel","bgColor","removeEventListener","naturalWidth","onOpenImageLoaded","onDoneCb","resume","always","parseItem","draggable","dumpList","dismissErrors","rectEl","rectList","scrollLeft","showFileData","forced","updateComment","saveFilename","updateFilename","setComment","rmErrored","fileError","checkSize","rmMetadata","backgroundImage","readFile","canPlayType","onerror","checkDimensions","setThumbnail","cv","attr","newName","long","pasteText","dragStart","setDragImage","dragEnd","dragEnter","dragLeave","drop","oldIndex","newIndex","eventPageRequest","chrome","runtime","addListener","params","sendMessage","binary","headers","responseHeaderString","fallback","getAllResponseHeaders","gmOptions","method","overrideMimeType","xhr","ArrayBuffer","responseText","responseHeaders","onabort","GM","xmlHttpRequest","contentType","contentDisposition","mime","Request","prototype","headerName","header","gmReq","ontimeout","cbFail","origins","CrossOrigin$1","fc","HTMLFormElement","FormData","fd","pageXHR","wrappedJSObject","XMLHttpRequest","XPCNativeWrapper","testCORB","ajaxPage","setRequestHeader","warn","send","requestID","ajaxPageInit","DOMParser","parseFromString","bucket","url0","reqs","testf","addCSP","policy","httpEquiv","path","evaluate","singleNodeValue","classNames","createDocumentFragment","insertBefore","replaceChild","properties2","globalThis","extension","cloneInto","defaultView","cancelable","navigator","userAgent","GM_info","unsafeConstructors","unsafeWindow","obj2","openInTab","GM_openInTab","taskQueue","execTask","Promise","resolve","then","mozHasAudio","webkitAudioDecodedByteCount","luma","rgb","oneItemSugar","oldValue","local","storage","onChanged","area","newValue","crxWorking","getManifest","crxWarningShown","lastError","result2","exceedsQuota","QUOTA_BYTES_PER_ITEM","setArea","setSync","done","deleteValue","BroadcastChannel","GM_addValueChangeListener","GM_deleteValue","getValue","GM_getValue","listValues","GM_listValues","setValue","GM_setValue","key2","remote","onChange","getSync","syncChannel","catch","$$1","IDs","handleQuotes","qPost","Get$1","filters","isstring","excludes","mask","only","noti","filterObj","filtersForType","boardsRaw","parseBoardsMemo","siteFilter","boardID2","hideable","filtersOrMap","isArray","catalogData","catalogParse","catalogViewNative","valueF","v","addFilter","re","removeFilters","res","flat","escape","showFilters","tl","textLength","quickFilterCB","undo","makeFilter","Site","defaultProperties","canonical","parseURL","catalogURL","catalogLink","useCatalog","setLinks","bottomBoardList","tail","indexOptions","externalParse","externalList","external","jsonIndex","nativeCatalog","noticesRoot","setBarPosition","box","barFixedToggler","headerToggler","scrollHeaderToggler","barPositionToggler","linkJustifyToggler","customNavToggler","footerToggler","shortcutToggler","editCustomNav","menuToggle","toggleBarFixed","toggleBarPosition","toggleHideBarOnScroll","toggleLinkJustify","toggleFooterVisibility","toggleShortcutIcons","toggleCustomNav","setBarFixed","setHideBarOnScroll","setBarVisibility","setLinkJustify","setShortcutIcons","setFooterVisibility","createNotification","setBoardList","generateFullBoardList","footer","absbot","cloneTopNav","cs","enableDesktopNotifications","shortcuts","btn","setCustomNav","fullBoardList","mapCustomNavigation","m0","m1","m2","urlV","urlIC","custom","full","showBoardList","centered","fixed","hideBarOnScroll","offsetY","pageYOffset","previousOffset","cust","down","offsetParent","headRect","rmShortcut","authorize","disable","requestPermission","Header$1","opacity","responses","nloaded","fail","archiveUIDs","dest","Developer","Verified","https","reports","alternative","Redirect$1","ImageHover","scale","ImageLoader","prefetchEnabled","prefetchAll","replaceVideo","prefetch","poster","isPrefetched","qpClone","Metadata","readInt","RevealSpoilers","regString","space","saved","endNode","word","part1","part2","makeRange","makeLink","startNode","startOffset","endOffset","createRange","setStart","setEnd","encodedDomain","startContainer","charAt","endContainer","extractContents","insertNode","ArchiveLink","typeParam","isSearch","CopyTextLink","copy","execCommand","DeleteLink","fileEl","postEntry","linkText","fileEntry","menuText","fileOnly","onlyimgdel","resDoc","DownloadLink","ReportLink","dims","AntiAutoplay","processVideo","Banner","banner","setTitle","bannerCnt","choices","contentEditable","Flash","SWFEmbed","tid","Fourchan","initBoard","pre","prettyPrintOne","MathJax","Hub","Queue","loadMathJax","math","clickable_ids","idClick","wbrs","wbr","IDColor","ids","compute","color","backgroundColor","IDHighlight","IDPostCount","ModContact","moved","specific","template","moveNote","Manager","qa","NormalizeURL","replaceState","PostJumper","makeButtons","addListeners","addButtons","buttonClick","toJumper","dir","jumper","jumper2","fromJumper","prevPos","destPos","PSA","announcement","PSAHiding","RemoveSpoilers","unspoiler","ThreadLinks","Tinyboard","ajaxComplete","responseJSON","noko","originalNoko","tb_settings","always_noko_replies","MarkNewIPs","markNew","markOld","ThreadStats","postIndex","statsHTML","statsTitle","showPurgePos","postCountEl","fileCountEl","pageCountEl","fetchPage","showPage","onThreadsLoad","purgePos","lastPageUpdate","retry","PassLink","styleSelector","passLink","QuoteInline","qiQuote","findRoot","isBacklink","qroot","forwarded","QuoteBacklink","bottomBacklinks","firstNode","secondNode","markYours","getContainer","backlinkContainer","QuoteCT","QuoteOP","Quotify","parseArchivelink","deadlink","parseDeadlink","fixDeadlink","quoteID","fetchable","green","Polyfill","mozMatchesSelector","webkitMatchesSelector","HTMLCanvasElement","encoderOptions","toDataURL","ui8a","RestoreDeletedFromArchive","restore","nrRestored","archivePosts","raw","postIdNr","indexOfNext","findIndex","newPost","insertAdjacentElement","menuEntry","frameElement","buildDate","freeze","writable","expectInitFinished","mountedCB","isMounted","mountedCBs","error2","fromCharCode0","Error","boardTitle","previousversion","isFirstRun","initFeatures","threadArchived","initStyle","features","mobileLink","innerWidth","bgColorStyle","keyboard","setClass","mainStyleSheet","styleSheets","knownStyles","setStyle","backgroundRepeat","backgroundPosition","initCatalog","initThread","addThreadsObserver","addThreads","addPostsObserver","addPosts","parseThreads","callbackNodesDB","threadRoots","boardObj","postRoots","unshift","parsePosts","postRoot","records","threadsRM","anyRemoved","removedNodes","addCatalogThreadsObserver","addCatalogThreads","parseCatalogThreads","softTask","parseError","reportLink","logs","lines","fork","details","addDetails","newIssueMaxLength","newIssue","scriptHandler","thisPageIsLegit","Main$1"],"mappings":"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BAAqB,EACnB,EACA,qCACA,GAEF,cAAe,EACb,EACA,iDACA,GAEF,eAAgB,EACd,EACA,mCACA,GAEF,YAAa,EACX,EACA,wFACA,GAEF,gBAAiB,EACf,EACA,0DACA,IAIJC,WAAc,CACZ,iBAAkB,EAChB,EACA,6FAEF,eAAgB,EACd,EACA,iDAEF,eAAgB,EACd,EACA,uDACA,GAEF,2BAA4B,EAC1B,EACA,kEACA;AAEF,iBAAkB,EAChB,EACA,yDAEF,cAAe,EACb,EACA,2DAEF,0BAA2B,EACzB,EACA,4DAEF,2BAA4B,EAC1B,EACA,6DACA,GAEF,uBAAwB,EACtB,EACA,qEACA,GAEF,wBAAyB,EACvB,EACA,4EAEF,eAAgB,EACd,EACA,kCAEF,oBAAqB,EACnB,EACA,mDACA,GAEF,sBAAuB,EACrB,EACA,8CACA,GAEF,8BAA+B,EAC7B,EACA,sFAEF,iBAAkB,EAChB,EACA;AAEF,uBAAwB,EACtB,EACA,iDACA,GAEF,4BAA6B,EAC3B,EACA,8DACA,GAEF,eAAgB,EACd,EACA,qEAEF,gBAAiB,EACf,EACA,oGAEF,oBAAqB,EACnB,EACA,oDACA,IAIJ,uBAAwB,CACtB,cAAe,EACb,EACA,wEAEF,gBAAiB,EACf,EACA,iDACA,GAEF,eAAgB,EACd,EACA,mDACA,GAEF,uBAAwB,EACtB,EACA,oGACA,GAEF,mBAAoB,EAClB,EACA,wCACA;AAEF,mBAAoB,EAClB,EACA,kEACA,GAEF,qBAAsB,EACpB,EACA,gFACA,GAEF,oCAAqC,EACnC,EACA,yEACA,GAEF,uBAAwB,EACtB,EACA,iEACA,GAEFC,SAAY,EACV,EACA,oDACA,GAEF,gCAAiC,EAC/B,EACA,oEACA,GAEF,oBAAqB,EACnB,EACA,uEACA,GAEF,6BAA8B,EAC5B,EACA,6DACA,GAEF,yBAA0B,EACxB,EACA,0EAEF,YAAa,EACX,EACA,2DAIJ,cAAe;AACb,kBAAmB,EACjB,EACA,wBAEF,eAAgB,EACd,EACA,2BACA,GAEF,mBAAoB,EAClB,EACA,0CACA,GAEF,iBAAkB,EAChB,EACA,gCAEF,kCAAmC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"}